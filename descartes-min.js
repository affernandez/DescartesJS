/*
 Joel Espinosa Longi
 joel.espinosa@amite.mx
 j.longi@gmail.com
 LGPL - http://www.gnu.org/licenses/lgpl.html
 2013-04-30
*/
var babel=function(a){if(a.loadLib)return a;a.falso=a["false"]=a.fals=a.gezurra=a.faux=a.fals="false";a.verdadero=a["true"]=a.veritable=a.egia=a.vrai=a.verdadeiro=a.veritable="true";a.no=a.ez=a.non=a["n\u00e3o"]="false";a["s\u00ed"]=a.yes=a.bai=a.oui=a.si=a["sim "]="true";a.negro=a.black=a.negre=a.beltza=a.noir=a.preto="#000000";a.maxenta=a.magenta="#ff00ff";a.azul=a.blue=a.blau=a.urdina=a.bleu="#0000ff";a.turquesa=a.cyan=a.turkesa=a.turquoise="#00ffff";a.verde=a.green=a.verd=a.berdea=a.vert="#00ff00";
a.amarillo=a.yellow=a.groc=a.horia=a.jaune=a.amarelo="#ffff00";a.naranja=a.orange=a.taronja=a.laranja=a.laranxa="#ffc800";a.rojo=a.red=a.vermell=a.gorria=a.rouge=a.vermello=a.vermelho="#ff0000";a.pink=a.rosa=a.arrosa=a.rose="#ffafaf";a.grisObscuro=a.darkGray=a.grisFosc=a["gris iluna"]=a.grisObscur=a.grisEscuro=a.cinzaEscuro="#404040";a.gris=a.gray=a.grisa=a.cinza="#808080";a.grisClaro=a.lightGray=a.grisClar=a["gris argia"]=a.grisClair=a.cinzaClaro="#c0c0c0";a.blanco=a.white=a.blanc=a.zuria=a.branco=
"#ffffff";a.escala=a.scale=a.eskala=a["\u00e9chelle"]="scale";a.nombre=a.name=a.nom=a.izena=a.nome="name";a.ikusgai=a["vis\u00edvel"]=a.visible="visible";a.rastro=a.trace=a.rastre=a.arrastoa="trace";a.fondo=a.background=a.fons=a.hondoa=a.fond=a.fundo="background";a.colour=a.color=a.kolorea=a.couleur=a.cor="color";a["par\u00e1metro"]=a.parameter=a.parametroa=a["par\u00e2metro"]=a["par\u00e0metre"]="parameter";a["sucesi\u00f3n"]=a.sequence=a["successi\u00f3"]=a.segida=a.succession=a["seq\u00fc\u00eancia"]=
"sequence";a["tama\u00f1o"]=a.size=a.neurria=a.taille=a.tamanho=a["grand\u00e0ria"]="size";a.decimales=a.decimals=a.hamartarra=a["d\u00e9cimales"]=a.decimais="decimals";a.red=a.net=a.xarxa=a.sarea=a["r\u00e9seau"]=a.rede=a.malha="net";a.red10=a.net10=a.xarxa10=a.sarea10=a["r\u00e9seau10"]=a.rede10=a.malha10="net10";a.ejes=a.axes=a.eixos=a.ardatzak=a.eixes="axes";a.texto=a.text=a.testua=a.texte="text";a["cr\u00e9ditos"]=a.about=a["cr\u00e8dits"]=a.kreditoak=a["cr\u00e9dits"]=a.sobre="about";a.config=
a.konfig=a["configura\u00e7\u00e3o"]="config";a.inicio=a.init=a.inici=a.hasiera=a.commencement=a["in\u00edcio"]="init";a.limpiar=a.clear=a.neteja=a.ezabatu=a.nettoye=a.limpar="clear";a.incr=a.gehi=a.incremento="incr";a.min=a.inf="min";a.max=a.sup=a["m\u00e1x"]="max";a.relleno=a.fill=a.ple=a.betea=a.plein=a.recheo=a.preencher="fill";a["relleno+"]=a["fill+"]=a["ple+"]=a["betea+"]=a["plein+"]=a["recheo+"]=a["preencher+"]="fillP";a["relleno-"]=a["fill-"]=a["ple-"]=a["betea-"]=a["plein-"]=a["recheo-"]=
a["preencher-"]="fillM";a.flecha=a.arrow=a.fletxa=a.gezia=a["fl\u00e8che"]=a.frecha=a.seta="arrow";a.ancho=a.width=a.ample=a.zabalera=a.large=a.largura="width";a.punta=a.spear=a.muturra=a.pointe=a.ponta="spear";a["regi\u00f3n"]=a.region=a["regi\u00f3"]=a.eskualde=a["r\u00e9gion"]=a["rexi\u00f3n"]=a["regi\u00e3o"]="region";a.norte=a.north=a.nord=a.ipar="north";a.sur=a.south=a.sud=a.hego=a.sul="south";a.este=a.east=a.est=a.ekialde=a.leste="east";a.oeste=a.west=a.oest=a.hegoalde=a.ouest="west";a.exterior=
a.external=a.kanpoalde=a.externo="external";a["expresi\u00f3n"]=a.expresion=a["expresi\u00f3"]=a.adierazpen=a["express\u00e3o"]="expresion";a.tipo=a.type=a.tipus=a.mota="type";a["posici\u00f3n"]=a.position=a["posici\u00f3"]=a.posizio=a["posi\u00e7\u00e3o"]="position";a["constricci\u00f3n"]=a.constraint=a["constricci\u00f3"]=a.beharte=a.constriction=a["constrici\u00f3n"]=a["restri\u00e7\u00e3o"]="constraint";a.valor=a.value=a.balio=a.valeur="value";a["ecuaci\u00f3n"]=a.equation=a["equaci\u00f3"]=a.ekuazio=
a["\u00e9quation"]=a["equa\u00e7\u00e3o"]="equation";a.curva=a.curve=a.corba=a.kurba=a.courbe="curve";a.texto=a.text=a.testu=a.texte="text";a.punto=a.point=a.punt=a.puntu=a.ponto="point";a.segmento=a.segment=a.zuzenki="segment";a.arco=a.arc=a.arku="arc";a["pol\u00edgono"]=a.polygon=a["pol\u00edgon"]=a.poligono=a.polygone="polygon";a.imagen=a.image=a.imatge=a.irudi=a.imaxe=a.imagem="image";a["Versi\u00f3n"]=a.Version=a["Versi\u00f3"]=a["Vers\u00e3o"]="version";a.Idioma=a.Language=a.Hizkuntza=a.Langue=
"language";a["O.x"]="O.x";a["O.y"]="O.y";a.Botones=a.Buttons=a.Botons=a.Botoiak=a.Boutons=a["Bot\u00f3ns"]=a["Bot\u00f5es"]=a.Botons="Buttons";a["Animaci\u00f3n"]=a.Animation=a["Animaci\u00f3"]=a.Animazio=a["Anima\u00e7\u00e3o"]="Animation";a.constante=a.constant=a.Konstante="constant";a.fuente=a.font=a.iturri=a.source=a.fonte="font";a["num\u00e9rico"]=a.numeric=a["num\u00e8ric"]=a.zenbakizko=a["num\u00e9rique"]="numeric";a["gr\u00e1fico"]=a.graphic=a["gr\u00e0fic"]=a.grafiko=a.graphique="graphic";
a.texto=a.text=a.testu=a.texte="text";a.inicio=a.init=a.inici=a.hasiera=a.commencement=a["in\u00edcio"]="init";a.hacer=a["do"]=a.fer=a.egin=a.faire=a.facer=a.fazer="doExpr";a.mientras=a["while"]=a.mentre=a.bitartean=a["tandis que"]=a.mentres=a.enquanto="whileExpr";a.evaluar=a.evaluate=a.avalua=a.ebaluatu=a["\u00e9valuer"]=a.avaliar="evaluate";a.variable=a.aldagaia=a["vari\u00e1vel"]="variable";a["funci\u00f3n"]=a["function"]=a["funci\u00f3"]=a.funtzio=a.fonction=a["fun\u00e7\u00e3o"]="function";a.algoritmo=
a.algorithm=a.algorisme=a.algorithme="algorithm";a.vector=a.array=a.bektore=a.vecteur=a.matriz="array";a["dibujar-si"]=a["draw-if"]=a["marraztu-baldin"]=a["dessiner-si"]=a["debuxar-se"]=a["desenhar-se"]=a["dibuixa-si"]="drawif";a.dominio=a.range=a.domini=a["izate-eremua"]=a.domain=a["dom\u00ednio"]="range";a.pausa=a.delay=a.eten="delay";a["eje-x"]=a["x-axis"]=a["eix-x"]=a["x-ardatza"]=a["axe-x"]=a["eixe-x"]=a["eixo-x"]="x_axis";a["eje-y"]=a["y-axis"]=a["eix-y"]=a["y-ardatza"]=a["axe-y"]=a["eixe-y"]=
a["eixo-y"]="y_axis";a["n\u00fameros"]=a.numbers=a.nombres=a.zenbakiak="numbers";a["exponencial-si"]=a["exponential-if"]=a["esponentzial-baldin"]=a["exponentiel-si"]=a["exponencial-se"]="exponentialif";a.familia=a.family=a["fam\u00edlia"]=a.famille="family";a.intervalo=a.interval=a.tarte=a.intervalle="interval";a.pasos=a.steps=a.passos=a.pausoak=a.pas="steps";a.centro=a.center=a.centre=a.zentro="center";a.radio=a.radius=a.radi=a.erradio=a.rayon=a.raio="radius";a.fin=a.end=a.fi=a.bukaera=a.fim="end";
a["una-sola-vez"]=a["only-once"]=a["una-sola-vegada"]=a["behin-bakarrik"]=a["une-seule-fois"]=a["unha-soa-vez"]=a["apenas-uma-vez"]="onlyOnce";a.siempre=a.always=a.sempre=a.beti=a.toujours="always";a["color-int"]=a["int-colour"]=a["barruko-kolore"]=a["couleur-int"]=a["cor-int"]="colorInt";a.repetir=a.loop=a.repeteix=a.errepikatu=a["r\u00e9p\u00e9ter"]="loop";a.controles=a.controls=a.kontrolak=a["contr\u00f4les"]=a.controis="controls";a.animar=a.animate=a.anima=a.animatu=a.animer="animate";a.auto=
"auto";a.alto=a.height=a.alt=a.altu=a.haut=a.altura="height";a.x=a.left="x";a.y=a.top="y";a.espacio=a.space=a.espai=a.espazio=a.espace=a.espazo=a["espa\u00e7o"]="space";a.Nu="Nu";a.Nv="Nv";a.ancho=a.depth=a.amplada=a.zabalera=a.largeur=a.ancho=a.profundidade=a.amplada="width";a.largo=a.length=a.llargada=a.luzera=a.longueur=a.longo=a.comprimento=a.llargada="length";a.alto=a.height=a["al\u00e7ada"]=a.altu=a.hauteur=a.alto=a.altura=a["al\u00e7ada"]="height";a.color_reverso=a.backcolor=a.color_revers=
a["atzealde kolorea"]=a.couleur_revers=a.cor_reverso=a.cor_de_fundo="backcolor";a.aristas=a.edges=a.arestes=a.ertzak=a["ar\u00eates"]=a.arestas="edges";a.rotini=a.inirot="inirot";a.posini=a.inipos="inipos";a["tri\u00e1ngulo"]=a.triangle=a.hirukia=a["tri\u00e2ngulo"]="triangle";a.cara=a.face=a.aurpegi="face";a.polireg=a.regpoly=a["pol\u00edgonoRegular"]="polireg";a.superficie=a.surface=a["superf\u00edcie"]=a.azalera="surface";a.cubo=a.cube=a.cub=a.kubo="cube";a["paralelep\u00edpedo"]=a.box=a["paral\u00b7lelep\u00edpede"]=
a.paralelepipedo=a["parall\u00e9l\u00e9pip\u00e8de"]="box";a.cono=a.cone=a.con=a.kono=a["c\u00f4ne"]="cone";a.cilindro=a.cylinder=a.cilindre=a.zilindro=a.cylindre="cylinder";a.esfera=a.sphere=a["sph\u00e8re"]="sphere";a.tetraedro=a.tetrahedron=a.tetraedre=a["t\u00e9tra\u00e8dre"]="tetrahedron";a.octaedro=a["octahedron="]=a.octaedre=a.oktaedro=a["octa\u00e8dre"]="octahedron";a.dodecaedro=a.dodecahedron=a.dodecaedre=a.dodekaedro=a["dod\u00e9ca\u00e8dre"]="dodecahedron";a.icosaedro=a.icosahedron=a.icosaedre=
a.ikosaedro=a["icosa\u00e8dre"]="icosahedron";a.elipsoide=a.ellipsoid=a["el\u00b7lipsoide"]=a["ellipso\u00efde"]=a["elips\u00f3ide"]="ellipsoid";a.macro=a.makro="macro";a.id="id";a.modelo=a.model=a.eredu=a["mod\u00e8le"]="model";a.color=a.kolore=a.couleur=a.cor="color";a.luz=a.light=a.llum=a.argia=a["lumi\u00e8re"]="light";a.metal=a.metall=a["m\u00e9tal"]="metal";a.alambre=a.wire=a.filferro=a.alanbre=a["fil de fer"]=a.arame="wire";a.cortar=a.split=a.talla=a.moztu=a.couper=a.dividir="split";a.despliegue=
a.render=a.desplegament=a.zabaltze=a["d\u00e8ploiement"]=a.despregamento=a.processar="render";a.orden=a.sort=a.ordre=a.ordena=a.orde=a.ordenar="sort";a.pintor=a.painter=a.margolari=a.peintre="painter";a["trazado de rayos"]=a["ray trace"]=a["tra\u00e7at de raigs"]=a["izpi trazadura"]=a["trace de rayons"]=a["trazado de raios"]=a["tra\u00e7ado de raios"]="raytrace";a.imagen=a.bg_image=a.imatge=a.irudia=a.imaxe=a.imagem_de_fundo="image";a.despl_imagen=a.bg_display=a.despl_imatge=a["irudi desplazamendu"]=
a.despl_image=a.despr_imaxe=a["apresenta\u00e7\u00e3o_de_imagem"]="bg_display";a["arr-izq"]=a.topleft=a["dalt-esq"]=a["goi-ezk"]=a["au-dessus-gau"]=a["arr-esq"]=a["acima-esquerda"]="topleft";a["expand."]=a.stretch=a.hedatu=a["expandir "]="stretch";a.mosaico=a.patch=a.mosaic=a.mosaiko=a["mosa\u00efque"]="patch";a.centrada=a.center=a.zentratu=a["centr\u00e9e"]=a.centrado="center";a.archivo=a.file=a.fitxer=a.artxibo=a.fichier=a.arquivo="file";a.filas_norte=a.rows_north=a.files_nord=a["HTML kodea"]=a.files_nord=
a.filas_norte=a.linhas_norte=a.files_nord="rowsNorth";a.filas_sur=a.rows_south=a.files_sud=a.ipar_lerro=a.files_sud=a.filas_sur=a.linhas_sul=a.files_sud="rowsSouth";a.ancho_este=a.width_east=a.ample_est=a.hego_lerro=a.ample_est=a.ancho_leste=a.largura_leste=a.ample_est="widthEast";a.ancho_oeste=a.width_west=a.ample_oest=a.ekialde_zabalera=a.ample_ouest=a.ancho_oeste=a.largura_oeste=a.ample_oest="widthWest";a.fijo=a.fixed=a.fix=a.hegoalde_zabalera=a.fixe=a.fixo="fixed";a["Reiniciar Animaci\u00f3n"]=
a["Init Animation"]=a["Reinicia Animaci\u00f3"]=a.finko=a["Recommencer l'Animation"]=a["Reiniciar Anima\u00e7\u00e3o"]="initAnimation";a["Explicaci\u00f3n"]=a.Explanation=a.Azalpena=a.Explication=a["Explica\u00e7\u00e3o"]=a["Explicaci\u00f3"]="Explanation";a.tooltip=a.dica="tooltip";a.discreto=a.discrete=a.discret=a.diskretu="discrete";a.interfaz=a.gui=a["interf\u00edcie"]=a.interfaze=a["interface"]="gui";a.pulsador=a.spinner=a.polsador=a.pultsadore=a.bouton="spinner";a["campo de texto"]=a.textfield=
a["camp de text"]=a["testu esarrua"]=a["champ de texte"]="textfield";a["men\u00fa"]=a.choice=a.menu=a.escolha="menu";a.barra=a.scrollbar=a.barre="scrollbar";a.opciones=a.options=a.opcions=a.aukerak=a["opci\u00f3ns"]=a["op\u00e7\u00f5es"]="options";a.interior=a.barruko=a["int\u00e9rieur"]="interior";a["condici\u00f3n"]=a.condition=a["condici\u00f3"]=a.baldintza=a["condi\u00e7\u00e3o"]="condition";a["acci\u00f3n"]=a.action=a["acci\u00f3"]=a.ekintza=a["a\u00e7\u00e3o"]="action";a.evento=a.event=a.esdeveniment=
a.gertaera=a["\u00e9v\u00e9nement"]="event";a["abrir URL"]=a["open URL"]=a["obre URL"]=a["URL zabaldu"]=a["ouvrir URL"]="openURL";a["abrir Escena"]=a["open Scene"]=a["obre Escena"]=a["eszena zabaldu"]=a["ouvrir Escena"]=a["abrir Cena"]="openScene";a["bot\u00f3n"]=a.button=a["bot\u00f3"]=a.botoi=a.bouton=a["bot\u00e3o"]="button";a.mensaje=a.message=a.mezua=a.mensaxe=a.mensagem=a.missatge="message";a.alternar=a.alternate=a.alterna=a.txandakatu=a.alterner="alternate";a["ejecuci\u00f3n"]=a.execution=
a["execuci\u00f3"]=a.gauzatze=a["ex\u00e9cution"]=a["execuci\u00f3n"]=a["execu\u00e7\u00e3o"]="execution";a.calcular=a.calculate=a.calcula=a.kalkulatu=a.calculer="calculate";a.coord_abs=a.abs_coord=a.koor_abs="abs_coord";a.negrita=a.bold=a.negreta=a.lodi=a["caract\u00e8re gras"]=a.negra=a.negrito="bold";a.cursiva=a.italics=a.etzana=a.italique=a["it\u00e1lico"]="italics";a.subrayada=a.underlined=a.subratllat=a.azpimarratua=a.soulignement=a["subli\u00f1ada"]=a.sublinhado="underlined";a.imagen=a.image=
a.imatge=a.irundia=a.imaxe=a.imagem="image";a.pos_mensajes=a.msg_pos=a.pos_missatges=a.mezuen_pos=a.pos_messages=a.pos_mensaxes="msg_pos";a.izquierda=a.left=a.esquerra=a.eskerrean=a.gauche=a.esquerda=a.esquerda=a.esquerra="x";a.derecha=a.right=a.dreta=a.eskuinan=a.droite=a.dereita=a.direita=a.dreta="right";a["sensible_a_los_movimientos_del_rat\u00f3n"]=a.sensitive_to_mouse_movements=a["sensible_als_moviments_del_ratol\u00ed"]=a["xagu mugimenduarekiko sentikorra"]=a.sensible_aux_mouvements_du_souris=
a.sensible_aos_movementos_do_rato=a["sens\u00edvel_aos_movimentos_do_mouse"]="sensitive_to_mouse_movements";a.reproducir=a.play=a.reprodueix=a.erreproduzitu=a.reproduire=a.reproduzir="playAudio";a["activo-si"]=a["active-if"]=a["actiu-si"]=a["altiboa-baldin"]=a["actif-si"]=a["activo-se"]=a["ativo-se"]="activeif";a.rotfin=a.finrot=a.bukrot="endrot";a.posfin=a.finpos=a.bukpos="endpos";a.editable=a.editagarria=a["edit\u00e1vel"]="editable";a.tipo=a.type=a.tipus=a.mota="type";a.R2="R2";a.R3="R3";a.vectores=
a.bektoreak=a.vecteurs=a.vetores=a.vectors="vectors";a["fuente puntos"]=a["font size"]=a["font punts"]=a["puntu iturria"]=a["source points"]=a["fonte puntos"]=a["fonte pontos"]="font_size";a["ecuaci\u00f3n"]=a.equation=a["equaci\u00f3"]=a.ekuazio=a["\u00e9quation"]=a["equa\u00e7\u00e3o"]="equation";a.punto=a.dot=a.punt=a.puntu=a.point=a.ponto="point";a.escenario=a.scenario=a.escenari=a.agertoki=a["sc\u00e8ne"]=a["cen\u00e1rio"]="scenario";a.cID="cID";a.matriz=a.matrix=a.matriu=a.matrice="matrix";
a.filas=a.rows=a.files="rows";a.columnas=a.columns=a.colonnes="columns";a.solo_texto=a.only_text=a.seulement_texte=a["s\u00f3_texto"]=a.tan_sols_texte="onlyText";a.evaluar=a.evaluate="evaluate";a.respuesta=a.answer="answer";a.decimal_symbol=a["signo decimal"]=a["decimal symbol"]="decimal_symbol";a.info="info";a.color_contorn_text=a.color_text_border=a.color_borde_texto=a.muga_testuaren_kolorea=a.couleur_contour_texte=a.cor_borde_texto=a.colore_bordo_testo=a.cor_borda_texto=a.color_contorn_text="border";
a.video=a["vid\u00e9o"]="video";a.audio=a["\u00e0udio"]="audio";a.autoplay="autoplay";a.loop="loop";a.poster="poster";a.opacidad=a.opacity=a["opacit\u00e9"]=a.opacitat=a.opacidade="opacity";a.alinear=a.align=a["ali\u00f1ar"]=a.aligner="align";a.malla=a.mesh="mesh";a.local=a.Local="local";a.loadLib=!0;return a}(babel||{}),descartesJS=function(a){function c(){var a,c,d,e;Number.prototype.toFixed=function(f){f=0>f?0:parseInt(f);a=this.toString();c=a.indexOf(".");d="";if(-1===c){0<f&&(d=".");for(var h=
0;h<f;h++)d+="0";return a+d}e=a.length-c-1;if(e>=f)return 0<f?a.substring(0,c+1+f):a.substring(0,c);h=0;for(f-=e;h<f;h++)d+="0";return a+d}}function g(a,c,d){a.fillStyle="#c0c0c0";a.fillRect(c.offsetLeft,c.offsetTop,c.offsetWidth,c.offsetHeight);h(a,c,d.controls)}function h(a,c,d){for(var e,f=d.length-1;0<=f;f--)e=d[f],a.drawImage(e.getScreenshot(),c.offsetLeft+e.x,c.offsetTop+e.y)}if(a.loadLib)return a;var d=2*Math.PI,f=360/d,l=d/360,k=Math.floor,e,t,m,n,s,p,u,q,r,w;a.rangeOK=1;a.extend=function(a,
c){if(a.prototype.__proto__)a.prototype.__proto__=c.prototype;else for(var d in c.prototype)c.prototype.hasOwnProperty(d)&&(a.prototype[d]=c.prototype[d]);a.prototype.uber=c.prototype};a.radToDeg=function(a){return a*f};a.degToRad=function(a){return a*l};a.convertFont=function(a){if(""==a)return a;e=a.split(",");t="";"bold"==e[1].toLowerCase()?t+="Bold ":"italic"==e[1].toLowerCase()||"italics"==e[1].toLowerCase()?t+="Italic ":"bold+italic"==e[1].toLowerCase()&&(t+="Italic Bold ");t+=e[2]+"px ";m=
e[0].split(" ")[0].toLowerCase();return t="serif"===m||"times new roman"===m||"timesroman"===m||"times"===m?t+"'Times New Roman', Times, 'Droid Serif', serif":"sansserif"===m||"arial"===m||"helvetica"===m?t+"Arial, Helvetica, 'Droid Sans', Sans-serif":t+"'Courier New', Courier, 'Droid Sans Mono', Monospace"};a.drawLine=function(a,c,d,e,f,h,g){a.lineWidth=g||1;a.strokeStyle=h||"black";h=a.lineWidth%2?0.5:0;a.beginPath();a.moveTo(k(c)+h,k(d)+h);a.lineTo(k(e)+h,k(f)+h);a.stroke()};a.getColor=function(a,
c){if("string"==typeof c)return c;n=a.evalExpression(c);s=k(255*n[0][0]);p=k(255*n[0][1]);u=k(255*n[0][2]);q=1-n[0][3];return"rgba("+s+","+p+","+u+","+q+")"};a.getFeatures=function(){a.hasJavaSupport=navigator.javaEnabled();var d=navigator.appVersion.toLowerCase();a.hasTouchSupport=window.hasOwnProperty&&window.hasOwnProperty("ontouchstart")||d.match("android")&&!0;a.hasTouchSupport=navigator.userAgent.toLowerCase().match("qt")?!1:a.hasTouchSupport;d=document.createElement("canvas");a.hasCanvasSupport=
d.getContext&&d.getContext("2d");a.hasCanvasSupport&&(a.ctx=document.createElement("canvas").getContext("2d"));try{(0).toFixed(100)}catch(e){c()}};a.whichButton=function(a){return null!==a.which?2>a.which?"L":2===a.which?"M":"R":2>a.button?"L":4===a.button?"M":"R"};a.getCursorPosition=function(a){a.touches?(a=a.touches[0],r=a.pageX,w=a.pageY):void 0!=a.pageX&&void 0!=a.pageY?(r=a.pageX,w=a.pageY):(r=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,w=a.clientY+document.body.scrollTop+
document.documentElement.scrollTop);return{x:r,y:w}};a.getTextWidth=function(c,d){a.ctx.font=d;return a.ctx.measureText(c).width};var v=document.createElement("span");v.appendChild(document.createTextNode("\u00c1p"));var z=document.createElement("div");z.setAttribute("style","display: inline-block; w: 1px; h: 0px;");var A=document.createElement("div");A.setAttribute("style","margin: 0; padding: 0;");A.appendChild(v);A.appendChild(z);var B={};a.getFontMetrics=function(a){if(B[a])return B[a];v.setAttribute("style",
"font: "+a+"; margin: 0px; padding: 0px;");document.body.appendChild(A);var c={};z.style.verticalAlign="baseline";c.ascent=z.offsetTop-v.offsetTop;z.style.verticalAlign="bottom";c.h=z.offsetTop-v.offsetTop;c.descent=c.h-c.ascent;c.baseline=c.ascent;document.body.removeChild(A);return B[a]=c};a.getFieldFontSize=function(a){return 14>=a?8:14<a&&16>=a?9:16<a&&19>=a?10:19<a&&22>=a?11:22<a?parseInt(a-11):k(a-0.25*a)};a.getScreenshot=function(){var c=a.apps[0],d,e=document.createElement("canvas"),f=new Image;
if(c){e.setAttribute("width",c.width);e.setAttribute("height",c.height);for(var k=e.getContext("2d"),l=0,n=c.spaces.length;l<n;l++)d=c.spaces[l],"R2"===d.type&&(k.drawImage(d.backgroundCanvas,d.x,d.y),k.drawImage(d.canvas,d.x,d.y),h(k,d.container,d.ctrs));0<c.northSpace.controls.length&&g(k,c.northSpace.container,c.northSpace);0<c.southSpace.controls.length&&g(k,c.southSpace.container,c.southSpace);0<c.eastSpace.controls.length&&g(k,c.eastSpace.container,c.eastSpace);0<c.westSpace.controls.length&&
g(k,c.westSpace.container,c.westSpace);f.src=e.toDataURL("image/png")}return f};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c,g;a.openExternalFile=function(a){c=null;var d=!1;if(window.XMLHttpRequest)try{d=new XMLHttpRequest}catch(f){d=!1}else if(window.ActiveXObject)try{d=new ActiveXObject("Msxml2.XMLHTTP")}catch(l){try{d=new ActiveXObject("Microsoft.XMLHTTP")}catch(k){d=!1}}g=d;g.open("GET",a,!1);try{g.send(null),c=g.responseText,c.match(String.fromCharCode(65533))&&
(g.open("GET",a,!1),g.overrideMimeType("text/plain; charset=ISO-8859-1"),g.send(null),c=g.responseText)}catch(e){console.log("Error to load the file :",a),c=null}return c};return a}(descartesJS||{}),descartesJS=function(a){function c(a){f=a.trim();a={ignoreAcents:!1,ignoreCaps:!1,regExp:null};f[0]==f[f.length-1]&&"'"==f[0]&&(a.ignoreCaps=!0,f=f.substring(1,f.length-1),"`"==f[0]&&"\u00b4"==f[f.length-1]&&(a.ignoreAcents=!0,f=f.substring(1,f.length-1)));"`"==f[0]&&"\u00b4"==f[f.length-1]&&(a.ignoreAcents=
!0,f=f.substring(1,f.length-1),f[0]==f[f.length-1]&&"'"==f[0]&&(a.ignoreCaps=!0,f=f.substring(1,f.length-1)));"*"===f.charAt(0)&&"*"!==f.charAt(f.length-1)?f=f.substring(1)+"$":"*"!==f.charAt(0)&&"*"===f.charAt(f.length-1)?f="^"+f.substring(0,f.length-1):"*"!==f.charAt(0)&&"*"!==f.charAt(f.length-1)?f="^"+f+"$":"*"===f.charAt(0)&&"*"===f.charAt(f.length-1)&&(f=f.substring(1,f.length-1));f=f.replace(/\?/g,"[\\S\\s]{1}");a.regExp=f;return a}function g(a,c){f=a.trim();a={ignoreAcents:!1,ignoreCaps:!1,
regExp:null};a.expr=f.split(",");a.expr[0]=a.expr[0].trim();a.expr[0]={type:a.expr[0].charAt(0),expr:c.parser.parse(a.expr[0].substring(1))};a.expr[1]=a.expr[1].trim();a.expr[1]={type:a.expr[1].charAt(a.expr[1].length-1),expr:c.parser.parse(a.expr[1].substring(0,a.expr[1].length-1))};return a}function h(a,c,d){c=parseFloat(c);t=a.expr[0];m=a.expr[1];n=d.evalExpression(t.expr);s=d.evalExpression(m.expr);p="("==t.type;u="["==t.type;q=")"==m.type;r="]"==m.type;return(p&&c>n||u&&c>=n)&&(q&&c<s||r&&c<=
s)?1:0}function d(a){return a.toString().replace(/\u00e1/g,"a").replace(/\u00e9/g,"e").replace(/\u00ed/g,"i").replace(/\u00f3/g,"o").replace(/\u00fa/g,"u").replace(/\u00c1/g,"A").replace(/\u00c9/g,"E").replace(/\u00cd/g,"I").replace(/\u00d3/g,"O").replace(/\u00da/g,"U").replace(/\u00f1/g,"n").replace(/\u00d1/g,"N")}if(a.loadLib)return a;var f,l,k,e,t,m,n,s,p,u,q,r;a.buildRegularExpresionsPatterns=function(a,d){"("===a.charAt(0)&&(")"===a.charAt(a.length-1)&&-1===a.indexOf(","))&&(a=a.substring(1,
a.length-1));a=a.replace(/&squot;/g,"'").replace(/&amp;/g,"&").split("|");for(var e=0,h=a.length;e<h;e++){l=a[e].split("&");k=[];for(var n=0,m=l.length;n<m;n++)f=l[n],-1!==f.indexOf(",")&&("("===f.charAt(0)||"["===f.charAt(0))&&(")"===f.charAt(f.length-1)||"]"===f.charAt(f.length-1))?k.push(g(f,d)):k.push(c(f));a[e]=k}return a};a.escorrecto=function(c,f,g,k){g=g||a.externalEvaluator;k=k||a.buildRegularExpresionsPatterns(c,g);f=d(f);c=0;for(var n=k.length;c<n;c++){l=k[c];e=!0;for(var m=0,p=l.length;m<
p;m++)e=l[m].regExp?e&&!!f.match(d(l[m].regExp),"i"):e&&h(l[m],f,g);if(e)return 1}return 0};a.esCorrecto=function(c,g,k,n){k=k||a.externalEvaluator;n=n||a.buildRegularExpresionsPatterns(c,k);c=0;for(var m=n.length;c<m;c++){l=n[c];e=!0;for(var p=0,t=l.length;p<t;p++)(f=l[p].regExp)?(l[p].ignoreAcents&&(g=d(g),f=d(f)),l[p].ignoreCaps&&(g=g.toLowerCase(),f=d(f).toLowerCase()),e=e&&!!g.match(f)):e=e=e&&h(l[p],g,k);if(e)return 1}return 0};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;
a.getCreativeCommonsLicenseImage=function(){var a=new Image;a.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFgAAAAfCAYAAABjyArgAAAABHNCSVQICAgIfAhkiAAACpVJREFUaIHtWm1sU9cZfu61iUYnPP/bJgdhhDbFkVYcCrR0tLHXrVNL01wvgUJDh820tivrkpQQtpEvA4HGhDoe/dCmNfbaVa1WKszX2oUO3xC0OHESm9Hi/FhloyQq1aY5OGgq8ce7H9f3xI7txKFsdKyPdHSPz8dzz33Oe77eY46IVBzHXcUXuOkgIo4DQABwuucUeJ4Hz/NQKBTgeQUUPA9ekXryPDiOB89x4DgO4DiZBQQCJQlJSiKZlEIikZCeyQQSiSSSyQTLS1KSlSciuTEsfjtgY+UmAAAHgGRxFQqFFHjFTFyhkPJ4RUpkDhzHp+ubEiclbFISM5FIhfR4IlPkZDLJhE0X+nbBxspNUALIFFehhDLjKYWTx0/B4/FgcHAQU9GpDKIlqiVYu3YtjN8xouLRR5BIKsDzcalDEjw4cJD6cgaUJGkkANIY4iRxR3x+uN9xIxgMZpTX6XQQqgSsWlNW0Md9Xng4APSns+9BqVQyUZVKpRQUSvSK52B73oaJiYmCGqTRaND4i0aUl9+PeCKBRCKOeDwVEnHE4wlm4emW/PHExzjS9SJGg6MAAIPBAL1eDwAIBAIQRREAUKIrwY7aHfja17+a8/1XPv4ELzle+lzwbKzcJAn8fu8ZKBXKGWGVi7BIqURrcxvcx9ysglqthiAI0Gq1KC8vBwD09vYiHA7D7XZjcnKSlRVMAhoad2LxHYsRj8cRi8cRj8cQj8czpwxK4mrkKn769LOIRqMQBAF2ux1arTajseFwGPX19XC73VCpVGi3tWd91LXoNdTuqPvc8MjzMJ3tO0t9/eeo39dPQwEfXfggQIJJIEiDl9RqNbW1tVEkEqG54HQ6Sa1Ws3oluhI6399HQ4Eh8g71U1//OfL0naUzYg+99+d36XTPKTrx7nHS6XQEgMxmcwafzDP7HTL328f/kBFKdCU5eRx2Oz3+2ObPxDM2Nkbe/n7y9vfT2NhYQTwAiAcARWoOVioUUCoyLVev18Pv96O1tRVqtTprGKTDbDYjFAqxoTQaHEWn7XDGXM6zHYm0G/F5fQgGgxAEAY27ds3JL79DEASMBkcx4vOz9BGfH6PBUawqK8O996xj6b/q6sLzNhtOnj6N3Q27MD4+XhBPent+/9prMKy/DzWbt6Bm8xYY1t+HMz09c/Kkg/q8feQd8tLIhWFyHHEwy9Hr9fNabS5EIhHS6/WMx/Gig0b+OkIDw1467+0jz3nJit99/4+kK5WsNxQKFcwfCoUIAOl0OmYt8igo+cY3acUyLZV/ez09/eMnCQC1tbXRwQMHCQAdffvtgnjk9nj7+yW+u9fRj7ZZqHFnA61YpqUVy7TksNvz8uSwYMmKbc/bAEjzrdPpnNdqc0GtVsPj8bC6toO21F46ZcFcak/N8wheCsJgMGTNcRaLhVm5xWLJyNNqtTAYDBkrezAo8VRUVGDjpk0YHx/HmZ4erFimxb+mrmHrE1tx6cMPUVVdXRCPVqtFNBpF0H8RAFAp/AC/dXWjo/MQ9rQ0AwBc3c68PDJ4AKlhK23F5N1CXV0dG+o3ArVaDbvdDgCYmJjAyROn2IFFEplj27Rc73G5XDnjMnLV0ev1sB3uxEFbB954601UVVfjo8th2A53YunSpXB1OxG8dKkgHhntL0gG95vfvcrSvvfggwCAaDSKT65cycsDpASWrcnj8QCQxKmtrWWFRFGEyWSC0WiE0WiE1WrNm9fV1cXyzGYzs2LPWU+a9XLg+BmB/xO4+5570NF5CGNjY2jc2YCyb92Jd44eRcXDG1CzeQubQ+eCSqWCw+HAHaoleOWVV3KW+fTT63NySAcNjgPPcRgcHAQACILAhBFFEUajMaOSKIoQRRG1tbUwmUxZeRcuXIDT6WRcLpcLg4OD0gkwJawkriRwIBDIapjZbGaWazabs/Jz1ZmdFo1GcaanBx2dh2C+ZEHFwxsAAANeLwa8XhQXF4NbpJyTZ5FSicaGBtyxeDFLG/B6WXyZdlne9gDMgqUPlk9oK1euZAXq6+sBSPNMKBSCx+OBVqvFtm3bmCXr9XqEQiEcO3YsY48MgMWnolPSe8ClPYHS0lKIoohwOJzRMLmDZscBaQ8qiiJ0Oh1L0+l0WTw/efIptO/dh1V3rkTN5i346HIYVdXV6Og8hJqtWwviGR8fR1tLKx5/bDPa9+5D+959aGlqAgDs2r07b3syBAaHjOGaPp/IPWM2m9lkHgqFYDabWZ58+BAEgeXJSF+8JKPNPDZvfExadOSOLARyWaFKYGlyPJ2no/MQLNu348o//o6/hUJw2O3Y09KMqupqWPfvQ9ma1fPyWLZvh2X7dgCAs7sbzu5uXP/0OjZUPIItNY/nbY+M7PHxX8a69eugK9XB7XbDYrFkWetsyKenEl1Jhh9g1ZoylOhKMniKi4uxp6UZX1q8GCPDw/hZXd0N8expacb3H3oIly+HAUijTldaOiePDMmCKdOLlT6fyNbscrkwOTmJQCCA5cuXw2q1sjz5mJyeJyN9yEpnM3l7PIPmtmaoVCq4XC6YTCZWh9K8bOFwGCaTCV1dXVCpVNhRuyPrY3b/sjEnz85dDXjjrTc/E8/qNatRVV2Nqupq6EpLC+IBUs4e38ggioqKsP7e+zAVnYLZbGaW5Ha7sxYyQJoyKisr8+bJ9evr69HV1YUlqiU4/5c+TE9PYzo2jVg8hlgsLjmDEnFE/jmJA9YDbC+p1+uh1+uhVqshiiLr9PmcNNei19BxwMacNLeShzl7BoYHUFRUBGuLFe5jbqjVakQiEVZQFEU4HA7mzDEYDGhtbWUd4HA4WNn0PABYvnw5wuEwHvjuAzhs78T16WnEZgks+42TiSR8Az4cO3rr3Yw3g4cJ7B3qx6JFRTh/7jxqn5X2v3a7HXVpc9aNwOVysVPY/gP78fCGhzAdm8Z0LIZ4LIZYfJbAORzw/8vYWLlJmoPlKx2DsRwajQYAYLVas7ZOC8Hk5CRbXTUaTcoRn7rFSCaRTM3FlLpyul3BA0CSkkgkpHu0fe17AUgCmUymDB9voZicnITRaGR1G3/emHKwJ2ZETrsyYovsrMX2dgEBoKbWJvKNDFLgop+e+OETGR41v9+/IE9XuidNMAkUuOgn38gg7W3fy9L/j8LMj7rnamnI76PADTjcI5EItbW1ZTjc16xdQxc+CNBQwEdNrU23+kNvSWDX9jKaW5tQaRKgVCpx2HYYr7/2Ostb6JWRdV8b4vE4BgYG8cxTz2A+pE8P8smSiDJOmbN/5+PJV0d+R6GOpnxtWhDH7NDc2iRZ8kU/dbteJY1GU3CPaTQachxxUOCin4YCPnr51y8XXJeI5oynp83HM1/9QrhylVkoR5YFy6h7rhY1W2vYVY/o6cWJ4yfmvLZ/VHgUBkM5u9A8fvwE9lv3F9DHEnJZS3reQqyO47i8z4VgtrXOXoTn48srMACsuqsMza0tKF6qSbuNSHc3ImPfKv/xZGJ8HC902nGu99yCP+azTA35eABkCbxQsXN1UiEccwos4/7y+7GhYgPuWn0XvqJSpf46Jb9ZetHVaBTDQ8M4ffL0goVN/wjWsJtgwbl+L2T+nG9NuGkCf4EbB09EX77VjbhdQUTcvwFtwhQyXNo3TwAAAABJRU5ErkJggg==";
return a};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c=Math.floor,g,h,d,f,l,k,e,t;a.Color=function(a,c){this.a=this.b=this.g=this.r=0;if(a){if(this.evaluator=c,babel[a]&&("net"===babel[a]&&(a="rojo"),a=babel[a],this.r=parseInt("0x"+a.substring(1,3),16),this.g=parseInt("0x"+a.substring(3,5),16),this.b=parseInt("0x"+a.substring(5,7),16),this.colorStr=a,this.getColor=this.getColorString),6===a.length&&(this.r=parseInt("0x"+a.substring(0,2),16),this.g=parseInt("0x"+a.substring(2,
4),16),this.b=parseInt("0x"+a.substring(4,6),16),this.colorStr="#"+a,this.getColor=this.getColorString),8===a.length&&(this.r=parseInt("0x"+a.substring(2,4),16),this.g=parseInt("0x"+a.substring(4,6),16),this.b=parseInt("0x"+a.substring(6,8),16),this.a=1-parseInt("0x"+a.substring(0,2),16)/255,this.colorStr="rgba("+this.r+","+this.g+","+this.b+","+this.a+")",this.getColor=this.getColorString),"("===a[0]){h=[];d=this.splitComa(a.substring(1,a.length-1));for(var e=0,g=d.length;e<g;e++)f=parseInt(d[e],
16),d[e]!=f.toString(16)&&d[e]!=="0"+f.toString(16)?("["===d[e].charAt(0)&&"]"===d[e].charAt(d[e].length-1)&&(d[e]=d[e].substring(1,d[e].length-1)),h.push(this.evaluator.parser.parse(d[e]))):h.push(this.evaluator.parser.parse((f/255).toString()));this.rExpr=h[0];this.gExpr=h[1];this.bExpr=h[2];this.aExpr=h[3];this.getColor=this.getColorExpression}}else this.colorStr="rgba("+this.r+","+this.g+","+this.b+","+this.a+")",this.getColor=this.getColorString};a.Color.prototype.splitComa=function(a){l=[];
k=[];for(var c=e=0,d=a.length;c<d;c++)t=a.charAt(c),"("===t?k.push(c):")"===t?k.pop():","===t&&0===k.length&&(l.push(a.substring(e,c)),e=c+1);l.push(a.substring(e));return l};a.Color.prototype.getColorString=function(){return this.colorStr};a.Color.prototype.getColorExpression=function(){g=this.evaluator;this.r=c(255*g.evalExpression(this.rExpr));this.g=c(255*g.evalExpression(this.gExpr));this.b=c(255*g.evalExpression(this.bExpr));this.a=1-g.evalExpression(this.aExpr);return"rgba("+this.r+","+this.g+
","+this.b+","+this.a+")"};a.Color.prototype.borderColor=function(){return 380>this.r+this.g+this.b?"white":"black"};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c=document.head,g=document.createElement("meta");g.setAttribute("http-equiv","X-UA-Compatible");g.setAttribute("content","chrome=1");c.appendChild(g);g=document.createElement("meta");g.setAttribute("name","viewport");g.setAttribute("content","width=device-width, initial-scale=1.0, user-scalable=yes");c.appendChild(g);
g=document.createElement("meta");g.setAttribute("name","apple-mobile-web-app-capable");g.setAttribute("content","yes");c.appendChild(g);g=document.createElement("meta");g.setAttribute("name","apple-mobile-web-app-status-bar-style");g.setAttribute("content","black-translucent");c.appendChild(g);(c=document.getElementById("StyleDescartesApps2"))&&c.parentNode.removeChild(c);c=document.createElement("style");c.type="text/css";c.id="StyleDescartesApps2";c.setAttribute("rel","stylesheet");document.head.appendChild(c);
c.innerHTML="body{ text-rendering:geometricPrecision; }\ncanvas{ image-rendering:optimizeSpeed; image-rendering:-moz-crisp-edges; image-rendering:-webkit-optimize-contrast; image-rendering:optimize-contrast; -ms-interpolation-mode:nearest-neighbor; }\ndiv.DescartesCatcher{ background-color: rgba(255, 255, 255, 0); cursor: pointer; position: absolute; }\ndiv.DescartesAppContainer{ border:0px solid black; position:relative; overflow:hidden; top:0px; left:0px; }\ndiv.DescartesLoader{ background-color :#efefef; position:absolute; overflow:hidden; -moz-box-shadow:0px 0px 0px #888; -webkit-box-shadow:0px 0px 100px #888; box-shadow:0px 0px 100px #888; background-image:linear-gradient(bottom, #bbbbbb 0%, #efefef 50%, #bbbbbb 100%); background-image:-o-linear-gradient(bottom, #bbbbbb 0%, #efefef 50%, #bbbbbb 100%); background-image:-moz-linear-gradient(bottom, #bbbbbb 0%, #efefef 50%, #bbbbbb 100%); background-image:-webkit-linear-gradient(bottom, #bbbbbb 0%, #efefef 50%, #bbbbbb 100%); background-image:-ms-linear-gradient(bottom, #bbbbbb 0%, #efefef 50%, #bbbbbb 100%); top:0px; left:0px; }\ndiv.DescartesLoaderImage{ background-repeat:no-repeat; background-position:center; position:absolute; overflow:hidden; top:0px; left:0px; }\ncanvas.DescartesLoaderBar{ position:absolute; overflow:hidden; top:0px; left:0px; }\ncanvas.DescartesSpace2DCanvas, canvas.DescartesSpace3DCanvas, div.blocker{ position:absolute; overflow:hidden; left:0px; top:0px; }\ndiv.DescartesSpace2DContainer, div.DescartesSpace3DContainer{ position:absolute; overflow:hidden; line-height:0px; }\ncanvas.DescartesButton{ position:absolute; cursor:pointer; }\ndiv.DescartesSpinnerContainer, div.DescartesTextFieldContainer{ background:lightgray; position:absolute; overflow:hidden; }\ninput.DescartesSpinnerField, input.DescartesTextFieldField, input.DescartesMenuField, input.DescartesScrollbarField{ font-family:Arial, Helvetica, 'Droid Sans', Sans-serif; padding:0px; border:solid #666666 1px; position:absolute; top:0px; }\nlabel.DescartesSpinnerLabel, label.DescartesMenuLabel, label.DescartesScrollbarLabel, label.DescartesTextFieldLabel{ font-family:Arial, Helvetica, 'Droid Sans', Sans-serif; font-weight:normal; text-align:center; text-overflow:ellipsis; white-space:nowrap; overflow:hidden; background-color:#e0e4e8; position:absolute; left:0px; top:0px; }\ndiv.DescartesGraphicControl{ border-style:none; position:absolute; }\ndiv.DescartesTextAreaContainer{ position:absolute; overflow:hidden; background:#c0d0d8; }\nselect.DescartesMenuSelect{ font-family:Arial, Helvetica, 'Droid Sans', Sans-serif; padding-top:0%; text-align:center; text-overflow:ellipsis; white-space:nowrap; overflow:hidden; background-color:white; position:absolute; left:0px; top:0px; }\ndiv.DescartesScrollbarContainer{ background:#eeeeee; overflow:hidden; position:absolute; }\n";
return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c=Math.sin,g=Math.floor,h=Math.random,d=Math.round,f=Math.abs,l=String.fromCharCode,k,e,t,m,n,s,p,u,q,r;a.Krypto=function(a){this.key=(a||0).toString()};a.Krypto.prototype.getKey=function(a){k=[];for(var d=0;256>d;d++)k[d]=l(this.alfanum(g(f(7.5*(c(1*d-a)+c(1.4*d+a)+c(0.6*d-a)+c(2.2*d+a))))));return k.join("")};a.Krypto.prototype.encode=function(a){e=g(31*h());this.key=this.getKey(e);m=l(this.alfanum(e));return m+this.encripta(a)};
a.Krypto.prototype.decode=function(a){e=this.numalfa(a.charCodeAt(0));this.key=this.getKey(e);return this.desencripta(a.substring(1))};a.Krypto.prototype.encripta=function(a){return this.bytesToString(this.encriptaAux(this.stringToBytes(a)))};a.Krypto.prototype.encriptaAux=function(a){if(null==a||null==this.key)return null;s=Array(3*a.length);for(var c=0,e=a.length;c<e;c++)q=256*g(a[c]+128)+d(255*h())+65536*d(255*h()),r=g((q<<this.shift(c))/256),s[3*c]=this.alfanum(r%32),s[3*c+1]=this.alfanum(r/32%
32),s[3*c+2]=this.alfanum(r/1024%32);return s};a.Krypto.prototype.desencripta=function(a){return this.bytesToString(this.desencriptaAux(this.stringToBytes(a)))};a.Krypto.prototype.desencriptaAux=function(a){if(null==a||null==this.key)return null;p=Array(a.length/3);for(var c=0,d=p.length;c<d;c++)r=this.numalfa(a[3*c])+32*this.numalfa(a[3*c+1])+1024*this.numalfa(a[3*c+2]),q=g(256*r>>this.shift(c)),u=g(q/256)%256-128,0>u&&(u+=256),p[c]=u;return p};a.Krypto.prototype.alfanum=function(a){a=g(a);return 10>
a?48+a:87+a};a.Krypto.prototype.numalfa=function(a){return 58>a?a-48:a-87};a.Krypto.prototype.stringToBytes=function(a){m=Array(a.length);for(var c=0,d=a.length;c<d;c++)m[c]=a.charCodeAt(c);return m};a.Krypto.prototype.bytesToString=function(a){for(var c=0,d=a.length;c<d;c++)a[c]=l(a[c]);return a.join("")};a.Krypto.prototype.shift=function(a){t=this.key.charCodeAt(a%this.key.length);m=this.numalfa(t);n=g(m/2%8);0==n&&(n=4);return n};a.Krypto.prototype.parseByte=function(a){a=parseInt(a);a=0>a?0:a;
return 255<a?255:a};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Animation=function(c,g){this.parent=c;var h=c.evaluator,d=h.parser,f=new a.Auxiliary(c);this.delay=g.delay?d.parse(g.delay):d.parse("60");this.loop=g.loop?g.loop:!1;this.auto=void 0==g.auto&&2==this.parent.version?!0:g.auto;this.controls=g.controls;this.init=f.splitInstructions(d,g.init);this.doExpr=f.splitInstructions(d,g.doExpr);g.whileExpr&&(this.whileExpr=d.parse(g.whileExpr));var l=this,k,e,t=l.doExpr.length;
this.animationExec=function(){for(e=0;e<t;e++)h.evalExpression(l.doExpr[e]);l.parent.update();l.playing&&(0<h.evalExpression(l.whileExpr)||l.loop)?(k=h.evalExpression(l.delay),l.timer=setTimeout(l.animationExec,10>k?10:k)):(l.stop(),l.parent.update())};this.playing=!1;this.auto&&this.play()};a.Animation.prototype.play=function(){this.playing?this.stop():(this.reinit(),this.playing=!0,this.timer=setTimeout(this.animationExec,this.parent.evaluator.evalExpression(this.delay)))};a.Animation.prototype.stop=
function(){this.playing=!1;clearInterval(this.timer)};a.Animation.prototype.reinit=function(){for(var a=0,g=this.init.length;a<g;a++)this.parent.evaluator.evalExpression(this.init[a])};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Action=function(a,g){this.parent=a;this.evaluator=this.parent.evaluator};a.Action.prototype.execute=function(){};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Message=function(c,g){a.Action.call(this,c,g);this.parameter=
g};a.extend(a.Message,a.Action);a.Message.prototype.execute=function(){alert(this.parameter)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Calculate=function(c,g){a.Action.call(this,c,g);var h=this.evaluator,d=h.parser;g=(g||"").replace(/&squot;/g,"'");g=g.replace(/;/g,"\\n");g=g.split("\\n")||[""];for(var f=[],l,k=0,e=g.length;k<e;k++)(l=d.parse(g[k],!0))&&f.push(l);e=f.length;this.execute=function(){for(k=0;k<e;k++)h.evalExpression(f[k])}};a.extend(a.Calculate,a.Action);
return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.OpenURL=function(c,g){a.Action.call(this,c,g);this.parameter=g;this.target="_blank";var h=this.parameter.indexOf("target");-1!=h&&(this.target=this.parameter.substring(h),this.target=this.target.substring(this.target.indexOf("=")+1),this.parameter=this.parameter.substring(0,h-1));"javascript"==this.parameter.substring(0,10)?(this.parameter=this.parameter.substring(11).replace(/&squot;/g,"'"),this.actionExec=function(){eval(this.parameter)}):
("http://"!=this.parameter.substring(0,7)&&(this.parameter=window.location.href.substring(0,window.location.href.lastIndexOf("/")+1)+this.parameter),this.actionExec=function(){window.open(this.parameter,this.target)})};a.extend(a.OpenURL,a.Action);a.OpenURL.prototype.execute=function(){this.actionExec()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.OpenScene=function(c,g){a.Action.call(this,c,g);this.parameter=g;this.target="_blank";var h=this.parameter.indexOf("target");
-1!=h&&(this.target=this.parameter.substring(h),this.target=this.target.substring(this.target.indexOf("=")+1),this.parameter=this.parameter.substring(0,h-1));"_blank"!==this.target&&"_parent"!==this.target&&"_self"!==this.target&&"_top"!==this.target?this.actionExec=function(){window.parent.postMessage({type:"changeTarget",name:this.target,value:this.parameter},"*")}:"javascript"==this.parameter.substring(0,10)?(this.parameter=this.parameter.substring(11).replace(/&squot;/g,"'"),this.actionExec=function(){eval(this.parameter)}):
("http://"!=this.parameter.substring(0,7)&&(this.parameter=window.location.href.substring(0,window.location.href.lastIndexOf("/")+1)+this.parameter),this.actionExec=function(){this.window=window.open(this.parameter,this.target,"width="+this.parent.width+",height="+this.parent.height+",left="+(window.screen.width-this.parent.width)/2+", top="+(window.screen.height-this.parent.height)/2+"location=no,menubar=no,scrollbars=no,status=no,titlebar=no,toolbar=no");this.window.onload=function(a){a=this.document;
var c=a.getElementsByTagName("applet");c&&0<c.length&&(this.innerWidth=c[0].width,this.height=c[0].height,a.body.style.margin="0px",a.body.style.padding="0px",c[0].parentNode.style.margin="0px",c[0].parentNode.style.padding="0px")}})};a.extend(a.OpenScene,a.Action);a.OpenScene.prototype.execute=function(){this.actionExec()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.About=function(c,g){a.Action.call(this,c,g);g||(this.urlAbout=window.location.href.substring(0,window.location.href.lastIndexOf("/")+
1)+g)};a.extend(a.About,a.Action);a.About.prototype.execute=function(){if(this.urlAbout)var a=window.open(this.urlAbout,"_blank","width=800px,height=600px,location=no,menubar=no,scrollbars=yes");else a=window.open("about:blank","_blank","width=800px,height=600px,location=no,menubar=no,scrollbars=yes"),a.document.write("<hmtl><head><title>Cr\u00e9ditos</title></head><body><h1>Aqu\u00ed van los cr\u00e9ditos</h1></body></html>")};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;
a.Config=function(c,g){a.Action.call(this,c,g)};a.extend(a.Config,a.Action);a.Config.prototype.execute=function(){window.open("about:blank","_blank","width=800px,height=600px,location=no,menubar=no,scrollbars=yes").document.write("<xmp style='width:100%; height:100%;'>"+this.parent.applet.outerHTML+"</xmp>")};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Init=function(c,g){a.Action.call(this,c,g)};a.extend(a.Init,a.Action);a.Init.prototype.execute=function(){this.parent.init()};
return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Clear=function(c,g){a.Action.call(this,c,g)};a.extend(a.Clear,a.Action);a.Clear.prototype.execute=function(){this.parent.clear()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Animate=function(c,g){a.Action.call(this,c,g)};a.extend(a.Animate,a.Action);a.Animate.prototype.execute=function(){this.parent.play()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.InitAnimation=
function(c,g){a.Action.call(this,c,g)};a.extend(a.InitAnimation,a.Action);a.InitAnimation.prototype.execute=function(){this.parent.reinitAnimation()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.PlayAudio=function(c,g){a.Action.call(this,c,g);this.filenameExpr=g?this.evaluator.parser.parse("'"+g.split(" ")[0].trim()+"'"):"";this.filename=this.evaluator.evalExpression(this.filenameExpr);this.theAudio=c.getAudio(this.filename)};a.extend(a.PlayAudio,a.Action);a.PlayAudio.prototype.execute=
function(){var a=this.theAudio;a.paused?a.play():(a.pause(),a.currentTime=0)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Auxiliary=function(a,c){this.parent=a;this.evaluator=this.parent.evaluator;this.expresion=this.id="";this.evaluate="onlyOnce";this.local="";for(var d in c)c.hasOwnProperty(d)&&(this[d]=c[d])};a.Auxiliary.prototype.firstRun=function(){};a.Auxiliary.prototype.update=function(){};var c,g,h,d;a.Auxiliary.prototype.splitInstructions=function(a,l){g=[];
l=l?l.split(";"):[""];h=0;for(d=l.length;h<d;h++)(c=a.parse(l[h],!0))&&g.push(c);return g};a.Auxiliary.prototype.getPrivateVariables=function(a,l){g=[];l=l?l.split(/;|,/):[""];h=0;for(d=l.length;h<d;h++)(c=a.parse(l[h],!0))&&g.push(c);h=0;for(d=g.length;h<d;h++)g[h]="asign"===g[h].type?g[h].childs[0].value:"identifier"===g[h].type?g[h].value:"";return g};a.Auxiliary.prototype.buildAlgorithm=function(){var c=this,d=c.evaluator,h=d.parser;c.init=c.splitInstructions(h,c.init);c.privateVars=c.getPrivateVariables(h,
c.local);c.doExpr=c.splitInstructions(h,c.doExpr);c.whileExpr&&(c.whileExpr=h.parse(c.whileExpr));var e,g,m,n=c.privateVars.length,s=c.params.length,p=c.init.length,u=c.doExpr.length;return function(){if(c.numberOfParams<=arguments.length){e=[];for(m=0;m<n;m++)e.push(d.getVariable(c.privateVars[m])),d.setVariable(c.privateVars[m],0);g=[];for(m=0;m<s;m++)g.push(d.getVariable(c.params[m])),d.setVariable(c.params[m],arguments[m]);for(m=0;m<p;m++)d.evalExpression(c.init[m]);do for(m=0;m<u;m++)d.evalExpression(c.doExpr[m]);
while(0<d.evalExpression(c.whileExpr));result=d.evalExpression(c.expresion);a.rangeOK=d.evalExpression(c.domain);for(m=0;m<s;m++)d.setVariable(c.params[m],g[m]);for(m=0;m<n;m++)d.setVariable(c.privateVars[m],e[m]);return result}}};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Variable=function(c,g){a.Auxiliary.call(this,c,g);var h=this.evaluator.parser;this.expresionString=this.expresion;(this.expresion=h.parse(this.expresionString))&&h.setVariable(this.id,this.expresion);
this.editable&&(this.registerTextField(),this.parent.editableRegionVisible=!0)};a.extend(a.Variable,a.Auxiliary);a.Variable.prototype.registerTextField=function(){var a=document.createElement("div"),g=document.createElement("label");g.appendChild(document.createTextNode("___"+this.id+"=___"));var h=document.createElement("input");h.value=this.expresionString;h.disabled=!this.editable;a.appendChild(g);a.appendChild(h);var d=this,f=d.evaluator.parser;h.onkeydown=function(a){13==a.keyCode&&(d.expresion=
f.parse(this.value),f.setVariable(d.id,d.expresion),d.parent.update())};this.parent.editableRegion.textFields.push({container:a,type:"div"})};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Constant=function(c,g){a.Auxiliary.call(this,c,g);this.expresion=this.evaluator.parser.parse(this.expresion);this.update()};a.extend(a.Constant,a.Auxiliary);a.Constant.prototype.update=function(){this.evaluator.setVariable(this.id,this.evaluator.evalExpression(this.expresion))};return a}(descartesJS||
{}),descartesJS=function(a){if(a.loadLib)return a;a.Vector=function(c,g){var h=c.evaluator,d=h.parser;this.size=d.parse("3");a.Auxiliary.call(this,c,g);this.expresion=this.expresion.split(";");var f;if(this.file){var l=document.getElementById(this.file);l&&"descartes/vectorFile"==l.type?(f=l.text,"\n"==f[0]&&(f=f.substring(1))):f=a.openExternalFile(this.file);null!=f&&(f=f.split("\n"));null==f||1==f.length&&""==f[0]?(f=[],this.size=0):(this.expresion=[],this.size=null);for(var k,e=0,t=/[\w-//]*(\.png|\.jpg|\.gif|\.svg|\.PNG|\.JPG|\.GIF|\.SVG)/g,
l=0,m=f.length;l<m;l++)f[l].match(/./)&&(this.expresion[e]=this.id+"["+e+"]="+f[l],e++,(k=f[l].match(t))&&this.parent.getImage(k));null===this.size&&(this.size=d.parse(this.expresion.length+""))}l=0;for(m=this.expresion.length;l<m;l++)(f=d.parse(this.expresion[l],!0))&&"asign"!=f.type&&(f=d.parse(this.id+"["+l+"]="+this.expresion[l],!0)),this.expresion[l]=f;d=[];l=0;for(m=h.evalExpression(this.size);l<m;l++)d.push(0);h.vectors[this.id]=d;this.update()};a.extend(a.Vector,a.Auxiliary);a.Vector.prototype.update=
function(){var a=this.evaluator;a.setVariable(this.id+".long",a.evalExpression(this.size));for(var g=0,h=this.expresion.length;g<h;g++)a.evalExpression(this.expresion[g])};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Matrix=function(c,g){var h=c.evaluator,d=h.parser;this.rows=d.parse("3");this.columns=d.parse("3");a.Auxiliary.call(this,c,g);this.expresion=this.splitInstructions(d,this.expresion);var d=h.evalExpression(this.rows),f=h.evalExpression(this.columns),l=[];
l.type="matrix";for(var k,e=0;e<f;e++){k=[];for(var t=0,m=d;t<m;t++)k.push(0);l[e]=k}h.matrices[this.id]=l;this.update()};a.extend(a.Matrix,a.Auxiliary);a.Matrix.prototype.update=function(){var a=this.evaluator,g=a.evalExpression(this.rows),h=a.evalExpression(this.columns);a.setVariable(this.id+".filas",g);a.setVariable(this.id+".columnas",h);var d=a.matrices[this.id];d.rows=g;d.cols=h;g=0;for(h=this.expresion.length;g<h;g++)a.evalExpression(this.expresion[g])};return a}(descartesJS||{}),descartesJS=
function(a){if(a.loadLib)return a;a.Function=function(c,g){a.Auxiliary.call(this,c,g);var h=this.evaluator,d=h.parser,f=this.id.indexOf("(");this.name=this.id.substring(0,f);this.params=this.id.substring(f+1,this.id.length-1);this.domain=this.range?d.parse(this.range):d.parse("1");this.params=""==this.params?[]:this.params.split(",");this.numberOfParams=this.params.length;this.algorithm||(this.whileExpr=this.doExpr=this.init="");this.expresion=d.parse(this.expresion);h.setFunction(this.name,this.buildAlgorithm())};
a.extend(a.Function,a.Auxiliary);return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.AuxSequence=function(c,g){a.Auxiliary.call(this,c,g);var h=this.evaluator,d=h.parser,f=this.id.indexOf("(");this.name=this.id.substring(0,f);this.params=this.id.substring(f+1,this.id.length-1);this.domain=this.range?d.parse(this.range):d.parse("1");this.params=""==this.params?[]:this.params.split(",");this.numberOfParams=this.params.length;this.algorithm||(this.whileExpr=this.doExpr=this.init=
"");this.expresion=d.parse(this.expresion);h.setFunction(this.name,this.buildAlgorithm())};a.extend(a.AuxSequence,a.Auxiliary);return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Algorithm=function(c,g){a.Auxiliary.call(this,c,g);var h=this.evaluator.parser;this.params=[];this.numberOfParams=0;this.domain=h.parse("1");this.expresion=h.parse("0");this.algorithmExec=this.buildAlgorithm()};a.extend(a.Algorithm,a.Auxiliary);a.Algorithm.prototype.update=function(){this.algorithmExec();
"onlyOnce"==this.evaluate&&(this.update=function(){})};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Event=function(c,g){a.Auxiliary.call(this,c,g);var h=this.evaluator;this.condition=h.parser.parse(this.condition);this.lastEvaluation=!1;this.action=this.parent.lessonParser.parseAction(this);"onlyOnce"==this.execution&&(this.eventExec=function(){0<h.evalExpression(this.condition)&&!this.lastEvaluation&&(this.lastEvaluation=!0,this.action.execute())});"alternate"==this.execution&&
(this.eventExec=function(){var a=0<h.evalExpression(this.condition);3==this.parent.version?a!=this.lastEvaluation&&(this.action.execute(),this.lastEvaluation=a?!0:!1):a&&!this.lastEvaluation?(this.action.execute(),this.lastEvaluation=!0):!a&&this.lastEvaluation&&(this.lastEvaluation=!1)});"always"==this.execution&&(this.eventExec=function(){0<h.evalExpression(this.condition)&&this.action.execute()})};a.extend(a.Event,a.Auxiliary);a.Event.prototype.update=function(){this.eventExec()};return a}(descartesJS||
{}),descartesJS=function(a){if(a.loadLib)return a;var c,g,h,d,f;a.Graphic=function(c,d){this.parent=c;this.evaluator=c.evaluator;var e=this.evaluator.parser;this.spaceID="E0";this.background=!1;this.type="";this.drawif=e.parse("1");this.abs_coord=!1;this.color=new a.Color("blue");2!==this.parent.version&&(this.color=new a.Color("20303a"),this.parent.arquimedes&&(this.color=new a.Color("black")));this.trace="";this.expresion=e.parse("(0,0)");this.family="";this.family_interval=e.parse("[0,1]");this.family_steps=
e.parse("8");this.editable=!1;this.font="Monospaced,PLAIN,12";this.fixed=!0;this.text="";this.decimals=e.parse("2");for(var h in d)d.hasOwnProperty(h)&&(this[h]=d[h]);this.space=this.getSpace();this.canvas=this.background?this.space.backgroundCanvas:this.space.canvas;this.ctx=this.canvas.getContext("2d");this.trace&&(this.traceCtx=this.space.backgroundCanvas.getContext("2d"));this.font=a.convertFont(this.font);this.fontSize=(this.fontSize=this.font.match(/(\d+)px/))?parseInt(this.fontSize[1]):10};
a.Graphic.prototype.getSpace=function(){for(var a=this.parent.spaces,c,d=0,h=a.length;d<h;d++)if(c=a[d],c.id==this.spaceID)return c;return a[0]};a.Graphic.prototype.getFamilyValues=function(){c=this.evaluator;g=c.evalExpression(this.family_interval);this.familyInf=g[0][0];this.familySup=g[0][1];this.fSteps=Math.round(c.evalExpression(this.family_steps));this.family_sep=0<this.fSteps?(this.familySup-this.familyInf)/this.fSteps:0};a.Graphic.prototype.drawFamilyAux=function(a,d,e){c=this.evaluator;this.getFamilyValues();
h=c.getVariable(this.family);if(0<=this.fSteps)for(var f=0,g=this.fSteps;f<=g;f++)c.setVariable(this.family,this.familyInf+f*this.family_sep),0<c.evalExpression(this.drawif)&&(this.update(),this.drawAux(a,d,e));c.setVariable("_Text_H_",0);c.setVariable(this.family,h)};a.Graphic.prototype.draw=function(a,c){""!=this.family?this.drawFamilyAux(this.ctx,a,c):0<this.evaluator.evalExpression(this.drawif)&&(this.update(),this.drawAux(this.ctx,a,c))};a.Graphic.prototype.drawTrace=function(a,c){""!=this.family?
this.drawFamilyAux(this.traceCtx,a,c):0<this.evaluator.evalExpression(this.drawif)&&(this.update(),this.drawAux(this.traceCtx,a,c))};a.Graphic.prototype.drawText=function(a,h,e,g,m,n,s,p,u,q,r){if("rtfNode"===h.type)a.fillStyle=m.getColor(),a.strokeStyle=m.getColor(),a.textBaseline="alphabetic",h.draw(a,e,g,u,q,s,r);else{"simpleText"===h.type&&(h=h.toString(u,q).split("\\n"));e+=n.match("Arial")?-2:n.match("Times")?-2:0;c=this.evaluator;a.fillStyle=m.getColor();a.font=n;a.textAlign=s;a.textBaseline=
p;this.border&&(a.strokeStyle=this.border.getColor(),a.lineWidth=parseInt(this.fontSize/12)+1.5);f=1.2*this.fontSize||0;m=0;for(n=h.length;m<n;m++)d=h[m],this.border&&(a.lineJoin="round",a.strokeText(d,e,g+f*m)),a.fillText(d,e,g+f*m)}};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.SimpleText=function(a,c){this.text=c.replace("&#x2013","\u2013");this.textElements=[];this.textElementsMacros=[];this.parent=a;this.evaluator=a.evaluator;this.type="simpleText";for(var f="'",
g=0,k=0,e=-1,t,m;g<c.length;)t=c.charAt(g),m=c.charAt(g-1),"["===t&&"\\"===m?(this.textElements.push(c.substring(k,g-1)+"["),this.textElementsMacros.push("'"+c.substring(k,g-1)+"['"),k=g+1):"]"===t&&"\\"===m?(this.textElements.push(c.substring(k,g-1)+"]"),this.textElementsMacros.push("'"+c.substring(k,g-1)+"]'"),k=g+1):"["===t&&-1==e?(this.textElements.push(c.substring(k,g)),this.textElementsMacros.push("'"+c.substring(k,g)+"'"),k=g,e++):"["===t?e++:"]"===t&&0==e?(this.textElements.push(this.evaluator.parser.parse(c.substring(k,
g+1))),this.textElementsMacros.push("["+c.substring(k,g+1)+"]"),k=g+1,e--):("]"==c.charAt(g)&&(e=0>e?e:e-1),f+=c.charAt(g)),g++;this.textElements.push(c.substring(k,g));this.textElementsMacros.push("'"+c.substring(k,g)+"'")};var c,g;a.SimpleText.prototype.toString=function(a,d){c="";for(var f=0,l=this.textElements.length;f<l;f++)"string"===typeof this.textElements[f]?c+=this.textElements[f]:(g=this.evaluator.evalExpression(this.textElements[f])[0][0],""!==g&&("string"===typeof g?c+=g:(g=parseFloat(g),
g=d?g.toFixed(a):parseFloat(g.toFixed(a)),c+=g.toString().replace(".",this.parent.decimal_symbol))));return c};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c=Math.floor,g=2*Math.PI,h,d,f,l,k,e,t,m,n,s,p,u,q,r,w,v,z,A,B,x,D,E,F,C,K,I,H,L,y,J,G,M,N,O,S,T,Q,R,P,W,U,X,Z,Y,V;a.Equation=function(c,d){this.width=c.evaluator.parser.parse("1");this.fillP=new a.Color("00ff80");this.fillM=new a.Color("ffc800");a.Graphic.call(this,c,d);this.generateStroke();this.parseExpression();
(this.visible=2===this.parent.version&&void 0==this.visible?!0:this.visible)&&this.registerTextField();s=new a.R2;p=new a.R2;u=new a.R2;w=new a.R2;q=new a.R2};a.extend(a.Equation,a.Graphic);a.Equation.prototype.parseExpression=function(){if("compOperator"==this.expresion.type){var c=this.expresion.childs[0],d=this.expresion.childs[1];"identifier"==c.type&&"y"==c.value&&!d.contains("y")?(this.funExpr=d,this.drawAux=this.drawAuxFunY):"identifier"==d.type&&"y"==d.value&&!c.contains("y")?(this.funExpr=
c,this.drawAux=this.drawAuxFunY):"identifier"==c.type&&"x"==c.value&&!d.contains("x")?(this.funExpr=d,this.drawAux=this.drawAuxFunX):"identifier"==d.type&&("x"==d.value&&!c.contains("x"))&&(this.funExpr=d,this.drawAux=this.drawAuxFunX)}this.newt=new a.R2Newton(this.evaluator,this.expresion)};a.Equation.prototype.generateStroke=function(){this.auxCanvas=document.createElement("canvas");var a=parseInt(this.evaluator.evalExpression(this.width));this.width_2=parseInt(a/2)||1;this.auxCanvas.setAttribute("width",
a);this.auxCanvas.setAttribute("height",a);this.auxCtx=this.auxCanvas.getContext("2d");this.auxCtx.fillStyle=this.color.getColor();this.auxCtx.beginPath();this.auxCtx.arc(this.width_2,this.width_2,this.width_2,0,2*Math.PI,!1);this.auxCtx.fill()};a.Equation.prototype.update=function(){};a.Equation.prototype.draw=function(){""!=this.family?this.drawFamilyAux(this.ctx,this.fill,this.color):(this.update(),this.drawAux(this.ctx,this.fill,this.color))};a.Equation.prototype.drawTrace=function(){this.uber.drawTrace.call(this,
this.fill,this.trace)};a.Equation.prototype.drawAux=function(g,l,N){g.lineWidth=1;h=this.evaluator;d=h.parser;f=this.space;k=h.evalExpression(this.width);k=c(k)/2;d.getVariable("x");d.getVariable("y");e=f.w;t=f.h;m=c(e/8);3>m&&(m=3);n=c(t/8);3>n&&(n=3);b=[];s.set(0,0);p.set(0,0);u.set(0,0);for(K=c(n/2);K<t;K+=n)for(C=c(m/2);C<e;C+=m)if(this.abs_coord?(w.set(C,K),r=this.newt.findZero(w),h.setVariable("x",r.x),h.setVariable("y",r.y),q.set(r.x,r.y)):(w.set(f.getRelativeX(C),f.getRelativeY(K)),r=this.newt.findZero(w),
h.setVariable("x",r.x),h.setVariable("y",r.y),q.set(f.getAbsoluteX(r.x),f.getAbsoluteY(r.y))),v=c(q.ix()),z=c(q.iy()),!(0>v||v>=e||0>z||z>=t||b[v+z*f.w]))if(b[v+z*f.w]=!0,s.x=r.x,s.y=r.y,p.x=r.x,p.y=r.y,A=this.newt.getUnitNormal(),!(0==A.x&&0==A.y)){A.rotL90();u.x=A.x;u.y=A.y;x=B=0;for(D=!1;2>x;){D&&(u.x=-A.x,u.y=-A.y,r.x=s.x,r.y=s.y,p.x=r.x,p.y=r.y,this.abs_coord?q.set(r.x,r.y):q.set(f.getAbsoluteX(r.x),f.getAbsoluteY(r.y)),v=q.ix(),z=q.iy(),D=!1,B=0);this.abs_coord?(r.x+=u.x,r.y+=u.y):(r.x+=u.x/
f.scale,r.y+=u.y/f.scale);r=this.newt.findZero(r);h.setVariable("x",r.x);h.setVariable("y",r.y);u.x=r.x-p.x;u.y=r.y-p.y;u.normalize();if(0==u.x&&0==u.y)break;p.x=r.x;p.y=r.y;this.abs_coord?q.set(r.x,r.y):q.set(f.getAbsoluteX(r.x),f.getAbsoluteY(r.y));E=c(q.ix());F=c(q.iy());if(E!=v||F!=z)if(v=E,z=F,0<=v&&v<e&&0<=z&&z<t)if(B=0,b[v+z*f.w])break;else b[v+z*f.w]=!0,a.rangeOK&&h.evalExpression(this.drawif)&&g.drawImage(this.auxCanvas,v-this.width_2,z-this.width_2);else D=!0,x++;else 4<++B&&(D=!0,x++)}}};
a.Equation.prototype.drawAuxFunY=function(c,d,g){h=this.evaluator;f=this.space;e=f.w;m=1/f.scale;H=f.getAbsoluteY(0);k=h.evalExpression(this.width);l=this.color.getColor();W=this.fillM.getColor();U=this.fillP.getColor();c.fillStyle=l;L=f.getRelativeX(0);h.setVariable("x",L);O=f.getAbsoluteX(L);S=f.getAbsoluteY(h.evalExpression(this.funExpr));P=0;for(d=1;d<e;d++){J=L+d*m;h.setVariable("x",J);G=h.evalExpression(this.funExpr);h.setVariable("y",G);M=f.getAbsoluteX(J);N=f.getAbsoluteY(G);T=Math.min(P,
G);Q=Math.max(P,G);R={min:T,max:Q};if(void 0!==G&&(a.rangeOK&&h.evalExpression(this.drawif))&&!this.hasSingularity(m,J,"x",J-m,P,J,G,R)){if(this.fillM||this.fillP)c.lineWidth=1,c.strokeStyle=N>H?W:U,c.beginPath(),c.moveTo(M+0.5,N),c.lineTo(M+0.5,H),c.stroke();c.lineWidth=k;c.strokeStyle=l;c.beginPath();c.moveTo(O,S);c.lineTo(M,N);c.stroke()}P=G||0;O=M;S=N}};a.Equation.prototype.drawAuxFunX=function(c,d,e){h=this.evaluator;f=this.space;t=f.h;n=1/f.scale;I=f.getAbsoluteX(0);k=h.evalExpression(this.width);
l=this.color.getColor();W=this.fillM.getColor();U=this.fillP.getColor();c.fillStyle=l;y=f.getRelativeY(t);h.setVariable("y",y);O=f.getAbsoluteX(h.evalExpression(this.funExpr));S=f.getAbsoluteY(y);d=0;for(e=1;e<t;e++){G=y+e*n;h.setVariable("y",G);J=h.evalExpression(this.funExpr);h.setVariable("x",J);M=f.getAbsoluteX(J);N=f.getAbsoluteY(G);T=Math.min(d,J);Q=Math.max(d,J);R={min:T,max:Q};if(void 0!==G&&(a.rangeOK&&h.evalExpression(this.drawif))&&!this.hasSingularity(n,G,"y",G-n,d,G,J,R)){if(this.fillM||
this.fillP)c.lineWidth=1,c.strokeStyle=M>I?W:U,c.beginPath(),c.moveTo(M,N+0.5),c.lineTo(I,N+0.5),c.stroke();c.lineWidth=k;c.strokeStyle=l;c.beginPath();c.moveTo(O,S);c.lineTo(M,N);c.stroke()}d=J||0;O=M;S=N}};a.Equation.prototype.hasSingularity=function(a,c,d,e,h,g,f,k){if(1E-12>Math.abs(g-e)||1E-8>Math.abs(g-e)&&Math.abs(f-h)>Math.abs(a))return!0;X=!1;Z=c;Y=(e+g)/2;this.evaluator.setVariable(d,Y);V=this.evaluator.evalExpression(this.funExpr);k.min<=V&&V<=k.max?X=!1:(k.x=Math.min(k.min,V),k.y=Math.max(k.max,
V),X=this.hasSingularity(a,c,d,e,h,Y,V,k)||this.hasSingularity(a,c,d,Y,V,g,f,k));this.evaluator.setVariable(d,Z);return X};a.drawPixel=function(a,c,d,e){a.moveTo(c,d);a.arc(c,d,e,0,g,!1)};a.Equation.prototype.registerTextField=function(){var a=document.createElement("input");a.value=this.expresionString;a.disabled=!this.editable;var c=this;a.onkeydown=function(a){13==a.keyCode&&(c.expresion=c.evaluator.parser.parse(this.value),c.parseExpression(),c.parent.update())};this.parent.editableRegion.textFields.push(a)};
return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c=Math.round;a.Curve=function(c,d){this.parameter="t";this.parameter_interval=c.evaluator.parser.parse("[0,1]");this.parameter_steps=c.evaluator.parser.parse("8");this.width=c.evaluator.parser.parse("1");this.fill="";a.Graphic.call(this,c,d);(this.visible=2==this.parent.version&&void 0==this.visible?!0:!1)&&this.registerTextField()};a.extend(a.Curve,a.Graphic);var g,h,d,f,l,k,e,t,m,n,s;a.Curve.prototype.update=function(){g=
this.evaluator;h=g.evalExpression(this.parameter_interval);this.paraInf=h[0][0];this.paraSup=h[0][1];this.pSteps=g.evalExpression(this.parameter_steps);this.paraSep=0<this.pSteps?Math.abs(this.paraSup-this.paraInf)/this.pSteps:0};a.Curve.prototype.draw=function(){this.uber.draw.call(this,this.fill,this.color)};a.Curve.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.fill,this.trace)};a.Curve.prototype.drawAux=function(h,u,q){g=this.evaluator;d=this.space;f=c(g.evalExpression(this.width));
h.lineWidth=0<f?f:1E-6;h.lineCap="round";h.lineJoin="round";h.strokeStyle=q.getColor();l=g.getVariable(this.parameter);h.beginPath();g.setVariable(this.parameter,this.paraInf);k=g.evalExpression(this.expresion);this.exprX=this.abs_coord?c(k[0][0]):c(d.getAbsoluteX(k[0][0]));this.exprY=this.abs_coord?c(k[0][1]):c(d.getAbsoluteY(k[0][1]));this.rotateExp&&(e=a.degToRad(g.evalExpression(this.rotateExp)),t=Math.cos(e),m=Math.sin(e),n=this.exprX*t-this.exprY*m,s=this.exprX*m+this.exprY*t,this.exprX=n,this.exprY=
s);h.moveTo(this.exprX+0.5,this.exprY+0.5);for(q=1;q<=this.pSteps;q++)g.setVariable(this.parameter,this.paraInf+q*this.paraSep),k=g.evalExpression(this.expresion),this.exprX=this.abs_coord?c(k[0][0]):c(d.getAbsoluteX(k[0][0])),this.exprY=this.abs_coord?c(k[0][1]):c(d.getAbsoluteY(k[0][1])),this.rotateExp&&(n=this.exprX*t-this.exprY*m,s=this.exprX*m+this.exprY*t,this.exprX=n,this.exprY=s),h.lineTo(this.exprX+0.5,this.exprY+0.5);this.fill&&(h.fillStyle=u.getColor(),h.fill());h.stroke();g.setVariable(this.parameter,
l)};a.Curve.prototype.registerTextField=function(){var a=document.createElement("input");a.value=this.expresionString;a.disabled=!this.editable;var c=this;a.onkeydown=function(a){13==a.keyCode&&(c.expresion=c.evaluator.parser.parse(this.value),c.parent.update())};this.parent.editableRegion.textFields.push(a)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c=2*Math.PI;a.Sequence=function(c,h){this.size=c.evaluator.parser.parse("2");a.Graphic.call(this,c,h)};a.extend(a.Sequence,
a.Graphic);a.Sequence.prototype.update=function(){var c=this.evaluator,h=c.evalExpression(this.expresion);this.exprX=h[0][0];this.exprY=h[0][1];if(this.rotateExp){var d=a.degToRad(c.evalExpression(this.rotateExp)),h=Math.cos(d),f=Math.sin(d),d=this.exprX*h-this.exprY*f,h=this.exprX*f+this.exprY*h;this.exprX=d;this.exprY=h}c=c.evalExpression(this.range);this.rangeInf=c[0][0];this.rangeMax=c[0][1]};a.Sequence.prototype.draw=function(){this.uber.draw.call(this,this.color,this.color)};a.Sequence.prototype.drawTrace=
function(){this.uber.drawTrace.call(this,this.trace,this.trace)};a.Sequence.prototype.drawAux=function(a,h){var d=this.evaluator,f,l,k,e=Math.ceil(d.evalExpression(this.size)-0.4);a.fillStyle=h.getColor();a.beginPath();this.rangeInf>this.rangeMax&&(k=this.rangeInf,this.rangeInf=this.rangeMax,this.rangeMax=k);for(var t=d.getVariable("n"),m=this.rangeInf,n=this.rangeMax;m<=n;m++)d.setVariable("n",m),k=d.evalExpression(this.expresion),this.exprX=k[0][0],this.exprY=k[0][1],this.abs_coord?f=k[0][1]:(f=
this.space.getAbsoluteX(k[0][0]),l=this.space.getAbsoluteY(k[0][1])),a.moveTo(f,l),a.sequence(f,l,e,0,c,!0);d.setVariable("n",t);a.fill();this.text!=[""]&&this.uber.drawText.call(this,a,this.text,f+e,l-e,this.color,this.font,"start","alphabetic",d.evalExpression(this.decimals),this.fixed,!0)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c=2*Math.PI,g=Math.round;a.Point=function(c,d){this.size=c.evaluator.parser.parse("2");a.Graphic.call(this,c,d)};a.extend(a.Point,
a.Graphic);var h,d,f,l,k,e,t,m,n,s,p,u;a.Point.prototype.update=function(){h=this.evaluator;f=h.evalExpression(this.expresion);this.exprX=f[0][0];this.exprY=f[0][1];this.rotateExp&&(l=a.degToRad(h.evalExpression(this.rotateExp)),k=Math.cos(l),e=Math.sin(l),t=this.exprX*k-this.exprY*e,m=this.exprX*e+this.exprY*k,this.exprX=t,this.exprY=m)};a.Point.prototype.draw=function(){this.uber.draw.call(this,this.color,this.color)};a.Point.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.trace,
this.trace)};a.Point.prototype.drawAux=function(a,e){h=this.evaluator;d=this.space;p=g(h.evalExpression(this.size));u=p+1;a.fillStyle=e.getColor();n=this.abs_coord?g(this.exprX):g(d.getAbsoluteX(this.exprX));s=this.abs_coord?g(this.exprY):g(d.getAbsoluteY(this.exprY));a.beginPath();a.arc(n,s,p,0,c,!0);a.fill();this.text!=[""]&&this.uber.drawText.call(this,a,this.text,n+u+1,s-u,this.color,this.font,"start","alphabetic",h.evalExpression(this.decimals),this.fixed,!0)};return a}(descartesJS||{}),descartesJS=
function(a){if(a.loadLib)return a;var c=Math.round,g=2*Math.PI,h,d,f,l,k,e,t,m,n,s,p,u,q,r,w,v,z,A;a.Segment=function(c,d){this.width=c.evaluator.parser.parse("1");this.size=c.evaluator.parser.parse("2");a.Graphic.call(this,c,d)};a.extend(a.Segment,a.Graphic);a.Segment.prototype.update=function(){h=this.evaluator;f=h.evalExpression(this.expresion);this.endPoints=[];for(var c=0,d=f.length;c<d;c++)this.endPoints[c]={x:f[c][0],y:f[c][1]};if(this.rotateExp){l=a.degToRad(h.evalExpression(this.rotateExp));
k=Math.cos(l);e=Math.sin(l);c=0;for(d=this.endPoints.length;c<d;c++)t=this.endPoints[c].x*k-this.endPoints[c].y*e,m=this.endPoints[c].x*e+this.endPoints[c].y*k,this.endPoints[c].x=t,this.endPoints[c].y=m}};a.Segment.prototype.draw=function(){this.uber.draw.call(this,this.color,this.color)};a.Segment.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.trace,this.trace)};a.Segment.prototype.drawAux=function(a,e,f){h=this.evaluator;d=this.space;n=c(h.evalExpression(this.width));a.lineWidth=
0<n?n:1E-6;q=h.evalExpression(this.size);0>q&&(q=0);a.fillStyle=e.getColor();a.strokeStyle=f.getColor();a.lineCap="round";s=10+a.lineWidth;r=0==a.lineWidth%2?0:0.5;this.abs_coord?(w=c(this.endPoints[0].x),v=c(this.endPoints[0].y),z=c(this.endPoints[1].x),A=c(this.endPoints[1].y)):(w=c(d.getAbsoluteX(this.endPoints[0].x)),v=c(d.getAbsoluteY(this.endPoints[0].y)),z=c(d.getAbsoluteX(this.endPoints[1].x)),A=c(d.getAbsoluteY(this.endPoints[1].y)));a.beginPath();a.moveTo(w+r,v+r);a.lineTo(z+r,A+r);a.stroke();
a.beginPath();a.arc(w,v,q,0,g,!0);a.arc(z,A,q,0,g,!0);a.fill();this.text!=[""]&&(p=parseInt((w+z)/2)-3,u=parseInt((v+A)/2)+3,this.uber.drawText.call(this,a,this.text,p+s,u-s,this.color,this.font,"start","alphabetic",h.evalExpression(this.decimals),this.fixed,!0))};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c=Math.floor,g=Math.round,h,d,f,l,k,e,t,m,n,s,p,u,q,r,w,v,z,A;a.Arrow=function(c,d){this.width=c.evaluator.parser.parse("5");this.size=c.evaluator.parser.parse("2");
this.spear=c.evaluator.parser.parse("8");this.arrow=new a.Color("ee0022");a.Graphic.call(this,c,d)};a.extend(a.Arrow,a.Graphic);a.Arrow.prototype.update=function(){h=this.evaluator;d=h.evalExpression(this.expresion);this.endPoints=[];for(var c=0,g=d.length;c<g;c++)this.endPoints[c]={x:d[c][0],y:d[c][1]};if(this.rotateExp){f=a.degToRad(h.evalExpression(this.rotateExp));l=Math.cos(f);k=Math.sin(f);c=0;for(g=this.endPoints.length;c<g;c++)e=this.endPoints[c].x*l-this.endPoints[c].y*k,t=this.endPoints[c].x*
k+this.endPoints[c].y*l,this.endPoints[c].x=e,this.endPoints[c].y=t}};a.Arrow.prototype.draw=function(){this.uber.draw.call(this,this.arrow,this.color)};a.Arrow.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.arrow,this.trace)};a.Arrow.prototype.drawAux=function(d,e,f){h=this.evaluator;m=this.space;h.evalExpression(this.size);p=h.evalExpression(this.width);1>p&&(p=1);u=Math.ceil(p/2);q=m.scale;this.vect=new a.Vector2D(this.endPoints[1].x-this.endPoints[0].x,this.endPoints[1].y-this.endPoints[0].y);
r=this.vect.vectorLength();this.angle=this.vect.angleBetweenVectors(a.Vector2D.AXIS_X);d.fillStyle=e.getColor();d.strokeStyle=f.getColor();d.lineWidth=2;this.abs_coord?(w=g(this.endPoints[0].x),v=g(this.endPoints[0].y),z=g(this.endPoints[1].x),A=g(this.endPoints[1].y)):(w=g(m.getAbsoluteX(this.endPoints[0].x)),v=g(m.getAbsoluteY(this.endPoints[0].y)),z=g(m.getAbsoluteX(this.endPoints[1].x)),A=g(m.getAbsoluteY(this.endPoints[1].y)));e=h.evalExpression(this.spear);0>e&&(e=0);d.save();d.translate(w,
v,r);this.abs_coord?0<=this.vect.x&&0<=this.vect.y||0>=this.vect.x&&0<=this.vect.y?d.rotate(this.angle):d.rotate(-this.angle):(r*=q,0<=this.vect.x&&0<=this.vect.y||0>=this.vect.x&&0<=this.vect.y?d.rotate(-this.angle):d.rotate(this.angle));d.beginPath();d.moveTo(-u,c(-u));d.lineTo(c(r-e-p),c(-u));d.lineTo(c(r-2*e),c(-e-u));d.lineTo(c(r),0);d.lineTo(c(r-2*e),c(e+u));d.lineTo(c(r-e-p),c(u));d.lineTo(-u,c(u));d.closePath();d.stroke();d.fill();d.restore();this.text!=[""]&&(n=parseInt((w+z)/2)-3,s=parseInt((v+
A)/2)+3,this.uber.drawText.call(this,d,this.text,n,s,f,this.font,"start","alphabetic",h.evalExpression(this.decimals),this.fixed,!0))};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c=Math.round,g,h,d,f,l,k,e,t,m,n,s,p;a.Polygon=function(c,d){this.width=c.evaluator.parser.parse("1");this.fill="";a.Graphic.call(this,c,d);this.endPoints=[]};a.extend(a.Polygon,a.Graphic);a.Polygon.prototype.update=function(){g=this.evaluator;d=g.evalExpression(this.expresion);for(var c=
0,h=d.length;c<h;c++)this.endPoints[c]={x:d[c][0],y:d[c][1]};if(this.rotateExp){f=a.degToRad(g.evalExpression(this.rotateExp));l=Math.cos(f);k=Math.sin(f);c=0;for(h=this.endPoints.length;c<h;c++)e=this.endPoints[c].x*l-this.endPoints[c].y*k,t=this.endPoints[c].x*k+this.endPoints[c].y*l,this.endPoints[c].x=e,this.endPoints[c].y=t}};a.Polygon.prototype.draw=function(){this.uber.draw.call(this,this.fill,this.color)};a.Polygon.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.trace,this.trace)};
a.Polygon.prototype.drawAux=function(a,d,e){g=this.evaluator;h=this.space;m=c(g.evalExpression(this.width));a.lineWidth=0<m?m:1E-6;a.strokeStyle=e.getColor();a.lineCap="round";a.lineJoin="round";n=0<m?0.5:0;s=this.abs_coord?c(this.endPoints[0].x):c(h.getAbsoluteX(this.endPoints[0].x));p=this.abs_coord?c(this.endPoints[0].y):c(h.getAbsoluteY(this.endPoints[0].y));a.beginPath();a.moveTo(s+n,p+n);e=1;for(var f=this.endPoints.length;e<f;e++)s=this.abs_coord?c(this.endPoints[e].x):c(h.getAbsoluteX(this.endPoints[e].x)),
p=this.abs_coord?c(this.endPoints[e].y):c(h.getAbsoluteY(this.endPoints[e].y)),a.lineTo(s+n,p+n);this.fill&&(a.fillStyle=d.getColor(),a.fill());a.stroke()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c=Math.round;a.Arc=function(c,d){this.width=c.evaluator.parser.parse("1");this.fill="";this.center=c.evaluator.parser.parse("(0,0)");this.radius=c.evaluator.parser.parse("1");this.init=c.evaluator.parser.parse("0");this.end=c.evaluator.parser.parse("90");a.Graphic.call(this,
c,d)};a.extend(a.Arc,a.Graphic);var g,h,d,f,l,k,e,t,m,n,s,p,u,q,r,w,v,z,A,B,x,D,E,F;a.Arc.prototype.update=function(){g=this.evaluator;h=g.evalExpression(this.center);this.exprX=h[0][0];this.exprY=h[0][1];this.rotateExp&&(d=a.degToRad(g.evalExpression(this.rotateExp)),f=Math.cos(d),l=Math.sin(d),k=this.exprX*f-this.exprY*l,e=this.exprX*l+this.exprY*f,this.exprX=k,this.exprY=e);t=g.evalExpression(this.init);m=g.evalExpression(this.end);"(expr)"==this.init.type&&"(expr)"==this.end.type||"[expr]"==this.init.type&&
"[expr]"==this.end.type||"(expr)"==this.init.type&&"[expr]"==this.end.type||"[expr]"==this.init.type&&"(expr)"==this.end.type?(this.vectors=!0,n=t[0][0],s=t[0][1],p=m[0][0],u=m[0][1],q=Math.acos((1*n+0*s)/Math.sqrt(n*n+s*s)),r=Math.acos((1*p+0*u)/Math.sqrt(p*p+u*u)),0<n&&(0<s&&!this.abs_coord)&&(q=2*Math.PI-q),0<n&&(0>s&&this.abs_coord)&&(q=2*Math.PI-q),0>n&&(0>s&&this.abs_coord)&&(q=2*Math.PI-q),0>n&&(0<s&&!this.abs_coord)&&(q=2*Math.PI-q),0<p&&(0<u&&!this.abs_coord)&&(r=2*Math.PI-r),0<p&&(0>u&&
this.abs_coord)&&(r=2*Math.PI-r),0>p&&(0>u&&this.abs_coord)&&(r=2*Math.PI-r),0>p&&(0<u&&!this.abs_coord)&&(r=2*Math.PI-r),w=Math.min(q,r),v=Math.max(q,r),q=w,r=v,r-q>Math.PI&&this.abs_coord&&(q=v,r=w),r-q<=Math.PI&&!this.abs_coord&&(q=v,r=w),this.iniAng=q,this.endAng=r):(this.vectors=!1,this.iniAng=a.degToRad(t),this.endAng=a.degToRad(m))};a.Arc.prototype.draw=function(){this.uber.draw.call(this,this.fill,this.color)};a.Arc.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.fill,this.trace)};
a.Arc.prototype.drawAux=function(a,d,e){g=this.evaluator;z=this.space;A=this.abs_coord?c(this.exprX):c(z.getAbsoluteX(this.exprX));B=this.abs_coord?c(this.exprY):c(z.getAbsoluteY(this.exprY));x=g.evalExpression(this.radius);!this.vectors&&this.iniAng>this.endAng&&(D=this.iniAng,this.iniAng=this.endAng,this.endAng=D);0>x&&(x=0);E=!1;this.abs_coord||(x*=z.scale,this.vectors||(this.iniAng=-this.iniAng,this.endAng=-this.endAng,E=!0));this.vectors&&(E=this.abs_coord?!1:!0);F=c(g.evalExpression(this.width));
a.lineWidth=0<F?F:1E-6;a.lineCap="round";a.strokeStyle=e.getColor();a.beginPath();a.arc(A,B,x,this.iniAng,this.endAng,E);this.fill&&(a.fillStyle=d.getColor(),a.fill());a.stroke();this.text!=[""]&&this.uber.drawText.call(this,a,this.text,A+4,B-2,this.color,this.font,"start","alphabetic",g.evalExpression(this.decimals),this.fixed,!0)};return a}(descartesJS||{}),descartesJS=function(a){function c(a,c,d){e=4*(c+d*a.width);return{r:a.data[e],g:a.data[e+1],b:a.data[e+2],a:a.data[e+3]}}if(a.loadLib)return a;
var g,h,d,f,l,k,e;a.Fill=function(c,d){a.Graphic.call(this,c,d)};a.extend(a.Fill,a.Graphic);a.Fill.prototype.update=function(){g=this.evaluator.evalExpression(this.expresion);this.exprX=g[0][0];this.exprY=g[0][1]};a.Fill.prototype.draw=function(){this.uber.draw.call(this,this.color,this.color)};a.Fill.prototype.drawTrace=function(){};a.Fill.prototype.drawAux=function(a,g){g.getColor();imageData=this.ctx.getImageData(0,0,this.space.w,this.space.h);this.abs_coord?(h=parseInt(this.exprX),d=parseInt(this.exprY)):
(h=parseInt(this.space.getAbsoluteX(this.exprX)),d=parseInt(this.space.getAbsoluteY(this.exprY)));f=[{x:h,y:d}];for(k=c(imageData,h,d);0<f.length;){l=f.pop();h=l.x;d=l.y;var n=c(imageData,h,d);if(k.r===n.r&&k.g===n.g&&k.b===n.b&&k.a===n.a){var n=imageData,s=g;e=4*(h+d*n.width);n.data[e+0]=s.r;n.data[e+1]=s.g;n.data[e+2]=s.b;n.data[e+3]=255-s.a;0<h&&f.push({x:h-1,y:d});h<imageData.width-1&&f.push({x:h+1,y:d});f.push({x:h,y:d-1});f.push({x:h,y:d+1})}}this.ctx.putImageData(imageData,0,0)};return a}(descartesJS||
{}),descartesJS=function(a){if(a.loadLib)return a;var c,g,h,d,f,l,k,e,t,m,n,s,p,u,q,r,w,v;a.Text=function(c,d){this.width=c.evaluator.parser.parse("0");a.Graphic.call(this,c,d);this.align||(this.align="start");this.ascent=this.fontSize-Math.ceil(this.fontSize/7)-(this.font.match("Courier")?3:0);this.abs_coord=!0};a.extend(a.Text,a.Graphic);a.Text.prototype.update=function(){c=this.evaluator;g=c.evalExpression(this.expresion);this.exprX=g[0][0];this.exprY=g[0][1];this.rotateExp&&(h=a.degToRad(c.evalExpression(this.rotateExp)),
d=Math.cos(h),f=Math.sin(h),l=this.exprX*d-this.exprY*f,k=this.exprX*f+this.exprY*d,this.exprX=l,this.exprY=k)};a.Text.prototype.draw=function(){this.uber.draw.call(this,this.color)};a.Text.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.color)};a.Text.prototype.drawAux=function(a,c){v=this.evaluator.evalExpression(this.decimals);"rtfNode"===this.text.type?(n=this.text,this.ascent=0):n=this.splitText(this.text.toString(v,this.fixed).split("\\n"));this.text!=[""]&&this.uber.drawText.call(this,
a,n,parseInt(this.exprX)+5,parseInt(this.exprY)+this.ascent,c,this.font,this.align,"alphabetic",v,this.fixed)};a.Text.prototype.splitText=function(a){c=this.evaluator;e=c.evalExpression(this.width);n=[];this.ctx.font=this.font;if(20<=e&&"undefined"!=a.type){for(var d=0,h=a.length;d<h;d++)t=a[d],m=this.ctx.measureText(t).width,m>e?n=n.concat(this.splitWords(t,e)):n.push(t);s=Math.floor(1.2*this.fontSize)*n.length;c.setVariable("_Text_H_",s);return n}c.setVariable("_Text_H_",0);c.setVariable("_Text_W_",
1E3);return a};a.Text.prototype.splitWords=function(a,c){p=a;u=[];q="";w=0;for(var d,e=0,h=a.length;e<h;e++)r=p.charAt(e)," "===r&&(lastIndexOfWhite=e),q+=r,Math.round(this.ctx.measureText(q).width)>c&&(d=a.substring(w,e+1)," "!==r&&(-1===d.indexOf(" ")?(lastIndexOfWhite=e,e--):e=lastIndexOfWhite),u.push(a.substring(w,lastIndexOfWhite)),q="",w=e+1);u.push(a.substring(w));return u};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c=Math.round;a.Image=function(c,d){this.file=
"";this.inirot=c.evaluator.parser.parse("0");a.Graphic.call(this,c,d);this.img=new Image;this.scaleY=this.scaleX=1;this.update()};a.extend(a.Image,a.Graphic);var g,h,d,f,l,k,e,t,m,n,s,p,u,q;a.Image.prototype.update=function(){g=this.evaluator;h=g.evalExpression(this.expresion);this.exprX=h[0][0];this.exprY=h[0][1];this.rotateExp&&(d=a.degToRad(g.evalExpression(this.rotateExp)),f=Math.cos(d),l=Math.sin(d),k=this.exprX*f-this.exprY*l,e=this.exprX*l+this.exprY*f,this.exprX=k,this.exprY=e);4==h[0].length&&
(this.centered=!0,this.scaleX=h[0][2],0==this.scaleX&&(this.scaleX=1E-5),this.scaleY=h[0][3],0==this.scaleY&&(this.scaleY=1E-5));h[1]&&2==h[1].length&&(this.centered=!0,this.scaleX=h[1][0],0==this.scaleX&&(this.scaleX=1E-5),this.scaleY=h[1][1],0==this.scaleY&&(this.scaleY=1E-5));if((t=g.evalExpression(this.file))||""==t)this.img=this.parent.getImage(t)};a.Image.prototype.draw=function(){this.uber.draw.call(this)};a.Image.prototype.drawTrace=function(){this.uber.drawTrace.call(this)};a.Image.prototype.drawAux=
function(d){g=this.evaluator;m=this.space;this.img&&(this.img.ready&&this.img.complete)&&(n=this.centered?0:this.img.width/2,s=this.centered?0:this.img.height/2,p=this.abs_coord?c(this.exprX):c(m.getAbsoluteX(this.exprX)),u=this.abs_coord?c(this.exprY):c(m.getAbsoluteY(this.exprY)),q=a.degToRad(-g.evalExpression(this.inirot)),d.translate(p+n,u+s),d.rotate(q),d.scale(this.scaleX,this.scaleY),this.opacity&&(d.globalAlpha=g.evalExpression(this.opacity)),d.drawImage(this.img,-this.img.width/2,-this.img.height/
2),d.setTransform(1,0,0,1,0,0),d.globalAlpha=1)};return a}(descartesJS||{}),descartesJS=function(a){function c(a,c,d){e=4*(c+d*a.width);return{r:a.data[e],g:a.data[e+1],b:a.data[e+2],a:a.data[e+3]}}if(a.loadLib)return a;var g,h,d,f,l,k,e;a.Fill=function(c,d){a.Graphic.call(this,c,d)};a.extend(a.Fill,a.Graphic);a.Fill.prototype.update=function(){g=this.evaluator.evalExpression(this.expresion);this.exprX=g[0][0];this.exprY=g[0][1]};a.Fill.prototype.draw=function(){this.uber.draw.call(this,this.color,
this.color)};a.Fill.prototype.drawTrace=function(){};a.Fill.prototype.drawAux=function(a,g){g.getColor();imageData=this.ctx.getImageData(0,0,this.space.w,this.space.h);this.abs_coord?(h=parseInt(this.exprX),d=parseInt(this.exprY)):(h=parseInt(this.space.getAbsoluteX(this.exprX)),d=parseInt(this.space.getAbsoluteY(this.exprY)));f=[{x:h,y:d}];for(k=c(imageData,h,d);0<f.length;){l=f.pop();h=l.x;d=l.y;var n=c(imageData,h,d);if(k.r===n.r&&k.g===n.g&&k.b===n.b&&k.a===n.a){var n=imageData,s=g;e=4*(h+d*n.width);
n.data[e+0]=s.r;n.data[e+1]=s.g;n.data[e+2]=s.b;n.data[e+3]=255-s.a;0<h&&f.push({x:h-1,y:d});h<imageData.width-1&&f.push({x:h+1,y:d});f.push({x:h,y:d-1});f.push({x:h,y:d+1})}}this.ctx.putImageData(imageData,0,0)};return a}(descartesJS||{}),descartesJS=function(a,c){if(a.loadLib)return a;a.Macro=function(g,h){this.expresion=void 0;this.inirot=g.evaluator.parser.parse("0");a.Graphic.call(this,g,h);for(var d in h)h.hasOwnProperty(d)&&(this[d]=h[d]);this.graphics=[];d=g.lessonParser;var f=new a.Tokenizer;
if(void 0!=this.expresion){"'"!==this.expresion.charAt(0)&&(this.expresion="'"+this.expresion+"'");this.expresion=this.evaluator.parser.parse(this.expresion);var l=this.evaluator.evalExpression(this.expresion),k,e=2;l&&((k=document.getElementById(l))&&"descartes/macro"==k.type?(k=k.text,e=3):(k=a.openExternalFile(l))&&!k.match(/tipo_de_macro/g)&&(k=null));var t="|";if(k){k=k.replace(/&aacute;/g,"\u00e1").replace(/&eacute;/g,"\u00e9").replace(/&iacute;/g,"\u00ed").replace(/&oacute;/g,"\u00f3").replace(/&uacute;/g,
"\u00fa").replace(/&Aacute;/g,"\u00c1").replace(/&Eacute;/g,"\u00c9").replace(/&Iacute;/g,"\u00cd").replace(/&Oacute;/g,"\u00d3").replace(/&Uacute;/g,"\u00da").replace(/&ntilde;/g,"\u00f1").replace(/&Ntilde;/g,"\u00d1").replace(/\&gt;/g,">").replace(/\&lt;/g,"<").replace(/\&amp;/g,"&").split("\n").slice(e);for(var m,n,l=0,e=k.length;l<e;l++)k[l]&&(k[l]=d.split(k[l]),k[l]&&(k[l][0]&&k[l][0][0]&&"id"===k[l][0][0])&&(m=k[l][0][1],n=m.indexOf("("),-1!=n&&(m=m.substring(0,n)),t+=m+"|"));for(var s,p,u,
q,l=0,e=k.length;l<e;l++){s=k[l]||[];m=0;for(n=s.length;m<n;m++)if(p=c[s[m][0]],u=s[m][0].indexOf("."),-1!=u&&(p=c[s[m][0].substring(u+1)]),!("id"!=p&&void 0!=c[s[m][1]]))if("text"==p)if(s[m][1].match(/\{\\rtf1/)){p=s[m][1];var r=this;q=function(a,c){for(var d=f.tokenize(c.replace(/\&squot;/g,"'")),e=0,h=d.length;e<h;e++)if("identifier"==d[e].type&&t.match("\\|"+d[e].value+"\\|"))d[e].value=r.name+"."+d[e].value;else if("identifier"==d[e].type&&-1!=(u=d[e].value.indexOf("."))&&t.match("\\|"+d[e].value.substring(0,
u)+"\\|"))d[e].value=r.name+"."+d[e].value;return(a.match(/^\\expr/)?"\\expr ":"\\decimals ")+f.flatTokens(d)};p=p.replace(/\\expr ([a-zA-Z_0-9\u00C0-\u021B+*/%|&^#!?:()><.']*)/gi,q);p=p.replace(/\\decimals ([a-zA-Z_0-9\u00C0-\u021B+*/%|&^#!?:()><.']*)/gi,q);s[m][1]=p}else{q=d.parseText(s[m][1]).textElementsMacros;for(var w=0,v=q.length;w<v;w++){p=f.tokenize(q[w].replace(/\&squot;/g,"'"));for(var z=0,A=p.length;z<A;z++)"identifier"==p[z].type&&t.match("\\|"+p[z].value+"\\|")&&(p[z].value=this.name+
"."+p[z].value);p=f.flatTokens(p).replace(/&squot;/g,"'").replace(/'\+\(/g,"[").replace(/\)\+'/g,"]");q[w]=p.substring(1,p.length-1)}s[m][1]=q.join("")}else{p=f.tokenize(s[m][1]);q=0;for(w=p.length;q<w;q++)if("identifier"==p[q].type&&t.match("\\|"+p[q].value+"\\|"))p[q].value=this.name+"."+p[q].value;else if("identifier"==p[q].type&&-1!=(u=p[q].value.indexOf("."))&&t.match("\\|"+p[q].value.substring(0,u)+"\\|"))p[q].value=this.name+"."+p[q].value;s[m][1]=f.flatTokens(p)}}l=0;for(e=k.length;l<e;l++)if(k[l][0]){s=
"";p=!1;m=0;for(n=k[l].length;m<n;m++)"type"===c[k[l][m][0]]&&(s="espacio='"+this.spaceID+"' ",p=!0),s=s+k[l][m][0]+"='"+k[l][m][1]+"' ";k[l]=s;p?this.graphics.push(d.parseGraphic(k[l],this.abs_coord,this.background,this.inirot)):d.parseAuxiliar(k[l])}}}};a.extend(a.Macro,a.Graphic);a.Macro.prototype.update=function(){if(this.inipos){var a=this.evaluator.evalExpression(this.inipos);this.iniPosX=a[0][0];this.iniPosY=a[0][1]}};a.Macro.prototype.drawAux=function(a){for(var c=0,d=this.graphics.length;c<
d;c++)this.inipos&&(this.graphics[c].abs_coord?a.translate(this.iniPosX,this.iniPosY):a.translate(this.iniPosX*this.space.scale,-this.iniPosY*this.space.scale)),this.graphics[c].draw(),a.setTransform(1,0,0,1,0,0)};return a}(descartesJS||{},babel),descartesJS=function(a){if(a.loadLib)return a;a.RenderMath={};a.RenderMath.inverseSqrt=function(a){return 1/Math.sqrt(number)};a.Vector2D=function(a,g){this.x=a||0;this.y=g||0};a.Vector2D.prototype.clone=function(){return new a.Vector2D(this.x,this.y)};a.Vector2D.prototype.add=
function(c){return new a.Vector2D(this.x+c.x,this.y+c.y)};a.Vector2D.prototype.substract=function(c){return new a.Vector2D(this.x-c.x,this.y-c.y)};a.Vector2D.prototype.multiply=function(c){return new a.Vector2D(this.x*c.x,this.y*c.y)};a.Vector2D.prototype.divide=function(c){return new a.Vector2D(this.x/c.x,this.y/c.y)};a.Vector2D.prototype.scale=function(c){return new a.Vector2D(this.x*c,this.y*c)};a.Vector2D.prototype.dist=function(a){var g=a.x-this.x;a=a.y-this.y;return Math.sqrt(g*g+a*a)};a.Vector2D.prototype.negate=
function(){return new a.Vector2D(-this.x,-this.y)};a.Vector2D.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};a.Vector2D.prototype.squaredLength=function(){return this.x*this.x+this.y*this.y};a.Vector2D.prototype.normalize=function(){var c=this.squaredLength();return 0<c?(c=Math.sqrt(c),new a.Vector2D(this.x/c,this.y/c)):new a.Vector2D(0,0)};a.Vector2D.prototype.crossProduct=function(a){return this.x*a.y-this.y*a.x};a.Vector2D.prototype.dot=function(a){return this.x*a.x+
this.y*a.y};a.Vector2D.prototype.direction=function(c){var g=this.x-c.x;c=this.y-c.y;var h=g*g+c*c;if(!h)return new a.Vector2D(0,0);h=1/Math.sqrt(h);return new a.Vector2D(g*h,c*h)};a.Vector2D.prototype.lerp=function(c,g){return new a.Vector2D(this.x+g*(c.x-this.x),this.y+g*(c.y-this.y))};a.Vector3D=function(a,g,h){this.x=a||0;this.y=g||0;this.z=h||0};a.Vector3D.prototype.set=function(a,g,h){this.x=a;this.y=g;this.z=h;return this};a.Vector3D.prototype.toVector4D=function(){return new a.Vector4D(this.x,
this.y,this.z,1)};a.Vector3D.prototype.copy=function(){return new a.Vector3D(this.x,this.y,this.z)};a.Vector3D.prototype.add=function(c){return new a.Vector3D(this.x+c.x,this.y+c.y,this.z+c.z)};a.Vector3D.prototype.substract=function(c){return new a.Vector3D(this.x-c.x,this.y-c.y,this.z-c.z)};a.Vector3D.prototype.multiply=function(c){return new a.Vector3D(this.x*c.x,this.y*c.y,this.z*c.z)};a.Vector3D.prototype.negate=function(){return new a.Vector3D(-this.x,-this.y,-this.z)};a.Vector3D.prototype.scale=
function(c){return new a.Vector3D(this.x*c,this.y*c,this.z*c)};a.Vector3D.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)};a.Vector3D.prototype.squaredLength=function(){return this.x*this.x+this.y*this.y+this.z*this.z};a.Vector3D.prototype.normalize=function(){var c=this.length();if(0==c)return new a.Vector3D(0,0,0);if(1==c)return new a.Vector3D(this.x,this.y,this.z);c=1/c;return new a.Vector3D(this.x*c,this.y*c,this.z*c)};a.Vector3D.prototype.crossProduct=
function(c){return new a.Vector3D(this.y*c.z-this.z*c.y,this.z*c.x-this.x*c.z,this.x*c.y-this.y*c.x)};a.Vector3D.prototype.dotProduct=function(a){return this.x*a.x+this.y*a.y+this.z*a.z};a.Vector3D.prototype.direction=function(c){var g=this.x-c.x,h=this.y-c.y;c=this.z-c.z;var d=Math.sqrt(g*g+h*h+c*c);if(0==d)return new a.Vector3D(0,0,0);d=1/d;return new a.Vector3D(g*d,h*d,c*d)};a.Vector3D.prototype.lerp=function(c,g){return new a.Vector3D(this.x+g*(c.x-this.x),this.y+g*(c.y-this.y),this.z+g*(c.z-
this.z))};a.Vector3D.prototype.distance=function(a){var g=a.x-this.x,h=a.y-this.y;a=a.z-this.z;return Math.sqrt(g*g+h*h+a*a)};a.Vector3D.prototype.unproject=function(c,g,h){var d=new a.Vector4D(2*(this.x-h.x)/h.width-1,2*(this.y-h.y)/h.height-1,2*this.z-1,d[3]=1);c=g.multiply(c);if(!c.inverse())return null;d=c.multiplyVector4(d);return 0==d.w?null:new a.Vector3D(d.x/d.w,d.y/d.w,d.z/d.w)};a.Vector3D.prototype.rotationTo=function(c){var g=new a.Vector3D(1,0,0),h=new a.Vector3D(0,1,0),d=new a.Vector3D(0,
0,1),f=this.dotProduct(c),l=new a.Quaternion;1<=f?l.setIdentity():-0.999999>f?(axis=g.crossProduct(this),1E-6>axis.length()&&(axis=h.crossProduct(this)),1E-6>axis.length()&&(axis=d.crossProduct(this)),axis=axis.normalize(),l=Quaternion.fromAngleAxis(Math.PI,axis)):(g=Math.squrt(2*(1+f)),h=1/g,axis=this.crossProduct(c),l.x=axis.x*h,l.y=axis.y*h,l.z=axis.z*h,l.w=0.5*g,l=Quaternion.normalize());1<l.w?l.w=1:-1>l.w&&(l.w=-1);return l};a.Vector4D=function(a,g,h,d){this.x=a||0;this.y=g||0;this.z=h||0;this.w=
d||0};a.Vector4D.prototype.set=function(a,g,h,d){this.x=a;this.y=g;this.z=h;this.w=d;return this};a.Vector4D.prototype.toVector3D=function(){var c=0!==this.w?1/this.w:0;return new a.Vector3D(this.x*c,this.y*c,this.z*c)};a.Vector4D.prototype.clone=function(){return new a.Vector4D(this.x,this.y,this.z,this.w)};a.Vector4D.prototype.add=function(c){return new a.Vector4D(this.x+c.x,this.y+c.y,this.z+c.z,this.w+c.w)};a.Vector4D.prototype.substract=function(c){return new a.Vector4D(this.x-c.x,this.y-c.y,
this.z-c.z,this.w-c.w)};a.Vector4D.prototype.multiply=function(c){return new a.Vector4D(this.x*c.x,this.y*c.y,this.z*c.z,this.w*c.w)};a.Vector4D.prototype.divide=function(c){return new a.Vector4D(this.x/c.x,this.y/c.y,this.z/c.z,this.w/c.w)};a.Vector4D.prototype.scale=function(c){return new a.Vector4D(this.x*c,this.y*c,this.z*c,this.w*c)};a.Vector4D.prototype.negate=function(){return new a.Vector4D(-this.x,-this.y,-this.z,-this.w)};a.Vector4D.prototype.length=function(){return Math.sqrt(this.x*this.x+
this.y*this.y+this.z*this.z+this.w*this.w)};a.Vector4D.prototype.squaredLength=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w};a.Vector4D.prototype.lerp=function(c,g){return new a.Vector4D(this.x+g*(c.x-this.x),this.y+g*(c.y-this.y),this.z+g*(c.z-this.z),this.w+g*(c.w-this.w))};a.Matrix2x2=function(a,g,h,d){this.a00=a||0;this.a01=g||0;this.a10=h||0;this.a11=d||0};a.Matrix2x2.prototype.clone=function(){return new a.Matrix2x2(this.a00,this.a01,this.a10,this.a11)};a.Matrix2x2.prototype.setIdentity=
function(){this.a00=1;this.a10=this.a01=0;this.a11=1;return this};a.Matrix2x2.prototype.transpose=function(){return new a.Matrix2x2(this.a00,this.a10,this.a01,this.a11)};a.Matrix2x2.prototype.determinant=function(){return this.a00*this.a11-this.a10*this.a01};a.Matrix2x2.prototype.inverse=function(){var c=this.determinant();if(!c)return null;c=1/c;return new a.Matrix2x2(this.a11*c,-this.a10*c,-this.a01*c,this.a00*c)};a.Matrix2x2.prototype.multiply=function(c){return new a.Matrix2x2(this.a00*c.a00+
this.a01*c.a10,this.a00*c.a01+this.a01*c.a11,this.a10*c.a00+this.a11*c.a10,this.a10*c.a01+this.a11*c.a11)};a.Matrix2x2.prototype.rotate=function(c){var g=Math.sin(c);c=Math.cos(c);return new a.Matrix2x2(this.a00*c+this.a01*g,this.a00*-g+this.a01*c,this.a10*c+this.a11*g,this.a10*-g+this.a11*c)};a.Matrix2x2.prototype.multiplyVector2=function(c){return new a.Vector2D(c.x*this.a00+c.y*this.a01,c.x*this.a10+c.y*this.a11)};a.Matrix2x2.prototype.scale=function(c){return new a.Matrix2x2(this.a00*c.x,this.a01*
c.y,this.a10*c.x,this.a11*c.y)};a.Matrix3x3=function(a,g,h,d,f,l,k,e,t){this.a00=a||0;this.a01=g||0;this.a02=h||0;this.a10=d||0;this.a11=f||0;this.a12=l||0;this.a20=k||0;this.a21=e||0;this.a22=t||0};a.Matrix3x3.prototype.copy=function(){return new a.Matrix3x3(this.a00,this.a01,this.a02,this.a10,this.a11,this.a12,this.a20,this.a21,this.a22)};a.Matrix3x3.prototype.determinant=function(){var a=this.a10,g=this.a11,h=this.a12,d=this.a20,f=this.a21,l=this.a22;return this.a00*(l*g-h*f)+this.a01*(-l*a+h*
d)+this.a02*(f*a-g*d)};a.Matrix3x3.prototype.inverse=function(){var c=this.a00,g=this.a01,h=this.a02,d=this.a10,f=this.a11,l=this.a12,k=this.a20,e=this.a21,t=this.a22,m=t*f-l*e,n=-t*d+l*k,s=e*d-f*k,p=c*m+g*n+h*s;if(!p)return null;p=1/p;return new a.Matrix3x3(m*p,(-t*g+h*e)*p,(l*g-h*f)*p,n*p,(t*c-h*k)*p,(-l*c+h*d)*p,s*p,(-e*c+g*k)*p,(f*c-g*d)*p)};a.Matrix3x3.prototype.multply=function(c){var g=this.a00,h=this.a01,d=this.a02,f=this.a10,l=this.a11,k=this.a12,e=this.a20,t=this.a21,m=this.a22,n=c.a00,
s=c.a01,p=c.a02,u=c.a10,q=c.a11,r=c.a12,w=c.a20,v=c.a21;c=c.a22;return new a.Matrix3x3(n*g+s*f+p*e,n*h+s*l+p*t,n*d+s*k+p*m,u*g+q*f+r*e,u*h+q*l+r*t,u*d+q*k+r*m,w*g+v*f+c*e,w*h+v*l+c*t,w*d+v*k+c*m)};a.Matrix3x3.prototype.multiplyVector2=function(c){return new a.Vector2D(c.x*this.a00+c.y*this.a10+this.a20,c.x*this.a01+c.y*this.a11+this.a21)};a.Matrix3x3.prototype.multiplyVector3=function(c){return new a.Vector3D(c.x*this.a00+c.y*this.a10+c.z*this.a20,c.x*this.a01+c.y*this.a11+c.z*this.a21,c.x*this.a02+
c.y*this.a12+c.z*this.a22)};a.Matrix3x3.prototype.setIdentity=function(){this.a00=1;this.a10=this.a02=this.a01=0;this.a11=1;this.a21=this.a20=this.a12=0;this.a22=1;return this};a.Matrix3x3.prototype.transpose=function(){return new a.Matrix3x3(this.a00,this.a10,this.a20,this.a01,this.a11,this.a21,this.a02,this.a12,this.a22)};a.Matrix3x3.prototype.toMatrix4x4=function(){return new a.Matrix4x4(this.a00,this.a01,this.a02,0,this.a10,this.a11,this.a12,0,this.a20,this.a21,this.a22,0,0,0,0,1)};a.Matrix4x4=
function(a,g,h,d,f,l,k,e,t,m,n,s,p,u,q,r){this.a00=a||0;this.a01=g||0;this.a02=h||0;this.a03=d||0;this.a10=f||0;this.a11=l||0;this.a12=k||0;this.a13=e||0;this.a20=t||0;this.a21=m||0;this.a22=n||0;this.a23=s||0;this.a30=p||0;this.a31=u||0;this.a32=q||0;this.a33=r||0};a.Matrix4x4.prototype.copy=function(){return new a.Matrix4x4(this.a00,this.a01,this.a02,this.a03,this.a10,this.a11,this.a12,this.a13,this.a20,this.a21,this.a22,this.a23,this.a30,this.a31,this.a32,this.a33)};a.Matrix4x4.prototype.setIdentity=
function(){this.a00=1;this.a10=this.a03=this.a02=this.a01=0;this.a11=1;this.a21=this.a20=this.a13=this.a12=0;this.a22=1;this.a32=this.a31=this.a30=this.a23=0;this.a33=1;return this};a.Matrix4x4.prototype.transpose=function(){return new a.Matrix3x3(this.a00,this.a10,this.a20,this.a30,this.a01,this.a11,this.a21,this.a31,this.a02,this.a12,this.a22,this.a32,this.a03,this.a13,this.a23,this.a33)};a.Matrix4x4.prototype.determinant=function(){var a=this.a00,g=this.a01,h=this.a02,d=this.a03,f=this.a10,l=this.a11,
k=this.a12,e=this.a13,t=this.a20,m=this.a21,n=this.a22,s=this.a23,p=this.a30,u=this.a31,q=this.a32,r=this.a33;return p*m*k*d-t*u*k*d-p*l*n*d+f*u*n*d+t*l*q*d-f*m*q*d-p*m*h*e+t*u*h*e+p*g*n*e-a*u*n*e-t*g*q*e+a*m*q*e+p*l*h*s-f*u*h*s-p*g*k*s+a*u*k*s+f*g*q*s-a*l*q*s-t*l*h*r+f*m*h*r+t*g*k*r-a*m*k*r-f*g*n*r+a*l*n*r};a.Matrix4x4.prototype.inverse=function(){var c=this.a00,g=this.a01,h=this.a02,d=this.a03,f=this.a10,l=this.a11,k=this.a12,e=this.a13,t=this.a20,m=this.a21,n=this.a22,s=this.a23,p=this.a30,u=this.a31,
q=this.a32,r=this.a33,w=c*l-g*f,v=c*k-h*f,z=c*e-d*f,A=g*k-h*l,B=g*e-d*l,x=h*e-d*k,D=t*u-m*p,E=t*q-n*p,F=t*r-s*p,C=m*q-n*u,K=m*r-s*u,I=n*r-s*q,H=w*I-v*K+z*C+A*F-B*E+x*D;if(!H)return null;H=1/H;return new a.Matrix4x4((l*I-k*K+e*C)*H,(-g*I+h*K-d*C)*H,(u*x-q*B+r*A)*H,(-m*x+n*B-s*A)*H,(-f*I+k*F-e*E)*H,(c*I-h*F+d*E)*H,(-p*x+q*z-r*v)*H,(t*x-n*z+s*v)*H,(f*K-l*F+e*D)*H,(-c*K+g*F-d*D)*H,(p*B-u*z+r*w)*H,(-t*B+m*z-s*w)*H,(-f*C+l*E-k*D)*H,(c*C-g*E+h*D)*H,(-p*A+u*v-q*w)*H,(t*A-m*v+n*w)*H)};a.Matrix4x4.prototype.toRotationMat=
function(){return new a.Matrix4x4(this.a00,this.a01,this.a02,this.a03,this.a10,this.a11,this.a12,this.a13,this.a20,this.a21,this.a22,this.a23,0,0,0,1)};a.Matrix4x4.prototype.toMatrix3x3=function(){return new a.Matrix4x4(this.a00,this.a01,this.a02,this.a10,this.a11,this.a12,this.a20,this.a21,this.a22)};a.Matrix4x4.prototype.toInverseMat3=function(){var c=this.a00,g=this.a01,h=this.a02,d=this.a10,f=this.a11,l=this.a12,k=this.a20,e=this.a21,t=this.a22,m=t*f-l*e,n=-t*d+l*k,s=e*d-f*k;return!(c*m+g*n+h*
s)?null:new a.Matrix3x3(m*id,(-t*g+h*e)*id,(l*g-h*f)*id,n*id,(t*c-h*k)*id,(-l*c+h*d)*id,s*id,(-e*c+g*k)*id,(f*c-g*d)*id)};a.Matrix4x4.prototype.multiply=function(c){var g=this.a00,h=this.a01,d=this.a02,f=this.a03,l=this.a10,k=this.a11,e=this.a12,t=this.a13,m=this.a20,n=this.a21,s=this.a22,p=this.a23,u=this.a30,q=this.a31,r=this.a32,w=this.a33,v=c.a00,z=c.a01,A=c.a02,B=c.a03,x=c.a10,D=c.a11,E=c.a12,F=c.a13,C=c.a20,K=c.a21,I=c.a22,H=c.a23,L=c.a30,y=c.a31,J=c.a32;c=c.a33;return new a.Matrix4x4(v*g+z*
l+A*m+B*u,v*h+z*k+A*n+B*q,v*d+z*e+A*s+B*r,v*f+z*t+A*p+B*w,x*g+D*l+E*m+F*u,x*h+D*k+E*n+F*q,x*d+D*e+E*s+F*r,x*f+D*t+E*p+F*w,C*g+K*l+I*m+H*u,C*h+K*k+I*n+H*q,C*d+K*e+I*s+H*r,C*f+K*t+I*p+H*w,L*g+y*l+J*m+c*u,L*h+y*k+J*n+c*q,L*d+y*e+J*s+c*r,L*f+y*t+J*p+c*w)};a.Matrix4x4.prototype.multiplyVector3=function(c){return new a.Vector3D(c.x*this.a00+c.y*this.a10+c.z*this.a20+this.a30,c.x*this.a01+c.y*this.a11+c.z*this.a21+this.a31,c.x*this.a02+c.y*this.a12+c.z*this.a22+this.a32)};a.Matrix4x4.prototype.multiplyVector4=
function(c){return new a.Vector4D(c.x*this.a00+c.y*this.a10+c.z*this.a20+c.w*this.a30,c.x*this.a01+c.y*this.a11+c.z*this.a21+c.w*this.a31,c.x*this.a02+c.y*this.a12+c.z*this.a22+c.w*this.a32,c.x*this.a03+c.y*this.a13+c.z*this.a23+c.w*this.a33)};a.Matrix4x4.prototype.translate=function(c){return new a.Matrix4x4(this.a00,this.a01,this.a02,this.a03,this.a10,this.a11,this.a12,this.a13,this.a20,this.a21,this.a22,this.a23,this.a00*c.x+this.a10*c.y+this.a20*c.z+this.a30,this.a01*c.x+this.a11*c.y+this.a21*
c.z+this.a31,this.a02*c.x+this.a12*c.y+this.a22*c.z+this.a32,this.a03*c.x+this.a13*c.y+this.a23*c.z+this.a33)};a.Matrix4x4.prototype.scale=function(c){return new a.Matrix4x4(this.a00*c.x,this.a01*c.x,this.a02*c.x,this.a03*c.x,this.a10*c.y,this.a11*c.y,this.a12*c.y,this.a13*c.y,this.a20*c.z,this.a21*c.z,this.a22*c.z,this.a23*c.z,this.a30,this.a31,this.a32,this.a33)};a.Matrix4x4.prototype.rotate=function(c,g){var h=Math.sqrt(g.x*g.x+g.y*g.y+g.z*g.z);if(!h)return null;1!==h&&(h=1/h,g.x*=h,g.y*=h,g.z*=
h);var d=Math.sin(c),f=Math.cos(c),l=1-f,h=this.a00,k=this.a01,e=this.a02,t=this.a03,m=this.a10,n=this.a11,s=this.a12,p=this.a13,u=this.a20,q=this.a21,r=this.a22,w=this.a23,v=g.x*g.x*l+f,z=g.y*g.x*l+g.z*d,A=g.z*g.x*l-g.y*d,B=g.x*g.y*l-g.z*d,x=g.y*g.y*l+f,D=g.z*g.y*l+g.x*d,E=g.x*g.z*l+g.y*d,d=g.y*g.z*l-g.x*d,f=g.z*g.z*l+f;return new a.Matrix4x4(h*v+m*z+u*A,k*v+n*z+q*A,e*v+s*z+r*A,t*v+p*z+w*A,h*B+m*x+u*D,k*B+n*x+q*D,e*B+s*x+r*D,t*B+p*x+w*D,h*E+m*d+u*f,k*E+n*d+q*f,e*E+s*d+r*f,t*E+p*d+w*f,this.a30,this.a31,
this.a32,this.a33)};a.Matrix4x4.prototype.rotateX=function(c){var g=Math.sin(c);c=Math.cos(c);var h=this.a10,d=this.a11,f=this.a12,l=this.a13,k=this.a20,e=this.a21,t=this.a22,m=this.a23;return new a.Matrix4x4(this.a00,this.a01,this.a02,this.a03,h*c+k*g,d*c+e*g,f*c+t*g,l*c+m*g,h*-g+k*c,d*-g+e*c,f*-g+t*c,l*-g+m*c,this.a30,this.a31,this.a32,this.a33)};a.Matrix4x4.prototype.rotateY=function(c){var g=Math.sin(c);c=Math.cos(c);var h=this.a00,d=this.a01,f=this.a02,l=this.a03,k=this.a20,e=this.a21,t=this.a22,
m=this.a23;return new a.Matrix4x4(h*c+k*-g,d*c+e*-g,f*c+t*-g,l*c+m*-g,this.a10,this.a11,this.a12,this.a13,h*g+k*c,d*g+e*c,f*g+t*c,l*g+m*c,this.a30,this.a31,this.a32,this.a33)};a.Matrix4x4.prototype.rotateZ=function(c){var g=Math.sin(c);c=Math.cos(c);var h=this.a00,d=this.a01,f=this.a02,l=this.a03,k=this.a10,e=this.a11,t=this.a12,m=this.a13;return new a.Matrix4x4(h*c+k*g,d*c+e*g,f*c+t*g,l*c+m*g,h*-g+k*c,d*-g+e*c,f*-g+t*c,l*-g+m*c,this.a20,this.a21,this.a22,this.a23,this.a30,this.a31,this.a32,this.a33)};
a.Matrix4x4.prototype.frustum=function(c,g,h,d,f,l){var k=g-c,e=d-h,t=l-f;return new a.Matrix4x4(2*f/k,0,0,0,0,2*f/e,0,0,(g+c)/k,(d+h)/e,-(l+f)/t,-1,0,0,-(2*l*f)/t,0)};a.Matrix4x4.prototype.perspective=function(a,g,h,d){a=h*Math.tan(a*Math.PI/360);g*=a;return this.frustum(-g,g,-a,a,h,d)};a.Matrix4x4.prototype.ortho=function(c,g,h,d,f,l){var k=g-c,e=d-h,t=l-f;return new a.Matrix4x4(2/k,0,0,0,0,2/e,0,0,0,0,-2/t,0,-(c+g)/k,-(d+h)/e,-(l+f)/t,1)};a.Matrix4x4.prototype.lookAt=function(c,g,h){if(c.x===g.x&&
c.y===g.y&&c.z===g.z)return(new a.Matrix4x4).setIdentity();var d=c.x-g.x,f=c.y-g.y;g=c.z-g.z;var l=1/Math.sqrt(d*d+f*f+g*g),d=d*l,f=f*l;g*=l;var k=h.y*g-h.z*f,e=h.z*d-h.x*g;h=h.x*f-h.y*d;(l=Math.sqrt(k*k+e*e+h*h))?(l=1/l,k*=l,e*=l,h*=l):h=e=k=0;var t=f*h-g*e,m=g*k-d*h,n=d*e-f*k;(l=Math.sqrt(t*t+m*m+n*n))?(l=1/l,t*=l,m*=l,n*=l):n=m=t=0;return new a.Matrix4x4(k,t,d,0,e,m,f,0,h,n,g,0,-(k*c.x+e*c.y+h*c.z),-(t*c.x+m*c.y+n*c.z),-(d*c.x+f*c.y+g*c.z),1)};a.Matrix4x4.prototype.fromRotationTranslation=function(c){var g=
2*this.x,h=2*this.y,d=2*this.z,f=this.x*g,l=this.x*h,k=this.x*d,e=this.y*h,t=this.y*d,m=this.z*d,g=this.w*g,h=this.w*h,d=this.w*d;return new a.Matrix4x4(1-(e+m),l+d,k-h,0,l-d,1-(f+m),t+g,0,k+h,t-g,1-(f+e),0,c.x,c.y,c.z,1)};a.Quaternion=function(a,g,h,d){this.x=a||0;this.y=g||0;this.z=h||0;this.w=d||0};a.Quaternion.prototype.clone=function(){return new a.Quaternion(this.x,this.y,this.z,this.w)};a.Quaternion.prototype.setIdentity=function(){this.z=this.y=this.x=0;this.w=1;return this};a.Quaternion.prototype.calculateW=
function(){return new a.Quaternion(this.x,this.y,this.z,-Math.sqrt(Math.abs(1-this.x*this.x-this.y*this.y-this.z*this.z)))};a.Quaternion.prototype.dot=function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w};a.Quaternion.prototype.inverse=function(){var c=this.dot(this),g=0;0!=c&&(g=1/c);return new a.Quaternion(-this.x*g,-this.y*g,-this.z*g,this.w*g)};a.Quaternion.prototype.conjugate=function(){return new a.Quaternion(-this.x,-this.y,-this.z,this.w)};a.Quaternion.prototype.length=function(){return Math.sqrt(this.x*
this.x+this.y*this.y+this.z*this.z+this.w*this.w)};a.Quaternion.prototype.normalize=function(c,g){var h=this.length();if(0===h)return new a.Quaternion;h=1/h;return new a.Quaternion(this.x*h,this.y*h,this.z*h,this.w*h)};a.Quaternion.prototype.add=function(c){return new a.Quaternion(this.x+c.x,this.y+c.y,this.z+c.z,this.w+c.w)};a.Quaternion.prototype.multiply=function(c){return new a.Quaternion(this.x*c.w+this.w*c.x+this.y*c.z-this.z*c.y,this.y*c.w+this.w*c.y+this.z*c.x-this.x*c.z,this.z*c.w+this.w*
c.z+this.x*c.y-this.y*c.x,this.w*c.w-this.x*c.x-this.y*c.y-this.z*c.z)};a.Quaternion.prototype.multiplyVector3=function(c){var g=this.w*c.x+this.y*c.z-this.z*c.y,h=this.w*c.y+this.z*c.x-this.x*c.z,d=this.w*c.z+this.x*c.y-this.y*c.x;c=-this.x*c.x-this.y*c.y-this.z*c.z;return new a.Vector3D(g*this.w+c*-this.x+h*-this.z-d*-this.y,h*this.w+c*-this.y+d*-this.x-g*-this.z,d*this.w+c*-this.z+g*-this.y-h*-this.x)};a.Quaternion.prototype.scale=function(c){return new a.Quaternion(this.x*c,this.y*c,this.z*c,
this.w*c)};a.Quaternion.prototype.toMatrix3x3=function(){var c=this.x+this.x,g=this.y+this.y,h=this.z+this.z,d=this.x*c,f=this.x*g,l=this.x*h,k=this.y*g,e=this.y*h,t=this.z*h,c=this.w*c,g=this.w*g,h=this.w*h;return new a.Matrix3x3(1-(k+t),f+h,l-g,f-h,1-(d+t),e+c,l+g,e-c,1-(d+k))};a.Quaternion.prototype.toMat4=function(){var c=this.x+this.x,g=this.y+this.y,h=this.z+this.z,d=this.x*c,f=this.x*g,l=this.x*h,k=this.y*g,e=this.y*h,t=this.z*h,c=this.w*c,g=this.w*g,h=this.w*h;return new a.Matrix4x4(1-(k+
t),f+h,l-g,0,f-h,1-(d+t),e+c,0,l+g,e-c,1-(d+k),0,0,0,0,1)};a.Quaternion.prototype.slerp=function(c,g){var h=this.x*c.x+this.y*c.y+this.z*c.z+this.w*c.w;if(1<=Math.abs(h))return new a.Quaternion(this.x,this.y,this.z,this.w);var d=Math.acos(h),f=Math.sqrt(1-h*h);if(0.0010>Math.abs(f))return new a.Quaternion(0.5*this.x+0.5*c.x,0.5*this.y+0.5*c.y,0.5*this.z+0.5*c.z,0.5*this.w+0.5*c.w);h=Math.sin((1-g)*d)/f;d=Math.sin(g*d)/f;return new a.Quaternion(this.x*h+c.x*d,this.y*h+c.y*d,this.z*h+c.z*d,this.w*h+
c.w*d)};a.Quaternion.prototype.fromRotationMatrix=function(c){var g=new a.Quaternion;fTrace=c.a00+c.a11+c.a22;var h;if(0<fTrace)h=Math.sqrt(fTrace+1),g.w=0.5*h,h=0.5/h,g.x=(c.a21-c.a12)*h,g.y=(c.a02-c.a20)*h,g.z=(c.a10-c.a01)*h;else{h=[1,2,0];var d=0;c=[c.a00,c.a01,c.a02,c.a10,c.a11,c.a12,c.a20,c.a21,c.a22];c[4]>c[0]&&(d=1);c[8]>c[3*d+d]&&(d=2);var f=h[d],l=h[f];h=Math.sqrt(c[3*d+d]-c[3*f+f]-c[3*l+l]+1);0==d?g.x=0.5*h:1==d?g.y=0.5*h:g.z=0.5*h;h=0.5/h;g.w=(c[3*l+f]-c[3*f+l])*h;0==f?g.x=(c[3*f+d]+c[3*
d+f])*h:1==f?g.y=(c[3*f+d]+c[3*d+f])*h:g.z=(c[3*f+d]+c[3*d+f])*h;0==f?g.x=(c[3*l+d]+c[3*d+l])*h:1==f?g.y=(c[3*l+d]+c[3*d+l])*h:g.z=(c[3*l+d]+c[3*d+l])*h}return g};a.Quaternion.prototype.setIdentity=function(){this.z=this.y=this.x=0;this.w=1;return this};a.Quaternion.prototype.fromAngleAxis=function(c,g){var h=0.5*c,d=Math.sin(h);return new a.Quaternion(Math.cos(h),d*g.x,d*g.y,d*g.z)};a.Quaternion.prototype.toAngleAxis=function(){var c=this.x*this.x+this.y*this.y+this.z*this.z,g=new a.Vector4D;0<c?
(g.w=2*Math.acos(this.w),c=a.RenderMath.inverseSqrt(c),g.x=this.x*c,g.y=this.y*c,g.z=this.z*c):(g.x=1,g.y=0,g.z=0,g.w=0);return g};a.Matrix4x4.prototype.toArray=function(){return[this.a00,this.a01,this.a02,this.a03,this.a10,this.a11,this.a12,this.a13,this.a20,this.a21,this.a22,this.a23,this.a30,this.a31,this.a32,this.a33]};return a}(descartesJS||{}),descartesJS=function(a){function c(a,c){for(var d in c)a[d]=c[d]}function g(a){c(a,this.style);a.beginPath();a.arc(this.transformedVertices[0].x,this.transformedVertices[0].y,
this.style.size,0,2*Math.PI);a.fill();a.stroke()}function h(a){c(a,this.style);a.beginPath();a.moveTo(this.transformedVertices[0].x,this.transformedVertices[0].y);for(var d=1,e=this.transformedVertices.length;d<e;d++)a.lineTo(this.transformedVertices[d].x,this.transformedVertices[d].y);a.closePath();"color"===this.style.model?(0<=this.direction?(a.fillStyle=this.style.backcolor,a.strokeStyle=this.style.backcolor):a.strokeStyle=this.style.fillStyle,a.fill(),a.lineWidth=1,a.stroke()):"light"===this.style.model||
"metal"===this.style.model?(0<this.direction?(a.fillStyle=this.style.backcolor,a.strokeStyle=this.style.backcolor):a.strokeStyle=this.style.fillStyle,a.fill(),a.lineWidth=1,a.stroke()):"wire"===this.style.model&&(a.lineWidth=1.25,a.strokeStyle=this.style.fillStyle,a.stroke());this.style.edges&&"wire"!==this.style.model&&(a.lineWidth=1,a.strokeStyle=this.style.strokeStyle,a.stroke())}function d(a){this.drawText(a,this.text,this.transformedVertices[0].x,this.transformedVertices[0].y+this.style.displace,
this.style.fillStyle,this.style.font,"left","alphabetic",this.style.decimals,this.style.fixed,!0)}function f(a){c(a,this.style);a.beginPath();a.moveTo(this.transformedVertices[0].x,this.transformedVertices[0].y);a.lineTo(this.transformedVertices[1].x,this.transformedVertices[1].y);a.stroke()}if(a.loadLib)return a;var l,k,e,t,m;a.Primitive3D=function(c,e,k,l,m){this.vertices=c;this.type=e;this.style=k;this.evaluator=l;this.text=m||"";this.light=a.Vector3D(1,1,1);this.transformedVertices=[];"vertex"===
e?this.draw=g:"face"===e?this.draw=h:"text"===e?this.draw=d:"edge"===e&&(this.draw=f);k.isText&&(this.computeDepth=function(a){this.transformedVertices=this.vertices;this.depth=a.perspectiveMatrix.multiplyVector4(this.vertices[0]).toVector3D().z})};a.Primitive3D.prototype.setVertices=function(a){this.vertices=a};a.Primitive3D.prototype.setStyle=function(a){this.style=a};a.Primitive3D.prototype.computeDepth=function(a){2<this.vertices.length&&(l=this.vertices[0].toVector3D().direction(this.vertices[1].toVector3D()),
k=this.vertices[0].toVector3D().direction(this.vertices[2].toVector3D()),this.normal=l.crossProduct(k),this.direction=this.normal.dotProduct(a.eye));this.depth=0;this.zMin=1E4;this.zMax=-1E4;for(var c=0,d=this.vertices.length;c<d;c++)this.transformedVertices[c]=a.perspectiveMatrix.multiplyVector4(this.vertices[c]).toVector3D(),this.depth+=this.transformedVertices[c].z,this.zMin=Math.min(this.zMin,this.transformedVertices[c].z),this.zMax=Math.max(this.zMax,this.transformedVertices[c].z),this.transformedVertices[c].x=
a.transformCoordinateX(this.transformedVertices[c].x),this.transformedVertices[c].y=a.transformCoordinateY(this.transformedVertices[c].y);this.depth/=d};a.Primitive3D.prototype.drawText=function(c,d,h,f,g,k,l,v,z,A,B){if("rtfNode"==d.type)c.fillStyle=g,c.strokeStyle=g,c.textBaseline="alphabetic",d.draw(c,h,f,z,A,l,B);else{"simpleText"===d.type&&(d=d.toString(z,A).split("\\n"));h+=k.match("Arial")?-2:k.match("Times")?-2:0;e=this.evaluator;c.fillStyle=a.getColor(e,g);c.font=k;c.textAlign=l;c.textBaseline=
v;t=1.2*this.fontSize||0;g=0;for(k=d.length;g<k;g++)m=d[g],this.border&&c.strokeText(m,h,f+t*g),c.fillText(m,h,f+t*g)}};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c,g,h,d,f,l,k,e,t,m=["x","y","z"];a.Graphic3D=function(c,d){this.parent=c;this.evaluator=c.evaluator;var h=this.parent.evaluator.parser;this.spaceID="E0";this.background=!1;this.type="";this.color=new a.Color("eeffaa");this.backcolor=new a.Color("6090a0");this.Nu=this.evaluator.parser.parse("7");this.Nv=
this.evaluator.parser.parse("7");this.drawif=h.parse("1");this.abs_coord=!1;this.family="";this.family_interval=h.parse("[0,1]");this.family_steps=h.parse("8");this.font="Monospaced,PLAIN,12";this.fixed=!0;this.text="";this.decimals=h.parse("2");this.inirot=h.parse("(0,0,0)");this.inipos=h.parse("(0,0,0)");this.endrot=h.parse("(0,0,0)");this.endpos=h.parse("(0,0,0)");this.model="color";for(var g in d)d.hasOwnProperty(g)&&(this[g]=d[g]);void 0==this.expresion&&"macro"!=this.type&&(this.expresion=h.parse("(0,0)"));
this.space=this.getSpace();this.canvas=this.background?this.space.backgroundCanvas:this.space.canvas;this.ctx=this.canvas.getContext("2d");this.font=a.convertFont(this.font);this.fontSize=(this.fontSize=this.font.match(/(\d+)px/))?parseInt(this.fontSize[1]):10;f=new a.Vector3D(1,0,0);l=new a.Vector3D(0,1,0);k=new a.Vector3D(0,0,1);e=new a.Vector3D(0,0,0)};a.Graphic3D.prototype.getSpace=function(){for(var a=this.parent.spaces,c,d=0,e=a.length;d<e;d++)if(c=a[d],c.id==this.spaceID)return c;return a[0]};
a.Graphic3D.prototype.getFamilyValues=function(){c=this.evaluator;g=c.evalExpression(this.family_interval);this.familyInf=g[0][0];this.familySup=g[0][1];this.fSteps=Math.round(c.evalExpression(this.family_steps));this.family_sep=0<this.fSteps?(this.familySup-this.familyInf)/this.fSteps:0};a.Graphic3D.prototype.buildFamilyPrimitives=function(){c=this.evaluator;this.getFamilyValues();h=c.getVariable(this.family);if(0<=this.fSteps)for(var a=0,d=this.fSteps;a<=d;a++)c.setVariable(this.family,this.familyInf+
a*this.family_sep),c.evalExpression(this.drawif)&&this.buildPrimitives();c.setVariable(this.family,h)};a.Graphic3D.prototype.update=function(){this.primitives=[];this.evaluator.evalExpression(this.drawif)&&(this.family?this.buildFamilyPrimitives():this.buildPrimitives())};a.Graphic3D.prototype.updateMVMatrix=function(c){this.mvMatrix=this.mvMatrix.setIdentity();c||(d=this.evaluator.evalExpression(this.inirot),this.mvMatrix=this.mvMatrix.rotate(a.degToRad(d[0][0]),f),this.mvMatrix=this.mvMatrix.rotate(a.degToRad(d[0][1]),
l),this.mvMatrix=this.mvMatrix.rotate(a.degToRad(d[0][2]),k));d=this.evaluator.evalExpression(this.inipos);e.set(d[0][0],d[0][1],d[0][2]);this.mvMatrix=this.mvMatrix.translate(e);c||(d=this.evaluator.evalExpression(this.endrot),this.mvMatrix=this.mvMatrix.rotate(a.degToRad(d[0][0]),f),this.mvMatrix=this.mvMatrix.rotate(a.degToRad(d[0][1]),l),this.mvMatrix=this.mvMatrix.rotate(a.degToRad(d[0][2]),k));d=this.evaluator.evalExpression(this.endpos);e.set(d[0][0],d[0][1],d[0][2]);this.mvMatrix=this.mvMatrix.translate(e)};
a.Graphic3D.prototype.findExpresion=function(a,c){t=m.indexOf(c);return(subexpresion=a.split(m[t]+"=")[1])?(subexpresion=subexpresion.split(m[(t+1)%3]+"=")[0],subexpresion=subexpresion.split(m[(t+2)%3]+"=")[0]):""};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c,g;a.Point3D=function(c,d){a.Graphic3D.call(this,c,d);this.mvMatrix=(new a.Matrix4x4).setIdentity()};a.extend(a.Point3D,a.Graphic3D);a.Point3D.prototype.buildPrimitives=function(){c=this.evaluator;this.updateMVMatrix(!0);
g=c.evalExpression(this.expresion);this.exprX=g[0][0];this.exprY=g[0][1];this.exprZ=g[0][2];this.primitives.push(new a.Primitive3D([this.mvMatrix.multiplyVector4(new a.Vector4D(this.exprX,this.exprY,this.exprZ,1))],"vertex",{fillStyle:this.backcolor.getColor(),strokeStyle:this.color.getColor(),lineCap:"round",lineJoin:"round",lineWidth:1,size:c.evalExpression(this.width)}));this.primitives.push(new a.Primitive3D([this.mvMatrix.multiplyVector4(new a.Vector4D(this.exprX,this.exprY,this.exprZ,1))],"text",
{fillStyle:this.color.getColor(),font:this.font,decimals:this.evaluator.evalExpression(this.decimals),fixed:this.fixed,displace:this.fontSize},this.evaluator,this.text))};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c,g,h,d,f,l;a.Segment3D=function(c,d){this.width=c.evaluator.parser.parse("1");a.Graphic3D.call(this,c,d);this.mvMatrix=(new a.Matrix4x4).setIdentity()};a.extend(a.Segment3D,a.Graphic3D);a.Segment3D.prototype.buildPrimitives=function(){evaluator=this.evaluator;
this.updateMVMatrix();expr=evaluator.evalExpression(this.expresion);c=expr[0][0];g=expr[0][1];h=expr[0][2];d=expr[1][0];f=expr[1][1];l=expr[1][2];this.primitives.push(new a.Primitive3D([this.mvMatrix.multiplyVector4(new a.Vector4D(c,g,h,1)),this.mvMatrix.multiplyVector4(new a.Vector4D(d,f,l,1))],"edge",{strokeStyle:this.color.getColor(),lineCap:"round",lineJoin:"round",lineWidth:this.evaluator.evalExpression(this.width)}))};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;
var c,g,h,d,f,l,k,e,t,m;a.Surface3D=function(c,d){this.parameter="t";this.parameter_interval=c.evaluator.parser.parse("[0,1]");this.parameter_steps=c.evaluator.parser.parse("8");a.Graphic3D.call(this,c,d);var e=this.evaluator.parser;this.mvMatrix=(new a.Matrix4x4).setIdentity();this.exprX=e.parse(this.findExpresion(this.expresion,"x"));this.exprY=e.parse(this.findExpresion(this.expresion,"y"));this.exprZ=e.parse(this.findExpresion(this.expresion,"z"));this.XcontainsY=this.exprX.contains("y");this.XcontainsZ=
this.exprX.contains("z");this.YcontainsX=this.exprY.contains("x");this.YcontainsZ=this.exprY.contains("z");this.ZcontainsX=this.exprZ.contains("x");this.ZcontainsY=this.exprZ.contains("y")};a.extend(a.Surface3D,a.Graphic3D);a.Surface3D.prototype.buildPrimitives=function(){c=this.evaluator;this.updateMVMatrix();g=c.getVariable("u");h=c.getVariable("v");c.setVariable("u",0);c.setVariable("v",0);d=c.evalExpression(this.Nu);f=c.evalExpression(this.Nv);t=[];for(var n=0;n<=d;n++){c.setVariable("u",n/d);
for(var s=0;s<=f;s++)c.setVariable("v",s/f),l=c.evalExpression(this.exprX),c.setVariable("x",l),k=c.evalExpression(this.exprY),c.setVariable("y",k),e=c.evalExpression(this.exprZ),c.setVariable("z",e),t.push(this.mvMatrix.multiplyVector4(new a.Vector4D(l,k,e,1)))}for(n=0;n<d;n++)for(s=0;s<f;s++)m=[],m.push(t[s+n*f+n]),m.push(t[s+1+n*f+n]),m.push(t[s+2+(n+1)*f+n]),m.push(t[s+1+(n+1)*f+n]),this.primitives.push(new a.Primitive3D(m,"face",{backcolor:this.backcolor.getColor(),fillStyle:this.color.getColor(),
strokeStyle:"#808080",lineCap:"round",lineJoin:"round",edges:this.edges,model:this.model}));c.setVariable("u",g);c.setVariable("v",h)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c,g,h,d,f,l;a.Polygon3D=function(c,d){this.width=c.evaluator.parser.parse("1");a.Graphic3D.call(this,c,d);this.mvMatrix=(new a.Matrix4x4).setIdentity()};a.extend(a.Polygon3D,a.Graphic3D);a.Polygon3D.prototype.buildPrimitives=function(){evaluator=this.evaluator;this.updateMVMatrix();expr=evaluator.evalExpression(this.expresion);
for(var k=0,e=expr.length-1;k<e;k++)c=expr[k][0],g=expr[k][1],h=expr[k][2],d=expr[k+1][0],f=expr[k+1][1],l=expr[k+1][2],this.primitives.push(new a.Primitive3D([this.mvMatrix.multiplyVector4(new a.Vector4D(c,g,h,1)),this.mvMatrix.multiplyVector4(new a.Vector4D(d,f,l,1))],"edge",{strokeStyle:this.color.getColor(),lineCap:"round",lineJoin:"round",lineWidth:this.evaluator.evalExpression(this.width)}))};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c,g;a.Curve3D=function(c,
d){this.width=c.evaluator.parser.parse("1");a.Graphic3D.call(this,c,d);var f=this.evaluator.parser;this.mvMatrix=(new a.Matrix4x4).setIdentity();this.exprX=f.parse(this.findExpresion(this.expresion,"x"));this.exprY=f.parse(this.findExpresion(this.expresion,"y"));this.exprZ=f.parse(this.findExpresion(this.expresion,"z"));this.XcontainsY=this.exprX.contains("y");this.XcontainsZ=this.exprX.contains("z");this.YcontainsX=this.exprY.contains("x");this.YcontainsZ=this.exprY.contains("z");this.ZcontainsX=
this.exprZ.contains("x");this.ZcontainsY=this.exprZ.contains("y")};a.extend(a.Curve3D,a.Graphic3D);a.Curve3D.prototype.buildPrimitives=function(){evaluator=this.evaluator;this.updateMVMatrix();tempParamU=evaluator.getVariable("u");evaluator.setVariable("u",0);g=evaluator.evalExpression(this.Nu);c=[];for(var h=0;h<=g;h++)evaluator.setVariable("u",h/g),xEval=evaluator.evalExpression(this.exprX),evaluator.setVariable("x",xEval),yEval=evaluator.evalExpression(this.exprY),evaluator.setVariable("y",yEval),
zEval=evaluator.evalExpression(this.exprZ),evaluator.setVariable("z",zEval),c.push(this.mvMatrix.multiplyVector4(new a.Vector4D(xEval,yEval,zEval,1)));for(var h=0,d=c.length-1;h<d;h++)this.primitives.push(new a.Primitive3D([c[h],c[h+1]],"edge",{strokeStyle:this.color.getColor(),lineCap:"round",lineJoin:"round",lineWidth:this.evaluator.evalExpression(this.width)}));evaluator.setVariable("u",tempParamU)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c,g,h,d,f,l,k,e,t;
a.Triangle3D=function(c,d){a.Graphic3D.call(this,c,d);this.mvMatrix=(new a.Matrix4x4).setIdentity()};a.extend(a.Triangle3D,a.Graphic3D);a.Triangle3D.prototype.buildPrimitives=function(){evaluator=this.evaluator;this.updateMVMatrix();expr=evaluator.evalExpression(this.expresion);c=expr[0][0];g=expr[0][1];h=expr[0][2];d=expr[1][0];f=expr[1][1];l=expr[1][2];k=expr[2][0];e=expr[2][1];t=expr[2][2];this.primitives.push(new a.Primitive3D([this.mvMatrix.multiplyVector4(new a.Vector4D(c,g,h,1)),this.mvMatrix.multiplyVector4(new a.Vector4D(d,
f,l,1)),this.mvMatrix.multiplyVector4(new a.Vector4D(k,e,t,1))],"face",{backcolor:this.color.getColor(),fillStyle:this.backcolor.getColor(),strokeStyle:"#808080",lineCap:"round",lineJoin:"round",edges:this.edges,model:this.model}))};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c;a.Face3D=function(c,h){a.Graphic3D.call(this,c,h);this.mvMatrix=(new a.Matrix4x4).setIdentity()};a.extend(a.Face3D,a.Graphic3D);a.Face3D.prototype.buildPrimitives=function(){evaluator=this.evaluator;
this.updateMVMatrix();expr=evaluator.evalExpression(this.expresion);c=[];for(var g=0,h=expr.length;g<h;g++)c.push(this.mvMatrix.multiplyVector4(new a.Vector4D(expr[g][0],expr[g][1],expr[g][2],1)));this.primitives.push(new a.Primitive3D(c,"face",{backcolor:this.color.getColor(),fillStyle:this.backcolor.getColor(),strokeStyle:"#808080",lineCap:"round",lineJoin:"round",edges:this.edges,model:this.model}))};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c,g,h,d,f;a.Polireg3D=
function(c,d){this.width=c.evaluator.parser.parse("2");this.length=c.evaluator.parser.parse("2");a.Graphic3D.call(this,c,d);this.mvMatrix=(new a.Matrix4x4).setIdentity()};a.extend(a.Polireg3D,a.Graphic3D);a.Polireg3D.prototype.buildPrimitives=function(){evaluator=this.evaluator;this.updateMVMatrix();c=evaluator.evalExpression(this.Nu);g=[this.mvMatrix.multiplyVector4(new a.Vector4D(0,0,0,1))];h=evaluator.evalExpression(this.width)/2;d=evaluator.evalExpression(this.length)/2;f=2*Math.PI/c;for(var l=
0;l<c;l++)g.push(this.mvMatrix.multiplyVector4(new a.Vector4D(h*Math.cos(f*l),d*Math.sin(f*l),0,1)));for(l=0;l<c;l++)this.primitives.push(new a.Primitive3D([g[0],g[l+1],l+2<=c?g[l+2]:g[1]],"face",{backcolor:this.color.getColor(),fillStyle:this.backcolor.getColor(),strokeStyle:"#808080",lineCap:"round",lineJoin:"round",edges:this.edges,model:this.model}))};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Text3D=function(c,g){a.Graphic3D.call(this,c,g)};a.extend(a.Text3D,a.Graphic3D);
a.Text3D.prototype.buildPrimitives=function(){evaluator=this.evaluator;expr=evaluator.evalExpression(this.expresion);this.exprX=expr[0][0];this.exprY=expr[0][1];this.exprZ=0;this.primitives.push(new a.Primitive3D([new a.Vector4D(this.exprX,this.exprY,this.exprZ,1)],"text",{fillStyle:this.color.getColor(),font:this.font,decimals:this.evaluator.evalExpression(this.decimals),fixed:this.fixed,displace:0,isText:!0},this.evaluator,this.text))};return a}(descartesJS||{}),descartesJS=function(a){function c(){k=
this.evaluator.evalExpression(this.width)/4;this.vertices=[new a.Vector4D(k,k,k,1),new a.Vector4D(k,-k,k,1),new a.Vector4D(k,k,-k,1),new a.Vector4D(k,-k,-k,1),new a.Vector4D(-k,k,k,1),new a.Vector4D(-k,-k,k,1),new a.Vector4D(-k,k,-k,1),new a.Vector4D(-k,-k,-k,1)];this.faces=[[0,1,3,2],[0,4,5,1],[4,6,7,5],[2,3,7,6],[0,2,6,4],[1,5,7,3]]}function g(){k=this.evaluator.evalExpression(this.width)/2;e=this.evaluator.evalExpression(this.height)/2;t=this.evaluator.evalExpression(this.length)/2;this.vertices=
[new a.Vector4D(k,t,e,1),new a.Vector4D(k,-t,e,1),new a.Vector4D(k,t,-e,1),new a.Vector4D(k,-t,-e,1),new a.Vector4D(-k,t,e,1),new a.Vector4D(-k,-t,e,1),new a.Vector4D(-k,t,-e,1),new a.Vector4D(-k,-t,-e,1)];this.faces=[[0,1,3,2],[0,4,5,1],[4,6,7,5],[2,3,7,6],[0,2,6,4],[1,5,7,3]]}function h(){k=l.evalExpression(this.width)/2;this.vertices=[new a.Vector4D(0,0,k,1),new a.Vector4D(-0.49*k,-0.86*k,-0.32*k,1),new a.Vector4D(-0.49*k,0.86*k,-0.32*k,1),new a.Vector4D(1*k,0,-0.32*k,1)];this.faces=[[1,2,3],[0,
2,1],[0,3,2],[0,1,3]]}function d(){k=l.evalExpression(this.width)/2;this.vertices=[new a.Vector4D(0,0,k,1),new a.Vector4D(k,0,0,1),new a.Vector4D(-k,0,0,1),new a.Vector4D(0,k,0,1),new a.Vector4D(0,-k,0,1),new a.Vector4D(0,0,-k,1)];this.faces=[[0,1,3],[0,3,2],[0,4,1],[0,2,4],[5,3,1],[5,2,3],[5,1,4],[5,4,2]]}function f(){function c(a){return parseInt(a)}function d(a){return parseFloat(a)}this.vertices=[];this.faces=[];for(var e=0,h=this.fileData.length;e<h;e++)p=this.fileData[e],p.match(/^V\(/)?(u=
p.substring(2,p.length-1).split(",").map(d),this.vertices.push(new a.Vector4D(u[0]||0,u[1]||0,u[2]||0,1))):p.match(/^F\(/)&&(u=p.substring(2,p.length-1).split(",").map(c),this.faces.push(u))}if(a.loadLib)return a;var l,k,e,t,m,n,s;a.OtherGeometry=function(e,k){this.width=e.evaluator.parser.parse("2");this.height=e.evaluator.parser.parse("2");this.length=e.evaluator.parser.parse("2");a.Graphic3D.call(this,e,k);this.mvMatrix=(new a.Matrix4x4).setIdentity();switch(this.type){case "cube":this.buildGeometry=
c;break;case "box":this.buildGeometry=g;break;case "tetrahedron":this.buildGeometry=h;break;case "octahedron":this.buildGeometry=d;break;case "mesh":this.fileData=a.openExternalFile(this.evaluator.evalExpression(this.file)).split(/\r/),this.buildGeometry=f}};a.extend(a.OtherGeometry,a.Graphic3D);a.OtherGeometry.prototype.buildPrimitives=function(){l=this.evaluator;this.updateMVMatrix();this.buildGeometry();m=this.color.getColor();n=this.backcolor.getColor();for(var c=0,d=this.faces.length;c<d;c++){s=
[];for(var e=0,h=this.faces[c].length;e<h;e++)s.push(this.mvMatrix.multiplyVector4(this.vertices[this.faces[c][e]]));this.primitives.push(new a.Primitive3D(s,"face",{backcolor:m,fillStyle:n,strokeStyle:"#808080",lineCap:"round",lineJoin:"round",edges:this.edges,model:this.model}))}};var p,u;return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c=Math.max,g=Math.min,h=Math.PI,d=Math.cos,f=Math.sin,l=Math.abs,k,e,t,m,n,s,p,u,q,r,w,v,z,A,B,x,D,E;a.R2=function(a,c){this.x=a||0;
this.y=c||0};a.R2.prototype.set=function(a,c){this.x=a||0;this.y=c||0};a.R2.prototype.copy=function(){return new a.R2(this.x,this.y)};a.R2.prototype.ix=function(){return Math.round(c(g(this.x,32E3),-32E3))};a.R2.prototype.iy=function(){return Math.round(c(g(this.y,32E3),-32E3))};a.R2.prototype.equals=function(a){return this.x==a.x&&this.y==a.y};a.R2.prototype.norm2=function(){return this.x*this.x+this.y*this.y};a.R2.prototype.norm=function(){return Math.sqrt(this.norm2())};a.R2.prototype.distance=
function(a){e=this.copy();e.sub(a);return e.norm()};a.R2.prototype.dot=function(a){return this.x*a.x+this.y*a.y};a.R2.prototype.det=function(a){return this.x*a.y-this.y*a.x};a.R2.prototype.mul=function(a){this.x*=a;this.y*=a};a.R2.prototype.div=function(a){this.x/=a;this.y/=a};a.R2.prototype.add=function(a){this.x+=a.x;this.y+=a.y};a.R2.prototype.sub=function(a){this.x-=a.x;this.y-=a.y};a.R2.prototype.normalize=function(){k=this.norm();0!=k&&this.div(k)};a.R2.prototype.rotR90=function(){k=this.x;
this.x=this.y;this.y=-k};a.R2.prototype.rotL90=function(){k=this.x;this.x=-this.y;this.y=k};a.R2.prototype.rot=function(a){t=this.copy();s=d(a);p=f(a);this.x=t.x*s-t.y*p;this.y=t.x*p+t.y*s};a.R2.prototype.rot=function(a){this.rot(a*h/180)};a.R2.prototype.intersection=function(d,e,h,f){u=e.x-d.x;q=h.x-f.x;r=h.x-d.x;w=e.y-d.y;v=h.y-f.y;z=h.y-d.y;E=u*v-q*w;return 1E-6<l(E)?(m=(r*v-z*q)/E,n=(-r*w+z*u)/E,0<=m&&1>=m&&0<=n&&1>=n?new a.R2(d.x+u*m,d.y+w*m):null):(e.x-h.x)*z!=(e.y-h.y)*r?null:d.x!=e.x?(A=g(d.x,
e.x),B=c(d.x,e.x),A<=h.x&&h.x<=B?h:A<=f.x&&f.x<=B?f:null):h.x!=f.x?(x=g(h.x,f.x),D=c(h.x,f.x),x<=d.x&&d.x<=D?d:x<=e.x&&e.x<=D?e:null):d.y!=e.y?(A=g(d.y,e.y),B=c(d.y,e.y),A<=h.y&&h.y<=B?h:A<=f.y&&f.y<=B?f:null):h.y!=f.y?(x=g(h.y,f.y),D=c(h.y,f.y),x<=d.y&&d.y<=D?d:x<=e.y&&e.y<=D?e:null):d.x==h.x&&d.y==h.y?d:null};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c,g,h,d,f,l,k,e;a.R2Newton=function(c,d){this.evaluator=c;this.constraint=d;if("=="==this.constraint.value||"<"==
this.constraint.value||"<="==this.constraint.value||">"==this.constraint.value||">="==this.constraint.value)this.sign="<"==this.constraint.value||"<="==this.constraint.value?"menor":">"==this.constraint.value||">="==this.constraint.value?"mayor":"igual",this.constraint=this.constraint.equalToMinus(),this.constraint=this.constraint.childs[0];l=new a.R2(0,0)};a.R2Newton.prototype.getUnitNormal=function(){this.normal.normalize();return this.normal.copy()};a.R2Newton.prototype.gradient=function(a){c=
this.evaluator;k=c.getVariable("x");e=c.getVariable("y");c.setVariable("x",a.x);c.setVariable("y",a.y);this.f0=c.evalExpression(this.constraint);c.setVariable("x",c.getVariable("x")+1E-12);g=c.evalExpression(this.constraint);l.x=(g-this.f0)/1E-12;l.x=!isNaN(l.x)?l.x:Infinity;c.setVariable("x",c.getVariable("x")-1E-12);c.setVariable("y",c.getVariable("y")+1E-12);g=c.evalExpression(this.constraint);l.y=(g-this.f0)/1E-12;l.y=!isNaN(l.y)?l.y:Infinity;c.setVariable("x",k);c.setVariable("y",e);return l};
a.R2Newton.prototype.findZero=function(a){c=this.evaluator;f=a.copy();k=c.getVariable("x");e=c.getVariable("y");c.setVariable("x",a.x);c.setVariable("y",a.y);this.f0=c.evalExpression(this.constraint);if("menor"===this.sign&&0>=this.f0||"mayor"===this.sign&&0<=this.f0)return f;c.setVariable("x",k);c.setVariable("y",e);for(var g=0;256>g;g++)if(h=f.x,d=f.y,this.normal=this.gradient(f),0!=this.normal.norm2()&&this.normal.mul(-this.f0/this.normal.norm2()),f.x=h+this.normal.x,f.y=d+this.normal.y,1E-6>this.normal.norm()){0===
this.normal.x&&0===this.normal.y&&(this.normal.x=f.x-a.x,this.normal.y=f.y-a.y);break}return f};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Vector2D=function(a,g){this.x=a;this.y=g};a.Vector2D.AXIS_X=new a.Vector2D(1,0);a.Vector2D.AXIS_Y=new a.Vector2D(0,1);a.Vector2D.prototype.vectorLength=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};a.Vector2D.prototype.dotProduct=function(a){return this.x*a.x+this.y*a.y};a.Vector2D.prototype.angleBetweenVectors=function(a){return Math.acos(this.dotProduct(a)/
(this.vectorLength()*a.vectorLength()))};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c=Math.floor,g=Math.round,h,d,f,l,k,e,t,m,n,s,p,u,q,r,w,v,z,A,B,x;a.Control=function(c,d){this.parent=c;this.evaluator=c.evaluator;var e=this.parser=c.evaluator.parser;this.id="graphic"!==d.type?"C":"G";this.gui=this.type="";this.region="south";this.y=this.x=0;this.w="video"!==d.type?100:350;this.h="video"!==d.type?23:120;"graphic"!==d.type?"text"!==d.type?this.expresion=e.parse("(0,0,100,23)"):
(this.expresion=e.parse("(0,0,300,200)"),this.w=300,this.h=200):this.expresion=e.parse("(0,0)");this.fixed=2!=this.parent.version?!1:!0;this.visible=!0;this.color=4>this.parent.version?new a.Color("000000"):new a.Color("222222");this.colorInt="graphic"!==d.type?new a.Color("f0f8ff"):new a.Color("ff0000");this.underlined=this.italics=this.bold="";this.font_size=4>this.parent.version?-1:e.parse("12");this.parameter=this.action="";this.parameterFont="Monospace 12px";this.drawif=e.parse("1");this.activeif=
e.parse("1");this.tooltip="";this.tooltipFont="Monospace 12px";this.Explanation="";this.ExplanationFont="Monospace 12px";this.cID=this.msg_pos="";this.valueExpr=e.parse("0");this.decimals=e.parse("2");this.min=e.parse("-Infinity");this.max=e.parse("Infinity");this.incr=e.parse("0.1");this.exponentialif=this.discrete=!1;this.zIndex=-1;for(var h in d)d.hasOwnProperty(h)&&(this[h]=d[h]);if(("video"===this.type||"audio"===this.type)&&"interior"!==this.region)this.region="interior";void 0==this.name&&
(this.name=2==this.parent.version?this.id:"_nada_");this.name="_._"==this.name||"_nada_"==this.name||"_void_"==this.name?"":this.name;e=this.evaluator.evalExpression(this.expresion);this.x=g(e[0][0]);this.y=g(e[0][1]);4==e[0].length&&(this.w=g(e[0][2]),this.h=g(e[0][3]));this.actionExec=c.lessonParser.parseAction(this)};a.Control.prototype.init=function(){};a.Control.prototype.update=function(){};a.Control.prototype.draw=function(){};a.Control.prototype.getContainer=function(){var a=this.parent.spaces,
c;if("interior"===this.region)for(var d=0,e=a.length;d<e;d++){if(c=a[d],c.id===this.spaceID)return c.addCtr(this),this.zIndex=c.zIndex,c.numericalControlContainer}else{if("external"===this.region)return this.parent.externalSpace.container;if("scenario"===this.region)return this.cID?(this.expresion=this.evaluator.parser.parse("(0,-1000,"+this.w+","+this.h+")"),this.parent.scenarioRegion.scenarioSpace.addCtr(this),this.zIndex=this.parent.scenarioRegion.scenarioSpace.zIndex,this.parent.scenarioRegion.scenarioSpace.numericalControlContainer):
this.parent.externalSpace.container;if("north"===this.region)return this.parent.northSpace.controls.push(this),this.parent.northSpace.container;if("south"===this.region)return this.parent.southSpace.controls.push(this),this.parent.southSpace.container;if("east"===this.region)return this.parent.eastSpace.controls.push(this),this.parent.eastSpace.container;if("west"===this.region)return this.parent.westSpace.controls.push(this),this.parent.westSpace.container;if("special"===this.region)return this.parent.specialSpace.controls.push(this),
this.parent.specialSpace.container}a[0].addCtr(this);this.zIndex=a[0].zIndex;return a[0].numericalControlContainer};a.Control.prototype.addControlContainer=function(a){var c=this.getContainer();c.childNodes[0]?c.insertBefore(a,c.childNodes[0]):c.appendChild(a);c.childNodes[0]?c.insertBefore(a,c.childNodes[0]):c.appendChild(a)};a.Control.prototype.updatePositionAndSize=function(){f=l=k=e=!1;t=this.evaluator.evalExpression(this.expresion);m=g(t[0][0]);f=g(this.x)!==m;this.x=m;m=g(t[0][1]);l=g(this.y)!==
m;this.y=m;4===t[0].length&&(m=g(t[0][2]),k=g(this.w)!==m,this.w=m,m=g(t[0][3]),e=g(this.h)!==m,this.h=m);if(k||e||f||l)this.init(),this.draw()};a.Control.prototype.formatOutputValue=function(a){q=this.parent;n=a+"";s=this.evaluator.evalExpression(this.decimals);p=n.indexOf(".");-1!=p&&(u=n.substring(p+1),u.length>s&&(n=parseFloat(n).toFixed(s)));if(this.fixed&&(2!==q.version||2===q.version&&!this.exponentialif))n=parseFloat(a).toFixed(s);this.exponentialif&&0!=parseFloat(n)&&(n=this.fixed&&2!==q.version?
parseFloat(n).toExponential(s):parseFloat(n).toExponential(),n=n.toUpperCase(),n=n.replace("+",""));return n=n.replace(".",q.decimal_symbol)};a.Control.prototype.updateAndExecAction=function(){this.parent.updateControls();"init"===this.action&&(this.click=!1);this.actionExec.execute();"animate"!==this.action&&this.parent.update()};a.Control.prototype.createGradient=function(a,e){this.linearGradient=this.ctx.createLinearGradient(0,0,0,e);h=e*e;for(var f=0;f<e;f++)d=c(f-35*e/100),this.linearGradient.addColorStop(f/
e,"rgba(0,0,0,"+192*d*d/h/255+")")};a.Control.prototype.getScreenshot=function(){v=this;r=document.createElement("canvas");r.setAttribute("width",v.w);r.setAttribute("height",v.h);w=r.getContext("2d");w.font=v.fieldFontSize+"px Arial, Helvetica, 'Droid Sans', Sans-serif";v.canvas&&(z=v.canvas.offsetLeft,A=v.canvas.offsetTop,w.drawImage(v.canvas,z,A));v.label&&(z=v.label.offsetLeft,A=v.label.offsetTop,B=v.label.offsetWidth,x=v.label.offsetHeight,w.fillStyle="#e0e4e8",w.fillRect(z,A,B,x),w.fillStyle=
"black",w.textAlign="center",w.textBaseline="middle",w.fillText(v.name,z+B/2,A+x/2));v.field&&(z=v.field.offsetLeft,A=v.field.offsetTop,B=v.field.offsetWidth,x=v.field.offsetHeight,w.fillStyle="white",w.strokeStyle="#666666",w.lineWidth=1,w.fillRect(z,0,B,x),w.strokeRect(z+0.5,0.5,B-1,x-1),w.fillStyle="black",w.textAlign="center",w.textAlign="left",w.fillText(v.field.value,z+2,x/2));v.select&&(z=v.select.offsetLeft,A=v.select.offsetTop,B=v.select.offsetWidth,x=v.select.offsetHeight,w.fillStyle="#e0e4e8",
w.strokeStyle="#666666",w.lineWidth=1,w.fillRect(z,0,B,x),w.strokeRect(z+0.5,0.5,B,x-1),w.fillStyle="black",w.textAlign="center",w.textAlign="left",w.fillText(v.select.value,z+2,x/2),w.fillStyle="#c0c0c0",w.fillRect(z+B-15+0.5,0.5,15,x-1),w.strokeRect(z+B-15+0.5,0.5,15,x-1),w.fillStyle="black",w.beginPath(),w.moveTo(z+B-15+4.5,x/2-2.5),w.lineTo(z+B-15+8,x/2+2.5),w.lineTo(z+B-15+11.5,x/2-2.5),w.closePath(),w.fill());return r};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;
var c=Math.floor,g,h,d,f,l,k,e,t,m,n,s,p,u=900;a.Button=function(c,d){this.imageSrc="";this.image=new Image;this.imageOver=new Image;this.imageDown=new Image;a.Control.call(this,c,d);-1===this.font_size&&(this.fontSizeNotSet=!0);"["===this.name.charAt(0)&&"]"===this.name.charAt(this.name.length-1)?this.name=this.parser.parse(this.name.substring(1,this.name.length-1)):this.name=this.parser.parse("'"+this.name+"'");var e;this.imageSrc.match("_COLORES_")&&(e=this.imageSrc.split("_"),this.colorInt=new a.Color(e[2]),
this.color=new a.Color(e[3]),this.font_size=this.parser.parse(e[5]),this.imageSrc="");this.imageSrc=this.parser.parse("'"+this.imageSrc+"'");e=this.evaluator.evalExpression(this.imageSrc).trim();if(""!=e){var h=e.substr(0,e.lastIndexOf(".")),f=e.substr(e.lastIndexOf("."));e.toLowerCase().match(/vacio.gif$/)?(this.image.ready=1,3===this.parent.version&&(this.name=this.parser.parse("")),this.emptyImage={ready:!0},this.parser.parse("'vacio.gif'")):(this.image=this.parent.getImage(e),this.imageOver=this.parent.getImage(h+
"_over"+f),this.imageDown=this.parent.getImage(h+"_down"+f))}this.canvas=document.createElement("canvas");this.canvas.setAttribute("class","DescartesButton");this.canvas.setAttribute("id",this.id);this.canvas.setAttribute("width",this.w+"px");this.canvas.setAttribute("height",this.h+"px");this.canvas.setAttribute("style","left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";");this.ctx=this.canvas.getContext("2d");this.ctx.imageSmoothingEnabled=!1;this.ctx.mozImageSmoothingEnabled=!1;this.ctx.webkitImageSmoothingEnabled=
!1;this.addControlContainer(this.canvas);this.registerMouseAndTouchEvents();this.init()};a.extend(a.Button,a.Control);a.Button.prototype.init=function(){g=this.evaluator;h=this.canvas;f=g.evalExpression(this.expresion);this.x=f[0][0];this.y=f[0][1];4==f[0].length&&(this.w=parseInt(f[0][2]),this.h=parseInt(f[0][3]));h.setAttribute("width",this.w+"px");h.setAttribute("height",this.h+"px");h.setAttribute("style","left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+"; display: block;");this.fontSizeNotSet&&
(this.font_size=g.parser.parse(a.getFieldFontSize(this.h)+""));this.createGradient(this.w,this.h);this.update()};a.Button.prototype.update=function(){g=this.evaluator;h=this.canvas;this.activeIfValue=0<g.evalExpression(this.activeif);(this.drawIfValue=0<g.evalExpression(this.drawif))?(h.style.display="block",this.draw()):(this.click=!1,h.style.display="none");this.updatePositionAndSize()};a.Button.prototype.draw=function(){g=this.evaluator;d=this.ctx;l=g.evalExpression(this.font_size);k=g.evalExpression(this.name);
e=g.evalExpression(this.imageSrc);t="vacio.gif"===e?this.emptyImage:this.parent.getImage(e);d.clearRect(0,0,this.w,this.h);n=m=0;this.click&&(n=m=1);t&&t.ready?t!==this.emptyImage&&t.complete&&d.drawImage(t,parseInt((this.w-t.width)/2)+m,parseInt((this.h-t.height)/2)+n):(d.fillStyle=this.colorInt.getColor(),d.fillRect(0,0,this.w,this.h),this.click||(a.drawLine(d,this.w-1,0,this.w-1,this.h,"rgba(0,0,0,"+128/255+")"),a.drawLine(d,0,0,0,this.h,"rgba(0,0,0,"+24/255+")"),a.drawLine(d,1,0,1,this.h,"rgba(0,0,0,"+
8/255+")")),d.fillStyle=this.linearGradient,d.fillRect(0,0,this.w,this.h));""!=this.imageOver.src&&(this.imageOver.ready&&this.over)&&d.drawImage(this.imageOver,parseInt((this.w-t.width)/2)+m,parseInt((this.h-t.height)/2)+n);""!=this.imageDown.src&&this.imageDown.ready&&this.click?d.drawImage(this.imageDown,parseInt((this.w-t.width)/2)+m,parseInt((this.h-t.height)/2)+n):this.click&&(a.drawLine(d,0,0,0,this.h-2,"gray"),a.drawLine(d,0,0,this.w-1,0,"gray"),d.fillStyle="rgba(0, 0, 0,"+24/255+")",d.fillRect(0,
0,this.w,this.h));d.fillStyle=this.color.getColor();d.font=this.italics+" "+this.bold+" "+l+"px Arial";d.textAlign="center";d.textBaseline="middle";this.colorInt!=this.color&&(d.lineJoin="round",d.lineWidth=parseInt(l/6),d.strokeStyle=this.colorInt.getColor(),d.strokeText(k,c(this.w/2+m)+0.5,c(this.h/2+n)+0.5));d.fillText(k,c(this.w/2+m)+0.5,c(this.h/2+n)+0.5);this.underlined&&(s=d.measureText(k).width,d.strokeStyle=this.color.getColor(),d.lineWidth=c(l/10)||2,d.lineCap="round",d.beginPath(),d.moveTo(parseInt((this.w-
s)/2)+m,c((this.h+l)/2)+c(l/5)-1.5+n),d.lineTo(parseInt((this.w+s)/2)+m,c((this.h+l)/2)+c(l/5)-1.5+n),d.stroke());this.activeIfValue||(d.fillStyle="rgba(240,240,240,"+160/255+")",d.fillRect(0,0,this.w,this.h))};a.Button.prototype.bottonPressed=function(){this.updateAndExecAction()};a.Button.prototype.registerMouseAndTouchEvents=function(){function c(a,d,e){clearInterval(k);g.click&&(d.call(g),a=e?a:30,k=setTimeout(function(){c(a,d)},a))}function d(h){h.preventDefault();g.whichButton=a.whichButton(h);
"L"==g.whichButton&&g.activeIfValue&&(g.click=!0,g.draw(),g.evaluator.setVariable(g.id,g.evaluator.evalExpression(g.valueExpr)),"calculate"==g.action&&c(u,g.bottonPressed,!0),p?window.addEventListener("touchend",e):window.addEventListener("mouseup",e))}function e(a){if(g.activeIfValue||g.click)g.click=!1,g.draw(),"calculate"!=g.action&&g.bottonPressed(),a.preventDefault(),p?window.removeEventListener("touchend",e,!1):window.removeEventListener("mouseup",e,!1)}function h(a){g.over=!0;g.draw()}function f(a){g.over=
!1;g.click=!1;g.draw()}p=a.hasTouchSupport;var g=this,k;g.canvas.oncontextmenu=function(){return!1};this.over=this.click=!1;p?this.canvas.addEventListener("touchstart",d):(this.canvas.addEventListener("mousedown",d),this.canvas.addEventListener("mouseover",h),this.canvas.addEventListener("mouseout",f))};a.Button.prototype.getScreenshot=function(){return this.canvas};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c,g,h,d,f,l,k,e,t,m,n,s,p,u,q,r,w;a.Spinner=function(c,
d){a.Control.call(this,c,d);this.tabindex=++this.parent.tabindex;this.containerControl=document.createElement("div");this.canvas=document.createElement("canvas");this.divUp=document.createElement("div");this.divDown=document.createElement("div");this.field=document.createElement("input");this.label=document.createElement("label");this.txtLabel=document.createTextNode(this.name);this.label.appendChild(this.txtLabel);""!=this.name.trim()&&this.containerControl.appendChild(this.label);this.containerControl.appendChild(this.field);
this.containerControl.appendChild(this.canvas);this.containerControl.appendChild(this.divUp);this.containerControl.appendChild(this.divDown);this.addControlContainer(this.containerControl);this.originalIncr=this.incr;if(0>=this.evaluator.evalExpression(this.decimals)){var e=this.evaluator.evalExpression(this.incr);0<e?this.originalIncr=this.incr=this.evaluator.parser.parse(parseInt(e).toString()):this.incr=this.evaluator.parser.parse("1")}this.registerMouseAndTouchEvents();this.init()};a.extend(a.Spinner,
a.Control);a.Spinner.prototype.init=function(){c=this.evaluator;this.value=this.validateValue(c.evalExpression(this.valueExpr));var d=this.formatOutputValue(this.value);this.fieldFontSize=2!==this.parent.version?a.getFieldFontSize(this.h):10;var e=2!==this.parent.version?"":"_____",h=a.getTextWidth(d+"_",this.fieldFontSize+"px Arial"),g=2+parseInt(this.h/2),f=parseInt(this.w/2-g/2),e=a.getTextWidth(this.name+e,this.fieldFontSize+"px Arial");this.visible||(f=this.w-g,h=0);f<e&&(f=e);""==this.name&&
(f=0);this.w-f-g<h&&(f=this.w-g-h);0>f&&(f=0);e=this.w-(f+g);this.containerControl.setAttribute("class","DescartesSpinnerContainer");this.containerControl.setAttribute("style","width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";");this.canvas.setAttribute("width",g+"px");this.canvas.setAttribute("height",this.h+"px");this.canvas.setAttribute("style","position: absolute; left: "+f+"px; top: 0px;");this.ctx=this.canvas.getContext("2d");this.divUp.setAttribute("style",
"background-color: rgba(255, 255, 255, 0); cursor: pointer; position: absolute; width : "+g+"px; height : "+this.h/2+"px; left: "+f+"px; top: 0px;");this.divDown.setAttribute("style","background-color: rgba(255, 255, 255, 0); cursor: pointer; position: absolute; width : "+g+"px; height : "+this.h/2+"px; left: "+f+"px; top: "+this.h/2+"px;");this.field.setAttribute("type","text");this.field.setAttribute("id",this.id+"_spinner");this.field.setAttribute("class","DescartesSpinnerField");this.field.setAttribute("style",
"font-family: Arial; font-size: "+this.fieldFontSize+"px; width : "+(e-2)+"px; height : "+(this.h-2)+"px; left: "+(g+f)+"px;");this.field.setAttribute("tabindex",this.tabindex);this.field.value=d;this.label.setAttribute("class","DescartesSpinnerLabel");this.label.setAttribute("style","font-size:"+this.fieldFontSize+"px; width: "+f+"px; height: "+this.h+"px; line-height: "+this.h+"px;");c.setVariable(this.id,this.value);this.createGradient(this.h/2,this.h);this.update()};a.Spinner.prototype.update=
function(){c=this.evaluator;0>=c.evalExpression(this.decimals)?(g=c.evalExpression(this.incr),0<g?this.originalIncr=this.incr=c.parser.parse(parseInt(g).toString()):this.incr=c.parser.parse("1")):this.incr=this.originalIncr;this.activeIfValue=0<c.evalExpression(this.activeif);this.drawIfValue=0<c.evalExpression(this.drawif);this.field.disabled=!this.activeIfValue;this.drawIfValue?(this.containerControl.style.display="block",this.draw()):(this.click=!1,this.containerControl.style.display="none");this.updatePositionAndSize();
h=this.field.value;d=this.value;this.value=this.validateValue(c.getVariable(this.id));this.field.value=this.formatOutputValue(this.value);this.value==d&&this.field.value!=h&&(this.value=this.validateValue(h),this.field.value=this.formatOutputValue(this.value));c.setVariable(this.id,this.value)};a.Spinner.prototype.draw=function(){f=this.ctx;l=this.canvas.width;k=this.canvas.height;f.fillStyle="#f0f8ff";f.fillRect(0,0,l,k);f.fillStyle=this.linearGradient;f.fillRect(0,0,l,k);this.up?(e="gray",t="#f0f8ff"):
(e="#f0f8ff",t="gray");a.drawLine(f,0,0,l,0,e);a.drawLine(f,0,0,0,k/2,e);a.drawLine(f,0,k/2,l,k/2,t);this.down?(e="gray",t="#f0f8ff"):(e="#f0f8ff",t="gray");a.drawLine(f,0,k/2+1,l,k/2+1,e);a.drawLine(f,0,k/2+1,0,k,e);a.drawLine(f,0,k-1,l,k-1,t);m=[parseInt(l/2+1),parseInt(l/5+1),parseInt(l-l/5+1)];n=[parseInt(k/8+1),parseInt(k/8+1+k/4),parseInt(k/8+1+k/4)];f.fillStyle=this.activeIfValue?"#2244cc":"#8888aa";f.beginPath();f.moveTo(m[0],n[0]);f.lineTo(m[1],n[1]);f.lineTo(m[2],n[2]);f.fill();n=[parseInt(k-
k/8),parseInt(k-k/8-k/4),parseInt(k-k/8-k/4)];f.fillStyle=this.activeIfValue?"#d00018":"#aa8888";f.beginPath();f.moveTo(m[0],n[0]);f.lineTo(m[1],n[1]);f.lineTo(m[2],n[2]);f.fill();f.fillStyle="rgba(0,0,0,"+24/255+")";this.up&&f.fillRect(0,0,l,k/2);this.down&&f.fillRect(0,k/2,l,k)};a.Spinner.prototype.validateValue=function(a){c=this.evaluator;a=isNaN(parseFloat(a))?a.toString():parseFloat(a).toFixed(20);s=parseFloat(c.evalExpression(c.parser.parse(a.replace(this.parent.decimal_symbol,"."))));isNaN(s)&&
(s=0);q=c.evalExpression(this.min);""==q&&(q=-Math.Infinity);r=c.evalExpression(this.max);""==r&&(r=Math.Infinity);s<q&&(s=q);s>r&&(s=r);this.discrete&&(p=c.evalExpression(this.incr),s=0==p?0:p*Math.round(s/p));u=c.evalExpression(this.decimals);0>=u&&(u=0);return s=parseFloat(parseFloat(s).toFixed(u))};a.Spinner.prototype.increase=function(){this.changeValue(parseFloat(this.value)+this.evaluator.evalExpression(this.incr))};a.Spinner.prototype.decrease=function(){this.changeValue(parseFloat(this.value)-
this.evaluator.evalExpression(this.incr))};a.Spinner.prototype.changeValue=function(a){this.activeIfValue&&(this.value=this.validateValue(a),this.field.value=this.formatOutputValue(this.value),this.evaluator.setVariable(this.id,this.value),this.updateAndExecAction())};a.Spinner.prototype.registerMouseAndTouchEvents=function(){function c(a,d,e){clearInterval(n);if(l.up||l.down)d.call(l),a=e?a:30,n=setTimeout(function(){c(a,d)},a)}function d(e){e.preventDefault();l.whichButton=a.whichButton(e);"L"==
l.whichButton&&l.activeIfValue&&(l.up=!0,c(m,l.increase,!0),l.draw())}function e(d){d.preventDefault();l.whichButton=a.whichButton(d);"L"==l.whichButton&&l.activeIfValue&&(l.down=!0,c(m,l.decrease,!0),l.draw())}function h(a){l.up=!1;clearInterval(n);l.draw();a.preventDefault()}function f(a){l.down=!1;clearInterval(n);l.draw();a.preventDefault()}function g(a){l.up=!1;clearInterval(n);l.draw();a.preventDefault()}function k(a){l.down=!1;clearInterval(n);l.draw();a.preventDefault()}w=a.hasTouchSupport;
var l=this,m=w?500:200,n;l.divUp.oncontextmenu=l.divDown.oncontextmenu=l.field.oncontextmenu=l.label.oncontextmenu=function(){return!1};w?this.label.addEventListener("touchstart",function(a){a.preventDefault();return!1}):this.label.addEventListener("mousedown",function(a){a.preventDefault();return!1});this.field.addEventListener("keydown",function(a){13==a.keyCode&&l.changeValue(l.field.value)});w?this.divUp.addEventListener("touchstart",d):this.divUp.addEventListener("mousedown",d);w?this.divDown.addEventListener("touchstart",
e):this.divDown.addEventListener("mousedown",e);w||this.divUp.addEventListener("mouseout",h);w||this.divDown.addEventListener("mouseout",f);w?(this.divUp.addEventListener("touchend",g),window.addEventListener("touchend",g)):(this.divUp.addEventListener("mouseup",g),window.addEventListener("mouseup",g));w?(this.divDown.addEventListener("touchend",k),window.addEventListener("touchend",k)):(this.divDown.addEventListener("mouseup",k),window.addEventListener("mouseup",k))};return a}(descartesJS||{}),descartesJS=
function(a){if(a.loadLib)return a;var c,g,h,d,f,l,k;a.TextField=function(c,d){a.Control.call(this,c,d);void 0===this.valueExprString&&(this.valueExprString="");this.emptyString=!1;this.ok=0;this.tabindex=++this.parent.tabindex;if(this.answer)if(this.answer.match("krypto_")&&(this.answer=(new a.Krypto).decode(this.answer.substring(7))),this.answerPattern=this.answer,this.answer=a.buildRegularExpresionsPatterns(this.answer,this.evaluator),this.onlyText){var h=this.answerPattern.indexOf("|");this.firstAnswer=
-1==h?this.answerPattern:this.answerPattern.substring(0,h)}else this.firstAnswer=this.parser.parse(this.answerPattern.substring(1,this.answerPattern.indexOf(",")));if(this.onlyText){if(!this.valueExprString.match(/^'/)||!this.valueExprString.match(/^'/))this.valueExpr=this.evaluator.parser.parse("'"+this.valueExprString+"'");this.validateValue=function(a){return"''"==a||"'"==a?"":a};this.formatOutputValue=function(a){return a.toString()}}""==this.name.trim()&&(this.name="");this.containerControl=
document.createElement("div");this.field=document.createElement("input");this.label=document.createElement("label");this.txtLabel=document.createTextNode(this.name);this.label.appendChild(this.txtLabel);this.containerControl.appendChild(this.label);this.containerControl.appendChild(this.field);this.addControlContainer(this.containerControl);this.registerMouseAndTouchEvents();this.init()};a.extend(a.TextField,a.Control);a.TextField.prototype.init=function(){c=this.evaluator;this.value=this.validateValue(c.evalExpression(this.valueExpr));
var d=this.formatOutputValue(this.value);this.fieldFontSize=a.getFieldFontSize(this.h);var h=a.getTextWidth(d+"_",this.fieldFontSize+"px Arial"),f=parseInt(this.w/2),g=a.getTextWidth(this.name,this.fieldFontSize+"px Arial");f<g&&(f=g);""==this.name&&(f=0);this.w-f<h&&(f=this.w-h);0>f&&(f=0);h=this.w-f;this.containerControl.setAttribute("class","DescartesTextFieldContainer");this.containerControl.setAttribute("style","width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+
this.zIndex+";");this.field.setAttribute("type","text");this.field.setAttribute("id",this.id+"TextField");this.field.setAttribute("class","DescartesTextFieldField");this.field.setAttribute("style","font-size: "+this.fieldFontSize+"px; width : "+(h-2)+"px; height : "+(this.h-2)+"px; left: "+f+"px;");this.field.setAttribute("tabindex",this.tabindex);this.field.value=d;this.label.setAttribute("class","DescartesTextFieldLabel");this.label.setAttribute("style","font-size:"+this.fieldFontSize+"px; width: "+
f+"px; height: "+this.h+"px; line-height: "+this.h+"px;");this.evaluate&&(this.ok=this.evaluateAnswer());this.evaluator.setVariable(this.id,this.value);this.evaluator.setVariable(this.id+".ok",this.ok);this.oldValue=this.value;this.update()};a.TextField.prototype.update=function(){c=this.evaluator;this.activeIfValue=0<c.evalExpression(this.activeif);this.drawIfValue=0<c.evalExpression(this.drawif);this.field.disabled=!this.activeIfValue;this.containerControl.style.display=this.drawIfValue?"block":
"none";this.updatePositionAndSize();g=this.field.value;h=this.value;this.value=this.validateValue(c.getVariable(this.id));this.field.value=this.formatOutputValue(this.value);this.value===h&&this.field.value!=g&&(this.value=this.validateValue(g),this.field.value=this.formatOutputValue(this.value));c.setVariable(this.id,this.value)};a.TextField.prototype.validateValue=function(a){if(""===a||"''"==a)return"";c=this.evaluator;d=parseFloat(c.evalExpression(c.parser.parse(a.toString().replace(this.parent.decimal_symbol,
"."))));isNaN(d)&&(d=0);f=c.evalExpression(this.min);""==f&&(f=-Math.Infinity);l=c.evalExpression(this.max);""==l&&(l=Math.Infinity);this.discrete&&(a=c.evalExpression(this.incr),d=0==a?0:a*Math.round(d/a));return d=parseFloat(parseFloat(d).toFixed(c.evalExpression(this.decimals)))};a.TextField.prototype.formatOutputValue=function(a){return""===a?"":this.uber.formatOutputValue.call(this,a)};a.TextField.prototype.changeValue=function(a,c){this.activeIfValue&&(this.value=this.validateValue(a),this.field.value=
this.formatOutputValue(this.value),this.evaluate&&(this.ok=this.evaluateAnswer()),this.evaluator.setVariable(this.id,this.value),this.evaluator.setVariable(this.id+".ok",this.ok),this.updateAndExecAction())};a.TextField.prototype.evaluateAnswer=function(){return a.esCorrecto(this.answer,this.value,this.evaluator,this.answer)};a.TextField.prototype.getFirstAnswer=function(){return this.answer?this.onlyText?this.firstAnswer:this.evaluator.evalExpression(this.firstAnswer):""};a.TextField.prototype.registerMouseAndTouchEvents=
function(){k=a.hasTouchSupport;var c=this;c.label.oncontextmenu=function(){return!1};k?c.label.addEventListener("touchstart",function(a){a.preventDefault();return!1}):c.label.addEventListener("mousedown",function(a){a.preventDefault();return!1});this.field.addEventListener("blur",function(a){c.update()});this.field.addEventListener("keydown",function(a){c.activeIfValue&&13==a.keyCode&&c.changeValue(c.field.value,!0)})};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c=
Math.abs,g,h,d,f;a.Menu=function(c,d){this.options="";a.Control.call(this,c,d);var h=this.parser;this.options=this.options.split(",");this.menuOptions=[];this.strValue=[];for(var f,g=0,l=this.options.length;g<l;g++)f=this.options[g].split(/[\[\]]/,2),1==f.length?(this.menuOptions.push(f[0]),this.strValue.push(g.toString())):2==f.length&&(this.menuOptions.push(f[0]),""==f[1]?this.strValue.push(g.toString()):this.strValue.push(f[1]));g=0;for(l=this.strValue.length;g<l;g++)this.strValue[g]=h.parse(this.strValue[g]);
this.containerControl=document.createElement("div");this.label=document.createElement("label");this.txtLabel=document.createTextNode(this.name);this.label.appendChild(this.txtLabel);this.select=document.createElement("select");g=0;for(l=this.menuOptions.length;g<l;g++)h=document.createElement("option"),h.innerHTML=this.menuOptions[g],this.select.appendChild(h);this.field=document.createElement("input");this.containerControl.appendChild(this.label);this.containerControl.appendChild(this.select);this.visible&&
this.containerControl.appendChild(this.field);this.addControlContainer(this.containerControl);this.registerMouseAndTouchEvents();this.init()};a.extend(a.Menu,a.Control);var l;a.Menu.prototype.init=function(){l=this.evaluator;this.fieldFontSize=2!=this.parent.version?a.getFieldFontSize(this.h):10;var c=0,d=0,h=0;this.value=l.evalExpression(this.valueExpr);this.indexValue=this.getIndex(this.value);for(var f=0,g=this.menuOptions.length;f<g;f++)h=a.getTextWidth(this.menuOptions[f],this.fieldFontSize+
"px Arial"),h>c&&(c=h,d=f);c+=25;h=a.getTextWidth(this.formatOutputValue(l.evalExpression(this.strValue[d])),this.fieldFontSize+"px Arial")+7;d=a.getTextWidth(this.name,this.fieldFontSize+"px Arial")+10;""==this.name&&(d=0);this.visible||(h=0);for(f=this.w-h-d;f<c&&0<d;)d--,f++;for(;f<c&&0<h;)h--,f++;for(;d+f+h+1<this.w;)f++,h++;var c=d,g=c+f,h=this.w-g,s=this.formatOutputValue(l.evalExpression(this.strValue[this.indexValue]));this.containerControl.setAttribute("class","DescartesSpinnerContainer");
this.containerControl.setAttribute("style","width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";");this.label.setAttribute("class","DescartesMenuLabel");this.label.setAttribute("style","font-size:"+this.fieldFontSize+"px; width: "+d+"px; height: "+this.h+"px; line-height: "+this.h+"px;");this.field.setAttribute("type","text");this.field.setAttribute("id",this.id+"menu");this.field.value=s;this.field.setAttribute("class","DescartesMenuField");
this.field.setAttribute("style","font-size: "+this.fieldFontSize+"px; width : "+(h-2)+"px; height : "+(this.h-2)+"px; left: "+g+"px;");this.select.setAttribute("id",this.id+"menuSelect");this.select.setAttribute("class","DescartesMenuSelect");this.select.setAttribute("style","text-align: left; font-size: "+this.fieldFontSize+"px; width : "+f+"px; height : "+this.h+"px; left: "+c+"px; border-color: #7a8a99; border-width: 1.5px; border-style: solid; background-color: #eeeeee;");this.select.selectedIndex=
this.indexValue;l.setVariable(this.id,parseFloat(s));this.update()};a.Menu.prototype.update=function(){l=this.evaluator;this.activeIfValue=0<l.evalExpression(this.activeif);this.drawIfValue=0<l.evalExpression(this.drawif);this.field.disabled=this.activeIfValue?!1:!0;this.select.disabled=this.activeIfValue?!1:!0;this.drawIfValue?this.containerControl.style.display="block":(this.click=!1,this.containerControl.style.display="none");this.updatePositionAndSize();this.value=l.getVariable(this.id);this.field.value=
this.formatOutputValue(this.value);l.setVariable(this.id,parseFloat(this.value));this.select.selectedIndex=parseFloat(this.getIndex(this.value))};a.Menu.prototype.getIndex=function(a){a=parseFloat(a.toString().replace(this.parent.decimal_symbol,"."));g=-1;h=Infinity;for(var e=0,f=this.strValue.length;e<f;e++)d=c(a-parseFloat(this.evaluator.evalExpression(this.strValue[e]))),d<=h&&(h=d,g=e);return g};a.Menu.prototype.changeValue=function(){this.activeIfValue&&(this.evaluator.setVariable(this.id,this.value),
this.updateAndExecAction())};a.Menu.prototype.registerMouseAndTouchEvents=function(){f=a.hasTouchSupport;var c=this;c.select.oncontextmenu=c.label.oncontextmenu=c.field.oncontextmenu=function(){return!1};f?c.label.addEventListener("touchstart",function(a){a.preventDefault();return!1}):c.label.addEventListener("mousedown",function(a){a.preventDefault();return!1});this.select.addEventListener("change",function(a){c.value=c.evaluator.evalExpression(c.strValue[this.selectedIndex]);c.field.value=c.formatOutputValue(c.value);
c.evaluator.setVariable(c.id,c.field.value);c.changeValue();a.preventDefault()});this.field.addEventListener("keydown",function(a){13==a.keyCode&&(c.indexValue=c.getIndex(c.field.value),c.value=c.evaluator.evalExpression(c.strValue[c.indexValue]),c.field.value=c.formatOutputValue(c.indexValue),c.select.selectedIndex=c.indexValue,c.changeValue())})};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c=Math.floor,g="h",h,d,f,l,k,e,t,m,n,s,p,u,q,r,w,v,z,A,B,x,D;a.Scrollbar=
function(c,d){a.Control.call(this,c,d);this.orientation=this.w>=this.h?g:"v";this.containerControl=document.createElement("div");this.canvas=document.createElement("canvas");this.divUp=document.createElement("div");this.divDown=document.createElement("div");this.field=document.createElement("input");this.scrollManipulator=document.createElement("div");this.label=document.createElement("label");this.txtLabel=document.createTextNode(this.name);this.label.appendChild(this.txtLabel);this.containerControl.appendChild(this.canvas);
this.containerControl.appendChild(this.label);this.containerControl.appendChild(this.divUp);this.containerControl.appendChild(this.divDown);this.containerControl.appendChild(this.field);this.containerControl.appendChild(this.scrollManipulator);this.addControlContainer(this.containerControl);this.registerMouseAndTouchEvents();this.init()};a.extend(a.Scrollbar,a.Control);a.Scrollbar.prototype.init=function(){h=this.evaluator;this.findOffset();0==h.evalExpression(this.decimals)?this.incr=1:this.incr=
(h.evalExpression(this.max)-h.evalExpression(this.min))/100;this.value=this.validateValue(h.evalExpression(this.valueExpr));f=this.formatOutputValue(this.value);l=this.evaluator.evalExpression(this.expresion);this.x=l[0][0];this.y=l[0][1];4==l[0].length&&(this.w=l[0][2],this.h=l[0][3]);this.orientation=this.w>=this.h?g:"v";this.initScroll(f);this.changeScrollPositionFromValue();this.prePos=this.pos;h.setVariable(this.id,this.value)};a.Scrollbar.prototype.initScroll=function(c){d=this;h=d.evaluator;
var e="v"===d.orientation?parseInt(19+5*(d.h-100)/100):d.h;d.fieldFontSize="v"===d.orientation?e-parseInt(d.h/20)-1:2!==d.parent.version?a.getFieldFontSize(e):10;var f=a.getTextWidth(c+"_",d.fieldFontSize+"px Arial"),g=d.parent.getSpaceById(d.spaceID).h;d.labelHeight=""==d.name?0:e;d.fieldHeight=""==d.visible?0:e;if("v"===d.orientation)d.canvasWidth=d.w,d.canvasHeight=d.h-d.labelHeight-d.fieldHeight,18<=d.canvasHeight+d.y-g&&(d.canvasHeight=g),f=0,f=d.fieldHeight,e=f+d.canvasHeight,d.canvasX=0,d.canvasY=
d.fieldHeight,d.labelWidth=d.w,d.labelY=e,d.upWidth=d.downW=d.w,d.upHeight=d.downH=15,d.upX=0,d.upY=d.fieldHeight,d.downX=0,d.downY=e-d.downH,d.fieldWidth=d.w,d.fieldX=0,d.scrollManipulatorW=d.w,d.scrollManipulatorH=parseInt((d.canvasHeight-d.upHeight-d.downH-d.labelHeight-d.fieldHeight)/10),d.scrollManipulatorH=15>d.scrollManipulatorH?15:d.scrollManipulatorH,d.scrollManipulatorLimInf=e-d.downH-d.scrollManipulatorH,d.scrollManipulatorLimSup=f+d.downH;else{e=a.getTextWidth(d.name,d.fieldFontSize+"px Arial")+
10;d.labelWidth=e;d.fieldWidth=f;""==d.name&&(d.labelWidth=0);d.visible||(d.fieldWidth=0);for(e=d.w-d.fieldWidth-d.labelWidth;58>e&&0<d.labelWidth;)d.labelWidth--,e++;for(;58>e&&0<d.fieldWidth;)d.fieldWidth--,e++;f=d.labelWidth;g=f+e;d.fieldWidth=d.w-g;d.canvasWidth=e;d.canvasHeight=d.h;d.canvasX=d.labelWidth;d.canvasY=0;d.fieldX=d.canvasWidth+d.labelWidth;d.labelHeight=d.h;d.labelY=0;d.upWidth=d.downW=15;d.upHeight=d.downH=d.h;d.upX=g-d.downW;d.upY=0;d.downX=d.labelWidth;d.downY=0;d.scrollManipulatorW=
parseInt((d.canvasWidth-d.upWidth-d.downW)/10);d.scrollManipulatorW=15>d.scrollManipulatorW?15:d.scrollManipulatorW;d.scrollManipulatorH=d.h;d.scrollManipulatorLimInf=f+d.downW;d.scrollManipulatorLimSup=f+d.canvasWidth-d.downW-d.scrollManipulatorW}d.containerControl.setAttribute("class","DescartesScrollbarContainer");d.containerControl.setAttribute("style","width: "+d.w+"px; height: "+d.h+"px; left: "+d.x+"px; top: "+d.y+"px; z-index: "+d.zIndex+";");d.canvas.setAttribute("width",d.w+"px");d.canvas.setAttribute("height",
d.h+"px");d.canvas.setAttribute("style","position: absolute; left: 0px; top: 0px;");d.ctx=d.canvas.getContext("2d");d.divUp.setAttribute("class","DescartesCatcher");d.divUp.setAttribute("style","width : "+d.upWidth+"px; height : "+d.upHeight+"px; left: "+d.upX+"px; top: "+d.upY+"px;");d.divDown.setAttribute("class","DescartesCatcher");d.divDown.setAttribute("style","width : "+d.downW+"px; height : "+d.downH+"px; left: "+d.downX+"px; top: "+d.downY+"px;");d.scrollManipulator.setAttribute("class","DescartesCatcher");
d.scrollManipulator.setAttribute("style","width : "+d.scrollManipulatorW+"px; height : "+d.scrollManipulatorH+"px;");d.scrollManipulator.style.top=("v"===d.orientation?d.scrollManipulatorLimInf:0)+"px";d.scrollManipulator.style.left=("v"===d.orientation?0:d.scrollManipulatorLimInf)+"px";d.field.setAttribute("type","text");d.field.setAttribute("id",d.id+"scrollbar");d.field.setAttribute("class","DescartesScrollbarField");d.field.setAttribute("style","font-size: "+d.fieldFontSize+"px; width : "+(d.fieldWidth-
2)+"px; height : "+(d.fieldHeight-2)+"px; left: "+d.fieldX+"px; top: 0px;");d.field.value=c;0===d.fieldHeight&&(d.field.style.display="none");d.label.setAttribute("class","DescartesScrollbarLabel");d.label.setAttribute("style","font-size:"+d.fieldFontSize+"px; width: "+d.labelWidth+"px; height: "+d.labelHeight+"px; line-height: "+d.labelHeight+"px; left: 0px; top:"+d.labelY+"px;");d.txtLabel=document.createTextNode(d.name);this.update()};a.Scrollbar.prototype.update=function(){h=this.evaluator;0==
h.evalExpression(this.decimals)?this.incr=1:this.incr=(h.evalExpression(this.max)-h.evalExpression(this.min))/100;this.activeIfValue=0<h.evalExpression(this.activeif);this.drawIfValue=0<h.evalExpression(this.drawif);this.field.disabled=!this.activeIfValue;this.drawIfValue?(this.containerControl.style.display="block",this.draw()):this.containerControl.style.display="none";this.updatePositionAndSize();this.value=this.validateValue(h.getVariable(this.id));this.field.value=this.formatOutputValue(this.value);
h.setVariable(this.id,this.value)};a.Scrollbar.prototype.draw=function(){d=this;k=d.ctx;t=c(this.w);e=c(this.h);k.fillStyle="#e0e4e8";k.fillRect(0,0,t,e);k.strokeStyle="#7a8a99";d.down&&(k.fillStyle="#ccdcec",k.fillRect(d.downX+0.5,d.downY+0.5,d.downW,d.downH-1));k.strokeRect(d.downX+0.5,d.downY+0.5,d.downW,d.downH-1);d.up&&(k.fillStyle="#ccdcec",k.fillRect(d.upX+0.5,d.upY-0.5,d.upWidth,d.upHeight+1));k.strokeRect(d.upX+0.5,d.upY-0.5,d.upWidth,d.upHeight+1);m=4;k.fillStyle="black";k.beginPath();d.orientation===
g?(k.moveTo(d.downX+m,d.downH/2),k.lineTo(d.downX+d.downW-m,m),k.lineTo(d.downX+d.downW-m,d.downH-m),k.moveTo(d.upX+d.upWidth-m,d.downH/2),k.lineTo(d.upX+m,m),k.lineTo(d.upX+m,d.downH-m),k.fill(),d.activeIfValue&&(n=c(d.pos),k.fillStyle="#ccdcec",k.fillRect(n+0.5,0,c(d.scrollManipulatorW),e),k.strokeStyle="#6382bf",k.strokeRect(n+0.5,0,c(d.scrollManipulatorW),e),s=c(d.scrollManipulatorW/2),k.beginPath(),k.moveTo(n+s+0.5-2,3),k.lineTo(n+s+0.5-2,e-3),k.moveTo(n+s+0.5,3),k.lineTo(n+s+0.5,e-3),k.moveTo(n+
s+0.5+2,3),k.lineTo(n+s+0.5+2,e-3),k.stroke())):(k.moveTo(d.downX+d.downW/2,d.downY+d.downH-m),k.lineTo(d.downX+m,d.downY+m),k.lineTo(d.downX+d.downW-m,d.downY+m),k.moveTo(d.upX+d.upWidth/2,d.upY+m),k.lineTo(d.upX+m,d.upY+d.upHeight-m),k.lineTo(d.upX+d.upWidth-m,d.upY+d.upHeight-m),k.fill(),d.activeIfValue&&(n=c(d.pos),k.fillStyle="#ccdcec",k.fillRect(0,n+0.5,t,c(d.scrollManipulatorH)),k.strokeStyle="#6382bf",k.strokeRect(0,n+0.5,t,c(d.scrollManipulatorH)),s=c(d.scrollManipulatorH/2),k.beginPath(),
k.moveTo(3,n+s+0.5-2),k.lineTo(t-3,n+s+0.5-2),k.moveTo(3,n+s+0.5),k.lineTo(t-3,n+s+0.5),k.moveTo(3,n+s+0.5+2),k.lineTo(t-3,n+s+0.5+2),k.stroke()));k.strokeRect(0.5,0.5,t-1,e-1);d.activeIfValue||(k.fillStyle="rgba(240,240,240,"+160/255+")",k.fillRect(0,0,t,e.h))};a.Scrollbar.prototype.validateValue=function(a){h=this.evaluator;p=a.toString();p=parseFloat(p.replace(this.parent.decimal_symbol,"."));isNaN(p)&&(p=0);this.minimo=h.evalExpression(this.min);p<this.minimo&&(this.value=null,p=this.minimo);
this.maximo=h.evalExpression(this.max);p>this.maximo&&(this.value=null,p=this.maximo);u=this.incr;p=0!=u?p*u/u:0;this.fixed&&(p=parseFloat(parseFloat(p).toFixed(h.evalExpression(this.decimals))));return p};a.Scrollbar.prototype.increase=function(){this.changeValue(parseFloat(this.value)+this.incr)};a.Scrollbar.prototype.decrease=function(){this.changeValue(parseFloat(this.value)-this.incr)};a.Scrollbar.prototype.increase10=function(){m=(this.evaluator.evalExpression(this.max)-this.evaluator.evalExpression(this.min))/
10;this.orientation==g?this.clickPos.x>this.prePos&&this.changeValue(parseFloat(this.value)+m):this.clickPos.y<this.prePos&&this.changeValue(parseFloat(this.value)+m)};a.Scrollbar.prototype.decrease10=function(){m=(this.evaluator.evalExpression(this.max)-this.evaluator.evalExpression(this.min))/10;this.orientation==g?this.clickPos.x<this.prePos&&this.changeValue(parseFloat(this.value)-m):this.clickPos.y>this.prePos&&this.changeValue(parseFloat(this.value)-m)};a.Scrollbar.prototype.changeValue=function(a){this.activeIfValue&&
(q=this.validateValue(a),q!=this.value&&(this.value=q,this.field.value=this.formatOutputValue(q),this.changeScrollPositionFromValue(),this.prePos=this.pos,this.evaluator.setVariable(this.id,this.value),this.updateAndExecAction()))};a.Scrollbar.prototype.changeValueForScrollMovement=function(){h=this.evaluator;r=this.scrollManipulatorLimInf;w=this.scrollManipulatorLimSup;v=h.evalExpression(this.min);z=h.evalExpression(this.max);u=this.incr;q=c((this.pos-r)*(z-v)/(w-r)/u)*u+v;q!=this.value&&(this.value=
q,this.field.value=this.formatOutputValue(q),h.setVariable(this.id,this.value),this.parent.updateControls(),this.actionExec.execute(),this.parent.update())};a.Scrollbar.prototype.changeScrollPositionFromValue=function(){h=this.evaluator;r=this.scrollManipulatorLimInf;w=this.scrollManipulatorLimSup;v=h.evalExpression(this.min);z=h.evalExpression(this.max);u=this.incr;this.pos=(this.value-v)*(w-r)/(z-v)+r;this.orientation==g?this.scrollManipulator.style.left=this.pos+"px":this.scrollManipulator.style.top=
this.pos+"px"};a.Scrollbar.prototype.registerMouseAndTouchEvents=function(){function c(a,d,e,h){clearInterval(z);if((r.up||r.down||r.canvasClick)&&1E-7<Math.abs(r.value-h))d.call(r),a=e?a:30,z=setTimeout(function(){c(a,d,!1,h)},a)}function d(e){e.preventDefault();r.whichButton=a.whichButton(e);"L"==r.whichButton&&r.activeIfValue&&(r.clickPos=r.getCursorPosition(e),r.canvasClick=!0,r.orientation==g?r.clickPos.x<r.prePos?c(v,r.decrease10,!0,r.minimo):c(v,r.increase10,!0,r.maximo):r.clickPos.y<r.prePos?
c(v,r.increase10,!0,r.maximo):c(v,r.decrease10,!0,r.minimo))}function e(a){r.canvasClick=!1;clearInterval(z);a.preventDefault()}function h(a){!0==r.canvasClick&&(r.clickPos=r.getCursorPosition(a),a.preventDefault())}function f(a){r.activeIfValue&&(r.scrollClick=!0,r.initPos=r.getCursorPosition(a),window.addEventListener("mouseup",l),window.addEventListener("mousemove",n),a.preventDefault())}function k(a){r.activeIfValue&&(r.scrollClick=!0,r.initPos=r.getCursorPosition(a),window.addEventListener("touchend",
m),window.addEventListener("touchmove",onToucheMove_scrollManipulator),a.preventDefault())}function l(a){r.scrollClick=!1;r.prePos=r.pos;window.removeEventListener("mouseup",l,!1);window.removeEventListener("mousemove",n,!1);a.preventDefault()}function m(a){r.scrollClick=!1;r.prePos=r.pos;window.removeEventListener("touchend",m,!1);window.removeEventListener("touchmove",n,!1);a.preventDefault()}function n(a){var c=r.getCursorPosition(a);r.orientation==g?(r.pos=r.prePos-(r.initPos.x-c.x),r.pos<r.scrollManipulatorLimInf&&
(r.pos=r.scrollManipulatorLimInf),r.pos>r.scrollManipulatorLimSup&&(r.pos=r.scrollManipulatorLimSup),r.scrollManipulator.setAttribute("style","background-color: rgba(255, 255, 255, 0); cursor: pointer; position: absolute; width : "+r.scrollManipulatorW+"px; height : "+r.h+"px; left: "+r.pos+"px; top: 0px;")):(r.pos=r.prePos-(r.initPos.y-c.y),r.pos>r.scrollManipulatorLimInf&&(r.pos=r.scrollManipulatorLimInf),r.pos<r.scrollManipulatorLimSup&&(r.pos=r.scrollManipulatorLimSup),r.scrollManipulator.setAttribute("style",
"background-color: rgba(255, 255, 255, 0); cursor: pointer; position: absolute; width : "+r.w+"px; height : "+r.scrollManipulatorH+"px; left: 0px; top: "+r.pos+"px;"));r.changeValueForScrollMovement();a.preventDefault()}function p(d){d.preventDefault();r.whichButton=a.whichButton(d);"L"==r.whichButton&&r.activeIfValue&&(r.up=!0,c(v,r.increase,!0,r.maximo))}function s(d){d.preventDefault();r.whichButton=a.whichButton(d);"L"==r.whichButton&&r.activeIfValue&&(r.down=!0,c(v,r.decrease,!0,r.minimo))}function q(a){r.up=
!1;clearInterval(z);a.preventDefault()}function t(a){r.down=!1;clearInterval(z);a.preventDefault()}function w(a){r.up=!1;clearInterval(z);a.preventDefault();r.draw()}function u(a){r.down=!1;clearInterval(z);a.preventDefault();r.draw()}A=a.hasTouchSupport;var r=this,v=A?500:200,z;r.canvas.oncontextmenu=r.divUp.oncontextmenu=r.divDown.oncontextmenu=r.label.oncontextmenu=r.field.oncontextmenu=r.scrollManipulator.oncontextmenu=function(){return!1};this.field.addEventListener("keydown",function(a){13==
a.keyCode&&r.changeValue(r.field.value)});A?this.canvas.addEventListener("touchstart",d):this.canvas.addEventListener("mousedown",d);A||this.divDown.addEventListener("mouseout",t);A?window.addEventListener("touchend",e):window.addEventListener("mouseup",e);A?this.canvas.addEventListener("touchmove",h):this.canvas.addEventListener("mousemove",h);A?this.scrollManipulator.addEventListener("touchstart",k):this.scrollManipulator.addEventListener("mousedown",f);A?this.divUp.addEventListener("touchstart",
p):this.divUp.addEventListener("mousedown",p);A?this.divDown.addEventListener("touchstart",s):this.divDown.addEventListener("mousedown",s);A||this.divUp.addEventListener("mouseout",q);A||this.divDown.addEventListener("mouseout",t);A?window.addEventListener("touchend",w):window.addEventListener("mouseup",w);A?window.addEventListener("touchend",u):window.addEventListener("mouseup",u)};a.Scrollbar.prototype.findOffset=function(){B=this.containerControl;this.offsetTop=this.offsetLeft=0;x=this.containerControl.style.display;
for(this.containerControl.style.display="block";B;)this.offsetLeft+=B.offsetLeft||0,this.offsetTop+=B.offsetTop||0,B=B.parentNode;this.containerControl.style.display=x};a.Scrollbar.prototype.getCursorPosition=function(c){D=a.getCursorPosition(c);return{x:D.x-this.offsetLeft,y:D.y-this.offsetTop}};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c;a.Audio=function(c,h){this.controls=!0;this.file="";a.Control.call(this,c,h);var d=this.evaluator.evalExpression(this.expresion);
4==d[0].length?(this.w=d[0][2],this.h=d[0][3]):(this.w=100,this.h=28);this.audio=this.parent.getAudio(this.file);this.autoplay&&(this.audio.setAttribute("autoplay","autoplay"),this.audio.play());this.loop&&this.audio.setAttribute("loop","loop");this.controls&&this.audio.setAttribute("controls","controls");this.audio.setAttribute("style","position: absolute; width: "+this.w+"px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";");this.addControlContainer(this.audio)};a.extend(a.Audio,
a.Control);a.Audio.prototype.init=function(){this.audio.style.left=this.x+"px";this.audio.style.top=this.y+"px";this.update()};a.Audio.prototype.update=function(){c=this.evaluator;0<c.evalExpression(this.drawif)?this.audio.style.display="block":(this.audio.style.display="none",this.audio.pause());this.updatePositionAndSize()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c;a.Video=function(c,h){this.controls=!0;this.file="";a.Control.call(this,c,h);var d=this.evaluator.evalExpression(this.expresion);
4==d[0].length?(this.w=d[0][2],this.h=d[0][3]):this.h=this.w=null;this.video=document.createElement("video");this.autoplay&&this.video.setAttribute("autoplay","autoplay");this.loop&&this.video.setAttribute("loop","loop");this.controls&&this.video.setAttribute("controls","controls");this.poster&&this.video.setAttribute("poster",this.poster);this.w&&(this.video.setAttribute("width",this.w),this.video.setAttribute("height",this.h));this.video.setAttribute("style","position: absolute; overflow: hidden; left: "+
this.x+"px; top: "+this.y+"px;");var d=this.file,f=d.lastIndexOf(".");-1!=f&&(d=this.file.substring(0,f));this.video.canPlayType("video/mp4")&&(f=document.createElement("source"),f.setAttribute("src",d+".mp4"),f.setAttribute("type","video/mp4"),this.video.appendChild(f));this.video.canPlayType("video/ogg")&&(f=document.createElement("source"),f.setAttribute("src",d+".ogg"),f.setAttribute("type","video/ogg"),this.video.appendChild(f),f=document.createElement("source"),f.setAttribute("src",d+".ogv"),
f.setAttribute("type","video/ogg"),this.video.appendChild(f));this.video.canPlayType("video/webm")&&(f=document.createElement("source"),f.setAttribute("src",d+".webm"),f.setAttribute("type","video/webm"),this.video.appendChild(f));this.addControlContainer(this.video)};a.extend(a.Video,a.Control);a.Video.prototype.init=function(){this.video.style.left=this.x+"px";this.video.style.top=this.y+"px";this.update()};a.Video.prototype.update=function(){c=this.evaluator;0<c.evalExpression(this.drawif)?this.video.style.display=
"block":(this.video.style.display="none",this.video.pause());this.updatePositionAndSize()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c,g;a.TextArea=function(c,d){a.Control.call(this,c,d);this.region="interior";this.tabindex=++this.parent.tabindex;if(this.answer){this.answer.match("krypto_")&&(this.answer=(new a.Krypto).decode(this.answer.substring(7)));var f=this.parent.lessonParser.parseText(this.answer)}this.containerControl=document.createElement("div");this.textArea=
document.createElement("div");this.textAreaAnswer=document.createElement("div");this.showButton=document.createElement("div");this.activeCover=document.createElement("div");this.containerControl.appendChild(this.textArea);this.containerControl.appendChild(this.textAreaAnswer);this.containerControl.appendChild(this.showButton);this.containerControl.appendChild(this.activeCover);this.addControlContainer(this.containerControl);this.showAnswer=!1;this.text=void 0==this.text||void 0==this.text.type?this.rawText||
"":this.text.hasFormula?this.rawText:this.text.toHTML();f&&void 0!=f.type&&!this.text.hasFormula&&(this.answer=f.toHTML());this.evaluator.setVariable(this.id,this.text);this.drawButton();this.registerMouseAndTouchEvents();this.init()};a.extend(a.TextArea,a.Control);a.TextArea.prototype.init=function(){g=this.answer?28:8;c=this.evaluator;this.text=c.getVariable(this.id);this.containerControl.setAttribute("class","DescartesTextAreaContainer");this.containerControl.setAttribute("style","width: "+this.w+
"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";");this.containerControl.style.display=0<c.evalExpression(this.drawif)?"block":"none";this.containerControl.setAttribute("spellcheck","false");this.textArea.setAttribute("class","DescartesTextAreaContainer");this.textArea.setAttribute("style","width: "+(this.w-8)+"px; height: "+(this.h-g)+"px; left: 4px; top: 4px; background-color: white; text-align: left; font: "+a.convertFont(this.font)+";");this.textArea.setAttribute("contenteditable",
"true");this.textArea.innerHTML="<span style='position: relative; top: 10px; left: 10px; white-space: nowrap;' >"+this.text+"</span>";this.textAreaAnswer.setAttribute("class","DescartesTextAreaContainer");this.textAreaAnswer.setAttribute("style","width: "+(this.w-8)+"px; height: "+(this.h-g)+"px; left: 4px; top: 4px; background-color: white; text-align: left; font: "+a.convertFont(this.font)+";");this.textAreaAnswer.style.display=this.showAnswer?"block":"none";this.textAreaAnswer.innerHTML="<span style='position: relative; top: 10px; left: 10px; white-space: nowrap;'>"+
this.answer+"</span>";this.showButton.setAttribute("style","width: 20px; height: 16px; position: absolute; bottom: 4px; right: 4px; cursor: pointer;");this.showButton.style.backgroundImage="url("+this.imageUnPush+")";this.showButton.style.display=this.answer?"block":"none";this.showButton.innerHTML="<span style='position: relative; top: 2px; text-align: center; font: 9px Arial'> S </span>";this.activeCover.setAttribute("style","position: absolute; width: "+this.w+"px; height: "+this.h+"px; left: "+
this.x+"px; top: "+this.y+"px;");this.update()};a.TextArea.prototype.drawButton=function(){var c=document.createElement("canvas");c.setAttribute("width",20);c.setAttribute("height",16);var d=c.getContext("2d");this.canvas=c;this.ctx=d;this.createGradient(20,16);d.lineWidth=1;d.fillStyle="white";d.fillRect(0,0,20,16);d.fillStyle=this.linearGradient;d.fillRect(0,0,20,16);a.drawLine(d,19,0,19,16,"rgba(0,0,0,"+128/255+")");a.drawLine(d,0,0,0,16,"rgba(0,0,0,"+24/255+")");a.drawLine(d,1,0,1,16,"rgba(0,0,0,"+
8/255+")");this.imageUnPush=c.toDataURL();d.fillStyle="white";d.fillRect(0,0,20,16);d.fillStyle=this.linearGradient;d.fillRect(0,0,20,16);a.drawLine(d,0,0,0,14,"gray");a.drawLine(d,0,0,19,0,"gray");d.fillStyle="rgba(0, 0, 0,"+24/255+")";d.fillRect(0,0,this.w,this.h);this.imagePush=c.toDataURL()};a.TextArea.prototype.update=function(){c=this.evaluator;this.activeIfValue=0<c.evalExpression(this.activeif);this.drawIfValue=0<c.evalExpression(this.drawif);c.setVariable(this.id,this.text);this.activeCover.style.display=
this.activeIfValue?"none":"block";this.containerControl.style.display=this.drawIfValue?"block":"none";this.updatePositionAndSize()};a.TextArea.prototype.registerMouseAndTouchEvents=function(){function a(h){h.preventDefault();c.showButton.style.backgroundImage="url("+c.imageUnPush+")"}var c=this;this.showButton.addEventListener("mousedown",function(a){a.preventDefault();c.showAnswer=!c.showAnswer;c.textAreaAnswer.style.display=c.showAnswer?"block":"none";c.showButton.childNodes[0].childNodes[0].textContent=
c.showAnswer?"T":"S";c.showButton.style.backgroundImage="url("+c.imagePush+")"});this.showButton.addEventListener("mouseup",a);this.showButton.addEventListener("mouseout",a)};a.TextArea.prototype.getScreenshot=function(){var a=document.createElement("canvas");a.setAttribute("width",this.w);a.setAttribute("height",this.h);var c=a.getContext("2d");c.fillStyle="white";c.strokeStyle="black";c.lineWidth=1;c.fillRect(0,0,this.w,this.h);c.strokeRect(0,0,this.w,this.h);return a};return a}(descartesJS||{}),
descartesJS=function(a){if(a.loadLib)return a;var c=2*Math.PI,g,h,d,f,l,k,e,t,m;a.GraphicControl=function(c,d){h=c.evaluator.parser;this.spaceID="E0";this.text="";this.size=h.parse("4");this.font="Monospaced,PLAIN,12";this.image=new Image;this.image.onload=function(){this.ready=1};this.imageSrc="";a.Control.call(this,c,d);this.touchId=null;this.font=a.convertFont(this.font);this.constraintExpr&&(this.constraint=h.parse(this.constraintExpr),"(expr)"==this.constraint.type&&(this.constraint=h.parse(this.constraintExpr.substring(1,
this.constraintExpr.length-1))),"compOperator"==this.constraint.type?this.newt=new a.R2Newton(this.evaluator,this.constraint):this.constraint=null,t=new a.R2(0,0));this.container=this.getContainer();this.mouseCacher=document.createElement("div");this.mouseCacher.setAttribute("class","DescartesGraphicControl");this.mouseCacher.setAttribute("id",this.id);this.mouseCacher.setAttribute("dragged",!0);this.mouseCacher.setAttribute("tabindex","-1");this.ctx=this.space.ctx;this.container.appendChild(this.mouseCacher);
this.registerMouseAndTouchEvents();this.init()};a.extend(a.GraphicControl,a.Control);a.GraphicControl.prototype.init=function(){g=this.evaluator;m=a.hasTouchSupport;var c=g.evalExpression(this.expresion);this.x=c[0][0];this.y=c[0][1];g.setVariable(this.id+".x",this.x);g.setVariable(this.id+".y",this.y);""!=this.imageSrc&&!this.imageSrc.toLowerCase().match(/vacio.gif$/)?(this.image=this.parent.getImage(this.imageSrc),this.width=this.image.width,this.height=this.image.height):(this.width=2*g.evalExpression(this.size),
this.height=2*g.evalExpression(this.size));this._w=m&&70>this.width?70:this.width;this._h=m&&70>this.height?70:this.height;this.mouseCacher.setAttribute("style","cursor: pointer; background-color: rgba(255, 255, 255, 0); width: "+this._w+"px; height: "+this._h+"px; z-index: "+this.zIndex+";");this.mouseCacher.style.left=parseInt(this.space.getAbsoluteX(this.x)-this._w/2)+"px";this.mouseCacher.style.top=parseInt(this.space.getAbsoluteY(this.y)-this._h/2)+"px";g.setVariable(this.id+".activo",0);this.update()};
a.GraphicControl.prototype.update=function(){g=this.evaluator;this.activeIfValue=0<g.evalExpression(this.activeif);this.drawIfValue=0<g.evalExpression(this.drawif);this.x=g.getVariable(this.id+".x");this.y=g.getVariable(this.id+".y");d=this.space.getAbsoluteX(this.x);f=this.space.getAbsoluteY(this.y);this.active||(this.mouseCacher.style.left=parseInt(d-this._w/2)+"px",this.mouseCacher.style.top=parseInt(f-this._h/2)+"px");this.mouseCacher.style.display=this.drawIfValue?"block":"none";this.constraint&&
this.evalConstraint();this.draw()};a.GraphicControl.prototype.draw=function(){g=this.evaluator;this.drawIfValue&&(k=this.ctx,e=this.space.backgroundCtx,d=parseInt(this.space.getAbsoluteX(this.x))+0.5,f=parseInt(this.space.getAbsoluteY(this.y))+0.5,""!=this.text&&this.drawText(d,f),this.image.ready?(this.image.complete&&k.drawImage(this.image,parseInt(d-this.image.width/2),parseInt(f-this.image.height/2)),this.trace&&(e.save(),e.translate(d,f),e.scale(parseInt(this.image.width/2),parseInt(this.image.height/
2)),e.beginPath(),e.arc(0,0,1,0,c,!1),e.restore(),e.lineWidth=1,e.strokeStyle=this.trace.getColor(),e.stroke())):(k.beginPath(),k.arc(d,f,parseInt(this.width/2),0,c,!1),k.fillStyle=this.colorInt.getColor(),k.fill(),k.lineWidth=1,k.strokeStyle=this.color.getColor(),k.stroke(),this.active&&(k.beginPath(),k.arc(d,f,parseInt(this.width/2)-2,0,c,!1),k.strokeStyle=this.colorInt.borderColor(),k.stroke()),this.trace&&(e.lineWidth=1,e.strokeStyle=this.trace.getColor(),e.beginPath(),e.arc(d,f,parseInt(this.width/
2),0,c,!1),e.stroke())))};a.GraphicControl.prototype.evalConstraint=function(a,c){t.set(this.x,this.y);l=this.newt.findZero(t);this.x=l.x;this.y=l.y;this.evaluator.setVariable(this.id+".x",this.x);this.evaluator.setVariable(this.id+".y",this.y)};a.GraphicControl.prototype.drawText=function(a,c){k=this.ctx;g=this.evaluator;k.fillStyle=this.color.getColor();k.font=this.font;k.textBaseline="alphabetic";k.fillText(g.evalExpression(this.text[0],g.evalExpression(this.decimals),this.fixed),parseInt(a+1+
this.width/2),parseInt(c-1-this.height/2))};a.GraphicControl.prototype.getContainer=function(){for(var a=this.parent.spaces,c,d=0,e=a.length;d<e;d++)if(c=a[d],c.id==this.spaceID)return c.addCtr(this),this.zIndex=c.zIndex,this.space=c,c.graphicControlContainer;a[0].addCtr(this);this.zIndex=a[0].zIndex;this.space=a[0];return a[0].graphicControlContainer};a.GraphicControl.prototype.deactivate=function(){this.active=!1;this.evaluator.setVariable(this.id+".activo",0)};a.GraphicControl.prototype.registerMouseAndTouchEvents=
function(){function c(d){d.preventDefault();k.whichButton=a.whichButton(d);"L"==k.whichButton&&(k.activeIfValue&&k.over)&&(k.parent.deactivateGraphiControls(),k.click=!0,k.active=!0,k.evaluator.setVariable(k.id+".activo",1),k.posAnte=k.getCursorPosition(d),k.prePos={x:k.space.getAbsoluteX(k.x),y:k.space.getAbsoluteY(k.y)},k.evaluator.setVariable(k.space.id+".mouse_x",k.x),k.evaluator.setVariable(k.space.id+".mouse_y",k.y),k.parent.update(),window.addEventListener("mouseup",e),window.addEventListener("mousemove",
h))}function d(a){a.preventDefault();k.activeIfValue&&(k.parent.deactivateGraphiControls(),k.click=!0,k.active=!0,k.evaluator.setVariable(k.id+".activo",1),k.posAnte=k.getCursorPosition(a),k.prePos={x:k.space.getAbsoluteX(k.x),y:k.space.getAbsoluteY(k.y)},k.evaluator.setVariable(k.space.id+".mouse_x",k.x),k.evaluator.setVariable(k.space.id+".mouse_y",k.y),k.parent.update(),window.addEventListener("touchmove",h),window.addEventListener("touchend",e))}function e(c){c.preventDefault();k.touchId=null;
if(k.activeIfValue||k.active)k.click=!1,a.hasTouchSupport?(window.removeEventListener("touchmove",h,!1),window.removeEventListener("touchend",e,!1)):(window.removeEventListener("mouseup",e,!1),window.removeEventListener("mousemove",h,!1)),k.evaluator.setVariable(k.space.id+".mouse_x",k.x),k.evaluator.setVariable(k.space.id+".mouse_y",k.y),k.parent.update(),k.mouseCacher.style.left=k.space.getAbsoluteX(k.x)-k._w/2+"px",k.mouseCacher.style.top=k.space.getAbsoluteY(k.y)-k._h/2+"px"}function h(a){a.preventDefault();
a.touchId=k.touchId;l=k.getCursorPosition(a);k.posX=k.prePos.x-(k.posAnte.x-l.x);k.posY=k.prePos.y-(k.posAnte.y-l.y);k.evaluator.setVariable(k.id+".x",k.space.getRelativeX(k.posX));k.evaluator.setVariable(k.id+".y",k.space.getRelativeY(k.posY));k.evaluator.setVariable(k.space.id+".mouse_x",k.x);k.evaluator.setVariable(k.space.id+".mouse_y",k.y);k.parent.updateControls();k.parent.update()}function f(a){k.over=!0}function g(a){k.over=!1;k.click=!1}var k=this;this.active=this.over=this.click=!1;this.mouseCacher.oncontextmenu=
function(){return!1};a.hasTouchSupport?this.mouseCacher.addEventListener("touchstart",d):(this.mouseCacher.addEventListener("mousedown",c),this.mouseCacher.addEventListener("mouseover",f),this.mouseCacher.addEventListener("mouseout",g));var l};a.GraphicControl.prototype.getCursorPosition=function(a){if(a.touches){var c;if(a.touchId){d=0;for(e=a.touches.length;d<e;d++)if(a.touches[d].identifier==a.touchId){c=a.touches[d];break}}else for(var d=0,e=a.touches.length;d<e;d++)if(a.target==a.touches[d].target){c=
a.touches[d];this.touchId=c.identifier;break}mouseX=c.pageX;mouseY=c.pageY}else void 0!=a.pageX&&void 0!=a.pageY?(mouseX=a.pageX,mouseY=a.pageY):(mouseX=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,mouseY=a.clientY+document.body.scrollTop+document.documentElement.scrollTop);return{x:mouseX-(this.space.container.offsetLeft+this.space.container.parentNode.offsetLeft),y:mouseY-(this.space.container.offsetTop+this.space.container.parentNode.offsetTop)}};return a}(descartesJS||
{}),descartesJS=function(a,c){var g,h,d,f,l,k,e,t,m,n;if(a.loadLib)return a;var s,p,u,q,r,w,v,z,A=/[\w-//]*(\.png|\.jpg|\.gif|\.svg|\.PNG|\.JPG|\.GIF|\.SVG)/g,B,x,D,E,F,C,K,I,H,L,y,J,G,M,N,O,S,T,Q,R,P;a.LessonParser=function(c){this.parent=c;this.parser=c.evaluator.parser;this.RTFparser=new a.RTFParser(c.evaluator)};a.LessonParser.prototype.parseButtonsConfig=function(a){var d={rowsNorth:0,rowsSouth:0,widthEast:125,widthWest:125,height:23};a=this.split(a);for(var e=0,h=a.length;e<h;e++)switch(u=a[e][0],
q=a[e][1],p=c[u],p){case "rowsNorth":case "rowsSouth":case "widthEast":case "widthWest":case "height":d[p]=parseInt(q);break;case "about":case "config":case "init":case "clear":d[p]="true"===c[q];break;default:console.log("----- attributo de space no identificado: <"+u+"> valor: <"+q+"> -----")}return d};a.LessonParser.prototype.parseSpace=function(d){r={};d=this.split(d);for(var e=0,h=d.length;e<h;e++)switch(u=d[e][0],q=d[e][1],p=c[u],p){case "type":case "id":case "cID":case "file":r[p]=q;break;
case "fixed":case "numbers":case "sensitive_to_mouse_movements":case "R3":case "split":r[p]="true"===c[q];break;case "bg_display":case "render":r[p]=c[q];break;case "net":case "net10":case "axes":case "text":r[p]="false"===c[q]?"":new a.Color(q,this.parent.evaluator);break;case "x_axis":case "y_axis":r[p]="false"===c[q]?"":q;break;case "O.x":r.OxExpr=q;break;case "O.y":r.OyExpr=q;break;case "image":r.imageSrc=q;break;case "x":s=q;s="%"===s[s.length-1]?(this.parent.container.width*parseFloat(s)/100).toString():
q;r.xExpr=this.parser.parse(s);break;case "y":s=q;s="%"===s[s.length-1]?(this.parent.container.height*parseFloat(s)/100).toString():q;r.yExpr=this.parser.parse(s);break;case "width":s=q;"%"===s[s.length-1]?s=this.parent.container.width*parseFloat(s)/100:(s=parseFloat(q),s!=q&&(s=this.parent.container.width));r.w=s;break;case "height":s=q;"%"===s[s.length-1]?s=this.parent.container.height*parseFloat(s)/100:(s=parseFloat(q),s!=q&&(s=this.parent.container.height));r.h=s;break;case "drawif":r.drawif=
this.parser.parse(q);break;case "scale":s=parseFloat(q);s.toString()!=q&&(s=48);r.scale=s;break;case "background":r.background=new a.Color(q,this.parent.evaluator);break;default:console.log("----- attributo de space no identificado: <"+u+"> valor: <"+q+"> -----")}switch(r.type){case "R2":return new a.Space2D(this.parent,r);case "R3":return new a.Space3D(this.parent,r);case "AP":return new a.SpaceAP(this.parent,r);case "HTMLIFrame":return new a.SpaceHTML_IFrame(this.parent,r);default:return new a.Space2D(this.parent,
r)}};a.LessonParser.prototype.parseControl=function(d){w={};d=this.split(d);for(var e=0,h=d.length;e<h;e++)switch(u=d[e][0],q=d[e][1],p=c[u],p){case "id":case "name":case "parameter":case "tooltip":case "tooltipFont":case "Explanation":case "ExplanationFont":case "cID":case "options":case "font":case "file":case "answer":w[p]=q;break;case "gui":case "region":case "action":case "msg_pos":case "poster":w[p]=c[q];break;case "fixed":case "visible":case "discrete":case "onlyText":case "evaluate":case "autoplay":case "loop":case "controls":w[p]=
"true"===c[q];break;case "color":case "colorInt":case "trace":w[p]=new a.Color(q,this.parent.evaluator);break;case "font_size":case "drawif":case "activeif":case "decimals":case "min":case "max":case "size":w[p]=this.parser.parse(q);break;case "constraint":w.constraintExpr=q;break;case "image":w.imageSrc=q;break;case "space":w.spaceID=q;break;case "type":w.type=c[q.trim()];break;case "expresion":w.expresion=this.parser.parse(q.replace(")(",","));break;case "bold":"false"!=c[q]&&(w.bold="bold");break;
case "italics":"false"!=c[q]&&(w.italics="italic");break;case "underlined":"false"!=c[q]&&(w.underlined=!0);break;case "value":var f=q.replace(/&squot;/g,"'");f.match(/^\|/)&&(f="'"+f.substring(1),f.match(/\|$/)&&(f=f.substring(0,f.length-1)+"'"));w.valueExpr=this.parser.parse(f);w.valueExprString=f;break;case "incr":0!=q&&(w.incr=this.parser.parse(q));break;case "exponentialif":w.exponentialif=parseFloat(q);break;case "text":w.rawText=q;for(var f=this.parseText(q),g=0,k=f.length;g<k;g++)f[g]=this.parser.parse(f[g],
!1);w.text=f;break;default:g=u.indexOf(".");f=c[u.substring(0,g)];g=c[u.substring(g+1)];if("parameter"===f&&"font"===g){w.parameterFont=q;break}else if("Explanation"===f&&"font"===g){w.ExplanationFont=q;break}else if("tooltip"===f&&"font"===g){w.tooltipFont=q;break}console.log("----- attributo de control no identificado: <"+u+"> valor: <"+q+"> -----")}if("numeric"===w.type)switch(w.gui){case "spinner":return new a.Spinner(this.parent,w);case "button":return new a.Button(this.parent,w);case "textfield":return new a.TextField(this.parent,
w);case "menu":return new a.Menu(this.parent,w);case "scrollbar":return new a.Scrollbar(this.parent,w);default:return new a.Spinner(this.parent,w)}else{if("video"===w.type)return new a.Video(this.parent,w);if("audio"===w.type)return new a.Audio(this.parent,w);if("graphic"===w.type)return new a.GraphicControl(this.parent,w);if("text"===w.type)return new a.TextArea(this.parent,w)}};a.LessonParser.prototype.parseGraphic=function(d,e,h,f){v={rotateExp:f,parameter:"t"};d=this.split(d);f=0;for(var g=d.length;f<
g;f++)switch(u=d[f][0],q=d[f][1],p=c[u],p){case "type":case "align":v[p]=c[q];break;case "background":case "abs_coord":case "visible":case "editable":case "fixed":case "vectors":v[p]="true"===c[q];break;case "color":case "trace":case "fill":case "fillP":case "fillM":case "arrow":v[p]=new a.Color(q,this.parent.evaluator);break;case "family":case "parameter":case "info":case "font":case "name":v[p]=q;break;case "drawif":case "width":case "decimals":case "size":case "spear":case "center":case "radius":case "init":case "end":case "opacity":case "inirot":case "inipos":case "range":v[p]=
this.parser.parse(q);break;case "space":v.spaceID=q;break;case "expresion":"macro"!=v.type?(v.expresion=this.parser.parse(q),v.expresionString=q):v.expresion=q;break;case "text":v.text=this.parseText(q);break;case "file":var k=q.replace(/&squot;/g,"'");"["===k.charAt(0)&&"]"===k.charAt(k.length-1)&&(k=k.substring(1,k.length-1));k.match(A)&&(k="'"+k+"'");v.file=this.parser.parse(k);break;case "border":"false"!=c[q]&&(v.border=new a.Color(q,this.parent.evaluator));break;default:if(void 0!=v.family&&
u.substring(0,v.family.length+1)===v.family+"."){switch(c[u.substring(v.family.length+1)]){case "interval":v.family_interval=this.parser.parse(q);break;case "steps":v.family_steps=this.parser.parse(q)}break}if(void 0!=v.parameter&&u.substring(0,v.parameter.length+1)===v.parameter+"."){switch(c[u.substring(v.parameter.length+1)]){case "interval":v.parameter_interval=this.parser.parse(q);break;case "steps":v.parameter_steps=this.parser.parse(q)}break}console.log("----- attributo del graphic no identificado: <"+
u+"> valor: <"+q+"> -----")}e&&(v.abs_coord=e);h&&(v.background=h);switch(v.type){case "text":return new a.Text(this.parent,v);case "image":return new a.Image(this.parent,v);case "point":return new a.Point(this.parent,v);case "polygon":return new a.Polygon(this.parent,v);case "arc":return new a.Arc(this.parent,v);case "segment":return new a.Segment(this.parent,v);case "arrow":return new a.Arrow(this.parent,v);case "macro":return new a.Macro(this.parent,v);case "curve":return new a.Curve(this.parent,
v);case "equation":return new a.Equation(this.parent,v);case "sequence":return new a.Sequence(this.parent,v);case "fill":return new a.Fill(this.parent,v)}};a.LessonParser.prototype.parse3DGraphic=function(d,e,f,h){v={rotateExp:h,parameter:"t"};d=this.split(d);e=0;for(f=d.length;e<f;e++)switch(u=d[e][0],q=d[e][1],p=c[u],p){case "type":case "model":v[p]=c[q];break;case "background":case "fixed":case "edges":v[p]="true"===c[q];break;case "color":case "backcolor":v[p]=new a.Color(q,this.parent.evaluator);
break;case "type":case "model":v[p]=c[q];break;case "background":case "fixed":case "edges":v[p]="true"===c[q];break;case "color":case "backcolor":v[p]=new a.Color(q,this.parent.evaluator);break;case "drawif":case "width":case "length":case "height":case "decimals":case "Nu":case "Nv":case "inirot":case "endrot":case "inipos":case "endpos":v[p]=this.parser.parse(q);break;case "family":case "parameter":case "font":case "name":v[p]=q;break;case "space":v.spaceID=q;break;case "expresion":"macro"!=v.type&&
"curve"!=v.type&&"surface"!=v.type?(v.expresion=this.parser.parse(q),v.expresionString=q):v.expresion=q;break;case "text":h=this.parseText(q);for(var g=0,k=h.length;g<k;g++)h[g]=this.parser.parse(h[g],!1);v.text=h;break;case "file":h=q.replace(/&squot;/g,"'");"["===h.charAt(0)&&"]"===h.charAt(h.length-1)&&(h=h.substring(1,h.length-1));h.match(/./)&&(h="'"+h+"'");v.file=this.parser.parse(h);break;case "drawif":case "width":case "length":case "decimals":case "Nu":case "Nv":case "inirot":case "endrot":case "inipos":case "endpos":v[p]=
this.parser.parse(q);break;case "family":case "parameter":case "font":case "name":v[p]=q;break;case "space":v.spaceID=q;break;case "expresion":"macro"!=v.type&&"curve"!=v.type&&"surface"!=v.type?(v.expresion=this.parser.parse(q),v.expresionString=q):v.expresion=q;break;case "text":h=this.parseText(q);g=0;for(k=h.length;g<k;g++)h[g]=this.parser.parse(h[g],!1);v.text=h;break;case "file":h=q.replace(/&squot;/g,"'");"["===h.charAt(0)&&"]"===h.charAt(h.length-1)&&(h=h.substring(1,h.length-1));h.match(/./)&&
(h="'"+h+"'");v.file=this.parser.parse(h);break;default:if(void 0!==v.family&&u.substring(0,v.family.length+1)===v.family+"."){"family_interval"===c[u.substring(v.family.length+1)]?v.family_interval=this.parser.parse(q):v.family_steps=this.parser.parse(q);break}console.log("----- attributo del graphic3D no identificado: <"+u+"> valor: <"+q+"> -----")}switch(v.type){case "point":return new a.Point3D(this.parent,v);case "segment":return new a.Segment3D(this.parent,v);case "polygon":return new a.Polygon3D(this.parent,
v);case "curve":return new a.Curve3D(this.parent,v);case "triangle":return new a.Triangle3D(this.parent,v);case "face":return new a.Face3D(this.parent,v);case "polireg":return new a.Polireg3D(this.parent,v);case "surface":return new a.Surface3D(this.parent,v);case "text":return new a.Text3D(this.parent,v);case "mesh":case "cube":case "box":case "tetrahedron":case "octahedron":return new a.OtherGeometry(this.parent,v);default:console.log(v.type)}};a.LessonParser.prototype.parseAuxiliar=function(d){z=
{};d=this.split(d);for(var e=0,h=d.length;e<h;e++)d[e][1]=d[e][1].replace(/&squot;/g,"'");e=0;for(h=d.length;e<h;e++)switch(u=d[e][0],q=d[e][1],p=c[u],p){case "id":case "file":case "init":case "doExpr":case "whileExpr":case "range":case "local":case "expresion":case "condition":case "parameter":z[p]=q;break;case "editable":case "constant":case "array":case "matrix":case "algorithm":case "sequence":z[p]="true"===c[q];break;case "size":case "rows":case "columns":z[p]=this.parser.parse(q);break;case "evaluate":case "event":case "execution":case "msg_pos":case "action":z[p]=
c[q];break;default:var f=u.indexOf("."),g=c[u.substring(0,f)],f=c[u.substring(f+1)];if("parameter"===g&&"font"===f){z.parameterFont=q;break}console.log("----- attributo de auxiliar no identificado: <"+u+"> valor: <"+q+"> -----")}z.sequence?new a.AuxSequence(this.parent,z):z.constant?(d=new a.Constant(this.parent,z),z.evaluate&&"always"===z.evaluate&&this.parent.auxiliaries.push(d)):z.algorithm&&z.evaluate?(d=new a.Algorithm(this.parent,z),this.parent.auxiliaries.push(d)):z.array&&!z.matrix&&")"!=
z.id.charAt(z.id.length-1)?(d=new a.Vector(this.parent,z),z.evaluate&&"always"===z.evaluate&&this.parent.auxiliaries.push(d)):z.matrix&&")"!=z.id.charAt(z.id.length-1)?(d=new a.Matrix(this.parent,z),z.evaluate&&"always"===z.evaluate&&this.parent.auxiliaries.push(d)):z.event&&")"!=z.id.charAt(z.id.length-1)?this.parent.events.push(new a.Event(this.parent,z)):")"===z.id.charAt(z.id.length-1)?new a.Function(this.parent,z):new a.Variable(this.parent,z)};a.LessonParser.prototype.parseAction=function(c){B=
c.action;x=c.parent;D=c.parameter;if(B)switch(B){case "message":return new a.Message(x,D);case "calculate":return new a.Calculate(x,D);case "openURL":return new a.OpenURL(x,D);case "openScene":return new a.OpenScene(x,D);case "about":return new a.About(x,D);case "config":return new a.Config(x,D);case "init":return new a.Init(x,D);case "clear":return new a.Clear(x,D);case "animate":return new a.Animate(x,D);case "initAnimation":return new a.InitAnimation(x,D);case "playAudio":return new a.PlayAudio(x,
D);default:console.log("----- Accion no soportada aun: <"+B+"> -----")}else return{execute:function(){}}};a.LessonParser.prototype.parseAnimation=function(d){var e={};d=this.split(d);for(var h=0,f=d.length;h<f;h++)switch(u=d[h][0],q=d[h][1],p=c[u],p){case "id":case "delay":case "init":case "doExpr":case "whileExpr":e[p]=q;break;case "controls":case "auto":case "loop":case "algorithm":case "evaluate":e[p]="true"===c[q];break;default:console.log("----- attributo de la animacion no identificado: <"+
u+">  <"+q+"> -----")}return new a.Animation(this.parent,e)};a.LessonParser.prototype.parsePleca=function(c,p){c=this.split(c);h=g="";d=0;f="#536891";l="white";k="left";e="";t="SansSerif,BOLD,20";m="SansSerif,PLAIN,18";n=void 0;for(var r=0,s=c.length;r<s;r++)switch(u=c[r][0],q=c[r][1],u){case "title":g=q;break;case "subtitle":h=q;break;case "subtitlines":d=q;break;case "bgcolor":""!=q&&(f="#"+(new a.Color(q,this.parent.evaluator)).getColor());break;case "fgcolor":""!=q&&(l="#"+(new a.Color(q,this.parent.evaluator)).getColor());
break;case "align":""!=q&&(k=q);break;case "titleimage":e=q;break;case "titlefont":t=""!=q?a.convertFont(q):a.convertFont(t);break;case "subtitlefont":m=""!=q?a.convertFont(q):a.convertFont(m);break;default:console.log("----- attributo de la pleca no identificado: <"+u+">  <"+q+"> -----")}L=m.substring(0,m.indexOf("px"));L=L.substring(L.lastIndexOf(" "));""!=e&&(y=this.parent.getImage(e),J=y.height);n=document.createElement("div");n.setAttribute("id","descartesPleca");J?(n.setAttribute("style","position: absolute; left: 0px; top: 0px; text-align: "+
k+"; width: "+(p-30)+"px; height: "+(J-16)+"px; background: "+f+"; color: "+l+"; padding-top: 8px; padding-bottom: 8px; padding-left: 15px; padding-right: 15px; margin: 0px; overflow: hidden; z-index: 100;"),y.setAttribute("style","position: absolute; left: 0px; top: 0px; z-index: -1; width: 100%; height: 100%"),n.appendChild(y)):n.setAttribute("style","position: absolute; left: 0px; top: 0px; text-align: "+k+"; width: "+(p-30)+"px; background: "+f+"; color: "+l+"; padding-top: 8px; padding-bottom: 8px; padding-left: 15px; padding-right: 15px; margin: 0px; z-index: 100;");
G=document.createElement("div");G.setAttribute("style","padding: 0px; margin: 0px; font: "+t+"; overflow: hidden; white-space: nowrap;");G.innerHTML=g;M=document.createElement("div");if(1===parseInt(d)){Q=0;N=document.createElement("div");N.innerHTML=h;document.body.appendChild(N);S=L;do S-=Q,N.setAttribute("style","padding: 0px; margin: 0px; font: "+m+"; font-size: "+S+"px; width: "+(p-30)+"px; line-height: "+S+"px;"),O=N.offsetHeight,T=O/S,Q=1;while(1<T&&8<S);document.body.removeChild(N);M.setAttribute("style",
"padding: 0px; margin: 0px; font: "+m+"; font-size: "+S+"px; line-height: 110%; overflow: hidden; white-space: nowrap;")}else M.setAttribute("style","padding: 0px; margin: 0px; font: "+m+"; line-height: 110%;");M.innerHTML=h;n.appendChild(G);n.appendChild(M);n.imageHeight=J;return n};a.LessonParser.prototype.split=function(a){if("string"!=typeof a)return[];a=(a||"").replace(/\\'/g,"\u2019");E=[];C=F=0;K=!1;I=0;for(H=!1;F<a.length;)" "===a.charAt(F)&&!K&&F++," "!==a.charAt(F)&&!K&&(K=!0,I=F),"="===
a.charAt(F)&&("'"===a.charAt(F+1)&&!H)&&(H=!0,E[C]=[a.substring(I,F)],I=F+2,F+=2),H&&"'"===a.charAt(F)&&(K=H=!1,E[C].push(a.substring(I,F)),C++),"="===a.charAt(F)&&("'"!==a.charAt(F+1)&&!H)&&(E[C]=[a.substring(I,F)],I=F+1,F++,R=a.substring(F).indexOf("="),-1===R?P=R=a.length:(R+=F,P=a.substring(F,R).lastIndexOf(" "),P=-1===P?a.length:P+F),E[C].push(a.substring(I,P)),C++,K=!1,F=P),F++;return E};a.LessonParser.prototype.parseText=function(c){return c.match(/^\{\\rtf1/)?this.RTFparser.parse(c.substring(10)):
new a.SimpleText(this.parent,c)};return a}(descartesJS||{},babel),descartesJS=function(a){function c(a,c){s=[];s.type="matrix";s.rows=a;s.cols=c;var d;u=0;for(q=c;u<q;u++){d=[];p=0;for(r=a;p<r;p++)d.push(0);s[u]=d}return s}function g(a,d){m=a.rows;n=a.cols;s=c(m,n);var e;for(u=0;u<m;u++)for(p=0;p<n;p++){for(q=e=0;q<n;q++)e+=a[q][u]*d[p][q];s[p][u]=e}return s}function h(a,d,e){for(var h=c(e.length-1,e.length-1),f=0,g=h.length;f<g;f++)for(var k=0;k<g;k++)h[f][k]=f<a?k<d?e[f][k]:e[f][k+1]:f<d?e[f+1][k]:
e[f+1][k+1];return h}function d(a){if(1<a.cols){for(var c=0,e=1,f=0,g=a.cols;f<g;f++)c+=e*a[0][f]*d(h(0,f,a)),e=-e;return c}return a[0][0]}if(a.loadLib)return a;var f=Math.floor,l,k,e,t;a.Node=function(a,c){this.sep="";this.type=a;this.value=c;this.parent=null;this.childs=[]};a.Node.prototype.getRoot=function(){return null===this.parent?this:this.parent.getRoot()};a.Node.prototype.addChild=function(a){a.parent=this;this.childs.push(a)};a.Node.prototype.replaceLastChild=function(a){l=this.childs.length-
1;lastChild=this.childs[l];lastChild.parent=null;this.childs[l]=a;a.parent=this;return a};a.Node.prototype.contains=function(a){if(this.value===a)return!0;for(var c=0,d=this.childs.length;c<d;c++)if(this.childs[c].contains(a))return!0;return!1};a.Node.prototype.equalToMinus=function(){return"compOperator"===this.type?(this.type="operator",this.value="-",e=new a.Node("compOperator","=="),t=new a.Node("number","0"),e.addChild(this),e.addChild(t),k=this.getRoot(),k.setAllEvaluateFunction(),k):this};
a.Node.prototype.setAllEvaluateFunction=function(){this.setEvaluateFunction();for(var a=0,c=this.childs.length;a<c;a++)this.childs[a].setAllEvaluateFunction()};a.Node.prototype.setEvaluateFunction=function(){if("number"===this.type)this.evaluate=function(a){return parseFloat(this.value)};else if("string"===this.type)this.evaluate=function(a){return this.value};else if("identifier"===this.type&&0===this.childs.length)if("rnd"==this.value)this.evaluate=function(a){return Math.random()};else{var a;this.evaluate=
function(c,d){a=c.variables[this.value];if("object"===typeof a)return a.evaluate(c);void 0==a&&d&&(a=c.matrices[this.value]);return void 0!==a?a:0}}else if("identifier"===this.type&&"square_bracket"===this.childs[0].type&&1===this.childs[0].childs.length){var e,k;this.evaluate=function(a){e=this.childs[0].childs[0].evaluate(a);try{return k=a.vectors[this.value][0>e?0:f(e)],void 0!==k?k:0}catch(c){return 0}}}else if("identifier"===this.type&&"square_bracket"===this.childs[0].type&&1<this.childs[0].childs.length){var l,
r;this.evaluate=function(a){l=this.childs[0].childs[0].evaluate(a);r=this.childs[0].childs[1].evaluate(a);try{return k=a.matrices[this.value][0>l?0:f(l)][0>r?0:f(r)],void 0!==k?k:0}catch(c){return 0}}}else if("identifier"===this.type&&"parentheses"===this.childs[0].type){var t;this.evaluate=function(a){t=[];for(var c=0,d=this.childs[0].childs.length;c<d;c++)t.push(this.childs[0].childs[c].evaluate(a));return"_Eval_"===this.value?a.evalExpression(a.parser.parse(t[0])):a.functions[this.value].apply(a,
t)}}else if("operator"===this.type){var q,E,F;"+"===this.value?this.evaluate=function(a){q=this.childs[0].evaluate(a,!0);E=this.childs[1].evaluate(a,!0);if("matrix"!==q.type||"matrix"!==E.type)return q+E;a=q;var d=E;m=a.rows;n=a.cols;s=c(m,n);for(u=0;u<m;u++)for(p=0;p<n;p++)s[p][u]=a[p][u]+d[p][u];return s}:"-"===this.value?this.evaluate=function(a){q=this.childs[0].evaluate(a,!0);E=this.childs[1].evaluate(a,!0);if("matrix"!==q.type||"matrix"!==E.type)return q-E;a=q;var d=E;m=a.rows;n=a.cols;s=c(m,
n);for(u=0;u<m;u++)for(p=0;p<n;p++)s[p][u]=a[p][u]-d[p][u];return s}:"*"===this.value?this.evaluate=function(a){q=this.childs[0].evaluate(a,!0);E=this.childs[1].evaluate(a,!0);return"matrix"!==q.type||"matrix"!==E.type?q*E:g(q,E)}:"/"===this.value?this.evaluate=function(a){q=this.childs[0].evaluate(a,!0);E=this.childs[1].evaluate(a,!0);if("matrix"!==q.type||"matrix"!==E.type)return q/E;a=q;var e;e=E;var f=c(e.length,e.length),k=d(e);if(0===k)e=0;else{var k=1/k,l;if(1<e.length)for(var m=0,n=e.length;m<
n;m++){l=k;for(var p=0;p<n;p++)f[p][m]=l*d(h(m,p,e)),l=-l;k=-k}else f[0][0]=k;e=f}a=0===e?c(a.rows,a.cols):g(a,e);return a}:"%"===this.value?this.evaluate=function(a){q=this.childs[0].evaluate(a);E=this.childs[1].evaluate(a);return q-f(q/E)*E}:"^"===this.value&&(this.evaluate=function(a){return Math.pow(this.childs[0].evaluate(a),this.childs[1].evaluate(a))})}else if("compOperator"===this.type)"<"===this.value?this.evaluate=function(a){return(this.childs[0].evaluate(a)<this.childs[1].evaluate(a))+
0}:"<="===this.value?this.evaluate=function(a){return(this.childs[0].evaluate(a)<=this.childs[1].evaluate(a))+0}:">"===this.value?this.evaluate=function(a){return(this.childs[0].evaluate(a)>this.childs[1].evaluate(a))+0}:">="===this.value?this.evaluate=function(a){return(this.childs[0].evaluate(a)>=this.childs[1].evaluate(a))+0}:"=="===this.value?this.evaluate=function(a){return(this.childs[0].evaluate(a)===this.childs[1].evaluate(a))+0}:"!="===this.value&&(this.evaluate=function(a){return(this.childs[0].evaluate(a)!=
this.childs[1].evaluate(a))+0});else if("boolOperator"===this.type)"&"===this.value?this.evaluate=function(a){return(q=this.childs[0].evaluate(a)?1:0)?this.childs[1].evaluate(a)?1:0:0}:"|"===this.value?this.evaluate=function(a){return(q=this.childs[0].evaluate(a)?1:0)?1:this.childs[1].evaluate(a)?1:0}:"!"===this.value&&(this.evaluate=function(a){q=this.childs[0].evaluate(a)?1:0;return!q+0});else if("conditional"===this.type)this.evaluate=function(a){q=this.childs[0].evaluate(a);return 0<q?this.childs[1].evaluate(a):
this.childs[2].evaluate(a)};else if("sign"===this.type)this.evaluate="sign+"===this.value?function(a){return this.childs[0].evaluate(a)}:function(a){return-this.childs[0].evaluate(a)};else if("parentheses"===this.type)this.evaluate=function(a,c){return this.childs[0].evaluate(a,c)};else if("(expr)"===this.type||"[expr]"===this.type){var C,K;this.evaluate=function(a){C=this.childs.length;F=[];if(1===C&&1===this.childs[0].childs.length&&"(expr)"===this.type)F=this.childs[0].childs[0].evaluate(a);else for(var c=
0;c<C;c++){K=[];for(var d=0,e=this.childs[c].childs.length;d<e;d++)K.push(this.childs[c].childs[d].evaluate(a));F[c]=K}return F}}else if("asign"===this.type){var I,H,L,y,J,G;this.evaluate=function(a){I=this.childs[0];H=this.childs[1];1===I.childs.length&&"square_bracket"===I.childs[0].type?(e=I.childs[0].childs,1===e.length?(L=e[0].evaluate(a),L=0>L?0:f(L),a.vectors[I.value][L]=H.evaluate(a)):2===e.length&&(y=e[0].evaluate(a),J=e[1].evaluate(a),y=0>y?0:f(y),J=0>J?0:f(J),a.matrices[I.value][y]||(a.matrices[I.value][y]=
[]),a.matrices[I.value][y][J]=H.evaluate(a))):(G=H.evaluate(a),G.type?a.matrices[I.value]=G:a.variables[I.value]=G)}}};var m,n,s,p,u,q,r;a.Node.prototype.toString=function(){var a="tipo: "+this.type+", valor: "+this.value+"\n";this.sep="   "+(this.parent?this.parent.sep:"");for(var c=0,d=this.childs.length;c<d;c++)a+=this.sep+this.childs[c].toString();return a};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c,g,h,d,f,l,k,e,t,m=/^\s+/,n=/^[a-zA-Z_\u00C0-\u021B]+[a-zA-Z_0-9\u00C0-\u021B]*([.]*[0-9a-zA-Z_\u00C0-\u021B]+[0-9]*)*/,
s=/^[0-9]+[.][0-9]+|^[.][0-9]+|^[0-9]+/,p=/^==|^!=|^<=|^<|^>=|^>|^#/,u=/^\!|^\~|^\&\&|^\&|^\|\||^\|/,q=/^=/,r=/^[\?\:]/,w=/^[\+\-\*\/\%\^]/,v=/^\[|^\]/,z=/^\(|^\)/,A=/^,/,B=/^;/;a.Tokenizer=function(){};a.Tokenizer.prototype.tokenize=function(a){function x(a,c,h){g.push({type:a,value:c});l=l.slice(h);d+=h;e++;t=a}if(c=a)a=a.replace(/\\u(\S+) /g,function(a,c){return String.fromCharCode(parseInt(c,16))}),a=a.replace(/\&sup(.+);/g,"^$1 "),a=a.replace(/&squot;/g,"'"),a.match(/\=\|\*/g)&&(a=a.replace("|*",
"'","g").replace("*|","'","g")),a.match(/\=\|/g)&&(a=a.replace("|","'","g"));g=[];h=!1;d=0;l=a;e=0;for(t="";a&&d<a.length;)if(h=d,"'"==l[0]){for(k=1;"'"!=l[k];)if(k<l.length)k++;else{console.log(">Error, unknown symbol: ["+l+"], in the string <<"+c+">>");return}f=l.substring(1,k);x("string",f,f.length+2)}else if(f=l.match(m))l=l.slice(f[0].length),d+=f[0].length,e++;else if(f=l.match(n))"number"===t&&g.push({type:"operator",value:"*"}),x("identifier",f[0],f[0].length);else if(f=l.match(s))x("number",
f[0],f[0].length);else if(f=l.match(p)){var C=f[0];"#"==C&&(C="!=");x("compOperator",C,f[0].length)}else if(f=l.match(u))C=f[0],"||"==C?C="|":"&&"==C?C="&":"~"==C&&(C="!"),x("boolOperator",C,f[0].length);else if((f=l.match(q))&&!l.match(/^==/))x("asign",f[0],f[0].length);else if(f=l.match(r))x("conditional",f[0],f[0].length);else if(f=l.match(w))x("operator",f[0],f[0].length);else if(f=l.match(v))x("square_bracket",f[0],f[0].length);else if(f=l.match(z))x("parentheses",f[0],f[0].length);else if(f=
l.match(A))x("separator",f[0],f[0].length);else if(f=l.match(B))x("final_of_expresion",f[0],f[0].length);else if(h==d){console.log("Error, simbolo no conocido: ["+l+"], en la cadena <<"+c+">>");return}return g};var x,D=/rnd|pi|e|Infinity|-Infinity|sqr|sqrt|ra\u00edz|exp|log|log10|abs|ent|sgn|ind|sin|sen|cos|tan|cot|sec|csc|sinh|senh|cosh|tanh|coth|sech|csch|asin|asen|acos|atan|min|max/;a.Tokenizer.prototype.flatTokens=function(a,c){a=a||[];c=c||"";x="";for(var d=0,e=a.length;d<e;d++)x="string"==a[d].type?
x+"&squot;"+a[d].value+"&squot;":"identifier"==a[d].type&&!a[d].value.match(D)?x+c+a[d].value:x+a[d].value;return x};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Parser=function(c){this.evaluator=c;this.tokenizer=new a.Tokenizer;this.vectors={};this.matrices={};this.variables={};this.functions={};this.registerDefaultValues()};a.Parser.prototype.setVariable=function(a,c){this.variables[a]=c};a.Parser.prototype.getVariable=function(a){return this.variables[a]};a.Parser.prototype.setVector=
function(a,c,d){this.vectors[a][c]=d};a.Parser.prototype.getVector=function(a){this.vectors.hasOwnProperty(a)||(this.vectors[a]=[0,0,0]);return this.vectors[a]};a.Parser.prototype.setMatrix=function(a,c,d,e){this.matrices[a][c][d]=e};a.Parser.prototype.getMatrix=function(a){this.matrices.hasOwnProperty(a)||(this.matrices[a]=[[0,0,0],[0,0,0],[0,0,0]]);return this.matrices[a]};a.Parser.prototype.setFunction=function(a,c){this.functions[a]=c};a.Parser.prototype.getFunction=function(a){this.functions.hasOwnProperty(a)||
(this.functions[a]=function(){return 0});return this.functions[a]};var c,g,h,d,f,l,k,e,t,m,n,s;a.Parser.prototype.parse=function(p,u){(h=this.tokenizer.tokenize(p))||(h=[]);d=null;u=!u||!1;c=e=k=l=0;for(g=h.length;c<g;c++)if(t=h[c],m=t.value,n=t.type,"identifier"===n&&(c+1<g&&"parentheses"===h[c+1].type&&"("===h[c+1].value?this.getFunction(m):c+1<g&&"square_bracket"===h[c+1].type&&"["===h[c+1].value?h[c+3]&&"square_bracket"===h[c+3].type&&"]"===h[c+3].value?this.getVector(m):this.getMatrix(m):this.getVariable(m)),
"asign"===n&&u&&(n="compOperator",m="=="),"asign"===n)if(f=new a.Node(n,m),null!=d)if("identifier"===d.type)d.parent&&d.parent.replaceLastChild(f),f.addChild(d),d=f,u=!0;else if("square_bracket"===d.type)f.addChild(d.parent),d=f,u=!0;else{f.type="compOperator";f.value="==";for(u=!0;d.parent&&this.getPrecedence(d.parent.value)>=this.getPrecedence(f.value);)d=d.parent;d.parent&&d.parent.replaceLastChild(f);f.addChild(d);d=f}else{console.log("Error1: en la expresion <<"+p+">>, en el token {valor: "+
m+", tipo: "+n+"}");break}else if("parentheses"===n&&"("===m||"square_bracket"===n&&"["===m)if(f=new a.Node(n,m),"("===m&&l++,"["===m&&k++,null===d)"("===m&&(new a.Node("(expr)","(expr)")).addChild(f),"["===m&&(new a.Node("[expr]","[expr]")).addChild(f),d=f;else if("operator"===d.type||"boolOperator"===d.type||"compOperator"===d.type||"conditional"===d.type||"asign"===d.type)d.addChild(f),d=f;else if("sign"===d.type)d.addChild(f),d=f;else if("parentheses"===d.type&&"("===d.value)d.addChild(f),d=f;
else if("square_bracket"===d.type&&"["===d.value)d.addChild(f),d=f;else if("parentheses"===d.type&&"()"===d.value)d.parent.addChild(f),d=f;else if("square_bracket"===d.type&&"[]"===d.value)d.parent.addChild(f),d=f;else if("identifier"===d.type)d.addChild(f),d=f;else{console.log("Error2: en la expresion <<"+p+">>, en el token ["+c+"] {valor: "+m+", tipo: "+n+"}");break}else if("parentheses"===n&&")"===m)if(l--,null===d)console.log("Error3: en la expresion <<"+p+">>, en el token (valor:"+m+", tipo:"+
n);else{for(;d&&d.parent&&"("!=d.value;)d=d.parent;if(d&&"("===d.value)d.value="()";else{console.log("Error4: en la expresion <<"+p+">>, en el token {valor: "+m+", tipo: "+n+"}");break}}else if("square_bracket"===n&&"]"===m)if(k--,null===d)console.log("Error5: en la expresion <<"+p+">>, en el token (valor:"+m+", tipo:"+n);else{for(;d&&d.parent&&"["!=d.value;)d=d.parent;if(d&&"["===d.value)d.value="[]";else{console.log("Error6: en la expresion <<"+p+">>, en el token {valor: "+m+", tipo: "+n+"}");break}}else if("number"===
n||"string"===n||"identifier"===n)if(f=new a.Node(n,m),null===d)d=f;else if("operator"===d.type||"compOperator"===d.type||"boolOperator"===d.type||"parentheses"===d.type&&"("===d.value||"square_bracket"===d.type&&"["===d.value||"sign"===d.type||"conditional"===d.type||"asign"===d.type)d.addChild(f),d=f;else{console.log("Error7: en la expresion <<"+p+">>, en el token {valor: "+m+", tipo: "+n+"}");break}else if("operator"===n||"compOperator"===n||"boolOperator"===n)if(f=new a.Node(n,m),null===d)if("-"===
m||"+"===m)f.type="sign",f.value="sign"+m,d=f;else if("!"===m)d=f;else{console.log("Error8: en la expresion <<"+p+">>, en el token {valor: "+m+", tipo: "+n+"}");break}else if("operator"===d.type||"compOperator"===d.type||"boolOperator"===d.type||"asign"===d.type||"conditional"===d.type||"square_bracket"===d.type&&"["===d.value&&("-"===m||"+"===m||"!"===m)||"parentheses"===d.type&&"("===d.value&&("-"===m||"+"===m||"!"===m)){if("-"===m||"+"===m)f.type="sign",f.value="sign"+m;d.addChild(f);d=f}else if("number"===
d.type||"parentheses"===d.type&&"()"===d.value||"square_bracket"===d.type&&"[]"===d.value||"string"===d.type||"identifier"===d.type||"conditional"===d.type||"asign"===d.type){for(;d.parent&&this.getPrecedence(d.parent.value)>=this.getPrecedence(f.value);)d=d.parent;d.parent&&d.parent.replaceLastChild(f);f.addChild(d);d=f}else{console.log("Error9: en la expresion <<"+p+">>, en el token {valor: "+m+", tipo: "+n+"}");break}else if("conditional"===n)if(f=new a.Node(n,m),null!=d)if("?"===f.value){for(e++;d.parent&&
this.getPrecedence(d.parent.value)>this.getPrecedence(f.value);)d=d.parent;d.parent&&d.parent.replaceLastChild(f);f.addChild(d);d=f}else{for(e--;d&&d.parent&&"?"!=d.value;)d=d.parent;if(d&&"?"===d.value)d.value="?:";else{console.log("Error10: en la expresion <<"+p+">>, en el token {valor: "+m+", tipo: "+n+"}");break}}else{console.log("Error11: en la expresion <<"+p+">>, en el token {valor: "+m+", tipo: "+n+"}");break}else if("separator"===n)if(null!=d)for(;d.parent&&"("!=d.value&&"["!=d.value;)d=
d.parent;else{console.log("Error12: en la expresion <<"+p+">>, en el token {valor: "+m+", tipo: "+n+"}");break}else{console.log("Error13: en la expresion <<"+p+">>, en el token {valor: "+m+", tipo: "+n+"}");break}0<l&&alert("Error, faltan parentesis por cerrar: "+p);0>l&&alert("Error, faltan parentesis por abrir: "+p);0<k&&alert("Error, faltan square bracketss por cerrar: "+p);0>k&&alert("Error, faltan square bracketss por abrir: "+p);0!=e&&alert("Error, condicional incompleta: "+p);(s=d?d.getRoot():
null)&&s.setAllEvaluateFunction();return s};a.Parser.prototype.getPrecedence=function(a){switch(a){case "=":return 1;case "(":return 2;case "[":return 2;case "?":return 2;case ":":return 3;case "?:":return 3;case "|":return 6;case "&":return 7;case "<":return 5;case "<=":return 5;case ">":return 5;case ">=":return 5;case "==":return 5;case "!=":return 5;case "+":return 6;case "-":return 6;case "/":return 7;case "*":return 7;case "sign-":return 7;case "sign+":return 7;case "!":return 8;case "^":return 8;
case "%":return 8;default:return 9}};a.Parser.prototype.registerDefaultValues=function(){this.variables.rnd=Math.random;this.variables.pi=Math.PI;this.variables.e=Math.E;this.variables.Infinity=Infinity;this.variables["-Infinity"]=-Infinity;this.functions.sqr=function(a){return a*a};this.functions.sqrt=this.functions["ra\u00edz"]=Math.sqrt;this.functions.exp=Math.exp;this.functions.log=Math.log;this.functions.log10=function(a){return Math.log(a)/Math.log(10)};this.functions.abs=Math.abs;this.functions.ent=
Math.floor;this.functions.sgn=function(a){return 0<a?1:0>a?-1:0};this.functions.ind=function(a){return a?1:0};this.functions.sin=this.functions.sen=Math.sin;this.functions.cos=Math.cos;this.functions.tan=Math.tan;this.functions.cot=function(a){return 1/Math.tan(a)};this.functions.sec=function(a){return 1/Math.cos(a)};this.functions.csc=function(a){return 1/Math.sin(a)};this.functions.sinh=this.functions.senh=function(a){return(Math.exp(a)-Math.exp(-a))/2};this.functions.cosh=function(a){return(Math.exp(a)+
Math.exp(-a))/2};this.functions.tanh=function(a){return(Math.exp(a)-Math.exp(-a))/(Math.exp(a)+Math.exp(-a))};this.functions.coth=function(a){return 1/this.functions.tanh(a)};this.functions.sech=function(a){return 1/this.functions.cosh(a)};this.functions.csch=function(a){return 1/this.functions.sinh(a)};this.functions.asin=this.functions.asen=Math.asin;this.functions.acos=Math.acos;this.functions.atan=Math.atan;this.functions.min=Math.min;this.functions.max=Math.max;var c=this;this.functions._Trace_=
function(a){console.log(a)};this.functions._Stop_Audios_=function(){c.evaluator.parent.stopAudios()};this.functions.esCorrecto=function(d,e,h){return a.esCorrecto(d,e,c.evaluator,h)};this.functions.escorrecto=function(d,e,h){return a.escorrecto(d,e,c.evaluator,h)};window.parent!==window&&(this.functions["parent.set"]=function(a,c){window.parent.postMessage({type:"set",name:a,value:c},"*")},this.functions["parent.update"]=function(){window.parent.postMessage({type:"update"},"*")},this.functions["parent.exec"]=
function(a,c){window.parent.postMessage({type:"exec",name:a,value:c},"*")})};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c=Math.floor;a.Evaluator=function(c){this.parent=c;this.parser=new a.Parser(this);this.variables=this.parser.variables;this.functions=this.parser.functions;this.vectors=this.parser.vectors;this.matrices=this.parser.matrices};a.Evaluator.prototype.setVariable=function(a,c){this.variables[a]=c};a.Evaluator.prototype.getVariable=function(a){return this.variables[a]};
a.Evaluator.prototype.setVector=function(a,h,d){h=0>h?0:c(h);this.vectors[a][h]=d};a.Evaluator.prototype.getVector=function(a,h){h=0>h?0:c(h);return this.vectors[a][h]};a.Evaluator.prototype.setMatrix=function(a,h,d,f){h=0>h?0:c(h);d=0>d?0:c(d);this.matrices[a][h][d]=f};a.Evaluator.prototype.getMatrix=function(a,h,d){h=0>h?0:c(h);d=0>d?0:c(d);return this.matrices[a][h][d]};a.Evaluator.prototype.setFunction=function(a,c){this.functions[a]=c};a.Evaluator.prototype.getFunction=function(a){return this.functions[a]};
a.Evaluator.prototype.evalExpression=function(a){return a?a.evaluate(this):0};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c=Math.floor,g=Math.max,h=2,d=!1,f,l,k,e,t,m,n,s,p,u,q,r,w,v,z,A,B,x,D,E,F,C,K,I,H,L,y;a.RTFNode=function(a,c,d,e){this.evaluator=a;this.type="rtfNode";this.value=c;this.nodeType=d;this.style=e;this.styleStr=e.toString();this.color=e.textColor;this.underline=e.textUnderline;this.overline=e.textOverline;this.parent=null;this.children=[];switch(this.nodeType){case "textBlock":this.draw=
this.drawTextBlock;break;case "textLineBlock":this.draw=this.drawTextLineBlock;break;case "formula":this.draw=this.drawFormula;break;case "superIndex":this.draw=this.drawSuperIndex;break;case "subIndex":this.draw=this.drawSubIndex;break;case "dynamicText":this.draw=this.drawDynamicText;this.decimal_symbol=this.evaluator.parent.decimal_symbol;break;case "fraction":this.draw=this.drawFraction;break;case "numerator":case "denominator":this.draw=this.drawNumDen;break;case "radical":this.draw=this.drawRadical;
break;case "limit":this.draw=this.drawLimit;break;case "integral":this.draw=this.drawIntegral;break;case "sum":this.draw=this.drawSum;break;case "matrix":this.draw=this.drawMatrix;break;case "defparts":this.draw=this.drawDefparts;break;case "text":case "newLine":this.draw=this.drawText;break;case "hyperlink":this.draw=this.drawHyperlink;break;case "mathSymbol":this.draw=this.drawMathSymbol;break;case "index":case "radicand":case "from":case "to":case "what":case "element":this.draw=this.drawGenericBlock;
break;case "componentNumCtrl":this.draw=this.drawComponentNumCtrl;break;case "componentSpace":this.draw=this.drawComponentSpace}};a.RTFNode.prototype.getRoot=function(){return null==this.parent?this:this.parent.getRoot()};a.RTFNode.prototype.addChild=function(a){a.parent=this;this.children.push(a)};var J=0,G=0,M=0;a.RTFNode.prototype.getTextMetrics=function(){this.spaceW=a.getTextWidth(" ",this.styleStr);switch(this.nodeType){case "textBlock":for(var c=0,y=this.children.length;c<y;c++)this.children[c].getTextMetrics();
break;case "textLineBlock":case "formula":this.getBlockMetric();break;case "newLine":f=a.getFontMetrics(this.styleStr);this.baseline=f.baseline;this.descent=f.descent;this.ascent=f.ascent;this.w=f.w;this.h=f.h;break;case "text":case "dynamicText":f=a.getFontMetrics(this.styleStr);this.baseline=f.baseline;this.descent=f.descent;this.ascent=f.ascent;e=this.value;"string"!=typeof this.value&&(l=void 0==this.decimals?h:this.evaluator.evalExpression(this.decimals),k=void 0==this.fixed?d:this.fixed,e=this.evaluator.evalExpression(this.value,
l,k),parseFloat(e)==e&&(e=parseFloat(e).toFixed(l),e=k?e:parseFloat(e),e=e.toString().replace(".",this.decimal_symbol)),e+=" ");this.w=a.getTextWidth(e,this.styleStr);this.h=f.h;break;case "hyperlink":f=a.getFontMetrics(this.styleStr);this.baseline=f.baseline;this.descent=f.descent;this.ascent=f.ascent;this.w=a.getTextWidth(this.value,this.styleStr);this.h=f.h;this.clickCacher=document.createElement("div");this.clickCacher.setAttribute("style","position: absolute; width: "+this.w+"px; height: "+this.h+
"px;");break;case "superIndex":p=J;u=G;q=M;metric=a.getFontMetrics(this.styleStr);this.getBlockMetric();0>this.h&&(this.ascent=metric.ascent,this.descent=metric.descent,this.h=this.ascent+this.descent,this.w=1.5*this.spaceW);t=q/2-u+this.h;this.superIndexPos=t-this.ascent;this.ascent=t;this.descent=u;this.baseline=this.ascent;this.h=this.ascent+this.descent;break;case "subIndex":p=J;u=G;q=M;metric=a.getFontMetrics(this.styleStr);this.getBlockMetric();0>this.h&&(this.ascent=metric.ascent,this.descent=
metric.descent,this.h=this.ascent+this.descent,this.w=1.5*this.spaceW);this.subIndexPos=u+1;this.ascent=p;this.descent=this.subIndexPos+this.descent;this.baseline=this.ascent;this.h=this.ascent+this.descent;break;case "fraction":p=J;u=G;q=M;r=this.children[0];w=this.children[1];metric=a.getFontMetrics(r.styleStr);r.getBlockMetric();w.getBlockMetric();0>r.h&&(r.h=metric.h,r.w=this.spaceW);0>w.h&&(w.h=metric.h,w.w=this.spaceW);this.h=r.h+w.h-1;this.ascent=r.h+q/2-u;this.descent=this.h-this.ascent;this.baseline=
this.ascent;this.w=g(r.w,w.w)+this.spaceW+8;break;case "radical":m=this.children[0].style.clone();if(1===this.children.length)this.children[1]=new a.RTFNode(this.evaluator,"","radicand",m),this.children[1].addChild(this.children[0]),this.children[0]=new a.RTFNode(this.evaluator,"","index",m);else if("index"!==this.children[0].nodeType||"radicand"!==this.children[1].nodeType){n=new a.RTFNode(this.evaluator,"","radicand",m);c=0;for(y=this.children.length;c<y;c++)n.addChild(this.children[c]);this.children=
[];this.children[0]=new a.RTFNode(this.evaluator,"","index",m);this.children[1]=n}v=this.children[0];z=this.children[1];v.getBlockMetric();z.getBlockMetric();this.ascent=z.h/2<v.h?z.h/2+v.h+2-z.descent:z.ascent+4;this.descent=z.descent;this.baseline=this.ascent;this.h=this.ascent+this.descent;this.w=v.w+z.w+4*this.spaceW;break;case "sum":p=J;u=G;q=M;A=this.children[0];B=this.children[1];x=this.children[2];A.getBlockMetric();B.getBlockMetric();x.getBlockMetric();-1==A.ascent&&(s=a.getFontMetrics(A.styleStr),
A.ascent=s.ascent,A.descent=s.descent,A.h=s.h);-1==B.ascent&&(s=a.getFontMetrics(B.styleStr),B.ascent=s.ascent,B.descent=s.descent,B.h=s.h);metric=a.getFontMetrics(this.styleStr);this.ascent=metric.h+B.h>x.ascent?metric.h-metric.descent+B.h:x.ascent;this.descent=A.h>x.descent?A.h+metric.descent:x.descent;this.baseline=this.ascent;this.h=this.ascent+this.descent;D=this.style.clone();D.fontType="Times New Roman";D.Bold="bold";D=D.toString();E=a.getTextWidth(String.fromCharCode(8721),D);this.w=g(A.w,
B.w,E)+g(x.w,this.spaceW)+this.spaceW;break;case "integral":p=J;u=G;q=M;A=this.children[0];B=this.children[1];x=this.children[2];A.getBlockMetric();B.getBlockMetric();x.getBlockMetric();-1==A.ascent&&(s=a.getFontMetrics(A.styleStr),A.ascent=s.ascent,A.descent=s.descent,A.h=s.h);-1==B.ascent&&(s=a.getFontMetrics(B.styleStr),B.ascent=s.ascent,B.descent=s.descent,B.h=s.h);metric=a.getFontMetrics(this.styleStr);this.ascent=metric.h+B.h>x.ascent?metric.h-metric.descent+B.h:x.ascent;this.descent=A.h>x.descent?
A.h+metric.descent:x.descent;this.baseline=this.ascent;this.h=this.ascent+this.descent;D=this.style.clone();D.fontSize*=1.5;D.fontType="Times New Roman";D.Bold="bold";D=D.toString();E=a.getTextWidth(String.fromCharCode(8747),D);this.w=g(A.w,B.w,E)+g(x.w,this.spaceW)+2*this.spaceW;break;case "limit":p=J;u=G;q=M;A=this.children[0];B=this.children[1];x=this.children[2];metric=a.getFontMetrics(this.styleStr);A.getBlockMetric();B.getBlockMetric();x.getBlockMetric();-1==A.ascent&&(s=a.getFontMetrics(A.styleStr),
A.ascent=s.ascent,A.descent=s.descent,A.h=s.h);-1==B.ascent&&(s=a.getFontMetrics(B.styleStr),B.ascent=s.ascent,B.descent=s.descent,B.h=s.h);-1==x.ascent&&(s=a.getFontMetrics(x.styleStr),x.ascent=s.ascent,x.descent=s.descent,x.h=s.h);this.ascent=x.ascent;this.descent=g(metric.h,x.descent);this.baseline=this.ascent;this.h=this.ascent+this.descent;0==A.w&&(A.w=this.spaceW);0==B.w&&(B.w=this.spaceW);0==x.w&&(x.w=this.spaceW);this.w=B.w+A.w+x.w+this.spaceW+a.getTextWidth(" "+String.fromCharCode(8594),
this.styleStr);break;case "matrix":metric=a.getFontMetrics(this.styleStr);p=J;u=G;q=M;K=metric.ascent;I=metric.descent;H=metric.h;L=this.spaceW;c=0;for(y=this.children.length;c<y;c++)this.children[c].getBlockMetric(),F=this.children[c].h,C=this.children[c].w,H<F&&(H=F,K=this.children[c].ascent,I=this.children[c].descent),L<C&&(L=C);this.childW=L+2*this.spaceW;this.childH=H;this.childAscent=K;this.childDescent=I;this.h=this.rows*H;this.ascent=this.h/2+u;this.descent=this.h-this.ascent;this.w=this.columns*
this.childW+this.spaceW;break;case "defparts":metric=a.getFontMetrics(this.styleStr);p=J;u=G;q=M;K=metric.ascent;I=metric.descent;H=metric.h;L=this.spaceW;c=0;for(y=this.children.length;c<y;c++)this.children[c].getBlockMetric(),F=this.children[c].h,C=this.children[c].w,H<F&&(H=F,K=this.children[c].ascent,I=this.children[c].descent),L<C&&(L=C);this.childW=L+2*this.spaceW;this.childH=H;this.childAscent=K;this.childDescent=I;this.h=this.parts*H;this.ascent=this.h/2+u;this.descent=this.h-this.ascent;
this.w=L+this.spaceW/2;break;case "mathSymbol":f=a.getFontMetrics(this.styleStr);this.baseline=f.baseline;this.descent=f.descent;this.ascent=f.ascent;this.w=a.getTextWidth(this.value,this.styleStr)+a.getTextWidth(" ",this.styleStr);this.h=f.h;break;case "componentNumCtrl":this.componentNumCtrl=this.evaluator.parent.getControlByCId(this.value);this.h=this.ascent=this.descent=this.baseline=0;this.w=this.componentNumCtrl.w;break;case "componentSpace":this.componentSpace=this.evaluator.parent.getSpaceByCId(this.value);
this.h=this.ascent=this.descent=this.baseline=0;this.w=this.componentSpace.w;break;default:console.log("Element i=unknown",this.nodeType)}};a.RTFNode.prototype.getBlockMetric=function(){this.w=0;K=I=-1;for(var a=0,c=this.children.length;a<c;a++){y=this.children[a];y.getTextMetrics();childAscent=y.ascent;childDescent=y.descent;this.w+=y.w;var d=childDescent,e=y.h;J=childAscent;G=d;M=e;K<childAscent&&(K=childAscent);I<childDescent&&(I=childDescent)}this.ascent=K;this.descent=I;this.baseline=this.ascent;
this.h=this.ascent+this.descent};a.RTFNode.prototype.drawTextBlock=function(a,c,e,f,g,k,l){this.stablew||(this.getTextMetrics(),h=f,d=g);l=l?-this.children[0].ascent:0;g=f=0;for(k=this.children.length;g<k;g++)0<g&&(f+=this.children[g-1].h),this.children[g].draw(a,c+0,e+l+f)};a.RTFNode.prototype.drawTextLineBlock=function(c,d,e){for(var h=0,f=0,g=this.children.length;f<g;f++)0<f&&(h+=this.children[f-1].w,"formula"==this.children[f-1].nodeType&&(h+=2*a.getTextWidth(" ",this.children[f].styleStr))),
this.children[f].draw(c,d+h,e+this.baseline)};a.RTFNode.prototype.drawFormula=function(a,c,d){for(var e=0,h=0,f=this.children.length;h<f;h++)0<h&&(e+=this.children[h-1].w),this.children[h].draw(a,c+this.spaceW+e,d)};a.RTFNode.prototype.drawText=function(a,c,d){null!==this.color&&(a.fillStyle=this.color);a.font=this.styleStr;a.textAlign="start";a.textBaseline="alphabetic";a.fillText(this.value,c-1,d);if(this.underline){var e="bold"==this.style.textBold,h=e?1:0.5;a.linew=e?2:1;null!=this.color&&(a.strokeStyle=
this.color);a.beginPath();a.moveTo(c-1,parseInt(d+this.descent/2)+h);a.lineTo(c-1+this.w,parseInt(d+this.descent/2)+h);a.stroke()}this.overline&&(h=(e="bold"==this.style.textBold)?2:1.5,a.linew=e?2:1,null!=this.color&&(a.strokeStyle=this.color),a.beginPath(),a.moveTo(c-1,parseInt(d-this.ascent)+h),a.lineTo(c-1+this.w,parseInt(d-this.ascent)+h),a.stroke())};a.RTFNode.prototype.drawDynamicText=function(f,g,m){var n=c(0.5*this.spaceW);l=void 0==this.decimals?h:this.evaluator.evalExpression(this.decimals);
k=void 0==this.fixed?d:this.fixed;e=this.evaluator.evalExpression(this.value);parseFloat(e)==e&&(e=k?parseFloat(e).toFixed(l):parseFloat(parseFloat(e).toFixed(l)),e=(""+e).replace(".",this.decimal_symbol));null!=this.color&&(f.fillStyle=this.color);f.font=this.styleStr;f.textAlign="start";f.textBaseline="alphabetic";this.w=a.getTextWidth(e,this.styleStr);f.fillText(e,n+g,m);if(this.underline){var p="bold"==this.style.textBold,r=p?1:0.5;f.linew=p?2:1;null!=this.color&&(f.strokeStyle=this.color);f.beginPath();
f.moveTo(n+g-1,parseInt(m+this.descent/2)+r);f.lineTo(n+g-1+this.w,parseInt(m+this.descent/2)+r);f.stroke()}this.overline&&(r=(p="bold"==this.style.textBold)?2:1.5,f.linew=p?2:1,null!=this.color&&(f.strokeStyle=this.color),f.beginPath(),f.moveTo(n+g-1,parseInt(m-this.ascent)+r),f.lineTo(n+g-1+this.w,parseInt(m-this.ascent)+r),f.stroke());this.w+=2*n};a.RTFNode.prototype.drawHyperlink=function(a,c,d){a.save();this.click?(a.fillStyle="red",a.strokeStyle="red"):(a.fillStyle="blue",a.strokeStyle="blue");
a.font=this.styleStr;a.textAlign="start";a.textBaseline="alphabetic";a.fillText(this.value,c-1,d);var e="bold"==this.style.textBold,h=e?1:0.5;a.linew=e?2:1;a.beginPath();a.moveTo(c-1,parseInt(d+this.descent/2)+h);a.lineTo(c-1+this.w,parseInt(d+this.descent/2)+h);a.stroke();a.restore()};a.RTFNode.prototype.drawRadical=function(a,d,e){var h=c(this.spaceW);this.children[0].draw(a,d,c(e+this.children[1].descent-this.children[1].h/2-this.children[0].descent));this.children[1].draw(a,d+1.5*h+this.children[0].w,
e);a.linew=1;null!=this.color&&(a.strokeStyle=this.color);a.beginPath();a.moveTo(d,c(e+this.children[1].descent-this.children[1].h/2));a.lineTo(d+this.children[0].w,c(e+this.children[1].descent-this.children[1].h/2));a.lineTo(d+this.children[0].w+0.5*h,e+this.children[1].descent);a.lineTo(d+this.children[0].w+1*h,e-this.children[1].ascent);a.lineTo(d+this.children[0].w+2*h+this.children[1].w,e-this.children[1].ascent);a.stroke()};a.RTFNode.prototype.drawFraction=function(a,d,e){this.children[0].draw(a,
d+(this.w-this.children[0].w)/2,e-this.ascent);this.children[1].draw(a,d+(this.w-this.children[1].w)/2,e-this.ascent+this.children[0].h-1);var h=c(0.5*this.spaceW);a.linew=1;null!=this.color&&(a.strokeStyle=this.color);a.beginPath();a.moveTo(d+h,parseInt(e-this.ascent+this.children[0].h)+0.5);a.lineTo(d-h+this.w-1,parseInt(e-this.ascent+this.children[0].h)+0.5);a.stroke()};a.RTFNode.prototype.drawNumDen=function(a,c,d){for(var e=0,h=0,f=this.children.length;h<f;h++)0<h&&(e+=this.children[h-1].w),
this.children[h].draw(a,c+e,d+this.baseline)};a.RTFNode.prototype.drawSubIndex=function(a,c,d){for(var e=0,h=0,f=this.children.length;h<f;h++)0<h&&(e+=this.children[h-1].w),this.children[h].draw(a,c+e,d+this.subIndexPos)};a.RTFNode.prototype.drawSuperIndex=function(a,c,d){for(var e=0,h=0,f=this.children.length;h<f;h++)0<h&&(e+=this.children[h-1].w),this.children[h].draw(a,c+e,d-this.superIndexPos)};a.RTFNode.prototype.drawLimit=function(c,d,e){var h=a.getFontMetrics(this.styleStr),f=" "+String.fromCharCode(8594);
E=a.getTextWidth(f,this.styleStr);this.children[0].draw(c,d,e+h.descent+this.children[0].ascent);this.children[1].draw(c,d+this.children[0].w+E,e+h.descent+this.children[1].ascent);this.children[2].draw(c,d+E+this.children[0].w+this.children[1].w,e);null!=this.color&&(c.fillStyle=this.color);c.font=this.styleStr;c.textAlign="start";c.textBaseline="alphabetic";c.fillText("l\u00edm",d+this.children[0].w,e);c.fillText(f,d+this.children[0].w,e+h.descent+this.children[0].ascent)};a.RTFNode.prototype.drawIntegral=
function(d,e,h){D=this.style.clone();D.fontSize*=1.5;D.fontType="Times New Roman";D.Bold="bold";D=D.toString();E=a.getTextWidth(String.fromCharCode(8747),D);var f=a.getFontMetrics(D);L=g(this.children[0].w,this.children[1].w,c(1.5*E));this.children[0].draw(d,e+E,h+f.descent+this.children[0].ascent);this.children[1].draw(d,e+E+this.spaceW/2,h-this.ascent+this.children[1].ascent);this.children[2].draw(d,e+L+E,h);null!=this.color&&(d.fillStyle=this.color);d.font=D;d.textAlign="start";d.textBaseline=
"alphabetic";d.fillText(String.fromCharCode(8747),e,h+f.descent/2)};a.RTFNode.prototype.drawSum=function(d,e,h){D=this.style.clone();D.fontType="Times New Roman";D.Bold="bold";D=D.toString();E=a.getTextWidth(String.fromCharCode(8721),D);var f=a.getFontMetrics(this.styleStr);L=g(this.children[0].w,this.children[1].w,E);this.children[0].draw(d,e+(L-this.children[0].w)/2,h+f.descent+this.children[0].ascent);this.children[1].draw(d,e+(L-this.children[1].w)/2,h-f.ascent-this.children[1].descent);this.children[2].draw(d,
e+L,h);null!=this.color&&(d.fillStyle=this.color);d.font=D;d.textAlign="start";d.textBaseline="alphabetic";d.fillText(String.fromCharCode(8721),e+c((L-E)/2),h-5)};a.RTFNode.prototype.drawMatrix=function(a,d,e){for(var h,f,g=0,k=this.children.length;g<k;g++)h=g%this.columns,f=c(g/this.columns),this.children[g].draw(a,2*this.spaceW+d+h*this.childW,e-this.ascent+this.childAscent+f*this.childH);a.linew=1;null!=this.color&&(a.strokeStyle=this.color);a.beginPath();a.moveTo(c(d+this.spaceW)+0.5,e-this.ascent+
0.5);a.lineTo(c(d+this.spaceW/2)+0.5,e-this.ascent+0.5);a.lineTo(c(d+this.spaceW/2)+0.5,e+this.descent+0.5);a.lineTo(c(d+this.spaceW)+0.5,e+this.descent+0.5);a.moveTo(c(d+this.w-this.spaceW)-0.5,e-this.ascent+0.5);a.lineTo(c(d+this.w-this.spaceW/2)-0.5,e-this.ascent+0.5);a.lineTo(c(d+this.w-this.spaceW/2)-0.5,e+this.descent+0.5);a.lineTo(c(d+this.w-this.spaceW)-0.5,e+this.descent+0.5);a.stroke()};a.RTFNode.prototype.drawDefparts=function(a,d,e){for(var h=0,f=this.children.length;h<f;h++)this.children[h].draw(a,
d+this.spaceW/4,e-this.ascent+this.childAscent+h%this.parts*this.childH);a.linew=1;null!=this.color&&(a.strokeStyle=this.color);a.beginPath();a.moveTo(c(d+this.spaceW/3)+0.5,e-this.ascent+0.5);a.lineTo(c(d+this.spaceW/6)+0.5,e-this.ascent+0.5+(this.spaceW/3-this.spaceW/6));a.lineTo(c(d+this.spaceW/6)+0.5,e+this.descent-this.h/2-(this.spaceW/3-this.spaceW/6));a.lineTo(d+0.5,e+this.descent-this.h/2);a.lineTo(c(d+this.spaceW/6)+0.5,e+this.descent-this.h/2+(this.spaceW/3-this.spaceW/6));a.lineTo(c(d+
this.spaceW/6)+0.5,e+this.descent+0.5-(this.spaceW/3-this.spaceW/6));a.lineTo(c(d+this.spaceW/3)+0.5,e+this.descent+0.5);a.stroke()};a.RTFNode.prototype.drawMathSymbol=function(a,c,d){a.linew=1;null!=this.color&&(a.strokeStyle=this.color,a.fillStyle=this.color);a.beginPath();"("==this.value?(a.font=this.styleStr,a.textAlign="start",a.textBaseline="alphabetic",a.fillText("(",c,d)):")"==this.value?(a.font=this.styleStr,a.textAlign="start",a.textBaseline="alphabetic",a.fillText(")",c+this.spaceW,d)):
(a.font=this.styleStr,a.textAlign="center",a.textBaseline="alphabetic",a.fillText(this.value,c+this.w/2,d))};a.RTFNode.prototype.drawGenericBlock=function(a,c,d){for(var e=0,h=0,f=this.children.length;h<f;h++)0<h&&(e+=this.children[h-1].w),this.children[h].draw(a,c+e,d)};a.RTFNode.prototype.drawComponentNumCtrl=function(a,c,d){this.getTextMetrics();this.componentNumCtrl.expresion=this.evaluator.parser.parse("("+c+","+(d-this.parent.ascent)+","+this.componentNumCtrl.w+","+this.componentNumCtrl.h+")")};
a.RTFNode.prototype.drawComponentSpace=function(a,c,d){this.getTextMetrics();this.componentSpace.xExpr=this.evaluator.parser.parse(c+"");this.componentSpace.yExpr=this.evaluator.parser.parse(d-this.parent.ascent+"")};a.RTFNode.prototype.draw=function(a,c,d){console.log(">>> Dibujo desconocido ",this.nodeType);this.children[0].draw(a,c,d)};a.RTFNode.prototype.toHTML=function(){var a="";if("textLineBlock"===this.nodeType||"textBlock"===this.nodeType)for(var c=0,d=this.children.length;c<d;c++)a+=this.children[c].toHTML();
else"text"===this.nodeType?a="<span "+this.style.toCSS()+">"+this.value+"</span>":"newLine"===this.nodeType?a="<span "+this.style.toCSS()+">"+this.value+"<br /></span>":console.log(">>><<<",this);return a};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c=String.fromCharCode,g,h,d,f,l,k,e,t,m,n,s;a.RTFTokenizer=function(){};a.RTFTokenizer.prototype.tokenize=function(a){if(a)a=a.replace(/\&quote;/g,"''").replace(/\\rquote /g,"'").replace(/\\endash /g,"-").replace(/\n/g,
" ").replace(/\r/g,"").replace(/\\uc(\d+) /g,"").replace(/\\uc(\d+)/g,"");else return[];g=[];h=a.length;g=[];d="";l=f=0;e=a.charAt(0);t=!1;for(m="text";f<h;)k=e,e=a.charAt(f+1),t?"\\"===e||"{"===e||"}"===e||" "===e||";"===e?(t=!1,d+=k," "===e&&(f++,e=a.charAt(f+1)),(n=d.match(/^\'([0-9a-f]{2})/))?(s="","text"===m&&(s=g.pop().value),d=s+=c(parseInt(n[1],16))+d.substring(3)):(n=d.match(/^u[0-9]+/))?(s="","text"===m&&(s=g.pop().value),d=s+=c(n[0].substring(1))):(g.push({type:"controlWord",value:d}),
m="controlWord",d="")):d+=k:"\\"===k?(t=!0,""!==d&&(g.push({type:"text",value:d}),m="text"),d=""):"{"===k?(l++,""!==d&&g.push({type:"text",value:d}),d="",g.push({type:"openBlock",value:l}),m="openBlock"):"}"===k?(""!==d&&g.push({type:"text",value:d}),d="",g.push({type:"closeBlock",value:l}),m="closeBlock",l--):""===d&&" "===k&&"controlWord"===m?m="text":d+=k,f++;""!==d&&g.push({type:"text",value:d});return g};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c,g,h,d,f,l,
k,e,t,m,n,s,p,u,q,r,w,v,z,A,B,x,D,E,F,C,K,I,H,L;a.RTFParser=function(c){this.evaluator=c;this.tokenizer=new a.RTFTokenizer};a.RTFParser.prototype.parse=function(y){y=c=this.tokenizer.tokenize(y);for(var J=[],G=!1,M=!1,N=[],O=0,S=y.length;O<S;O++){"openBlock"==y[O].type&&N.push(y[O].value);"closeBlock"==y[O].type&&(N.pop(),0>=N.length&&(G=!1));if("controlWord"==y[O].type&&("expr"==y[O].value||"decimals"==y[O].value))M=!0;"controlWord"==y[O].type&&"mjaformula"==y[O].value&&(G=!0);if("text"==y[O].type&&
G&&!M){for(var T=0,Q=y[O].value,R="",P=0,W=Q.length;P<W;P++)if("("==Q.charAt(P)||")"==Q.charAt(P)||"+"==Q.charAt(P)||"-"==Q.charAt(P)||"*"==Q.charAt(P)||"="==Q.charAt(P))R=Q.substring(T,P),""!=R&&J.push({type:"text",value:R}),J.push({type:Q.charAt(P),value:Q.charAt(P)}),T=P+1;R=Q.substring(T,P);""!=R&&J.push({type:"text",value:R})}else J.push(y[O]),"text"==y[O].type&&M&&(M=!1)}c=J;g={};d=2;if("openBlock"==c[0].type&&"fonttbl"==c[1].value){for(h=c[0].value;"closeBlock"!=c[d].type&&c[d].value!=h;)g[c[d].value]=
c[d+2].value.substring(0,c[d+2].value.length-1),d+=3;d++}f={};l=0;if("openBlock"==c[d].type&&"colortbl"==c[d+1].value){h=c[d++].value;for(d++;"closeBlock"!=c[d].type&&c[d].value!=h;)k=parseInt(c[d++].value.substring(3)).toString(16),e=parseInt(c[d++].value.substring(5)).toString(16),t=parseInt(c[d++].value.substring(4)).toString(16),";"===c[d].value&&d++,f[l++]="#"+(2>k.length?"0"+k:k)+(2>e.length?"0"+e:e)+(2>t.length?"0"+t:t);d++}m=new a.RTFNode(this.evaluator,"","textBlock","",!1,"");n=new a.RTFNode(this.evaluator,
"","textLineBlock","",!1,"");m.addChild(n);u=p=s=null;A=z=v=w=r=q=!1;B=[new a.FontStyle(20,"Arial","","",!1,!1,null)];x=B[0];D=!0;F=E=-1;C=[];L=H=I=K=!1;y=d;for(J=c.length;y<J;y++)if("controlWord"==c[y].type&&g[c[y].value])x.fontType=g[c[y].value];else if("controlWord"==c[y].type&&c[y].value.match(/^fs(\d+)/))x.fontSize=parseInt(c[y].value.match(/^fs(\d+)/)[1]/2);else if("controlWord"==c[y].type&&"b"==c[y].value)x.textBold="bold";else if("controlWord"==c[y].type&&"b0"==c[y].value)x.textBold="";else if("controlWord"==
c[y].type&&"i"==c[y].value)x.textItalic="italic";else if("controlWord"==c[y].type&&"i0"==c[y].value)x.textItalic="";else if("controlWord"==c[y].type&&"ul"==c[y].value)x.textUnderline=!0;else if("controlWord"==c[y].type&&"ulnone"==c[y].value)x.textUnderline=!1;else if("controlWord"==c[y].type&&"ol"==c[y].value)x.textOverline=!0;else if("controlWord"==c[y].type&&"olnone"==c[y].value)x.textOverline=!1;else if("controlWord"==c[y].type&&c[y].value.match(/^cf(\d+)/))x.textColor=f[parseInt(c[y].value.substring(2))];
else if("openBlock"==c[y].type)E=c[y].value,x=x.clone(),B.push(x),C.push(null);else if("closeBlock"==c[y].type)c[y].value==F&&(F=-1,q=!1,n=n.parent),B.pop(),x=B[B.length-1],C.pop();else if("controlWord"==c[y].type&&"par"==c[y].value){n.addChild(new a.RTFNode(this.evaluator,"","newLine",x.clone()));m=new a.RTFNode(this.evaluator,"","textLineBlock",x.clone());if("textBlock"!=n.nodeType)for(n=n.parent;"textBlock"!=n.nodeType;)n=n.parent;n.addChild(m);n=m}else if("controlWord"==c[y].type&&"mjaformula"==
c[y].value)K=!0,F=E,q=!0,m=new a.RTFNode(this.evaluator,"","formula",x.clone()),n.addChild(m),n=m,C[C.length-1]=m;else if("controlWord"==c[y].type&&("fraction"==c[y].value||"radicand"==c[y].value||"radical"==c[y].value||"what"==c[y].value||"sum"==c[y].value||"integral"==c[y].value||"limit"==c[y].value))G=C[C.length-2].style.clone(),m=new a.RTFNode(this.evaluator,"",c[y].value,G),C[C.length-2].addChild(m),C[C.length-1]=m;else if("controlWord"==c[y].type&&"index"==c[y].value||"to"==c[y].value||"from"==
c[y].value)G=C[C.length-2].style.clone(),G.fontSize=parseInt(G.fontSize-0.2*G.fontSize),8>G.fontSize&&(G.fontSize=8),m=new a.RTFNode(this.evaluator,"",c[y].value,G),C[C.length-2].addChild(m),C[C.length-1]=m;else if("controlWord"==c[y].type&&("num"==c[y].value||"den"==c[y].value))G=C[C.length-2].style.clone(),G.fontSize=Math.round(G.fontSize-0.1*G.fontSize),8>G.fontSize&&(G.fontSize=8),"num"==c[y].value?m=new a.RTFNode(this.evaluator,"","numerator",G):"den"==c[y].value&&(m=new a.RTFNode(this.evaluator,
"","denominator",G)),C[C.length-2].addChild(m),C[C.length-1]=m;else if("controlWord"==c[y].type&&("subix"==c[y].value||"supix"==c[y].value))G=C[C.length-2].style.clone(),G.fontSize=Math.floor(G.fontSize-G.fontSize/3),8>G.fontSize&&(G.fontSize=8),"subix"==c[y].value?m=new a.RTFNode(this.evaluator,"","subIndex",G):"supix"==c[y].value&&(m=new a.RTFNode(this.evaluator,"","superIndex",G)),m.originalStyle=C[C.length-2].style.clone(),C[C.length-2].addChild(m),C[C.length-1]=m;else if("controlWord"==c[y].type&&
("defparts"==c[y].value||"matrix"==c[y].value||"element"==c[y].value))G=C[C.length-2].style.clone(),m=new a.RTFNode(this.evaluator,"",c[y].value,G),C[C.length-2].addChild(m),C[C.length-1]=m,"defparts"==c[y].value?u=m:"matrix"==c[y].value&&(p=m);else if("controlWord"==c[y].type&&"parts"==c[y].value)A=!0;else if("text"==c[y].type&&A)u.parts=parseInt(c[y].value),A=!1;else if("controlWord"==c[y].type&&"rows"==c[y].value)v=!0;else if("text"==c[y].type&&v)p.rows=parseInt(c[y].value),v=!1;else if("controlWord"==
c[y].type&&"columns"==c[y].value)z=!0;else if("text"==c[y].type&&z)p.columns=parseInt(c[y].value),z=!1;else if("controlWord"==c[y].type&&"expr"==c[y].value)D=!1,r=!0;else if("controlWord"==c[y].type&&"decimals"==c[y].value)w=!0;else if("text"==c[y].type&&w)s.decimals=this.evaluator.parser.parse(parseInt(c[y].value)+""),w=!1;else if("controlWord"==c[y].type&&"fixed1"==c[y].value)s.fixed=!0;else if("controlWord"==c[y].type&&"fixed0"==c[y].value)s.fixed=!1;else if(!("controlWord"==c[y].type&&"component"==
c[y].value))if("controlWord"==c[y].type&&"NumCtrl"==c[y].value)I=!0;else if("controlWord"==c[y].type&&"Space"==c[y].value)H=!0;else if("controlWord"==c[y].type&&"hyperlink"==c[y].value)L=!0;else if("text"==c[y].type&&L){textContent=c[y].value.split("|")[0];G=x.clone();m=new a.RTFNode(this.evaluator,textContent,"hyperlink",G);if("textLineBlock"!=n.nodeType)for(n=n.parent;"textLineBlock"!=n.nodeType;)n=n.parent;n.addChild(m);L=!1}else if("text"==c[y].type&&I)m=new a.RTFNode(this.evaluator,c[y].value,
"componentNumCtrl",x.clone()),n.addChild(m),I=!1;else if("text"==c[y].type&&H)m=new a.RTFNode(this.evaluator,c[y].value,"componentSpace",x.clone()),n.addChild(m),H=!1;else if("text"==c[y].type&&r)G=C[C.length-2].style.clone(),textContent=this.evaluator.parser.parse(c[y].value),m=new a.RTFNode(this.evaluator,textContent,"dynamicText",G),C[C.length-2].addChild(m),s=C[C.length-1]=m,r=!1;else if("text"==c[y].type&&!r&&!q){textContent=c[y].value;m=new a.RTFNode(this.evaluator,textContent,"text",x.clone());
if("textLineBlock"!=n.nodeType)for(n=n.parent;"textLineBlock"!=n.nodeType;)n=n.parent;n.addChild(m)}else if("text"==c[y].type&&!r&&q)textContent=c[y].value,m=new a.RTFNode(this.evaluator,textContent,"text",C[C.length-1].style.clone()),C[C.length-1].addChild(m);else if("("==c[y].type||")"==c[y].type)G=C[C.length-1].style.clone(),G.textItalic="",m=new a.RTFNode(this.evaluator,c[y].type,"mathSymbol",G),C[C.length-1].addChild(m);else if("+"==c[y].type||"-"==c[y].type||"*"==c[y].type||"="==c[y].type)m=
new a.RTFNode(this.evaluator,c[y].type,"mathSymbol",C[C.length-1].style.clone()),C[C.length-1].addChild(m);if(null!=n){var U=n.getRoot();U.stableWidth=D;U.getTextMetrics();U.hasFormula=K}return U};a.FontStyle=function(a,c,d,e,h,f,g){this.fontSize=a;this.fontType=c;this.textItalic=d;this.textBold=e;this.textUnderline=h;this.textOverline=f;this.textColor=g};a.FontStyle.prototype.toString=function(){return(this.textBold+" "+this.textItalic+" "+this.fontSize+"px "+this.fontType).trim()};a.FontStyle.prototype.toCSS=
function(){var a="style='font: "+this.fontSize+"px "+this.fontType+"; ";this.textUnderline&&!this.textOverline&&(a+="text-decoration: underline; ");!this.textUnderline&&this.textOverline&&(a+="text-decoration: overline; ");this.textUnderline&&this.textOverline&&(a+="text-decoration: underline overline; ");this.textBold&&!this.textItalic&&(a+="font-style: normal; font-weight: bold; ");!this.textBold&&this.textItalic&&(a+="font-style: italic; font-weight: normal; ");this.textBold&&this.textItalic&&
(a+="font-style: italic; font-weight: bold; ");!this.textBold&&!this.textItalic&&(a+="font-style: normal; font-weight: normal; ");this.textColor&&(a+="color: "+this.textColor+"; ");return a+"'"};a.FontStyle.prototype.clone=function(){return new a.FontStyle(this.fontSize,this.fontType,this.textItalic,this.textBold,this.textUnderline,this.textOverline,this.textColor)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c,g,h,d,f,l,k,e,t,m,n,s,p,u,q;a.Space=function(c,d){this.parent=
c;g=this.evaluator=this.parent.evaluator;h=g.parser;this.values=d;this.type="R2";this.xExpr=h.parse("0");this.yExpr=h.parse("0");this.w=parseInt(c.container.width);this.h=parseInt(c.container.height);this.drawif=h.parse("1");this.fixed=2!=c.version?!1:!0;this.scale=48;this.Oy=this.Ox=0;this.image=new Image;this.image.onload=function(){this.ready=1};this.imageSrc="";this.bg_display="topleft";this.background="descinst.com.mja.descartes.DescartesJS.class"===c.code||c.arquimedes?new a.Color("f0f8fa"):
new a.Color("ffffff");this.net=2!=c.version?new a.Color("c0c0c0"):"";this.net10=2!=c.version?new a.Color("808080"):"";this.axes=2!=c.version?new a.Color("808080"):"";this.text=new a.Color("ffafaf");this.numbers=!1;this.x_axis=2!=c.version?"":" ";this.y_axis=2!=c.version?"":" ";this.sensitive_to_mouse_movements=!1;this.cID="";this.mouse_y=this.mouse_x=0;this.ctrs=[];this.graphicsCtr=[];this.graphics=[];this.backgroundGraphics=[];this.zIndex=c.zIndex;this.plecaHeight=c.plecaHeight||0;this.displaceRegionNorth=
c.displaceRegionNorth||0;this.displaceRegionWest=c.displaceRegionWest||0;for(var e in d)d.hasOwnProperty(e)&&(this[e]=d[e]);this.init()};a.Space.prototype.init=function(){c=this.parent;g=this.evaluator;d=this.id;this.displaceRegionNorth=c.displaceRegionNorth||0;this.displaceRegionWest=c.displaceRegionWest||0;k=parseInt(c.container.height);e=parseInt(c.container.width);g.setVariable(d+"._w",this.w);g.setVariable(d+"._h",this.h);this.x=g.evalExpression(this.xExpr)+this.displaceRegionWest;this.y=g.evalExpression(this.yExpr)+
this.plecaHeight+this.displaceRegionNorth;this.container&&(this.container.style.left=this.x+"px",this.container.style.top=this.y+"px");0<=this.y?(f=k-this.y,this.h>f&&(this.h=f)):(f=this.h+this.y,this.h=f>=k?k:f);0<=this.x?(l=e-this.x,this.w>l&&(this.w=l)):(l=this.w+this.x,this.w=l>=e?e:l);if(""!=this.imageSrc||!this.imageSrc.trim().toLowerCase().match(/vacio.gif$/))this.image=c.getImage(this.imageSrc);this.OxExpr&&(m=this.OxExpr,"%"===m[m.length-1]?this.Ox=this.w*parseFloat(m)/100:(t=parseFloat(m),
t!=m&&(t=0),this.Ox=t));this.OyExpr&&(n=this.OyExpr,"%"===n[n.length-1]?this.Oy=this.h*parseFloat(n)/100:(t=parseFloat(n),t!=n&&(t=0),this.Oy=t));2!==c.version?(g.setVariable(d+"._w",this.w),g.setVariable(d+"._h",this.h),g.setVariable(d+".escala",this.scale),g.setVariable(d+".Ox",this.Ox),g.setVariable(d+".Oy",this.Oy),g.setVariable(d+".mouse_x",0),g.setVariable(d+".mouse_y",0),g.setVariable(d+".mouse_pressed",0)):(t=g.getVariable("_w"),void 0===t&&(t=this.w),g.setVariable("_w",t),t=g.getVariable("_h"),
void 0===t&&(t=this.h),g.setVariable("_h",t),t=g.getVariable("escala"),void 0===t&&(t=this.scale),g.setVariable("escala",t),t=g.getVariable("Ox"),void 0===t&&(t=this.Ox),g.setVariable("Ox",t),t=g.getVariable("Oy"),void 0===t&&(t=this.Oy),g.setVariable("Oy",t),g.setVariable("mouse_x",0),g.setVariable("mouse_y",0),g.setVariable("mouse_pressed",0),""===this.x_axis&&""===this.y_axis&&(this.axes=""));this.w_2=this.w/2;this.h_2=this.h/2};a.Space.prototype.addCtr=function(a){"graphic"===a.type?this.graphicsCtr.push(a):
this.ctrs.push(a)};a.Space.prototype.addGraph=function(a){a.background?this.backgroundGraphics.push(a):this.graphics.push(a)};a.Space.prototype.getRelativeX=function(a){return(a-this.w_2-this.Ox)/this.scale};a.Space.prototype.getRelativeY=function(a){return(-a+this.h_2+this.Oy)/this.scale};a.Space.prototype.getAbsoluteX=function(a){return a*this.scale+this.w_2+this.Ox};a.Space.prototype.getAbsoluteY=function(a){return-a*this.scale+this.h_2+this.Oy};a.Space.prototype.findOffset=function(){s=this.container;
this.offsetTop=this.offsetLeft=0;p=this.container.style.display;for(this.container.style.display="block";s;){u=null;s.getAttribute&&(u=s.getAttribute("class"));if(u&&("DescartesSpace2DContainer"===u||"DescartesSpace3DContainer"===u||"DescartesAppContainer"===u))this.offsetLeft+=s.offsetLeft||0,this.offsetTop+=s.offsetTop||0;s=s.parentNode}this.container.style.display=p};a.Space.prototype.getCursorPosition=function(c){q=a.getCursorPosition(c);return{x:q.x-this.offsetLeft,y:q.y-this.offsetTop}};return a}(descartesJS||
{}),descartesJS=function(a){var c,g;if(a.loadLib)return a;var h=Math.floor,d=Math.round,f=2*Math.PI,l=a.convertFont("SansSerif,PLAIN,12"),k=a.convertFont("Monospaced,PLAIN,12"),e,t,m,n,s,p,u,q,r,w,v,z,A,B,x,D,E,F,C,K,I,H,L,y,J,G,M,N,O;a.Space2D=function(c,d){a.Space.call(this,c,d);e=this;e.backgroundCanvas=document.createElement("canvas");e.backgroundCanvas.setAttribute("id",e.id+"_background");e.backgroundCanvas.setAttribute("width",e.w+"px");e.backgroundCanvas.setAttribute("height",e.h+"px");e.backgroundCtx=
e.backgroundCanvas.getContext("2d");e.backgroundCtx.imageSmoothingEnabled=!1;e.backgroundCtx.mozImageSmoothingEnabled=!1;e.backgroundCtx.webkitImageSmoothingEnabled=!1;e.canvas=document.createElement("canvas");e.canvas.setAttribute("id",e.id+"_canvas");e.canvas.setAttribute("width",e.w+"px");e.canvas.setAttribute("height",e.h+"px");e.canvas.setAttribute("class","DescartesSpace2DCanvas");e.canvas.setAttribute("style","z-index: "+e.zIndex+";");e.ctx=e.canvas.getContext("2d");e.ctx.imageSmoothingEnabled=
!1;e.ctx.mozImageSmoothingEnabled=!1;e.ctx.webkitImageSmoothingEnabled=!1;e.graphicControlContainer=document.createElement("div");e.graphicControlContainer.setAttribute("id",e.id+"_graphicControls");e.graphicControlContainer.setAttribute("style","position: absolute; left: 0px; top: 0px; z-index: "+e.zIndex+";");e.numericalControlContainer=document.createElement("div");e.numericalControlContainer.setAttribute("id",e.id+"_numericalControls");e.numericalControlContainer.setAttribute("style","position: absolute; left: 0px; top: 0px; z-index: "+
e.zIndex+";");e.container=document.createElement("div");e.container.setAttribute("id",e.id);e.container.setAttribute("class","DescartesSpace2DContainer");e.container.setAttribute("style","left: "+e.x+"px; top: "+e.y+"px; z-index: "+e.zIndex+";");e.parent.arquimedes&&"#f0f8fa"===e.background.getColor()&&(e.container.style.border="1px solid #b8c4c8");e.container.appendChild(e.backgroundCanvas);e.container.appendChild(e.canvas);e.container.appendChild(e.graphicControlContainer);e.container.appendChild(e.numericalControlContainer);
c.container.insertBefore(e.container,c.loader);e.parent.images[e.id+".image"]=e.canvas;e.parent.images[e.id+".image"].ready=1;e.parent.images[e.id+".image"].complete=!0;e.evaluator.setVariable(e.id+".image",e.id+".image");e.parent.images[e.id+".back"]=e.backgroundCanvas;e.parent.images[e.id+".back"].ready=1;e.parent.images[e.id+".back"].complete=!0;e.evaluator.setVariable(e.id+".back",e.id+".back");e.OxString=2!==c.version?e.id+".Ox":"Ox";e.OyString=2!==c.version?e.id+".Oy":"Oy";e.scaleString=2!==
c.version?e.id+".escala":"escala";e.wString=e.id+"._w";e.hString=e.id+"._h";"descartesJS_scenario"!==e.id&&e.registerMouseAndTouchEvents()};a.extend(a.Space2D,a.Space);a.Space2D.prototype.init=function(){e=this;e.uber.init.call(e);e.canvas&&(e.backgroundCanvas.setAttribute("width",e.w+"px"),e.backgroundCanvas.setAttribute("height",e.h+"px"),e.canvas.setAttribute("width",e.w+"px"),e.canvas.setAttribute("height",e.h+"px"));e.container&&e.findOffset()};a.Space2D.prototype.update=function(a){e=this;t=
e.evaluator;m=e.parent;t.setVariable(e.wString,e.w);t.setVariable(e.hString,e.h);e.drawIfValue=0<t.evalExpression(e.drawif);if(e.drawIfValue){s=e.x!==t.evalExpression(e.xExpr)+e.displaceRegionWest;p=e.y!==t.evalExpression(e.yExpr)+m.plecaHeight+e.displaceRegionNorth;e.spaceChange=a||s||p||e.drawBefore!==e.drawIfValue||e.Ox!==t.getVariable(e.OxString)||e.Oy!==t.getVariable(e.OyString)||e.scale!==t.getVariable(e.scaleString);e.x=s?t.evalExpression(e.xExpr)+e.displaceRegionWest:e.x;e.y=p?t.evalExpression(e.yExpr)+
m.plecaHeight+e.displaceRegionNorth:e.y;e.Ox=t.getVariable(e.OxString);e.Oy=t.getVariable(e.OyString);e.scale=t.getVariable(e.scaleString);e.drawBefore=e.drawIfValue;1E-6>e.scale?(e.scale=1E-6,t.setVariable(e.scaleString,1E-6)):1E6<e.scale&&(e.scale=1E6,t.setVariable(e.scaleString,1E6));if(s||p)e.container.style.left=e.x+"px",e.container.style.top=e.y+"px",e.findOffset();e.container.style.display="block";e.drawTrace=!e.spaceChange&&!e.click;e.spaceChange&&e.drawBackground();e.draw()}else e.container.style.display=
"none"};a.Space2D.prototype.drawBackground=function(){t=this.evaluator;n=this.backgroundCtx;n.clearRect(0,0,this.backgroundCanvas.width,this.backgroundCanvas.height);n.fillStyle=this.background.getColor();n.fillRect(0,0,this.backgroundCanvas.width,this.backgroundCanvas.height);this.image&&(""!=this.image.src&&this.image.ready&&this.image.complete)&&("topleft"===this.bg_display?n.drawImage(this.image,0,0):"stretch"===this.bg_display?n.drawImage(this.image,0,0,this.w,this.h):"patch"===this.bg_display?
(n.fillStyle=n.createPattern(this.image,"repeat"),n.fillRect(0,0,this.canvas.width,this.canvas.height)):"center"===this.bg_display&&n.drawImage(this.image,(this.w-this.image.width)/2,(this.h-this.image.height)/2));q=this.scale;r=0;for(w=0>this.w+this.h?0:this.w+this.h;q>w;)q/=10,r++;for(;q<w/10;)q*=10;n.lineWidth=1;""!==this.net&&(n.strokeStyle=this.net.getColor(),this.drawMarks(n,q/10,-1));if(2!==this.parent.version&&""!==this.net10||2===this.parent.version&&""!==this.net&&""!==this.net10)n.strokeStyle=
this.net10.getColor(),this.drawMarks(n,q,-1);if(""!==this.axes){n.strokeStyle=this.axes.getColor();n.beginPath();if(""!==this.x_axis||2!==this.parent.version)n.moveTo(0,h(this.h/2+this.Oy)+0.5),n.lineTo(this.w,h(this.h/2+this.Oy)+0.5);if(""!==this.y_axis||2!==this.parent.version)n.moveTo(h(this.w/2+this.Ox)+0.5,0),n.lineTo(h(this.w/2+this.Ox)+0.5,this.h);n.stroke();this.drawMarks(n,q,4);this.drawMarks(n,q/2,2);this.drawMarks(n,q/10,1)}if(""!==this.x_axis||""!==this.y_axis)n.fillStyle=this.axes.getColor(),
n.font=l,n.textAlign="right",n.textBaseline="alphabetic",n.fillText(this.x_axis,h(this.w)-2,h(this.h/2+this.Oy)+12),n.fillText(this.y_axis,h(this.w/2+this.Ox)-2,12);this.numbers&&""!=this.axes&&(n.fillStyle=this.axes.getColor(),n.font=l,n.textAlign="start",n.textBaseline="bottom",q>(this.w+this.h)/2?this.drawNumbers(n,q/5,q<=this.scale?r+1:r):q>(this.w+this.h)/4?this.drawNumbers(n,q/2,q<=this.scale?r+1:r):this.drawNumbers(n,q,r));for(var a=0,c=this.backgroundGraphics.length;a<c;a++)this.backgroundGraphics[a].draw()};
a.Space2D.prototype.draw=function(){n=this.ctx;n.clearRect(0,0,this.canvas.width,this.canvas.height);for(var a=0,c=this.graphics.length;a<c;a++)u=this.graphics[a],""!==u.trace&&this.drawTrace&&u.drawTrace(),u.draw();a=0;for(c=this.graphicsCtr.length;a<c;a++)this.graphicsCtr[a].draw();""!=this.text&&(this.click&&"L"===this.whichButton)&&(console.log("aqui"),n.fillStyle=this.text.getColor(),n.strokeStyle=n.fillStyle,n.lineWidth=1,n.font=k,n.textAlign="center",n.textBaseline="alphabetic",I=1>=this.scale?
this.mouse_x.toFixed(0):this.mouse_x.toFixed(this.scale.toString().length),H=1>=this.scale?this.mouse_y.toFixed(0):this.mouse_y.toFixed(this.scale.toString().length),L="("+I+","+H+")",y=h(n.measureText(L).width/2),J=this.getAbsoluteX(this.mouse_x),G=this.getAbsoluteY(this.mouse_y),M=h(J),N=h(G-10),M+y>this.w?M=this.w-y:0>M-y&&(M=y),N+1>this.h?N=this.h:0>N-14&&(N=15),n.fillText(L,M,N),n.beginPath(),n.arc(J,G,2.5,0,f,!0),n.stroke())};a.Space2D.prototype.drawMarks=function(a,c,e){v=this.w;z=this.h;E=
0;F=v;C=0;K=z;x=h(v/2+this.Ox);D=h(z/2+this.Oy);0<=e&&(E=x-e,F=x+e,C=D-e,K=D+e);a.beginPath();for(e=-d(x/c);(A=x+d(e*c))<v;e++)a.moveTo(A+0.5,C+0.5),a.lineTo(A+0.5,K+0.5);for(e=-d(D/c);(B=D+d(e*c))<z;e++)a.moveTo(E+0.5,B+0.5),a.lineTo(F+0.5,B+0.5);a.stroke()};a.Space2D.prototype.drawNumbers=function(a,c,e){v=this.w;z=this.h;x=h(v/2+this.Ox);D=h(z/2+this.Oy);for(e=-d(x/c);(A=x+d(e*c))<v;e++)a.fillText(parseFloat((e*c/this.scale).toFixed(4)),A+1,D-2);for(e=-d(D/c);(B=D+d(e*c))<z;e++)0!==parseFloat(-e*
c/this.scale)&&a.fillText(parseFloat((-e*c/this.scale).toFixed(4)),x+5,B+5)};a.Space2D.prototype.registerMouseAndTouchEvents=function(){function d(a){p.click=1;p.evaluator.setVariable(p.id+".mouse_pressed",1);p.parent.deactivateGraphiControls();l(a);window.addEventListener("touchmove",n);window.addEventListener("touchend",e);a.preventDefault()}function e(a){p.click=0;p.evaluator.setVariable(p.id+".mouse_pressed",0);window.removeEventListener("touchmove",n,!1);window.removeEventListener("touchend",
e,!1);a.preventDefault();p.parent.update()}function f(c){p.click=1;p.evaluator.setVariable(p.id+".mouse_pressed",1);p.parent.deactivateGraphiControls();p.whichButton=a.whichButton(c);"R"===p.whichButton&&(window.addEventListener("mouseup",k),p.fixed||(p.clickPosForZoom=p.getCursorPosition(c).y,p.tempScale=p.scale,window.addEventListener("mousemove",m)));"L"===p.whichButton&&(p.evaluator.setVariable(p.id+".mouse_pressed",1),l(c),window.addEventListener("mousemove",n),window.addEventListener("mouseup",
k));c.preventDefault()}function k(a){p.click=0;p.evaluator.setVariable(p.id+".mouse_pressed",0);a.preventDefault();"R"===p.whichButton&&window.removeEventListener("mousemove",m,!1);p.sensitive_to_mouse_movements||window.removeEventListener("mousemove",n,!1);window.removeEventListener("mouseup",k,!1);p.parent.update()}function l(a){p.posAnte=p.getCursorPosition(a);p.mouse_x=p.getRelativeX(p.posAnte.x);p.mouse_y=p.getRelativeY(p.posAnte.y);p.evaluator.setVariable(p.id+".mouse_x",p.mouse_x);p.evaluator.setVariable(p.id+
".mouse_y",p.mouse_y);p.parent.update()}function m(a){a.preventDefault();p.clickPosForZoomNew=p.getCursorPosition(a).y;p.evaluator.setVariable(p.scaleString,p.tempScale+p.tempScale/45*((p.clickPosForZoom-p.clickPosForZoomNew)/10));p.parent.update()}function n(a){p.fixed||(p.posNext=p.getCursorPosition(a),c=h(p.posAnte.x-p.posNext.x),g=h(p.posAnte.y-p.posNext.y),p.evaluator.setVariable(p.OxString,p.Ox-c),p.evaluator.setVariable(p.OyString,p.Oy-g),p.posAnte.x-=c,p.posAnte.y-=g);l(a);a.preventDefault()}
var p=this;O=a.hasTouchSupport;p.canvas.oncontextmenu=function(){return!1};O&&(this.sensitive_to_mouse_movements&&this.canvas.addEventListener("touchmove",l),this.canvas.addEventListener("touchstart",d));O||(this.sensitive_to_mouse_movements&&this.canvas.addEventListener("mousemove",l),this.canvas.addEventListener("mousedown",f))};return a}(descartesJS||{}),descartesJS=function(a){function c(a,c){return c.depth-a.depth}if(a.loadLib)return a;var g=Math.round,h=Math.cos,d=Math.sin,f=Math.PI/2,l,k,e,
t,m,n,s,p,u,q,r,w,v;a.Space3D=function(c,g){a.Space.call(this,c,g);e=this;e.backgroundCanvas=document.createElement("canvas");e.backgroundCanvas.setAttribute("id",e.id+"_background");e.backgroundCanvas.setAttribute("width",e.w+"px");e.backgroundCanvas.setAttribute("height",e.h+"px");e.backgroundCtx=e.backgroundCanvas.getContext("2d");e.backgroundCtx.imageSmoothingEnabled=!1;e.backgroundCtx.mozImageSmoothingEnabled=!1;e.backgroundCtx.webkitImageSmoothingEnabled=!1;e.canvas=document.createElement("canvas");
e.canvas.setAttribute("id",e.id+"_canvas");e.canvas.setAttribute("width",e.w+"px");e.canvas.setAttribute("height",e.h+"px");e.canvas.setAttribute("class","DescartesSpace3DCanvas");e.canvas.setAttribute("style","z-index: "+e.zIndex+";");e.ctx=e.canvas.getContext("2d");e.ctx.imageSmoothingEnabled=!1;e.ctx.mozImageSmoothingEnabled=!1;e.ctx.webkitImageSmoothingEnabled=!1;e.graphicControlContainer=document.createElement("div");e.graphicControlContainer.setAttribute("id",e.id+"_graphicControls");e.graphicControlContainer.setAttribute("style",
"position: absolute; left: 0px; top: 0px; z-index: "+e.zIndex+";");e.numericalControlContainer=document.createElement("div");e.numericalControlContainer.setAttribute("id",e.id+"_numericalControls");e.numericalControlContainer.setAttribute("style","position: absolute; left: 0px; top: 0px; z-index: "+e.zIndex+";");e.container=document.createElement("div");e.container.setAttribute("id",e.id);e.container.setAttribute("class","DescartesSpace3DContainer");e.container.setAttribute("style","left: "+e.x+"px; top: "+
e.y+"px; z-index: "+e.zIndex+";");e.container.appendChild(e.backgroundCanvas);e.container.appendChild(e.canvas);e.container.appendChild(e.graphicControlContainer);e.container.appendChild(e.numericalControlContainer);c.container.insertBefore(e.container,c.loader);e.observer=2E3;e.evaluator.setVariable(e.id+".observador",2E3);e.eye=new a.Vector3D(0,0,0);e.center=new a.Vector3D(0,0,0);e.yUpEye=new a.Vector3D(0,0,1);e.distanceEyeCenter=e.observer/(4*e.scale);e.alpha=0;e.beta=0;e.evaluator.setVariable(e.id+
".rot.z",e.alpha);e.evaluator.setVariable(e.id+".rot.y",-e.beta);e.lookAtMatrix=new a.Matrix4x4;e.perspectiveMatrix=new a.Matrix4x4;e.perspective=(new a.Matrix4x4).perspective(45,e.w/e.h,0.01,1E3);q=h(-e.alpha);r=d(-e.alpha);w=h(e.beta);v=d(e.beta);e.eye.set(e.distanceEyeCenter*q*w,e.distanceEyeCenter*r*w,-e.distanceEyeCenter*v);e.yUpEye=e.yUpEye.set(h(-e.alpha-f),d(-e.alpha-f),0).crossProduct(e.eye).normalize();e.lookAtMatrix=e.lookAtMatrix.setIdentity().lookAt(e.eye,e.center,e.yUpEye);e.perspectiveMatrix=
e.perspective.multiply(e.lookAtMatrix);e.OxString=e.id+".Ox";e.OyString=e.id+".Oy";e.scaleString=e.id+".escala";e.wString=e.id+"._w";e.hString=e.id+"._h";e.observerString=e.id+".observador";e.update();e.registerMouseAndTouchEvents()};a.extend(a.Space3D,a.Space);a.Space3D.prototype.init=function(){e=this;e.uber.init.call(e);e.canvas&&(e.backgroundCanvas.setAttribute("width",e.w+"px"),e.backgroundCanvas.setAttribute("height",e.h+"px"),e.canvas.setAttribute("width",e.w+"px"),e.canvas.setAttribute("height",
e.h+"px"));e.container&&e.findOffset();e.w_2=e.w/2;e.h_2=e.h/2;e.oldMouse={x:0,y:0}};a.Space3D.prototype.update=function(a){e=this;l=e.evaluator;k=e.parent;l.setVariable(e.wString,e.w);l.setVariable(e.hString,e.h);e.drawIfValue=0<l.evalExpression(e.drawif);if(e.drawIfValue){p=e.x!==l.evalExpression(e.xExpr)+e.displaceRegionWest;u=e.y!==l.evalExpression(e.yExpr)+k.plecaHeight+e.displaceRegionNorth;e.spaceChange=a||p||u||e.drawBefore!==e.drawIfValue||e.Ox!==l.getVariable(e.OxString)||e.Oy!==l.getVariable(e.OyString)||
e.scale!==l.getVariable(e.scaleString);e.x=p?l.evalExpression(e.xExpr)+e.displaceRegionWest:e.x;e.y=u?l.evalExpression(e.yExpr)+k.plecaHeight+e.displaceRegionNorth:e.y;e.Ox=l.getVariable(e.OxString);e.Oy=l.getVariable(e.OyString);e.scale=l.getVariable(e.scaleString);e.drawBefore=e.drawIfValue;e.observer=l.getVariable(e.observerString);1E-6>e.scale?(e.scale=1E-6,l.setVariable(e.scaleString,1E-6)):1E6<e.scale&&(e.scale=1E6,l.setVariable(e.scaleString,1E6));if(p||u)e.container.style.left=e.x+"px",e.container.style.top=
e.y+"px",e.findOffset();e.container.style.display="block";e.draw()}else e.container.style.display="none"};a.Space3D.prototype.draw=function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);this.ctx.fillStyle=this.background.getColor();this.ctx.fillRect(0,0,this.backgroundCanvas.width,this.backgroundCanvas.height);this.setCamera();this.primitives=[];for(var a=0,d=this.graphics.length;a<d;a++)t=this.graphics[a],t.update(),this.primitives=this.primitives.concat(t.primitives||[]);a=0;for(d=
this.backgroundGraphics.length;a<d;a++)t=this.backgroundGraphics[a],t.update(),this.primitives=this.primitives.concat(t.primitives||[]);m=this.primitives;n=m.length;for(a=0;a<n;a++)m[a].computeDepth(this);m=m.sort(c);for(a=0;a<n;a++)m[a].draw(this.ctx);a=0;for(d=this.graphicsCtr.length;a<d;a++)this.graphicsCtr[a].draw()};a.Space3D.prototype.transformCoordinateX=function(a){return parseInt((a+1)*this.w_2+this.Ox)+0.5};a.Space3D.prototype.transformCoordinateY=function(a){return parseInt((1-a)*this.h_2+
this.Oy)+0.5};a.Space3D.prototype.setCamera=function(){e=this;e.distanceEyeCenter=e.observer/(4*e.scale);e.alpha=a.degToRad(e.evaluator.getVariable(e.id+".rot.z"));e.beta=a.degToRad(-e.evaluator.getVariable(e.id+".rot.y"));e.alpha=g(a.radToDeg(e.alpha+(e.mouse_x-e.oldMouse.x)));e.beta=g(a.radToDeg(e.beta+(e.mouse_y-e.oldMouse.y)));e.evaluator.setVariable(e.id+".rot.z",e.alpha);e.evaluator.setVariable(e.id+".rot.y",-e.beta);e.alpha=a.degToRad(e.alpha);e.beta=a.degToRad(e.beta);q=h(-e.alpha);r=d(-e.alpha);
w=h(e.beta);v=d(e.beta);e.eye.set(e.distanceEyeCenter*q*w,e.distanceEyeCenter*r*w,-e.distanceEyeCenter*v);e.yUpEye=e.yUpEye.set(h(-e.alpha-f),d(-e.alpha-f),0).crossProduct(e.eye).normalize();e.lookAtMatrix=e.lookAtMatrix.setIdentity().lookAt(e.eye,e.center,e.yUpEye);e.perspectiveMatrix=e.perspective.multiply(e.lookAtMatrix)};a.Space3D.prototype.registerMouseAndTouchEvents=function(){function c(a){e.click=1;e.evaluator.setVariable(e.id+".mouse_pressed",1);e.parent.deactivateGraphiControls();g(a);window.addEventListener("touchmove",
l);window.addEventListener("touchend",d);a.preventDefault()}function d(a){e.click=0;e.evaluator.setVariable(e.id+".mouse_pressed",0);window.removeEventListener("touchmove",l,!1);window.removeEventListener("touchend",d,!1);a.preventDefault()}function h(c){e.click=1;e.parent.deactivateGraphiControls();e.whichButton=a.whichButton(c);"R"===e.whichButton?(window.addEventListener("mouseup",f),e.fixed||(e.clickPosForZoom=e.getCursorPosition(c).y,e.tempScale=e.scale,window.addEventListener("mousemove",k))):
"L"==e.whichButton&&(e.evaluator.setVariable(e.id+".mouse_pressed",1),e.posAnte=e.getCursorPosition(c),e.oldMouse.x=e.getRelativeX(e.posAnte.x),e.oldMouse.y=e.getRelativeY(e.posAnte.y),g(c),window.addEventListener("mousemove",l),window.addEventListener("mouseup",f));c.preventDefault()}function f(a){e.click=0;e.evaluator.setVariable(e.id+".mouse_pressed",0);a.preventDefault();"R"===e.whichButton&&window.removeEventListener("mousemove",k,!1);window.removeEventListener("mousemove",l,!1);window.removeEventListener("mouseup",
f,!1)}function g(a){e.posAnte=e.getCursorPosition(a);e.mouse_x=e.getRelativeX(e.posAnte.x);e.mouse_y=e.getRelativeY(e.posAnte.y);e.evaluator.setVariable(e.id+".mouse_x",e.mouse_x);e.evaluator.setVariable(e.id+".mouse_y",e.mouse_y);e.parent.update()}function k(a){a.preventDefault();e.clickPosForZoomNew=e.getCursorPosition(a).y;e.evaluator.setVariable(e.scaleString,e.tempScale+e.tempScale/45*((e.clickPosForZoom-e.clickPosForZoomNew)/10));e.parent.update()}function l(a){e.click&&(g(a),e.setCamera(),
e.oldMouse={x:e.mouse_x,y:e.mouse_y})}e=this;s=a.hasTouchSupport;this.canvas.oncontextmenu=function(){return!1};s&&this.canvas.addEventListener("touchstart",c);s||this.canvas.addEventListener("mousedown",h)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c;a.SpaceAP=function(g,h){a.Space.call(this,g,h);this.exportarVars=this.importarVars=null;c=g.evaluator;this.file.match(/^\[/)&&this.file.match(/\]$/)?this.file=c.parser.parse(this.file.substring(1,this.file.length-1)):
this.file.match(/^\'/)&&this.file.match(/\'$/)?this.file=c.parser.parse(this.file):this.file=c.parser.parse("'"+this.file+"'");this.oldFile=c.evalExpression(this.file);this.initFile()};a.extend(a.SpaceAP,a.Space);a.SpaceAP.prototype.initFile=function(){this.firstUpdate=!0;var c;if(this.oldFile){var h=document.getElementById(this.oldFile);c=h&&"descartes/spaceApFile"==h.type?h.text:a.openExternalFile(this.oldFile);null!=c&&(c=c.split("\n"))}if(c&&c.toString().match(/<applet/gi)){for(var h="",d=!1,
f=0,l=c.length;f<l&&!(c[f].match("<applet")&&(d=!0),d&&(h+=c[f]),c[f].match("</applet"));f++);f=document.createElement("div");f.innerHTML=h;f.firstChild.setAttribute("width",this.w);f.firstChild.setAttribute("height",this.h);h=this.descApp?this.descApp.container:null;this.descApp=new a.DescartesApp(f.firstChild);this.descApp.container.setAttribute("class","DescartesAppContainer");this.descApp.container.setAttribute("style","position: absolute; overflow: hidden; background-color: "+this.background+
"; width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";");h?this.parent.container.replaceChild(this.descApp.container,h):this.parent.container.insertBefore(this.descApp.container,this.parent.loader);h=this.descApp.spaces;f=0;for(l=h.length;f<l;f++)h[f].findOffset();this.descApp.container.style.display=0<this.evaluator.evalExpression(this.drawif)?"block":"none";var k=this;this.descApp.update=function(){this.updateAuxiliaries();this.updateEvents();
this.updateControls();this.updateSpaces();k.exportar()}}else h=this.descApp?this.descApp.container:null,this.descApp={},this.descApp.container=document.createElement("div"),this.descApp.container.setAttribute("class","DescartesAppContainer"),f="position: absolute; overflow: hidden; background-color: "+this.background+"; width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";",this.image&&("topleft"==this.bg_display?f+="background-image: url("+this.imageSrc+
"); background-repeat:no-repeat;":"stretch"==this.bg_display?f+="background-image: url("+this.imageSrc+"); background-repeat:no-repeat; background-size: 100% 100%;":"patch"==this.bg_display?f+="background-image: url("+this.imageSrc+");":"center"==this.bg_display&&(f+="background-image: url("+this.imageSrc+"); background-repeat:no-repeat; background-position: center center;")),this.descApp.container.setAttribute("style",f),h?this.parent.container.replaceChild(this.descApp.container,h):this.parent.container.insertBefore(this.descApp.container,
this.parent.loader),this.descApp.container.style.display=0<this.evaluator.evalExpression(this.drawif)?"block":"none"};a.SpaceAP.prototype.update=function(){var a=this.evaluator.evalExpression(this.file);if(this.oldFile!=a)this.oldFile=a,this.initFile();else{var a=this.x!=this.evaluator.evalExpression(this.xExpr),c=this.y!=this.evaluator.evalExpression(this.yExpr)+this.plecaHeight;this.x=a?this.evaluator.evalExpression(this.xExpr):this.x;this.y=c?this.evaluator.evalExpression(this.yExpr)+this.plecaHeight:
this.y;a&&(this.descApp.container.style.left=this.x+"px");c&&(this.descApp.container.style.top=this.y+"px");if(a||c)for(var a=this.descApp.spaces,c=0,d=a.length;c<d;c++)a[c].findOffset();this.descApp.container.style.display=0<this.evaluator.evalExpression(this.drawif)?"block":"none";if(this.firstUpdate&&(this.firstUpdate=!1,null==this.importarVars)){this.importarVars=[];for(var f in this.evaluator.variables)this.evaluator.variables.hasOwnProperty(f)&&f.match(/^public./)&&this.importarVars.push({varName:f,
value:this.evaluator.getVariable(f)})}this.importar()}};a.SpaceAP.prototype.importar=function(){for(var a,c=!1,d=0,f=this.importarVars.length;d<f;d++)a=this.evaluator.getVariable(this.importarVars[d].varName),a!=this.importarVars[d].value&&(this.importarVars[d].value=a,this.descApp.evaluator.setVariable(this.importarVars[d].varName,this.importarVars[d].value),c=!0);c&&this.descApp.update()};a.SpaceAP.prototype.exportar=function(){};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;
var c,g,h,d;a.SpaceHTML_IFrame=function(c,d){a.Space.call(this,c,d);var h=this.parent.evaluator;window.navigator.userAgent.toLowerCase().match(/firefox/);this.file=this.file?this.file.trim():"";this.file.match(/^\[/)&&this.file.match(/\]$/)?this.file=h.parser.parse(this.file.substring(1,this.file.length-1)):this.file.match(/^\'/)&&this.file.match(/\'$/)?this.file=h.parser.parse(this.file):this.file=h.parser.parse("'"+this.file+"'");this.oldFile=h.evalExpression(this.file);this.MyIFrame=document.createElement("iframe");
this.MyIFrame.setAttribute("src",this.oldFile);this.MyIFrame.setAttribute("id",this.id);this.MyIFrame.setAttribute("marginheight",0);this.MyIFrame.setAttribute("marginwidth",0);this.MyIFrame.setAttribute("frameborder",0);this.MyIFrame.setAttribute("scrolling","auto");this.MyIFrame.setAttribute("style","position: absolute; width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px;");this.parent.container.insertBefore(this.MyIFrame,this.parent.loader);var e=this;this.MyIFrame.onload=
function(a){var c=this;e.evaluator.setFunction(e.id+".set",function(a,d){c.contentWindow.postMessage({type:"set",name:a,value:d},"*")});e.evaluator.setFunction(e.id+".update",function(){c.contentWindow.postMessage({type:"update"},"*")});e.evaluator.setFunction(e.id+".exec",function(a,d){c.contentWindow.postMessage({type:"exec",name:a,value:d},"*")})};this.update=this.iframeUpdate;this.evaluator.setVariable(this.id+"._scroll",0)};a.extend(a.SpaceHTML_IFrame,a.Space);a.SpaceHTML_IFrame.prototype.init=
function(){self=this;self.uber.init.call(self);self.MyIFrame&&(self.MyIFrame.style.width=self.w+"px",self.MyIFrame.style.height=self.h+"px",self.MyIFrame.style.left=self.x+"px",self.MyIFrame.style.top=self.y+"px")};a.SpaceHTML_IFrame.prototype.iframeUpdate=function(a){c=this.evaluator;this.drawIfValue=0<c.evalExpression(this.drawif);if(this.drawif){this.MyIFrame.style.display=this.drawIfValue?"block":"none";a&&(this.y=this.x=Math.Infinity);g=this.x!==c.evalExpression(this.xExpr)+this.displaceRegionWest;
h=this.y!==c.evalExpression(this.yExpr)+this.parent.plecaHeight+this.displaceRegionNorth;this.x=g?c.evalExpression(this.xExpr)+this.displaceRegionWest:this.x;this.y=h?c.evalExpression(this.yExpr)+this.parent.plecaHeight+this.displaceRegionNorth:this.y;if(g||h)this.MyIFrame.style.left=this.x+"px",this.MyIFrame.style.top=this.y+"px";d=c.evalExpression(this.file);d!==this.oldFile&&(this.oldFile=d,this.MyIFrame.setAttribute("src",d));this.scrollVar=c.getVariable(this.id+"._scroll");1==this.scrollVar?
(this.MyIFrame.setAttribute("scrolling","yes"),this.MyIFrame.style.overflow=""):-1==this.scrollVar?(this.MyIFrame.setAttribute("scrolling","no"),this.MyIFrame.style.overflow="hidden"):(this.MyIFrame.setAttribute("scrolling","auto"),this.MyIFrame.style.overflow="")}};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var c;a.DescartesLoader=function(a){this.children=a.children;this.lessonParser=a.lessonParser;this.images=a.images;this.images.length=a.images.length;this.audios=
a.audios;this.audios.length=a.audios.length;this.arquimedes=a.arquimedes;this.descartesApp=a;var c=a.image_loader?a.image_loader:l(a.loader.width,a.loader.height);this.imageLoader=document.createElement("div");this.imageLoader.width=a.width;this.imageLoader.height=a.height;this.imageLoader.setAttribute("class","DescartesLoaderImage");this.imageLoader.setAttribute("style","background-image: url("+c+"); width: "+a.width+"px; height: "+a.height+"px;");a.loader.appendChild(this.imageLoader);this.loaderBar=
document.createElement("canvas");this.loaderBar.width=a.width;this.loaderBar.height=a.height;this.loaderBar.setAttribute("class","DescartesLoaderBar");this.loaderBar.setAttribute("style","width: "+a.width+"px; height:"+a.height+"px;");this.loaderBar.ctx=this.loaderBar.getContext("2d");a.loader.appendChild(this.loaderBar);this.barWidth=Math.floor(80);this.barHeight=Math.floor(a.loader.height/70);var d=this;this.timer=setInterval(function(){d.drawLoaderBar(d.loaderBar.ctx,a.width,a.height)},10);a.firstRun=
!1;this.initPreloader()};a.DescartesLoader.prototype.initPreloader=function(){var c=this.children,d=this.images,h=this.audios,f=/[\w-//]*(\.png|\.jpg|\.gif|\.svg|\.PNG|\.JPG|\.GIF|\.SVG)/g,g=/[\w-//]*(\.ogg|\.oga|\.mp3|\.wav|\.OGG|\.OGA\.MP3|\.WAV)/g,l=/vector|array|bektore|vecteur|matriz/g,p=/archivo|file|fitxer|artxibo|fichier|arquivo/g;this.arquimedes&&(d["lib/DescartesCCLicense.png"]=a.getCreativeCommonsLicenseImage(),d["lib/DescartesCCLicense.png"].addEventListener("load",function(){this.ready=
1}),d["lib/DescartesCCLicense.png"].addEventListener("error",function(){this.errorload=1}));var u,q,r,w,v,z;w=0;for(v=c.length;w<v;w++){if(u=c[w].value.match(f)){r=0;for(z=u.length;r<z;r++)q=u[r],!q.toLowerCase().match(/vacio.gif$/)&&""!=q.substring(0,q.length-4)&&(d[q]=new Image,d[q].addEventListener("load",function(){this.ready=1}),d[q].addEventListener("error",function(){this.errorload=1}),d[q].src=q)}if(u=c[w].value.match(g)){r=0;for(q=u.length;r<q;r++)this.initAudio(u[r])}(r=c[w].value.match(l)&&
c[w].value.match(p))&&this.lessonParser.parseAuxiliar(c[w].value)}for(var A in d)d.hasOwnProperty(A)&&this.images.length++;for(A in h)h.hasOwnProperty(A)&&this.audios.length++;var B=this,x=this.images.length+this.audios.length,D=function(){B.readys=0;for(var a in d)d.hasOwnProperty(a)&&(d[a].ready||d[a].errorload)&&B.readys++;for(a in B.audios)h.hasOwnProperty(a)&&(h[a].ready||h[a].errorload)&&B.readys++;B.readys!=x?setTimeout(D,30):(clearTimeout(B.timer),B.descartesApp.initBuildApp())};D()};a.DescartesLoader.prototype.initAudio=
function(c){var d=this.audios;d[c]=new Audio(c);d[c].filename=c;var h=function(){this.ready=1},f=function(){!this.canPlayType("audio/"+this.filename.substring(this.filename.length-3))&&"mp3"==this.filename.substring(this.filename.length-3)?(d[c]=new Audio(this.filename.replace("mp3","ogg")),d[c].filename=this.filename.replace("mp3","ogg"),d[c].addEventListener("canplaythrough",h),d[c].addEventListener("load",h),d[c].addEventListener("error",f),d[c].load()):(console.log("El archivo '"+c+"' no puede ser reproducido"),
this.errorload=1)};d[c].addEventListener("canplaythrough",h);d[c].addEventListener("load",h);d[c].addEventListener("error",f);a.hasTouchSupport?(d[c].load(),d[c].play(),d[c].ready=1):d[c].load()};var g,h,d,f;a.DescartesLoader.prototype.drawLoaderBar=function(a,e,l){g=this.barWidth;h=this.barHeight;d=this.images.length+this.audios.length;f=2*(g-2)/d;a.translate(e/2,(l-65*c)/2+90*c);a.scale(c,c);a.strokeRect(-g,-h,2*g,h);a.fillStyle="gray";a.fillRect(-g+2,-h+2,2*(g-2),h-4);a.fillStyle="#1f375d";a.fillRect(-g+
2,-h+2,this.readys*f,h-4);a.setTransform(1,0,0,1,0,0)};var l=function(a,d){var h=document.createElement("canvas");h.width=a;h.height=d;var f=h.getContext("2d");f.save();f.strokeStyle="#1f375d";f.fillStyle="#1f375d";f.lineCap="round";f.lineWidth=2;f.beginPath();c=a<d?a/360:d/195;c=2.5<c?2.5:c;f.translate((a-120*c)/2,(d-65*c)/2);f.scale(c,c);f.moveTo(3,25);f.lineTo(3,1);f.lineTo(21,1);f.bezierCurveTo(33,1,41,15,41,25);f.stroke();f.beginPath();f.moveTo(1,63);f.lineTo(1,64);f.moveTo(5,62);f.lineTo(5,
64);f.moveTo(9,61);f.lineTo(9,64);f.moveTo(13,60);f.lineTo(13,64);f.moveTo(17,58);f.lineTo(17,64);f.moveTo(21,56);f.lineTo(21,64);f.moveTo(25,53);f.lineTo(25,64);f.moveTo(29,50);f.lineTo(29,64);f.moveTo(33,46);f.lineTo(33,64);f.moveTo(37,41);f.lineTo(37,64);f.moveTo(41,32);f.lineTo(41,64);f.stroke();f.font="20px Arial, Helvetica, 'Droid Sans', Sans-serif";f.fillText("escartes",45,33);f.fillText("JS",98,64);f.restore();return h.toDataURL()};return a}(descartesJS||{}),descartesJS=function(a){function c(a){for(var d=
"[",f=0,l=a.length;f<l;f++){if(a[f]instanceof Array)d+=c(a[f]);else{g=a[f];if("undefined"==typeof g||!g)g=0;"string"==typeof g&&(g="'"+g+"'");d+=g}f<l-1&&(d+=",")}return d+"]"}if(a.loadLib)return a;a.DescartesApp=function(c){this.applet=c;this.parentContainer=c.parentNode;this.width=parseFloat(c.getAttribute("width"));this.height=parseFloat(c.getAttribute("height"));this.decimal_symbol=".";this.children=c.getElementsByTagName("param");this.code=c.getAttribute("code");this.saveState=[];this.images=
{};this.images.length=-1;this.audios={};this.audios.length=-1;this.evaluator=new a.Evaluator(this);this.lessonParser=new a.LessonParser(this);this.firstRun=!0;this.arquimedes=!!this.code.match("descinst.DescartesWeb2_0.class","i")||!!this.code.match("Arquimedes","i")||!!this.code.match("Discurso","i");this.licenseA="{\\rtf1\\uc0{\\fonttbl\\f0\\fcharset0 Arial;\\f1\\fcharset0 Arial;\\f2\\fcharset0 Arial;\\f3\\fcharset0 Arial;\\f4\\fcharset0 Arial;}{\\f0\\fs34 __________________________________________________________________________________ \\par \\fs22                                        Los contenidos de esta unidad did\u00e1ctica interactiva est\u00e1n bajo una  {\\*\\hyperlink licencia Creative Commons|http://creativecommons.org/licenses/by-nc-sa/2.5/es/}, si no se indica lo contrario.\\par                                        La unidad did\u00e1ctica fue creada con Arqu\u00edmedes, que es un producto de c\u00f3digo abierto del  {\\*\\hyperlink Ministerio de Educaci\u00f3n de Espa\u00f1a|http://recursostic.educacion.es/descartes/web/DescartesWeb2.0/} y\\par                                        el {\\*\\hyperlink Instituto de Matem\u00e1ticas|http://arquimedes.matem.unam.mx/} de la Universidad Nacional Aut\u00f3noma de M\u00e9xico, cedido bajo licencia {\\*\\hyperlink EUPL v 1.1|/resources/eupl_v1.1es.pdf}, con {\\*\\hyperlink c\u00f3digo en Java|http://recursostic.educacion.es/descartes/web/source/}.}";
c=this.children;for(var d,f=0,g=0,k=0,e=c.length;k<e;k++)d=c[k],"rtf_height"==d.name&&(f=parseInt(d.value)),"Buttons"==babel[d.name]&&(this.buttonsConfig=this.lessonParser.parseButtonsConfig(d.value),g=this.buttonsConfig.height),"image_loader"==d.name&&(this.image_loader=d.value);this.arquimedes&&f&&(this.height=f+g+70);this.init()};a.DescartesApp.prototype.init=function(){this.spaces=[];this.externalSpace={container:document.createElement("div"),controls:[]};this.northSpace={container:document.createElement("div"),
controls:[]};this.southSpace={container:document.createElement("div"),controls:[]};this.eastSpace={container:document.createElement("div"),controls:[]};this.westSpace={container:document.createElement("div"),controls:[]};this.specialSpace={container:document.createElement("div"),controls:[]};this.editableRegion={container:document.createElement("div"),textFields:[]};this.controls=[];this.auxiliaries=[];this.events=[];this.cacheVars={};this.getVarsNames={};this.numberOfIframes=this.plecaHeight=this.tabindex=
this.zIndex=0;void 0!=this.container&&this.parentContainer.removeChild(this.container);this.container=document.createElement("div");this.loader=document.createElement("div");this.parentContainer.appendChild(this.container);this.container.width=this.width;this.container.height=this.height;this.container.setAttribute("class","DescartesAppContainer");this.container.setAttribute("style","width:"+this.width+"px; height:"+this.height+"px;");this.container.appendChild(this.loader);this.loader.width=this.width;
this.loader.height=this.height;this.loader.setAttribute("class","DescartesLoader");this.loader.setAttribute("style","width:"+this.width+"px; height:"+this.height+"px; z-index:1000;");this.firstRun?this.descartesLoader=new a.DescartesLoader(this):this.initBuildApp()};a.DescartesApp.prototype.initBuildApp=function(){for(var a=this.children,c=this.lessonParser,f=[],g=[],k=[],e=[],t=[],m=[],n,s=0,p=a.length;s<p;s++)if(n=a[s],"pleca"==n.name)n=c.parsePleca(n.value,this.width),this.container.insertBefore(n,
this.loader),this.plecaHeight=n.imageHeight?n.imageHeight:n.offsetHeight;else if("Buttons"==babel[n.name])this.buttonsConfig=c.parseButtonsConfig(n.value);else if("decimal_symbol"==babel[n.name])this.decimal_symbol=n.value;else if("version"==babel[n.name])this.version=parseInt(n.value);else if("language"==babel[n.name])this.language=n.value;else if("rtf"==n.name){var u=parseInt(this.height)-this.plecaHeight-this.buttonsConfig.height-45;e.push("space='descartesJS_scenario' type='text' expresion='[10,20]' background='yes' text='"+
n.value.replace(/'/g,"&squot;")+"'");e.push("space='descartesJS_scenario' type='text' expresion='[10,"+(u-25)+"]' background='yes' text='"+this.licenseA+"'");e.push("space='descartesJS_scenario' type='image' expresion='[15,"+u+"]' background='yes' abs_coord='yes' file='lib/DescartesCCLicense.png'")}else"E"==n.name.charAt(0)?(n.value.match(/'HTMLIFrame'/)&&this.numberOfIframes++,f.push(n.value)):"C"==n.name.charAt(0)&&"_"==n.name.charAt(1)?g.push(n.value):"A"==n.name.charAt(0)&&"_"==n.name.charAt(1)?
k.push(n.value):"G"==n.name.charAt(0)?e.push(n.value):"S"==n.name.charAt(0)?t.push(n.value):"Animation"==babel[n.name]&&m.push(n.value);this.scenarioRegion={container:document.createElement("div"),scroll:0};this.scenarioRegion.container.setAttribute("id","descartesJS_Scenario_Region");this.scenarioRegion.scenarioSpace=this.lessonParser.parseSpace("tipo='R2' id='descartesJS_scenario' fondo='blanco' x='0' y='0' fijo='yes' red='no' red10='no' ejes='no' text='no' ancho='"+this.width+"' alto='"+this.height+
"'");this.scenarioRegion.container.appendChild(this.scenarioRegion.scenarioSpace.container);this.arquimedes&&(this.container.appendChild(this.scenarioRegion.container),this.spaces.push(this.scenarioRegion.scenarioSpace));s=0;for(p=f.length;s<p;s++)a=c.parseSpace(f[s]),this.arquimedes&&this.scenarioRegion.container.appendChild(a.container),this.spaces.push(a),this.zIndex++;s=0;for(p=e.length;s<p;s++)if(f=c.parseGraphic(e[s]))f.visible&&(this.editableRegionVisible=!0),f.space.addGraph(f);s=0;for(p=
t.length;s<p;s++)(f=c.parse3DGraphic(t[s]))&&f.space.addGraph(f);s=0;for(p=g.length;s<p;s++)this.controls.push(c.parseControl(g[s]));s=0;for(p=k.length;s<p;s++)c.parseAuxiliar(k[s]);s=0;for(p=m.length;s<p;s++)this.animation=c.parseAnimation(m[s]);this.configRegions();this.updateAuxiliaries();s=0;for(p=this.controls.length;s<p;s++)this.controls[s].init();this.updateControls();this.updateSpaces(!0);var q=this;this.numberOfIframes?setTimeout(function(){q.finishInit()},300*this.numberOfIframes):this.finishInit()};
a.DescartesApp.prototype.finishInit=function(){this.update();this.loader.style.display="none";window.parent!==window&&(this.parentContainer.style.margin="0px",this.parentContainer.style.padding="0px",window.parent.postMessage({type:"reportSize",href:window.location.href,width:this.width,height:this.height},"*"),window.parent.postMessage({type:"ready"},"*"),a.onResize());a.externalEvaluator=new a.Evaluator};a.DescartesApp.prototype.configRegions=function(){var c=this.evaluator.parser,d=this.buttonsConfig,
f=this.container;if(2!=this.version)var g="15",k=100,e=100,t=100,m=100;else g="14",k=63,e=50,t=44,m=53;var n=0,s=0,p=0,u=p=0,q=0,r=0,w=0,v=0,r=this.northSpace.controls,z=this.southSpace.controls,A=this.eastSpace.controls,B=this.westSpace.controls;if(0<d.rowsNorth||0<r.length||d.about||d.config){0>=d.rowsNorth?(n=d.height,d.rowsNorth=1):n=d.height*d.rowsNorth;var x=this.northSpace.container;x.setAttribute("id","descartesJS_northRegion");x.setAttribute("style","width:"+f.width+"px; height:"+n+"px; background:#c0c0c0; position:absolute; left:0px; top:0px; z-index:100;");
f.insertBefore(x,this.loader);var q=f.width,D=0;d.about&&(D=k,q-=D);d.config&&(q-=e);for(var x=Math.ceil(r.length/d.rowsNorth),E=q/x,p=0,F=r.length;p<F;p++)r[p].expresion=c.parse("("+(D+E*(p%x))+","+d.height*Math.floor(p/x)+","+E+","+d.height+")"),r[p].drawif=c.parse("1");if(d.about){var C;"espa\u00f1ol"==this.language?C="cr\u00e9ditos":"english"==this.language&&(C="about");(new a.Button(this,{region:"north",name:C,font_size:c.parse(g),expresion:c.parse("(0, 0, "+k+", "+n+")")})).update()}d.config&&
(C="config",(new a.Button(this,{region:"north",name:C,font_size:c.parse(g),action:"config",expresion:c.parse("("+(q+k)+", 0, "+e+", "+n+")")})).update())}if(0<d.rowsSouth||0<z.length||d.init||d.clear){0>=d.rowsSouth?(s=d.height,d.rowsSouth=1):s=d.height*d.rowsSouth;r=f.width;D=0;d.init&&(D=t,r-=D);d.clear&&(r-=m);x=this.southSpace.container;x.setAttribute("id","descartesJS_southRegion");x.setAttribute("style","width:"+f.width+"px; height:"+s+"px; background:#c0c0c0; position:absolute; left: 0px; top:"+
(f.height-s)+"px; z-index:100;");f.insertBefore(x,this.loader);x=Math.ceil(z.length/d.rowsSouth);E=r/x;p=0;for(F=z.length;p<F;p++)z[p].expresion=c.parse("("+(D+E*(p%x))+","+d.height*Math.floor(p/x)+","+E+","+d.height+")"),z[p].drawif=c.parse("1");d.init&&("espa\u00f1ol"==this.language?C="inicio":"english"==this.language&&(C="init"),(new a.Button(this,{region:"south",name:C,font_size:c.parse(g),action:"init",expresion:c.parse("(0, 0, "+t+", "+s+")")})).update());d.clear&&("espa\u00f1ol"==this.language?
C="limpiar":"english"==this.language&&(C="clear"),(new a.Button(this,{region:"south",name:C,font_size:c.parse(g),action:"clear",expresion:c.parse("("+(r+t)+", 0, "+m+", "+s+")")})).update())}if(0<A.length){p=f.height-n-s;w=d.widthEast;x=this.eastSpace.container;x.setAttribute("id","descartesJS_eastRegion");x.setAttribute("style","width:"+w+"px; height:"+p+"px; background:#c0c0c0; position:absolute; left:"+(f.width-w)+"px; top:"+n+"px; z-index:100;");f.insertBefore(x,this.loader);p=0;for(F=A.length;p<
F;p++)A[p].expresion=c.parse("(0,"+d.height*p+","+w+","+d.height+")"),A[p].drawif=c.parse("1")}if(0<B.length){p=f.height-n-s;v=d.widthWest;x=this.westSpace.container;x.setAttribute("id","descartesJS_westRegion");x.setAttribute("style","width: "+v+"px; height: "+p+"px; background: #c0c0c0; position: absolute; left: 0px; top: "+n+"px; z-index: 100;");f.insertBefore(x,this.loader);p=0;for(F=B.length;p<F;p++)B[p].expresion=c.parse("(0,"+d.height*p+","+v+","+d.height+")"),B[p].drawif=c.parse("1")}if(this.editableRegionVisible){u=
d.height;x=this.editableRegion.container;x.setAttribute("id","descartesJS_editableRegion");x.setAttribute("style","width:"+f.width+"px; height:"+u+"px; position:absolute; left:0px; top:"+(f.height-s-d.height)+"px; z-index:100; background:#c0c0c0; overflow:hidden;");f.insertBefore(x,this.loader);c=this.editableRegion.textFields;d=f.width/c.length;g=a.getFieldFontSize(u);p=0;for(F=c.length;p<F;p++)"div"==c[p].type?(x.appendChild(c[p].container),c[p].container.setAttribute("style","font-family: Arial, Helvetica, 'Droid Sans', Sans-serif; width: "+
(d-4)+"px; height: "+u+"px; position: absolute; left: "+p*d+"px; top: 0px;"),k=c[p].container.firstChild,k.setAttribute("style","font-family: Arial, Helvetica, 'Droid Sans', Sans-serif; font-size: "+g+"px; padding-top: 0%; background-color: #e0e4e8; position: absolute; left: 0px; top: 0px; height:"+u+"px; text-align: center; line-height: "+u+"px;"),e=k.offsetWidth,k.style.width=e+"px",k.firstChild.textContent=k.firstChild.textContent.substring(3,k.firstChild.textContent.length-3),c[p].container.lastChild.setAttribute("style",
"font-family:'Courier New', Courier, 'Droid Sans Mono', Monospace; font-size: "+g+"px; width:"+(d-e)+"px; height:"+u+"px; position:absolute; left:"+e+"px; top:0px; border:2px groove white;")):(x.appendChild(c[p]),c[p].setAttribute("style","font-family:'Courier New', Courier, 'Droid Sans Mono', Monospace; font-size: "+g+"px; width:"+d+"px; height:"+u+"px; position:absolute; left:"+p*d+"px; top:0px; border:2px groove white;"))}this.displaceRegionNorth=n;this.displaceRegionWest=v;f.width-=w;f.height=
f.height-s-u;p=0;for(F=this.spaces.length;p<F;p++)this.spaces[p].init()};a.DescartesApp.prototype.update=function(){this.updateAuxiliaries();this.updateEvents();this.updateControls();this.updateSpaces()};a.DescartesApp.prototype.deactivateGraphiControls=function(){for(var a,c=0,f=this.controls.length;c<f;c++)a=this.controls[c],"graphic"==a.type&&a.deactivate()};a.DescartesApp.prototype.updateAuxiliaries=function(){for(var a=0,c=this.auxiliaries.length;a<c;a++)this.auxiliaries[a].update()};a.DescartesApp.prototype.updateEvents=
function(){for(var a=0,c=this.events.length;a<c;a++)this.events[a].update()};a.DescartesApp.prototype.updateControls=function(){for(var a=0,c=this.controls.length;a<c;a++)this.controls[a].update()};a.DescartesApp.prototype.updateSpaces=function(a){for(var c=0,f=this.spaces.length;c<f;c++)this.spaces[c].update(a)};a.DescartesApp.prototype.clear=function(){for(var a=0,c=this.spaces.length;a<c;a++)this.spaces[a].spaceChange=!0,this.spaces[a].drawBackground()};a.DescartesApp.prototype.play=function(){this.animation&&
this.animation.play()};a.DescartesApp.prototype.stop=function(){this.animation&&this.animation.stop()};a.DescartesApp.prototype.reinitAnimation=function(){this.animation&&this.animation.reinit()};a.DescartesApp.prototype.stopAudios=function(){this.stop();for(var a in this.audios)this.audios.hasOwnProperty(a)&&this.audios[a].pause&&(this.audios[a].pause(),this.audios[a].currentTime=0)};a.DescartesApp.prototype.getImage=function(a){var c=this.images;if(a)return c[a]||(c[a]=new Image,c[a].addEventListener("load",
function(){this.ready=1}),c[a].addEventListener("error",function(){this.errorload=1}),c[a].src=a),c[a]};a.DescartesApp.prototype.getAudio=function(a){var c=this.audios;if(a){if(!c[a]){var f=file.lastIndexOf("."),f=-1===f?file.lenght:f;file.substring(0,f);c[a]=new Audio(a);var g=function(a){this.ready=1};c[a].addEventListener("canplaythrough",g);var k=function(e){!this.canPlayType("audio/"+a.substring(a.length-3))&&"mp3"==a.substring(a.length-3)?(c[a]=new Audio(a.replace("mp3","ogg")),c[a].addEventListener("canplaythrough",
g),c[a].addEventListener("load",g),c[a].addEventListener("error",k),c[a].load()):(console.log("El archivo '"+a+"' no puede ser reproducido"),this.errorload=1)};c[a].addEventListener("error",k);c[a].play();setTimeout(function(){c[a].pause()},15)}return c[a]}return new Audio};a.DescartesApp.prototype.getControlByCId=function(a){for(var c,f=0,g=this.controls.length;f<g;f++)if(c=this.controls[f],c.cID==a)return c;return{update:function(){},w:0}};a.DescartesApp.prototype.getControlById=function(a){for(var c,
f=0,g=this.controls.length;f<g;f++)if(c=this.controls[f],c.id==a)return c;return{update:function(){}}};a.DescartesApp.prototype.getSpaceByCId=function(a){for(var c,f=0,g=this.spaces.length;f<g;f++)if(c=this.spaces[f],c.cID==a)return c;return{update:function(){},w:0}};a.DescartesApp.prototype.getSpaceById=function(a){for(var c,f=0,g=this.spaces.length;f<g;f++)if(c=this.spaces[f],c.id==a)return c;return{update:function(){},w:0}};var g;a.DescartesApp.prototype.getState=function(){var a,d="",f=this.evaluator.variables,
g;for(g in f)f.hasOwnProperty(g)&&(a=f[g],"string"==typeof a&&(a="'"+a+"'"),void 0!=a&&("rnd"!=g&&"pi"!=g&&"e"!=g&&"Infinity"!=g&&"-Infinity"!=g&&"object"!=typeof a)&&(d=""!=d?d+"\n"+g+"="+a:g+"="+a));var f=this.evaluator.vectors,k;for(k in f)f.hasOwnProperty(k)&&(a=f[k],d=d+"\n"+k+"="+c(a));k=this.evaluator.matrices;for(var e in k)k.hasOwnProperty(e)&&(a=k[e],d=d+"\n"+e+"="+c(a));return d};a.DescartesApp.prototype.setState=function(a){a=a.split("\n");for(var c,f,g=0,k=a.length;g<k;g++)c=a[g].split("="),
2<=c.length&&(f=eval(c[1]),-1!=c[1].indexOf("[[")?(this.evaluator.matrices[c[0]]=f,this.evaluator.matrices[c[0]].rows=f.length,this.evaluator.matrices[c[0]].cols=f[0].length):-1!=c[1].indexOf("[")?(this.evaluator.vectors[c[0]]=f,this.evaluator.variables[c[0]+".long"]=f.length):this.evaluator.variables[c[0]]=f),this.update()};a.DescartesApp.prototype.getEvaluation=function(){for(var a=0,c=0,f="",g=0,k=this.controls.length;g<k;g++)"textfield"==this.controls[g].gui&&this.controls[g].evaluate&&(a++,c+=
this.controls[g].ok,this.controls[g].value=""==this.controls[g].value?"''":this.controls[g].value,f+=" \\n "+this.controls[g].id+"="+this.controls[g].value+"|"+this.controls[g].ok);return"questions="+a+" \\n correct="+c+" \\n wrong="+(a-c)+f};a.DescartesApp.prototype.showSolution=function(){for(var a=this.controls,c=0,f=a.length;c<f;c++)"textfield"==a[c].gui&&a[c].evaluate&&a[c].changeValue(a[c].getFirstAnswer());this.update()};a.DescartesApp.prototype.showAnswer=function(){for(var a=0,c=this.saveState.length;a<
c;a++)this.evaluator.evalExpression(this.saveState[a]);this.update()};return a}(descartesJS||{}),descartesJS=function(a){function c(){for(var c=document.getElementsByTagName("applet"),d,g=[],e=0,h=c.length;e<h;e++)d=c[e],(d.getAttribute("code").match("DescartesJS")||d.getAttribute("code").match("Descartes.class")||d.getAttribute("code").match("descinst.DescartesWeb2_0.class")||d.getAttribute("code").match("Arquimedes")||d.getAttribute("code").match("Discurso"))&&g.push(d);c=0;for(d=g.length;c<d;c++)a.apps.push(new a.DescartesApp(g[c])),
g[c].className="DescartesJS"}function g(){var a=document.getElementById("StyleDescartesApps");a&&a.parentNode.removeChild(a);a=document.createElement("style");a.id="StyleDescartesApps";a.type="text/css";a.setAttribute("rel","stylesheet");a.innerHTML="applet.DescartesJS {display:none;} applet {display:none;}";document.head.appendChild(a)}function h(){for(var a=document.getElementsByTagName("*"),c=[],d=0,e=a.length;d<e;d++)"DescartesAppContainer"==a[d].className&&c.push(a[d]);d=0;for(e=c.length;d<e;d++)c[d].parentNode.removeChild(c[d])}
function d(d){a.getFeatures();a.hasCanvasSupport?(h(),c(),document.getElementById("StyleDescartesApps").innerHTML="applet.DescartesJS {display:none;}",window.addEventListener("resize",a.onResize),setTimeout(function(){window.scrollTo(0,1)},1)):document.getElementById("StyleDescartesApps").innerHTML="applet {display:block;}"}if(a.loadLib)return a;a.apps=[];a.getDescartesApps=function(){return a.apps};(!window.hasOwnProperty("debugDescartesJS")||!debugDescartesJS)&&g();a.onResize=function(c){for(var d=
0,g=a.apps.length;d<g;d++){c=a.apps[d].spaces;for(var e=0,h=c.length;e<h;e++)c[e].findOffset()}};a.receiveMessage=function(c){if(0<a.apps.length&&(c=c.data))if("set"===c.type)a.apps[0].evaluator.setVariable(c.name,c.value);else if("update"===c.type)a.apps[0].update();else if("exec"===c.type){var d=a.apps[0].evaluator.getFunction(c.name),g=[];""!==c.value&&(g=c.value.toString().split(","));d&&d.apply(a.apps[0].evaluator,g)}};void 0==a.loadLib&&(a.loadLib=!0,window.addEventListener("load",d),window.addEventListener("message",
a.receiveMessage));return a}(descartesJS||{});
