/*
 Joel Espinosa Longi
 joel.espinosa@amite.mx
 j.longi@gmail.com
 LGPL - http://www.gnu.org/licenses/lgpl.html
 2013-03-25
*/
var babel=function(a){a.falso=a["false"]=a.fals=a.gezurra=a.faux=a.fals="false";a.verdadero=a["true"]=a.veritable=a.egia=a.vrai=a.verdadeiro=a.veritable="true";a.no=a.ez=a.non=a["n\u00e3o"]="false";a["s\u00ed"]=a.yes=a.bai=a.oui=a.si=a["sim "]="true";a.negro=a.black=a.negre=a.beltza=a.noir=a.preto="#000000";a.maxenta=a.magenta="#ff00ff";a.azul=a.blue=a.blau=a.urdina=a.bleu="#0000ff";a.turquesa=a.cyan=a.turkesa=a.turquoise="#00ffff";a.verde=a.green=a.verd=a.berdea=a.vert="#00ff00";a.amarillo=a.yellow=
a.groc=a.horia=a.jaune=a.amarelo="#ffff00";a.naranja=a.orange=a.taronja=a.laranja=a.laranxa="#ffc800";a.rojo=a.red=a.vermell=a.gorria=a.rouge=a.vermello=a.vermelho="#ff0000";a.pink=a.rosa=a.arrosa=a.rose="#ffafaf";a.grisObscuro=a.darkGray=a.grisFosc=a["gris iluna"]=a.grisObscur=a.grisEscuro=a.cinzaEscuro="#404040";a.gris=a.gray=a.grisa=a.cinza="#808080";a.grisClaro=a.lightGray=a.grisClar=a["gris argia"]=a.grisClair=a.cinzaClaro="#c0c0c0";a.blanco=a.white=a.blanc=a.zuria=a.branco="#ffffff";a.escala=
a.scale=a.eskala=a["\u00e9chelle"]="scale";a.nombre=a.name=a.nom=a.izena=a.nome="name";a.ikusgai=a["vis\u00edvel"]=a.visible="visible";a.rastro=a.trace=a.rastre=a.arrastoa="trace";a.fondo=a.background=a.fons=a.hondoa=a.fond=a.fundo="background";a.colour=a.color=a.kolorea=a.couleur=a.cor="color";a["par\u00e1metro"]=a.parameter=a.parametroa=a["par\u00e2metro"]=a["par\u00e0metre"]="parameter";a["sucesi\u00f3n"]=a.sequence=a["successi\u00f3"]=a.segida=a.succession=a["seq\u00fc\u00eancia"]="sequence";
a["tama\u00f1o"]=a.size=a.neurria=a.taille=a.tamanho=a["grand\u00e0ria"]="size";a.decimales=a.decimals=a.hamartarra=a["d\u00e9cimales"]=a.decimais="decimals";a.red=a.net=a.xarxa=a.sarea=a["r\u00e9seau"]=a.rede=a.malha="net";a.red10=a.net10=a.xarxa10=a.sarea10=a["r\u00e9seau10"]=a.rede10=a.malha10="net10";a.ejes=a.axes=a.eixos=a.ardatzak=a.eixes="axes";a.texto=a.text=a.testua=a.texte="text";a["cr\u00e9ditos"]=a.about=a["cr\u00e8dits"]=a.kreditoak=a["cr\u00e9dits"]=a.sobre="about";a.config=a.konfig=
a["configura\u00e7\u00e3o"]="config";a.inicio=a.init=a.inici=a.hasiera=a.commencement=a["in\u00edcio"]="init";a.limpiar=a.clear=a.neteja=a.ezabatu=a.nettoye=a.limpar="clear";a.incr=a.gehi=a.incremento="incr";a.min=a.inf="min";a.max=a.sup=a["m\u00e1x"]="max";a.relleno=a.fill=a.ple=a.betea=a.plein=a.recheo=a.preencher="fill";a["relleno+"]=a["fill+"]=a["ple+"]=a["betea+"]=a["plein+"]=a["recheo+"]=a["preencher+"]="fillP";a["relleno-"]=a["fill-"]=a["ple-"]=a["betea-"]=a["plein-"]=a["recheo-"]=a["preencher-"]=
"fillM";a.flecha=a.arrow=a.fletxa=a.gezia=a["fl\u00e8che"]=a.frecha=a.seta="arrow";a.ancho=a.width=a.ample=a.zabalera=a.large=a.largura="width";a.punta=a.spear=a.muturra=a.pointe=a.ponta="spear";a["regi\u00f3n"]=a.region=a["regi\u00f3"]=a.eskualde=a["r\u00e9gion"]=a["rexi\u00f3n"]=a["regi\u00e3o"]="region";a.norte=a.north=a.nord=a.ipar="north";a.sur=a.south=a.sud=a.hego=a.sul="south";a.este=a.east=a.est=a.ekialde=a.leste="east";a.oeste=a.west=a.oest=a.hegoalde=a.ouest="west";a.exterior=a.external=
a.kanpoalde=a.externo="external";a["expresi\u00f3n"]=a.expresion=a["expresi\u00f3"]=a.adierazpen=a["express\u00e3o"]="expresion";a.tipo=a.type=a.tipus=a.mota="type";a["posici\u00f3n"]=a.position=a["posici\u00f3"]=a.posizio=a["posi\u00e7\u00e3o"]="position";a["constricci\u00f3n"]=a.constraint=a["constricci\u00f3"]=a.beharte=a.constriction=a["constrici\u00f3n"]=a["restri\u00e7\u00e3o"]="constraint";a.valor=a.value=a.balio=a.valeur="value";a["ecuaci\u00f3n"]=a.equation=a["equaci\u00f3"]=a.ekuazio=a["\u00e9quation"]=
a["equa\u00e7\u00e3o"]="equation";a.curva=a.curve=a.corba=a.kurba=a.courbe="curve";a.texto=a.text=a.testu=a.texte="text";a.punto=a.point=a.punt=a.puntu=a.ponto="point";a.segmento=a.segment=a.zuzenki="segment";a.arco=a.arc=a.arku="arc";a["pol\u00edgono"]=a.polygon=a["pol\u00edgon"]=a.poligono=a.polygone="polygon";a.imagen=a.image=a.imatge=a.irudi=a.imaxe=a.imagem="image";a["Versi\u00f3n"]=a.Version=a["Versi\u00f3"]=a["Vers\u00e3o"]="version";a.Idioma=a.Language=a.Hizkuntza=a.Langue="language";a["O.x"]=
"O.x";a["O.y"]="O.y";a.Botones=a.Buttons=a.Botons=a.Botoiak=a.Boutons=a["Bot\u00f3ns"]=a["Bot\u00f5es"]=a.Botons="Buttons";a["Animaci\u00f3n"]=a.Animation=a["Animaci\u00f3"]=a.Animazio=a["Anima\u00e7\u00e3o"]="Animation";a.constante=a.constant=a.Konstante="constant";a.fuente=a.font=a.iturri=a.source=a.fonte="font";a["num\u00e9rico"]=a.numeric=a["num\u00e8ric"]=a.zenbakizko=a["num\u00e9rique"]="numeric";a["gr\u00e1fico"]=a.graphic=a["gr\u00e0fic"]=a.grafiko=a.graphique="graphic";a.texto=a.text=a.testu=
a.texte="text";a.inicio=a.init=a.inici=a.hasiera=a.commencement=a["in\u00edcio"]="init";a.hacer=a["do"]=a.fer=a.egin=a.faire=a.facer=a.fazer="do";a.mientras=a["while"]=a.mentre=a.bitartean=a["tandis que"]=a.mentres=a.enquanto="while";a.evaluar=a.evaluate=a.avalua=a.ebaluatu=a["\u00e9valuer"]=a.avaliar="evaluate";a.variable=a.aldagaia=a["vari\u00e1vel"]="variable";a["funci\u00f3n"]=a["function"]=a["funci\u00f3"]=a.funtzio=a.fonction=a["fun\u00e7\u00e3o"]="function";a.algoritmo=a.algorithm=a.algorisme=
a.algorithme="algorithm";a.vector=a.array=a.bektore=a.vecteur=a.matriz="array";a["dibujar-si"]=a["draw-if"]=a["marraztu-baldin"]=a["dessiner-si"]=a["debuxar-se"]=a["desenhar-se"]=a["dibuixa-si"]="drawif";a.dominio=a.range=a.domini=a["izate-eremua"]=a.domain=a["dom\u00ednio"]="range";a.pausa=a.delay=a.eten="delay";a["eje-x"]=a["x-axis"]=a["eix-x"]=a["x-ardatza"]=a["axe-x"]=a["eixe-x"]=a["eixo-x"]="x-axis";a["eje-y"]=a["y-axis"]=a["eix-y"]=a["y-ardatza"]=a["axe-y"]=a["eixe-y"]=a["eixo-y"]="y-axis";
a["n\u00fameros"]=a.numbers=a.nombres=a.zenbakiak="numbers";a["exponencial-si"]=a["exponential-if"]=a["esponentzial-baldin"]=a["exponentiel-si"]=a["exponencial-se"]="exponentialif";a.familia=a.family=a["fam\u00edlia"]=a.famille="family";a.intervalo=a.interval=a.tarte=a.intervalle="interval";a.pasos=a.steps=a.passos=a.pausoak=a.pas="steps";a.centro=a.center=a.centre=a.zentro="center";a.radio=a.radius=a.radi=a.erradio=a.rayon=a.raio="radius";a.fin=a.end=a.fi=a.bukaera=a.fim="end";a["una-sola-vez"]=
a["only-once"]=a["una-sola-vegada"]=a["behin-bakarrik"]=a["une-seule-fois"]=a["unha-soa-vez"]=a["apenas-uma-vez"]="onlyOnce";a.siempre=a.always=a.sempre=a.beti=a.toujours="always";a["color-int"]=a["int-colour"]=a["barruko-kolore"]=a["couleur-int"]=a["cor-int"]="colorInt";a.repetir=a.loop=a.repeteix=a.errepikatu=a["r\u00e9p\u00e9ter"]="loop";a.controles=a.controls=a.kontrolak=a["contr\u00f4les"]=a.controis="controls";a.animar=a.animate=a.anima=a.animatu=a.animer="animate";a.auto="auto";a.alto=a.height=
a.alt=a.altu=a.haut=a.altura="height";a.x=a.left="x";a.y=a.top="y";a.espacio=a.space=a.espai=a.espazio=a.espace=a.espazo=a["espa\u00e7o"]="space";a.Nu="Nu";a.Nv="Nv";a.ancho=a.depth=a.amplada=a.zabalera=a.largeur=a.ancho=a.profundidade=a.amplada="width";a.largo=a.length=a.llargada=a.luzera=a.longueur=a.longo=a.comprimento=a.llargada="length";a.alto=a.height=a["al\u00e7ada"]=a.altu=a.hauteur=a.alto=a.altura=a["al\u00e7ada"]="height";a.color_reverso=a.backcolor=a.color_revers=a["atzealde kolorea"]=
a.couleur_revers=a.cor_reverso=a.cor_de_fundo="backcolor";a.aristas=a.edges=a.arestes=a.ertzak=a["ar\u00eates"]=a.arestas="edges";a.rotini=a.inirot="inirot";a.posini=a.inipos="inipos";a["tri\u00e1ngulo"]=a.triangle=a.hirukia=a["tri\u00e2ngulo"]="triangle";a.cara=a.face=a.aurpegi="face";a.polireg=a.regpoly=a["pol\u00edgonoRegular"]="polireg";a.superficie=a.surface=a["superf\u00edcie"]=a.azalera="surface";a.macro=a.makro="macro";a.id="id";a.modelo=a.model=a.eredu=a["mod\u00e8le"]="model";a.color=a.kolore=
a.couleur=a.cor="color";a.luz=a.light=a.llum=a.argia=a["lumi\u00e8re"]="light";a.metal=a.metall=a["m\u00e9tal"]="metal";a.alambre=a.wire=a.filferro=a.alanbre=a["fil de fer"]=a.arame="wire";a.cortar=a.split=a.talla=a.moztu=a.couper=a.dividir="split";a.despliegue=a.render=a.desplegament=a.zabaltze=a["d\u00e8ploiement"]=a.despregamento=a.processar="render";a.orden=a.sort=a.ordre=a.ordena=a.orde=a.ordenar="sort";a.pintor=a.painter=a.margolari=a.peintre="painter";a["trazado de rayos"]=a["ray trace"]=a["tra\u00e7at de raigs"]=
a["izpi trazadura"]=a["trace de rayons"]=a["trazado de raios"]=a["tra\u00e7ado de raios"]="raytrace";a.imagen=a.bg_image=a.imatge=a.irudia=a.imaxe=a.imagem_de_fundo="image";a.despl_imagen=a.bg_display=a.despl_imatge=a["irudi desplazamendu"]=a.despl_image=a.despr_imaxe=a["apresenta\u00e7\u00e3o_de_imagem"]="bg_display";a["arr-izq"]=a.topleft=a["dalt-esq"]=a["goi-ezk"]=a["au-dessus-gau"]=a["arr-esq"]=a["acima-esquerda"]="topleft";a["expand."]=a.stretch=a.hedatu=a["expandir "]="stretch";a.mosaico=a.patch=
a.mosaic=a.mosaiko=a["mosa\u00efque"]="patch";a.centrada=a.center=a.zentratu=a["centr\u00e9e"]=a.centrado="center";a.archivo=a.file=a.fitxer=a.artxibo=a.fichier=a.arquivo="file";a.filas_norte=a.rows_north=a.files_nord=a["HTML kodea"]=a.files_nord=a.filas_norte=a.linhas_norte=a.files_nord="rowsNorth";a.filas_sur=a.rows_south=a.files_sud=a.ipar_lerro=a.files_sud=a.filas_sur=a.linhas_sul=a.files_sud="rowsSouth";a.ancho_este=a.width_east=a.ample_est=a.hego_lerro=a.ample_est=a.ancho_leste=a.largura_leste=
a.ample_est="widthEast";a.ancho_oeste=a.width_west=a.ample_oest=a.ekialde_zabalera=a.ample_ouest=a.ancho_oeste=a.largura_oeste=a.ample_oest="widthWest";a.fijo=a.fixed=a.fix=a.hegoalde_zabalera=a.fixe=a.fixo="fixed";a["Reiniciar Animaci\u00f3n"]=a["Init Animation"]=a["Reinicia Animaci\u00f3"]=a.finko=a["Recommencer l'Animation"]=a["Reiniciar Anima\u00e7\u00e3o"]="initAnimation";a["Explicaci\u00f3n"]=a.Explanation=a.Azalpena=a.Explication=a["Explica\u00e7\u00e3o"]=a["Explicaci\u00f3"]="Explanation";
a.tooltip=a.dica="tooltip";a.discreto=a.discrete=a.discret=a.diskretu="discrete";a.interfaz=a.gui=a["interf\u00edcie"]=a.interfaze=a["interface"]="gui";a.pulsador=a.spinner=a.polsador=a.pultsadore=a.bouton="spinner";a["campo de texto"]=a.textfield=a["camp de text"]=a["testu esarrua"]=a["champ de texte"]="textfield";a["men\u00fa"]=a.choice=a.menu=a.escolha="menu";a.barra=a.scrollbar=a.barre="scrollbar";a.opciones=a.options=a.opcions=a.aukerak=a["opci\u00f3ns"]=a["op\u00e7\u00f5es"]="options";a.interior=
a.barruko=a["int\u00e9rieur"]="interior";a["condici\u00f3n"]=a.condition=a["condici\u00f3"]=a.baldintza=a["condi\u00e7\u00e3o"]="condition";a["acci\u00f3n"]=a.action=a["acci\u00f3"]=a.ekintza=a["a\u00e7\u00e3o"]="action";a.evento=a.event=a.esdeveniment=a.gertaera=a["\u00e9v\u00e9nement"]="event";a["abrir URL"]=a["open URL"]=a["obre URL"]=a["URL zabaldu"]=a["ouvrir URL"]="openURL";a["abrir Escena"]=a["open Scene"]=a["obre Escena"]=a["eszena zabaldu"]=a["ouvrir Escena"]=a["abrir Cena"]="openScene";
a["bot\u00f3n"]=a.button=a["bot\u00f3"]=a.botoi=a.bouton=a["bot\u00e3o"]="button";a.mensaje=a.message=a.mezua=a.mensaxe=a.mensagem=a.missatge="message";a.alternar=a.alternate=a.alterna=a.txandakatu=a.alterner="alternate";a["ejecuci\u00f3n"]=a.execution=a["execuci\u00f3"]=a.gauzatze=a["ex\u00e9cution"]=a["execuci\u00f3n"]=a["execu\u00e7\u00e3o"]="execution";a.calcular=a.calculate=a.calcula=a.kalkulatu=a.calculer="calculate";a.coord_abs=a.abs_coord=a.koor_abs="abs_coord";a.negrita=a.bold=a.negreta=
a.lodi=a["caract\u00e8re gras"]=a.negra=a.negrito="bold";a.cursiva=a.italics=a.etzana=a.italique=a["it\u00e1lico"]="italics";a.subrayada=a.underlined=a.subratllat=a.azpimarratua=a.soulignement=a["subli\u00f1ada"]=a.sublinhado="underlined";a.imagen=a.image=a.imatge=a.irundia=a.imaxe=a.imagem="image";a.pos_mensajes=a.msg_pos=a.pos_missatges=a.mezuen_pos=a.pos_messages=a.pos_mensaxes="msg_pos";a.izquierda=a.left=a.esquerra=a.eskerrean=a.gauche=a.esquerda=a.esquerda=a.esquerra="left";a.derecha=a.right=
a.dreta=a.eskuinan=a.droite=a.dereita=a.direita=a.dreta="right";a["sensible_a_los_movimientos_del_rat\u00f3n"]=a.sensitive_to_mouse_movements=a["sensible_als_moviments_del_ratol\u00ed"]=a["xagu mugimenduarekiko sentikorra"]=a.sensible_aux_mouvements_du_souris=a.sensible_aos_movementos_do_rato=a["sens\u00edvel_aos_movimentos_do_mouse"]="sensitive_to_mouse_movements";a.reproducir=a.play=a.reprodueix=a.erreproduzitu=a.reproduire=a.reproduzir="playAudio";a["activo-si"]=a["active-if"]=a["actiu-si"]=a["altiboa-baldin"]=
a["actif-si"]=a["activo-se"]=a["ativo-se"]="activeif";a.rotfin=a.finrot=a.bukrot="endrot";a.posfin=a.finpos=a.bukpos="endpos";a.editable=a.editagarria=a["edit\u00e1vel"]="editable";a.tipo=a.type=a.tipus=a.mota="type";a.R2="R2";a.R3="R3";a.vectores=a.bektoreak=a.vecteurs=a.vetores=a.vectors="vectors";a["fuente puntos"]=a["font size"]=a["font punts"]=a["puntu iturria"]=a["source points"]=a["fonte puntos"]=a["fonte pontos"]="font_size";a["ecuaci\u00f3n"]=a.equation=a["equaci\u00f3"]=a.ekuazio=a["\u00e9quation"]=
a["equa\u00e7\u00e3o"]="equation";a.punto=a.dot=a.punt=a.puntu=a.point=a.ponto="point";a.escenario=a.scenario=a.escenari=a.agertoki=a["sc\u00e8ne"]=a["cen\u00e1rio"]="scenario";a.cID="cID";a.matriz=a.matrix=a.matriu=a.matrice="matrix";a.filas=a.rows=a.files="rows";a.columnas=a.columns=a.colonnes="columns";a.solo_texto=a.only_text=a.seulement_texte=a["s\u00f3_texto"]=a.tan_sols_texte="onlyText";a.evaluar=a.evaluate="evaluate";a.respuesta=a.answer="answer";a.decimal_symbol=a["signo decimal"]=a["decimal symbol"]=
"decimal_symbol";a.info="info";a.color_contorn_text=a.color_text_border=a.color_borde_texto=a.muga_testuaren_kolorea=a.couleur_contour_texte=a.cor_borde_texto=a.colore_bordo_testo=a.cor_borda_texto=a.color_contorn_text="border";a.video=a["vid\u00e9o"]="video";a.audio=a["\u00e0udio"]="audio";a.autoplay="autoplay";a.loop="loop";a.poster="poster";a.opacidad=a.opacity=a["opacit\u00e9"]=a.opacitat=a.opacidade="opacity";a.alinear=a.align=a["ali\u00f1ar"]=a.aligner="align";a.malla=a.mesh="mesh";return a}(babel||
{}),descartesJS=function(a){function d(){var a,d,c,f;Number.prototype.toFixed=function(h){h=0>h?0:parseInt(h);a=this.toString();d=a.indexOf(".");c="";if(-1===d){0<h&&(c=".");for(var g=0;g<h;g++)c+="0";return a+c}f=a.length-d-1;if(f>=h)return a.substring(0,d+1+h);g=0;for(h-=f;g<h;g++)c+="0";return a+c}}function e(a,d,c){a.fillStyle="#c0c0c0";a.fillRect(d.offsetLeft,d.offsetTop,d.offsetWidth,d.offsetHeight);f(a,d,c.controls)}function f(a,d,c){for(var h,f=c.length-1;0<=f;f--)h=c[f],a.drawImage(h.getScreenshot(),
d.offsetLeft+h.x,d.offsetTop+h.y)}if(a.loadLib)return a;var c=2*Math.PI,k=360/c,g=c/360,l=Math.floor,n,q,h,r,u,p,m,s,t,v;a.rangeOK=1;a.extend=function(a,d){if(a.prototype.__proto__)a.prototype.__proto__=d.prototype;else for(var c in d.prototype)d.prototype.hasOwnProperty(c)&&(a.prototype[c]=d.prototype[c]);a.prototype.uber=d.prototype};a.radToDeg=function(a){return a*k};a.degToRad=function(a){return a*g};a.convertFont=function(a){if(""==a)return a;n=a.split(",");q="";"bold"==n[1].toLowerCase()?q+=
"Bold ":"italic"==n[1].toLowerCase()||"italics"==n[1].toLowerCase()?q+="Italic ":"bold+italic"==n[1].toLowerCase()&&(q+="Italic Bold ");q+=n[2]+"px ";h=n[0].split(" ")[0].toLowerCase();return q="serif"==h||"times new roman"==h||"timesroman"==h?q+"'Times New Roman', Times, 'Droid Serif', serif":"sansserif"==h||"arial"==h||"helvetica"==h?q+"Arial, Helvetica, 'Droid Sans', Sans-serif":q+"'Courier New', Courier, 'Droid Sans Mono', Monospace"};a.drawLine=function(a,d,c,h,f,g,e){a.lineWidth=e||1;a.strokeStyle=
g||"black";g=a.lineWidth%2?0.5:0;a.beginPath();a.moveTo(l(d)+g,l(c)+g);a.lineTo(l(h)+g,l(f)+g);a.stroke()};a.getColor=function(a,d){if("string"==typeof d)return d;r=a.evalExpression(d);u=l(255*r[0][0]);p=l(255*r[0][1]);m=l(255*r[0][2]);s=1-r[0][3];return"rgba("+u+","+p+","+m+","+s+")"};a.getFeatures=function(){a.hasJavaSupport=navigator.javaEnabled();var c=navigator.appVersion.toLowerCase();a.hasTouchSupport=window.hasOwnProperty&&window.hasOwnProperty("ontouchstart")||c.match("android")&&!0;a.hasTouchSupport=
navigator.userAgent.toLowerCase().match("qt")?!1:a.hasTouchSupport;var h=document.createElement("canvas");a.hasCanvasSupport=h.getContext&&h.getContext("2d");a.hasCanvasSupport&&(a.ctx=document.createElement("canvas").getContext("2d"));c.match("chrome")&&d()};a.getCursorPosition=function(a){a.touches?(a=a.touches[0],t=a.pageX,v=a.pageY):void 0!=a.pageX&&void 0!=a.pageY?(t=a.pageX,v=a.pageY):(t=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,v=a.clientY+document.body.scrollTop+
document.documentElement.scrollTop);return{x:t,y:v}};a.getTextWidth=function(d,c){a.ctx.font=c;return a.ctx.measureText(d).width};a.getFieldFontSize=function(a){return 14>=a?8:14<a&&16>=a?9:16<a&&19>=a?10:19<a&&22>=a?11:22<a?parseInt(a-11):l(a-0.25*a)};a.getScreenshot=function(){var d=a.apps[0],c,h=document.createElement("canvas"),g=new Image;if(d){h.setAttribute("width",d.width);h.setAttribute("height",d.height);for(var k=h.getContext("2d"),m=0,l=d.spaces.length;m<l;m++)c=d.spaces[m],"R2"===c.type&&
(k.drawImage(c.backgroundCanvas,c.x,c.y),k.drawImage(c.canvas,c.x,c.y),f(k,c.container,c.ctrs));0<d.northSpace.controls.length&&e(k,d.northSpace.container,d.northSpace);0<d.southSpace.controls.length&&e(k,d.southSpace.container,d.southSpace);0<d.eastSpace.controls.length&&e(k,d.eastSpace.container,d.eastSpace);0<d.westSpace.controls.length&&e(k,d.westSpace.container,d.westSpace);g.src=h.toDataURL("image/png")}return g};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d,
e;a.openExternalFile=function(a){d=null;var c=!1;if(window.XMLHttpRequest)try{c=new XMLHttpRequest}catch(k){c=!1}else if(window.ActiveXObject)try{c=new ActiveXObject("Msxml2.XMLHTTP")}catch(g){try{c=new ActiveXObject("Microsoft.XMLHTTP")}catch(l){c=!1}}e=c;e.open("GET",a,!1);try{e.send(null),d=e.responseText,d.match(String.fromCharCode(65533))&&(e.open("GET",a,!1),e.overrideMimeType("text/plain; charset=ISO-8859-1"),e.send(null),d=e.responseText)}catch(n){console.log("Error to load the file :",a),
d=null}return d};return a}(descartesJS||{}),descartesJS=function(a){function d(a){f=a.trim();a={ignoreAcents:!1,ignoreCaps:!1,regExp:null};f[0]==f[f.length-1]&&"'"==f[0]&&(a.ignoreCaps=!0,f=f.substring(1,f.length-1),"`"==f[0]&&"\u00b4"==f[f.length-1]&&(a.ignoreAcents=!0,f=f.substring(1,f.length-1)));"`"==f[0]&&"\u00b4"==f[f.length-1]&&(a.ignoreAcents=!0,f=f.substring(1,f.length-1),f[0]==f[f.length-1]&&"'"==f[0]&&(a.ignoreCaps=!0,f=f.substring(1,f.length-1)));"*"==f[0]&&"*"!=f[f.length-1]&&(f=f.substring(1)+
"$");"*"!=f[0]&&"*"==f[f.length-1]&&(f="^"+f.substring(0,f.length-1));"*"==f[0]&&"*"==f[f.length-1]&&(f=f.substring(1,f.length-1));f=f.replace(/\?/g,"[\\S\\s]{1}");a.regExp=f;return a}function e(a){return a.toString().replace(/\u00e1/g,"a").replace(/\u00e9/g,"e").replace(/\u00ed/g,"i").replace(/\u00f3/g,"o").replace(/\u00fa/g,"u").replace(/\u00c1/g,"A").replace(/\u00c9/g,"E").replace(/\u00cd/g,"I").replace(/\u00d3/g,"O").replace(/\u00da/g,"U").replace(/\u00f1/g,"n").replace(/\u00d1/g,"N")}if(a.loadLib)return a;
var f,c,k,g,l,n;a.buildRegularExpresionsPatterns=function(a){"("===a.charAt(0)&&(a=a.substring(1));")"===a.charAt(a.length-1)&&(a=a.substring(0,a.length-2));a=a.replace(/&squot;/g,"'").replace(/&amp;/g,"&").split("|");for(var h=0,f=a.length;h<f;h++){c=a[h].split("&");k=[];for(var g=0,e=c.length;g<e;g++)k.push(d(c[g]));a[h]=k}return a};a.escorrecto=function(d,c){g=a.buildRegularExpresionsPatterns(d);c=e(c).toLowerCase();for(var f=0,k=g.length;f<k;f++){l=g[f];n=!0;for(var p=0,m=l.length;p<m;p++)l[p].regExp=
e(l[p].regExp).toLowerCase(),n=n&&!!c.match(l[p].regExp);if(n)return 1}return 0};a.esCorrecto=function(d,c){g=a.buildRegularExpresionsPatterns(d);for(var f=0,k=g.length;f<k;f++){l=g[f];n=!0;for(var p=0,m=l.length;p<m;p++)l[p].ignoreAcents&&(c=e(c),l[p].regExp=e(l[p].regExp)),l[p].ignoreCaps&&(c=c.toLowerCase(),l[p].regExp=l[p].regExp.toLowerCase()),n=n&&!!c.match(l[p].regExp);if(n)return 1}return 0};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.getCreativeCommonsLicenseImage=
function(){var a=new Image;a.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFgAAAAfCAYAAABjyArgAAAABHNCSVQICAgIfAhkiAAACpVJREFUaIHtWm1sU9cZfu61iUYnPP/bJgdhhDbFkVYcCrR0tLHXrVNL01wvgUJDh820tivrkpQQtpEvA4HGhDoe/dCmNfbaVa1WKszX2oUO3xC0OHESm9Hi/FhloyQq1aY5OGgq8ce7H9f3xI7txKFsdKyPdHSPz8dzz33Oe77eY46IVBzHXcUXuOkgIo4DQABwuucUeJ4Hz/NQKBTgeQUUPA9ekXryPDiOB89x4DgO4DiZBQQCJQlJSiKZlEIikZCeyQQSiSSSyQTLS1KSlSciuTEsfjtgY+UmAAAHgGRxFQqFFHjFTFyhkPJ4RUpkDhzHp+ubEiclbFISM5FIhfR4IlPkZDLJhE0X+nbBxspNUALIFFehhDLjKYWTx0/B4/FgcHAQU9GpDKIlqiVYu3YtjN8xouLRR5BIKsDzcalDEjw4cJD6cgaUJGkkANIY4iRxR3x+uN9xIxgMZpTX6XQQqgSsWlNW0Md9Xng4APSns+9BqVQyUZVKpRQUSvSK52B73oaJiYmCGqTRaND4i0aUl9+PeCKBRCKOeDwVEnHE4wlm4emW/PHExzjS9SJGg6MAAIPBAL1eDwAIBAIQRREAUKIrwY7aHfja17+a8/1XPv4ELzle+lzwbKzcJAn8fu8ZKBXKGWGVi7BIqURrcxvcx9ysglqthiAI0Gq1KC8vBwD09vYiHA7D7XZjcnKSlRVMAhoad2LxHYsRj8cRi8cRj8cQj8czpwxK4mrkKn769LOIRqMQBAF2ux1arTajseFwGPX19XC73VCpVGi3tWd91LXoNdTuqPvc8MjzMJ3tO0t9/eeo39dPQwEfXfggQIJJIEiDl9RqNbW1tVEkEqG54HQ6Sa1Ws3oluhI6399HQ4Eh8g71U1//OfL0naUzYg+99+d36XTPKTrx7nHS6XQEgMxmcwafzDP7HTL328f/kBFKdCU5eRx2Oz3+2ObPxDM2Nkbe/n7y9vfT2NhYQTwAiAcARWoOVioUUCoyLVev18Pv96O1tRVqtTprGKTDbDYjFAqxoTQaHEWn7XDGXM6zHYm0G/F5fQgGgxAEAY27ds3JL79DEASMBkcx4vOz9BGfH6PBUawqK8O996xj6b/q6sLzNhtOnj6N3Q27MD4+XhBPent+/9prMKy/DzWbt6Bm8xYY1t+HMz09c/Kkg/q8feQd8tLIhWFyHHEwy9Hr9fNabS5EIhHS6/WMx/Gig0b+OkIDw1467+0jz3nJit99/4+kK5WsNxQKFcwfCoUIAOl0OmYt8igo+cY3acUyLZV/ez09/eMnCQC1tbXRwQMHCQAdffvtgnjk9nj7+yW+u9fRj7ZZqHFnA61YpqUVy7TksNvz8uSwYMmKbc/bAEjzrdPpnNdqc0GtVsPj8bC6toO21F46ZcFcak/N8wheCsJgMGTNcRaLhVm5xWLJyNNqtTAYDBkrezAo8VRUVGDjpk0YHx/HmZ4erFimxb+mrmHrE1tx6cMPUVVdXRCPVqtFNBpF0H8RAFAp/AC/dXWjo/MQ9rQ0AwBc3c68PDJ4AKlhK23F5N1CXV0dG+o3ArVaDbvdDgCYmJjAyROn2IFFEplj27Rc73G5XDnjMnLV0ev1sB3uxEFbB954601UVVfjo8th2A53YunSpXB1OxG8dKkgHhntL0gG95vfvcrSvvfggwCAaDSKT65cycsDpASWrcnj8QCQxKmtrWWFRFGEyWSC0WiE0WiE1WrNm9fV1cXyzGYzs2LPWU+a9XLg+BmB/xO4+5570NF5CGNjY2jc2YCyb92Jd44eRcXDG1CzeQubQ+eCSqWCw+HAHaoleOWVV3KW+fTT63NySAcNjgPPcRgcHAQACILAhBFFEUajMaOSKIoQRRG1tbUwmUxZeRcuXIDT6WRcLpcLg4OD0gkwJawkriRwIBDIapjZbGaWazabs/Jz1ZmdFo1GcaanBx2dh2C+ZEHFwxsAAANeLwa8XhQXF4NbpJyTZ5FSicaGBtyxeDFLG/B6WXyZdlne9gDMgqUPlk9oK1euZAXq6+sBSPNMKBSCx+OBVqvFtm3bmCXr9XqEQiEcO3YsY48MgMWnolPSe8ClPYHS0lKIoohwOJzRMLmDZscBaQ8qiiJ0Oh1L0+l0WTw/efIptO/dh1V3rkTN5i346HIYVdXV6Og8hJqtWwviGR8fR1tLKx5/bDPa9+5D+959aGlqAgDs2r07b3syBAaHjOGaPp/IPWM2m9lkHgqFYDabWZ58+BAEgeXJSF+8JKPNPDZvfExadOSOLARyWaFKYGlyPJ2no/MQLNu348o//o6/hUJw2O3Y09KMqupqWPfvQ9ma1fPyWLZvh2X7dgCAs7sbzu5uXP/0OjZUPIItNY/nbY+M7PHxX8a69eugK9XB7XbDYrFkWetsyKenEl1Jhh9g1ZoylOhKMniKi4uxp6UZX1q8GCPDw/hZXd0N8expacb3H3oIly+HAUijTldaOiePDMmCKdOLlT6fyNbscrkwOTmJQCCA5cuXw2q1sjz5mJyeJyN9yEpnM3l7PIPmtmaoVCq4XC6YTCZWh9K8bOFwGCaTCV1dXVCpVNhRuyPrY3b/sjEnz85dDXjjrTc/E8/qNatRVV2Nqupq6EpLC+IBUs4e38ggioqKsP7e+zAVnYLZbGaW5Ha7sxYyQJoyKisr8+bJ9evr69HV1YUlqiU4/5c+TE9PYzo2jVg8hlgsLjmDEnFE/jmJA9YDbC+p1+uh1+uhVqshiiLr9PmcNNei19BxwMacNLeShzl7BoYHUFRUBGuLFe5jbqjVakQiEVZQFEU4HA7mzDEYDGhtbWUd4HA4WNn0PABYvnw5wuEwHvjuAzhs78T16WnEZgks+42TiSR8Az4cO3rr3Yw3g4cJ7B3qx6JFRTh/7jxqn5X2v3a7HXVpc9aNwOVysVPY/gP78fCGhzAdm8Z0LIZ4LIZYfJbAORzw/8vYWLlJmoPlKx2DsRwajQYAYLVas7ZOC8Hk5CRbXTUaTcoRn7rFSCaRTM3FlLpyul3BA0CSkkgkpHu0fe17AUgCmUymDB9voZicnITRaGR1G3/emHKwJ2ZETrsyYovsrMX2dgEBoKbWJvKNDFLgop+e+OETGR41v9+/IE9XuidNMAkUuOgn38gg7W3fy9L/j8LMj7rnamnI76PADTjcI5EItbW1ZTjc16xdQxc+CNBQwEdNrU23+kNvSWDX9jKaW5tQaRKgVCpx2HYYr7/2Ostb6JWRdV8b4vE4BgYG8cxTz2A+pE8P8smSiDJOmbN/5+PJV0d+R6GOpnxtWhDH7NDc2iRZ8kU/dbteJY1GU3CPaTQachxxUOCin4YCPnr51y8XXJeI5oynp83HM1/9QrhylVkoR5YFy6h7rhY1W2vYVY/o6cWJ4yfmvLZ/VHgUBkM5u9A8fvwE9lv3F9DHEnJZS3reQqyO47i8z4VgtrXOXoTn48srMACsuqsMza0tKF6qSbuNSHc3ImPfKv/xZGJ8HC902nGu99yCP+azTA35eABkCbxQsXN1UiEccwos4/7y+7GhYgPuWn0XvqJSpf46Jb9ZetHVaBTDQ8M4ffL0goVN/wjWsJtgwbl+L2T+nG9NuGkCf4EbB09EX77VjbhdQUTcvwFtwhQyXNo3TwAAAABJRU5ErkJggg==";
return a};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.addCSSrules=function(){var a=document.createElement("meta");a.setAttribute("name","viewport");a.setAttribute("content","width=device-width, initial-scale=1.0, user-scalable=yes");document.head.appendChild(a);a=document.createElement("meta");a.setAttribute("name","apple-mobile-web-app-capable");a.setAttribute("content","yes");document.head.appendChild(a);a=document.createElement("meta");a.setAttribute("name","apple-mobile-web-app-status-bar-style");
a.setAttribute("content","black-translucent");document.head.appendChild(a);(a=document.getElementById("StyleDescartesApps2"))&&a.parentNode.removeChild(a);a=document.createElement("style");a.type="text/css";a.id="StyleDescartesApps2";a.setAttribute("rel","stylesheet");document.head.appendChild(a);a.innerHTML="body{ text-rendering:geometricPrecision; }\ncanvas{ image-rendering:optimizeSpeed; image-rendering:-moz-crisp-edges; image-rendering:-webkit-optimize-contrast; image-rendering:optimize-contrast; -ms-interpolation-mode:nearest-neighbor; }\ndiv.DescartesAppContainer{ border:0px solid black; position:relative; overflow:hidden; top:0px; left:0px; }\ndiv.DescartesLoader{ background-color :#efefef; position:absolute; overflow:hidden; -moz-box-shadow:0px 0px 0px #888; -webkit-box-shadow:0px 0px 100px #888; box-shadow:0px 0px 100px #888; background-image:linear-gradient(bottom, #bbbbbb 0%, #efefef 50%, #bbbbbb 100%); background-image:-o-linear-gradient(bottom, #bbbbbb 0%, #efefef 50%, #bbbbbb 100%); background-image:-moz-linear-gradient(bottom, #bbbbbb 0%, #efefef 50%, #bbbbbb 100%); background-image:-webkit-linear-gradient(bottom, #bbbbbb 0%, #efefef 50%, #bbbbbb 100%); background-image:-ms-linear-gradient(bottom, #bbbbbb 0%, #efefef 50%, #bbbbbb 100%); top:0px; left:0px; }\ndiv.DescartesLoaderImage{ background-repeat:no-repeat; background-position:center; position:absolute; overflow:hidden; top:0px; left:0px; }\ncanvas.DescartesLoaderBar{ position:absolute; overflow:hidden; top:0px; left:0px; }\ncanvas.DescartesSpace2DCanvas, canvas.DescartesSpace3DCanvas, div.blocker{ position:absolute; overflow:hidden; left:0px; top:0px; }\ndiv.DescartesSpace2DContainer, div.DescartesSpace3DContainer{ position:absolute; overflow:hidden; line-height:0px; }\ncanvas.DescartesButton{ position:absolute; cursor:pointer; }\ndiv.DescartesSpinnerContainer, div.DescartesTextFieldContainer{ background:lightgray; position:absolute; overflow:hidden; }\ninput.DescartesSpinnerField, input.DescartesTextFieldField, input.DescartesMenuField, input.DescartesScrollbarField{ font-family:Arial, Helvetica, 'Droid Sans', Sans-serif; padding:0px; border:solid #666666 1px; position:absolute; top:0px; }\nlabel.DescartesSpinnerLabel, label.DescartesMenuLabel, label.DescartesScrollbarLabel, label.DescartesTextFieldLabel{ font-family:Arial, Helvetica, 'Droid Sans', Sans-serif; font-weight:normal; text-align:center; text-overflow:ellipsis; white-space:nowrap; overflow:hidden; background-color:#e0e4e8; position:absolute; left:0px; top:0px; }\ndiv.DescartesGraphicControl{ border-style:none; position:absolute; }\ndiv.DescartesTextAreaContainer{ position:absolute; overflow:hidden; background:#c0d0d8; }\nselect.DescartesMenuSelect{ font-family:Arial, Helvetica, 'Droid Sans', Sans-serif; padding-top:0%; text-align:center; text-overflow:ellipsis; white-space:nowrap; overflow:hidden; background-color:white; position:absolute; left:0px; top:0px; }\ndiv.DescartesScrollbarContainer{ background:#eeeeee; overflow:hidden; position:absolute; }\n"};
a.addCSSrules();return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d=Math.sin,e=Math.floor,f=Math.random,c=Math.round,k=Math.abs,g=String.fromCharCode,l,n,q,h,r,u,p,m,s,t;a.Krypto=function(a){this.key=(a||0).toString()};a.Krypto.prototype.getKey=function(a){l=[];for(var c=0;256>c;c++)l[c]=g(this.alfanum(e(k(7.5*(d(1*c-a)+d(1.4*c+a)+d(0.6*c-a)+d(2.2*c+a))))));return l.join("")};a.Krypto.prototype.encode=function(a){n=e(31*f());this.key=this.getKey(n);h=g(this.alfanum(n));
return h+this.encripta(a)};a.Krypto.prototype.decode=function(a){n=this.numalfa(a.charCodeAt(0));this.key=this.getKey(n);return this.desencripta(a.substring(1))};a.Krypto.prototype.encripta=function(a){return this.bytesToString(this.encriptaAux(this.stringToBytes(a)))};a.Krypto.prototype.encriptaAux=function(a){if(null==a||null==this.key)return null;u=Array(3*a.length);for(var d=0,h=a.length;d<h;d++)s=256*e(a[d]+128)+c(255*f())+65536*c(255*f()),t=e((s<<this.shift(d))/256),u[3*d]=this.alfanum(t%32),
u[3*d+1]=this.alfanum(t/32%32),u[3*d+2]=this.alfanum(t/1024%32);return u};a.Krypto.prototype.desencripta=function(a){return this.bytesToString(this.desencriptaAux(this.stringToBytes(a)))};a.Krypto.prototype.desencriptaAux=function(a){if(null==a||null==this.key)return null;p=Array(a.length/3);for(var c=0,d=p.length;c<d;c++)t=this.numalfa(a[3*c])+32*this.numalfa(a[3*c+1])+1024*this.numalfa(a[3*c+2]),s=e(256*t>>this.shift(c)),m=e(s/256)%256-128,0>m&&(m+=256),p[c]=m;return p};a.Krypto.prototype.alfanum=
function(a){a=e(a);return 10>a?48+a:87+a};a.Krypto.prototype.numalfa=function(a){return 58>a?a-48:a-87};a.Krypto.prototype.stringToBytes=function(a){h=Array(a.length);for(var c=0,d=a.length;c<d;c++)h[c]=a.charCodeAt(c);return h};a.Krypto.prototype.bytesToString=function(a){for(var c=0,d=a.length;c<d;c++)a[c]=g(a[c]);return a.join("")};a.Krypto.prototype.shift=function(a){q=this.key.charCodeAt(a%this.key.length);h=this.numalfa(q);r=e(h/2%8);0==r&&(r=4);return r};a.Krypto.prototype.parseByte=function(a){a=
parseInt(a);a=0>a?0:a;return 255<a?255:a};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Animation=function(d,e){this.parent=d;var f=d.evaluator,c=f.parser,k=new a.Auxiliary(d);this.delay=e.delay?c.parse(e.delay):c.parse("60");this.loop=e.loop?e.loop:!1;this.auto=void 0==e.auto&&2==this.parent.version?!0:e.auto;this.controls=e.controls;this.init=k.splitInstructions(c,e.init);this.doExpr=k.splitInstructions(c,e.doExpr);e.whileExpr&&(this.whileExpr=c.parse(e.whileExpr));
var g=this,l,n,q=g.doExpr.length;this.animationExec=function(){for(n=0;n<q;n++)f.evalExpression(g.doExpr[n]);g.parent.update();g.playing&&(0<f.evalExpression(g.whileExpr)||g.loop)?(l=f.evalExpression(g.delay),g.timer=setTimeout(g.animationExec,10>l?10:l)):(g.stop(),g.parent.update())};this.playing=!1;this.auto&&this.play()};a.Animation.prototype.play=function(){this.playing?this.stop():(this.reinit(),this.playing=!0,this.timer=setTimeout(this.animationExec,this.parent.evaluator.evalExpression(this.delay)))};
a.Animation.prototype.stop=function(){this.playing=!1;clearInterval(this.timer)};a.Animation.prototype.reinit=function(){for(var a=0,e=this.init.length;a<e;a++)this.parent.evaluator.evalExpression(this.init[a])};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Action=function(a,e){this.parent=a;this.evaluator=this.parent.evaluator};a.Action.prototype.execute=function(){};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Message=function(d,e){a.Action.call(this,
d,e);this.parameter=e};a.extend(a.Message,a.Action);a.Message.prototype.execute=function(){alert(this.parameter)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Calculate=function(d,e){a.Action.call(this,d,e);var f=this.evaluator,c=f.parser;e=(e||"").replace(/&squot;/g,"'");e=e.replace(/;/g,"\\n");e=e.split("\\n")||[""];for(var k=[],g,l=0,n=e.length;l<n;l++)(g=c.parse(e[l],!0))&&k.push(g);n=k.length;this.execute=function(){for(l=0;l<n;l++)f.evalExpression(k[l])}};a.extend(a.Calculate,
a.Action);return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.OpenURL=function(d,e){a.Action.call(this,d,e);this.parameter=e;this.target="_blank";var f=this.parameter.indexOf("target");-1!=f&&(this.target=this.parameter.substring(f),this.target=this.target.substring(this.target.indexOf("=")+1),this.parameter=this.parameter.substring(0,f-1));"javascript"==this.parameter.substring(0,10)?(this.parameter=this.parameter.substring(11).replace(/&squot;/g,"'"),this.actionExec=function(){eval(this.parameter)}):
("http://"!=this.parameter.substring(0,7)&&(this.parameter=window.location.href.substring(0,window.location.href.lastIndexOf("/")+1)+this.parameter),this.actionExec=function(){window.open(this.parameter,this.target)})};a.extend(a.OpenURL,a.Action);a.OpenURL.prototype.execute=function(){this.actionExec()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.OpenScene=function(d,e){a.Action.call(this,d,e);this.parameter=e;this.target="_blank";var f=this.parameter.indexOf("target");
-1!=f&&(this.target=this.parameter.substring(f),this.target=this.target.substring(this.target.indexOf("=")+1),this.parameter=this.parameter.substring(0,f-1));"_blank"!==this.target&&"_parent"!==this.target&&"_self"!==this.target&&"_top"!==this.target?this.actionExec=function(){window.parent.postMessage({type:"changeTarget",name:this.target,value:this.parameter},"*")}:"javascript"==this.parameter.substring(0,10)?(this.parameter=this.parameter.substring(11).replace(/&squot;/g,"'"),this.actionExec=function(){eval(this.parameter)}):
("http://"!=this.parameter.substring(0,7)&&(this.parameter=window.location.href.substring(0,window.location.href.lastIndexOf("/")+1)+this.parameter),this.actionExec=function(){this.window=window.open(this.parameter,this.target,"width="+this.parent.width+",height="+this.parent.height+",left="+(window.screen.width-this.parent.width)/2+", top="+(window.screen.height-this.parent.height)/2+"location=no,menubar=no,scrollbars=no,status=no,titlebar=no,toolbar=no");this.window.onload=function(a){a=this.document;
var d=a.getElementsByTagName("applet");d&&0<d.length&&(this.innerWidth=d[0].width,this.height=d[0].height,a.body.style.margin="0px",a.body.style.padding="0px",d[0].parentNode.style.margin="0px",d[0].parentNode.style.padding="0px")}})};a.extend(a.OpenScene,a.Action);a.OpenScene.prototype.execute=function(){this.actionExec()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.About=function(d,e){a.Action.call(this,d,e);e||(this.urlAbout=window.location.href.substring(0,window.location.href.lastIndexOf("/")+
1)+e)};a.extend(a.About,a.Action);a.About.prototype.execute=function(){if(this.urlAbout)var a=window.open(this.urlAbout,"_blank","width=800px,height=600px,location=no,menubar=no,scrollbars=yes");else a=window.open("about:blank","_blank","width=800px,height=600px,location=no,menubar=no,scrollbars=yes"),a.document.write("<hmtl><head><title>Cr\u00e9ditos</title></head><body><h1>Aqu\u00ed van los cr\u00e9ditos</h1></body></html>")};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;
a.Config=function(d,e){a.Action.call(this,d,e)};a.extend(a.Config,a.Action);a.Config.prototype.execute=function(){window.open("about:blank","_blank","width=800px,height=600px,location=no,menubar=no,scrollbars=yes").document.write("<xmp style='width:100%; height:100%;'>"+this.parent.applet.outerHTML+"</xmp>")};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Init=function(d,e){a.Action.call(this,d,e)};a.extend(a.Init,a.Action);a.Init.prototype.execute=function(){this.parent.init()};
return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Clear=function(d,e){a.Action.call(this,d,e)};a.extend(a.Clear,a.Action);a.Clear.prototype.execute=function(){this.parent.clear()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Animate=function(d,e){a.Action.call(this,d,e)};a.extend(a.Animate,a.Action);a.Animate.prototype.execute=function(){this.parent.play()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.InitAnimation=
function(d,e){a.Action.call(this,d,e)};a.extend(a.InitAnimation,a.Action);a.InitAnimation.prototype.execute=function(){this.parent.reinitAnimation()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.PlayAudio=function(d,e){a.Action.call(this,d,e);this.filenameExpr=e?this.evaluator.parser.parse("'"+e.split(" ")[0].trim()+"'"):"";this.filename=this.evaluator.evalExpression(this.filenameExpr);this.theAudio=d.getAudio(this.filename)};a.extend(a.PlayAudio,a.Action);a.PlayAudio.prototype.execute=
function(){var a=this.theAudio;a.paused?a.play():(a.pause(),a.currentTime=0)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Auxiliary=function(a,c){this.parent=a;this.evaluator=this.parent.evaluator;this.expresion=this.id="";this.evaluate="onlyOnce";for(var d in c)c.hasOwnProperty(d)&&(this[d]=c[d])};a.Auxiliary.prototype.firstRun=function(){};a.Auxiliary.prototype.update=function(){};var d,e,f,c;a.Auxiliary.prototype.splitInstructions=function(a,g){e=[];g=g?g.split(";"):
[""];f=0;for(c=g.length;f<c;f++)(d=a.parse(g[f],!0))&&e.push(d);return e};a.Auxiliary.prototype.getPrivateVariables=function(a){e=[];f=0;for(c=a.length;f<c;f++)"asign"===a[f].type&&e.push(a[f].childs[0].value);return e};a.Auxiliary.prototype.buildAlgorithm=function(){var c=this,d=c.evaluator,f=d.parser;c.init=c.splitInstructions(f,c.init);c.privateVars=[];c.doExpr=c.splitInstructions(f,c.doExpr);c.whileExpr&&(c.whileExpr=f.parse(c.whileExpr));var e,q,h,r=c.privateVars.length,u=c.params.length,p=c.init.length,
m=c.doExpr.length;return function(){if(c.numberOfParams==arguments.length){e=[];for(h=0;h<r;h++)e.push(d.getVariable(c.privateVars[h]));q=[];for(h=0;h<u;h++)q.push(d.getVariable(c.params[h])),d.setVariable(c.params[h],arguments[h]);for(h=0;h<p;h++)d.evalExpression(c.init[h]);do for(h=0;h<m;h++)d.evalExpression(c.doExpr[h]);while(0<d.evalExpression(c.whileExpr));result=d.evalExpression(c.expresion);a.rangeOK=d.evalExpression(c.domain);for(h=0;h<u;h++)d.setVariable(c.params[h],q[h]);for(h=0;h<r;h++)d.setVariable(c.privateVars[h],
e[h]);return result}}};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Variable=function(d,e){a.Auxiliary.call(this,d,e);var f=this.evaluator.parser;this.expresionString=this.expresion;(this.expresion=f.parse(this.expresionString))&&f.setVariable(this.id,this.expresion);this.editable&&(this.registerTextField(),this.parent.editableRegionVisible=!0)};a.extend(a.Variable,a.Auxiliary);a.Variable.prototype.registerTextField=function(){var a=document.createElement("div"),e=document.createElement("label");
e.appendChild(document.createTextNode("___"+this.id+"=___"));var f=document.createElement("input");f.value=this.expresionString;f.disabled=!this.editable;a.appendChild(e);a.appendChild(f);var c=this,k=c.evaluator.parser;f.onkeydown=function(a){13==a.keyCode&&(c.expresion=k.parse(this.value),k.setVariable(c.id,c.expresion),c.parent.update())};this.parent.editableRegion.textFields.push({container:a,type:"div"})};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Constant=function(d,
e){a.Auxiliary.call(this,d,e);this.expresion=this.evaluator.parser.parse(this.expresion);this.update()};a.extend(a.Constant,a.Auxiliary);a.Constant.prototype.update=function(){this.evaluator.setVariable(this.id,this.evaluator.evalExpression(this.expresion))};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Vector=function(d,e){var f=d.evaluator,c=f.parser;this.size=c.parse("3");a.Auxiliary.call(this,d,e);this.expresion=this.expresion.split(";");var k;if(this.file){var g=
document.getElementById(this.file);g&&"descartes/vectorFile"==g.type?(k=g.text,"\n"==k[0]&&(k=k.substring(1))):k=a.openExternalFile(this.file);null!=k&&(k=k.split("\n"));null==k||1==k.length&&""==k[0]?(k=[],this.size=0):(this.expresion=[],this.size=null);for(var l,n=0,q=/[\w-//]*(\.png|\.jpg|\.gif|\.svg|\.PNG|\.JPG|\.GIF|\.SVG)/g,g=0,h=k.length;g<h;g++)k[g].match(/./)&&(this.expresion[n]=this.id+"["+n+"]="+k[g],n++,(l=k[g].match(q))&&this.parent.getImage(l));null===this.size&&(this.size=c.parse(this.expresion.length+
""))}g=0;for(h=this.expresion.length;g<h;g++)(k=c.parse(this.expresion[g],!0))&&"asign"!=k.type&&(k=c.parse(this.id+"["+g+"]="+this.expresion[g],!0)),this.expresion[g]=k;c=[];g=0;for(h=f.evalExpression(this.size);g<h;g++)c.push(0);f.vectors[this.id]=c;this.update()};a.extend(a.Vector,a.Auxiliary);a.Vector.prototype.update=function(){var a=this.evaluator;a.setVariable(this.id+".long",a.evalExpression(this.size));for(var e=0,f=this.expresion.length;e<f;e++)a.evalExpression(this.expresion[e])};return a}(descartesJS||
{}),descartesJS=function(a){if(a.loadLib)return a;a.Matrix=function(d,e){var f=d.evaluator,c=f.parser;this.rows=c.parse("3");this.columns=c.parse("3");a.Auxiliary.call(this,d,e);this.expresion=this.splitInstructions(c,this.expresion);var c=f.evalExpression(this.rows),k=f.evalExpression(this.columns),g=[];g.type="matrix";for(var l,n=0;n<k;n++){l=[];for(var q=0,h=c;q<h;q++)l.push(0);g[n]=l}f.matrices[this.id]=g;this.update()};a.extend(a.Matrix,a.Auxiliary);a.Matrix.prototype.update=function(){var a=
this.evaluator,e=a.evalExpression(this.rows),f=a.evalExpression(this.columns);a.setVariable(this.id+".filas",e);a.setVariable(this.id+".columnas",f);var c=a.matrices[this.id];c.rows=e;c.cols=f;e=0;for(f=this.expresion.length;e<f;e++)a.evalExpression(this.expresion[e])};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Function=function(d,e){a.Auxiliary.call(this,d,e);var f=this.evaluator,c=f.parser,k=this.id.indexOf("(");this.name=this.id.substring(0,k);this.params=this.id.substring(k+
1,this.id.length-1);this.domain=this.range?c.parse(this.range):c.parse("1");this.params=""==this.params?[]:this.params.split(",");this.numberOfParams=this.params.length;this.algorithm||(this.whileExpr=this.doExpr=this.init="");this.expresion=c.parse(this.expresion);f.setFunction(this.name,this.buildAlgorithm())};a.extend(a.Function,a.Auxiliary);return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.AuxSequence=function(d,e){a.Auxiliary.call(this,d,e);var f=this.evaluator,c=f.parser,
k=this.id.indexOf("(");this.name=this.id.substring(0,k);this.params=this.id.substring(k+1,this.id.length-1);this.domain=this.range?c.parse(this.range):c.parse("1");this.params=""==this.params?[]:this.params.split(",");this.numberOfParams=this.params.length;this.algorithm||(this.whileExpr=this.doExpr=this.init="");this.expresion=c.parse(this.expresion);f.setFunction(this.name,this.buildAlgorithm())};a.extend(a.AuxSequence,a.Auxiliary);return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;
a.Algorithm=function(d,e){a.Auxiliary.call(this,d,e);var f=this.evaluator.parser;this.params=[];this.numberOfParams=0;this.domain=f.parse("1");this.expresion=f.parse("0");this.algorithmExec=this.buildAlgorithm()};a.extend(a.Algorithm,a.Auxiliary);a.Algorithm.prototype.update=function(){this.algorithmExec();"onlyOnce"==this.evaluate&&(this.update=function(){})};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Event=function(d,e){a.Auxiliary.call(this,d,e);var f=this.evaluator;
this.condition=f.parser.parse(this.condition);this.lastEvaluation=!1;this.action=this.parent.lessonParser.parseAction(this);"onlyOnce"==this.execution&&(this.eventExec=function(){0<f.evalExpression(this.condition)&&!this.lastEvaluation&&(this.lastEvaluation=!0,this.action.execute())});"alternate"==this.execution&&(this.eventExec=function(){var a=0<f.evalExpression(this.condition);3==this.parent.version?a!=this.lastEvaluation&&(this.action.execute(),this.lastEvaluation=a?!0:!1):a&&!this.lastEvaluation?
(this.action.execute(),this.lastEvaluation=!0):!a&&this.lastEvaluation&&(this.lastEvaluation=!1)});"always"==this.execution&&(this.eventExec=function(){0<f.evalExpression(this.condition)&&this.action.execute()})};a.extend(a.Event,a.Auxiliary);a.Event.prototype.update=function(){this.eventExec()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Graphic=function(c,d){this.parent=c;this.evaluator=c.evaluator;var f=this.evaluator.parser;this.spaceID="E0";this.background=!1;this.type=
"";this.drawif=f.parse("1");this.abs_coord=!1;2!=this.parent.version?(this.color="#20303a",this.parent.arquimedes&&(this.color="black")):this.color="blue";this.trace="";this.expresion=f.parse("(0,0)");this.family="";this.family_interval=f.parse("[0,1]");this.family_steps=f.parse("8");this.editable=!1;this.font="Monospaced,PLAIN,12";this.fixed=!0;this.text="";this.decimals=f.parse("2");for(var e in d)d.hasOwnProperty(e)&&(this[e]=d[e]);this.space=this.getSpace();this.canvas=this.background?this.space.backgroundCanvas:
this.space.canvas;this.ctx=this.canvas.getContext("2d");this.trace&&(this.traceCtx=this.space.backgroundCanvas.getContext("2d"));this.font=a.convertFont(this.font);this.fontSize=(this.fontSize=this.font.match(/(\d+)px/))?parseInt(this.fontSize[1]):10};a.Graphic.prototype.getSpace=function(){for(var a=this.parent.spaces,c,d=0,f=a.length;d<f;d++)if(c=a[d],c.id==this.spaceID)return c;return a[0]};var d,e,f,c,k;a.Graphic.prototype.getFamilyValues=function(){d=this.evaluator;e=d.evalExpression(this.family_interval);
this.familyInf=e[0][0];this.familySup=e[0][1];this.fSteps=Math.round(d.evalExpression(this.family_steps));this.family_sep=0<this.fSteps?(this.familySup-this.familyInf)/this.fSteps:0};a.Graphic.prototype.drawFamilyAux=function(a,c,e){d=this.evaluator;this.getFamilyValues();f=d.getVariable(this.family);if(0<=this.fSteps)for(var k=0,h=this.fSteps;k<=h;k++)d.setVariable(this.family,this.familyInf+k*this.family_sep),0<d.evalExpression(this.drawif)&&(this.update(),this.drawAux(a,c,e));d.setVariable("_Text_H_",
0);d.setVariable(this.family,f)};a.Graphic.prototype.draw=function(a,c){""!=this.family?this.drawFamilyAux(this.ctx,a,c):0<this.evaluator.evalExpression(this.drawif)&&(this.update(),this.drawAux(this.ctx,a,c))};a.Graphic.prototype.drawTrace=function(a,c){""!=this.family?this.drawFamilyAux(this.traceCtx,a,c):0<this.evaluator.evalExpression(this.drawif)&&(this.update(),this.drawAux(this.traceCtx,a,c))};a.Graphic.prototype.drawText=function(f,e,n,q,h,r,u,p,m,s,t){if("rtfNode"==e.type)f.fillStyle=h,f.strokeStyle=
h,f.textBaseline="alphabetic",e.draw(f,n,q,m,s,u,t);else{"simpleText"===e.type&&(e=e.toString(m,s).split("\\n"));n+=r.match("Arial")?-2:r.match("Times")?-2:0;d=this.evaluator;f.fillStyle=a.getColor(d,h);f.font=r;f.textAlign=u;f.textBaseline=p;this.border&&(f.strokeStyle=a.getColor(d,this.border),f.lineWidth=parseInt(this.fontSize/12)+1.5);k=1.2*this.fontSize||0;h=0;for(r=e.length;h<r;h++)c=e[h],this.border&&f.strokeText(c,n,q+k*h),f.fillText(c,n,q+k*h)}};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;
a.SimpleText=function(a,c){this.text=c.replace("&#x2013","\u2013");this.textElements=[];this.textElementsMacros=[];this.parent=a;this.evaluator=a.evaluator;this.type="simpleText";for(var d="'",e=0,l=0,n=-1,q,h;e<c.length;)q=c.charAt(e),h=c.charAt(e-1),"["===q&&"\\"===h?(this.textElements.push(c.substring(l,e-1)+"["),this.textElementsMacros.push("'"+c.substring(l,e-1)+"['"),l=e+1):"]"===q&&"\\"===h?(this.textElements.push(c.substring(l,e-1)+"]"),this.textElementsMacros.push("'"+c.substring(l,e-1)+
"]'"),l=e+1):"["===q&&-1==n?(this.textElements.push(c.substring(l,e)),this.textElementsMacros.push("'"+c.substring(l,e)+"'"),l=e,n++):"["===q?n++:"]"===q&&0==n?(this.textElements.push(this.evaluator.parser.parse(c.substring(l,e+1))),this.textElementsMacros.push("["+c.substring(l,e+1)+"]"),l=e+1,n--):("]"==c.charAt(e)&&(n=0>n?n:n-1),d+=c.charAt(e)),e++;this.textElements.push(c.substring(l,e));this.textElementsMacros.push("'"+c.substring(l,e)+"'")};var d,e;a.SimpleText.prototype.toString=function(a,
c){d="";for(var k=0,g=this.textElements.length;k<g;k++)"string"===typeof this.textElements[k]?d+=this.textElements[k]:(e=this.evaluator.evalExpression(this.textElements[k])[0][0],""!==e&&("string"===typeof e?d+=e:(e=parseFloat(e),e=c?e.toFixed(a):parseFloat(e.toFixed(a)),d+=e.toString().replace(".",this.parent.decimal_symbol))));return d};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d=Math.floor,e=2*Math.PI;a.Equation=function(c,d){this.width=c.evaluator.parser.parse("1");
this.fillM=this.fillP=this.fill="";a.Graphic.call(this,c,d);this.generateStroke();this.parseExpression();(this.visible=2==this.parent.version&&void 0==this.visible?!0:!1)&&this.registerTextField()};a.extend(a.Equation,a.Graphic);a.Equation.prototype.parseExpression=function(){if("compOperator"==this.expresion.type){var c=this.expresion.childs[0],d=this.expresion.childs[1];"identifier"==c.type&&"y"==c.value&&!d.contains("y")?(this.funExpr=d,this.drawAux=this.drawAuxFunY):"identifier"==d.type&&"y"==
d.value&&!c.contains("y")?(this.funExpr=c,this.drawAux=this.drawAuxFunY):"identifier"==c.type&&"x"==c.value&&!d.contains("x")?(this.funExpr=d,this.drawAux=this.drawAuxFunX):"identifier"==d.type&&("x"==d.value&&!c.contains("x"))&&(this.funExpr=d,this.drawAux=this.drawAuxFunX)}this.newt=new a.R2Newton(this.evaluator,this.expresion)};a.Equation.prototype.generateStroke=function(){this.auxCanvas=document.createElement("canvas");var a=parseInt(this.evaluator.evalExpression(this.width));this.width_2=parseInt(a/
2)||1;this.auxCanvas.setAttribute("width",a);this.auxCanvas.setAttribute("height",a);this.auxCtx=this.auxCanvas.getContext("2d");this.auxCtx.beginPath();this.auxCtx.arc(this.width_2,this.width_2,this.width_2,0,2*Math.PI,!1);this.auxCtx.fill()};a.Equation.prototype.update=function(){};a.Equation.prototype.draw=function(){""!=this.family?this.drawFamilyAux(this.ctx,this.fill,this.color):(this.update(),this.drawAux(this.ctx,this.fill,this.color))};a.Equation.prototype.drawTrace=function(){this.uber.drawTrace.call(this,
this.fill,this.trace)};var f,c,k,g,l,n,q,h,r,u,p,m,s,t,v,w,B,E,C,y,D,z,G,A;a.Equation.prototype.drawAux=function(e,x,Y){e.lineWidth=1;f=this.evaluator;c=f.parser;k=this.space;g=a.getColor(f,this.color);e.fillStyle=Y;l=f.evalExpression(this.width);l=d(l)/2;c.getVariable("x");c.getVariable("y");n=k.w;q=k.h;h=d(n/8);3>h&&(h=3);r=d(q/8);3>r&&(r=3);b=[];u=new a.R2;p=new a.R2;m=new a.R2;for(A=d(r/2);A<q;A+=r)for(G=d(h/2);G<n;G+=h)if(this.abs_coord?(t=this.newt.findZero(new a.R2(G,A)),f.setVariable("x",
t.x),f.setVariable("y",t.y),s=new a.R2(t.x,t.y)):(t=this.newt.findZero(new a.R2(k.getRelativeX(G),k.getRelativeY(A))),f.setVariable("x",t.x),f.setVariable("y",t.y),s=new a.R2(k.getAbsoluteX(t.x),k.getAbsoluteY(t.y))),v=d(s.ix()),w=d(s.iy()),!(0>v||v>=n||0>w||w>=q||b[v+w*k.w]))if(b[v+w*k.w]=!0,u.x=t.x,u.y=t.y,p.x=t.x,p.y=t.y,B=this.newt.getUnitNormal(),!(0==B.x&&0==B.y)){B.rotL90();m.x=B.x;m.y=B.y;C=E=0;for(y=!1;2>C;){y&&(m.x=-B.x,m.y=-B.y,t.x=u.x,t.y=u.y,p.x=t.x,p.y=t.y,s=this.abs_coord?new a.R2(t.x,
t.y):new a.R2(k.getAbsoluteX(t.x),k.getAbsoluteY(t.y)),v=s.ix(),w=s.iy(),y=!1,E=0);this.abs_coord?(t.x+=m.x,t.y+=m.y):(t.x+=m.x/k.scale,t.y+=m.y/k.scale);t=this.newt.findZero(t);f.setVariable("x",t.x);f.setVariable("y",t.y);m.x=t.x-p.x;m.y=t.y-p.y;m.normalize();if(0==m.x&&0==m.y)break;p.x=t.x;p.y=t.y;s=this.abs_coord?new a.R2(t.x,t.y):new a.R2(k.getAbsoluteX(t.x),k.getAbsoluteY(t.y));D=d(s.ix());z=d(s.iy());if(D!=v||z!=w)if(v=D,w=z,0<=v&&v<n&&0<=w&&w<q)if(E=0,b[v+w*k.w])break;else b[v+w*k.w]=!0,a.rangeOK&&
e.drawImage(this.auxCanvas,v-this.width_2,w-this.width_2);else y=!0,C++;else 4<++E&&(y=!0,C++)}}};var K,J,H,M,x,I,F,P,R,L,V,T,N,Q,O,S,U,X,Y,W;a.Equation.prototype.drawAuxFunY=function(c,d,e){f=this.evaluator;k=this.space;n=k.w;h=1/k.scale;J=k.getAbsoluteY(0);l=f.evalExpression(this.width);g=a.getColor(f,this.color);O=a.getColor(f,this.fillM);S=a.getColor(f,this.fillP);c.fillStyle=g;H=k.getRelativeX(0);f.setVariable("x",H);R=k.getAbsoluteX(H);L=k.getAbsoluteY(f.evalExpression(this.funExpr));Q=0;for(d=
1;d<n;d++){x=H+d*h;f.setVariable("x",x);I=f.evalExpression(this.funExpr);f.setVariable("y",I);F=k.getAbsoluteX(x);P=k.getAbsoluteY(I);V=Math.min(Q,I);T=Math.max(Q,I);N={min:V,max:T};if(void 0!==I&&(a.rangeOK&&f.evalExpression(this.drawif))&&!this.hasSingularity(h,x,"x",x-h,Q,x,I,N)){if(this.fillM||this.fillP)c.lineWidth=1,c.strokeStyle=P>J?O:S,c.beginPath(),c.moveTo(F+0.5,P),c.lineTo(F+0.5,J),c.stroke();c.lineWidth=l;c.strokeStyle=g;c.beginPath();c.moveTo(R,L);c.lineTo(F,P);c.stroke()}Q=I||0;R=F;
L=P}};a.Equation.prototype.drawAuxFunX=function(c,d,h){f=this.evaluator;k=this.space;q=k.h;r=1/k.scale;K=k.getAbsoluteX(0);l=f.evalExpression(this.width);g=a.getColor(f,this.color);O=a.getColor(f,this.fillM);S=a.getColor(f,this.fillP);c.fillStyle=g;M=k.getRelativeY(q);f.setVariable("y",M);R=k.getAbsoluteX(f.evalExpression(this.funExpr));L=k.getAbsoluteY(M);d=0;for(h=1;h<q;h++){I=M+h*r;f.setVariable("y",I);x=f.evalExpression(this.funExpr);f.setVariable("x",x);F=k.getAbsoluteX(x);P=k.getAbsoluteY(I);
V=Math.min(d,x);T=Math.max(d,x);N={min:V,max:T};if(void 0!==I&&(a.rangeOK&&f.evalExpression(this.drawif))&&!this.hasSingularity(r,I,"y",I-r,d,I,x,N)){if(this.fillM||this.fillP)c.lineWidth=1,c.strokeStyle=F>K?O:S,c.beginPath(),c.moveTo(F,P+0.5),c.lineTo(K,P+0.5),c.stroke();c.lineWidth=l;c.strokeStyle=g;c.beginPath();c.moveTo(R,L);c.lineTo(F,P);c.stroke()}d=x||0;R=F;L=P}};a.Equation.prototype.hasSingularity=function(a,c,d,f,h,e,g,m){if(1E-12>Math.abs(e-f)||1E-8>Math.abs(e-f)&&Math.abs(g-h)>Math.abs(a))return!0;
U=!1;X=c;Y=(f+e)/2;this.evaluator.setVariable(d,Y);W=this.evaluator.evalExpression(this.funExpr);m.min<=W&&W<=m.max?U=!1:(m.x=Math.min(m.min,W),m.y=Math.max(m.max,W),U=this.hasSingularity(a,c,d,f,h,Y,W,m)||this.hasSingularity(a,c,d,Y,W,e,g,m));this.evaluator.setVariable(d,X);return U};a.drawPixel=function(a,c,d,f){a.moveTo(c,d);a.arc(c,d,f,0,e,!1)};a.Equation.prototype.registerTextField=function(){var a=document.createElement("input");a.value=this.expresionString;a.disabled=!this.editable;var c=this;
a.onkeydown=function(a){13==a.keyCode&&(c.expresion=c.evaluator.parser.parse(this.value),c.parseExpression(),c.parent.update())};this.parent.editableRegion.textFields.push(a)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d=Math.round;a.Curve=function(c,d){this.parameter="t";this.parameter_interval=c.evaluator.parser.parse("[0,1]");this.parameter_steps=c.evaluator.parser.parse("8");this.width=c.evaluator.parser.parse("1");this.fill="";a.Graphic.call(this,c,d);(this.visible=
2==this.parent.version&&void 0==this.visible?!0:!1)&&this.registerTextField()};a.extend(a.Curve,a.Graphic);var e,f,c,k,g,l,n,q,h,r,u;a.Curve.prototype.update=function(){e=this.evaluator;f=e.evalExpression(this.parameter_interval);this.paraInf=f[0][0];this.paraSup=f[0][1];this.pSteps=e.evalExpression(this.parameter_steps);this.paraSep=0<this.pSteps?Math.abs(this.paraSup-this.paraInf)/this.pSteps:0};a.Curve.prototype.draw=function(){this.uber.draw.call(this,this.fill,this.color)};a.Curve.prototype.drawTrace=
function(){this.uber.drawTrace.call(this,this.fill,this.trace)};a.Curve.prototype.drawAux=function(f,m,s){e=this.evaluator;c=this.space;k=d(e.evalExpression(this.width));f.lineWidth=0<k?k:1E-6;f.lineCap="round";f.lineJoin="round";f.fillStyle=a.getColor(e,m);f.strokeStyle=a.getColor(e,s);g=e.getVariable(this.parameter);f.beginPath();e.setVariable(this.parameter,this.paraInf);l=e.evalExpression(this.expresion);this.exprX=this.abs_coord?d(l[0][0]):d(c.getAbsoluteX(l[0][0]));this.exprY=this.abs_coord?
d(l[0][1]):d(c.getAbsoluteY(l[0][1]));this.rotateExp&&(n=a.degToRad(e.evalExpression(this.rotateExp)),q=Math.cos(n),h=Math.sin(n),r=this.exprX*q-this.exprY*h,u=this.exprX*h+this.exprY*q,this.exprX=r,this.exprY=u);f.moveTo(this.exprX+0.5,this.exprY+0.5);for(m=1;m<=this.pSteps;m++)e.setVariable(this.parameter,this.paraInf+m*this.paraSep),l=e.evalExpression(this.expresion),this.exprX=this.abs_coord?d(l[0][0]):d(c.getAbsoluteX(l[0][0])),this.exprY=this.abs_coord?d(l[0][1]):d(c.getAbsoluteY(l[0][1])),
this.rotateExp&&(r=this.exprX*q-this.exprY*h,u=this.exprX*h+this.exprY*q,this.exprX=r,this.exprY=u),f.lineTo(this.exprX+0.5,this.exprY+0.5);this.fill&&f.fill();f.stroke();e.setVariable(this.parameter,g)};a.Curve.prototype.registerTextField=function(){var a=document.createElement("input");a.value=this.expresionString;a.disabled=!this.editable;var c=this;a.onkeydown=function(a){13==a.keyCode&&(c.expresion=c.evaluator.parser.parse(this.value),c.parent.update())};this.parent.editableRegion.textFields.push(a)};
return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d=2*Math.PI;a.Sequence=function(d,f){this.size=d.evaluator.parser.parse("2");a.Graphic.call(this,d,f)};a.extend(a.Sequence,a.Graphic);a.Sequence.prototype.update=function(){var d=this.evaluator,f=d.evalExpression(this.expresion);this.exprX=f[0][0];this.exprY=f[0][1];if(this.rotateExp){var c=a.degToRad(d.evalExpression(this.rotateExp)),f=Math.cos(c),k=Math.sin(c),c=this.exprX*f-this.exprY*k,f=this.exprX*k+this.exprY*f;this.exprX=
c;this.exprY=f}d=d.evalExpression(this.range);this.rangeInf=d[0][0];this.rangeMax=d[0][1]};a.Sequence.prototype.draw=function(){this.uber.draw.call(this,this.color,this.color)};a.Sequence.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.trace,this.trace)};a.Sequence.prototype.drawAux=function(e,f){var c=this.evaluator,k,g,l,n=Math.ceil(c.evalExpression(this.size)-0.4);e.fillStyle=a.getColor(c,f);e.beginPath();this.rangeInf>this.rangeMax&&(l=this.rangeInf,this.rangeInf=this.rangeMax,
this.rangeMax=l);for(var q=c.getVariable("n"),h=this.rangeInf,r=this.rangeMax;h<=r;h++)c.setVariable("n",h),l=c.evalExpression(this.expresion),this.exprX=l[0][0],this.exprY=l[0][1],this.abs_coord?k=l[0][1]:(k=this.space.getAbsoluteX(l[0][0]),g=this.space.getAbsoluteY(l[0][1])),e.moveTo(k,g),e.sequence(k,g,n,0,d,!0);c.setVariable("n",q);e.fill();this.text!=[""]&&this.uber.drawText.call(this,e,this.text,k+n,g-n,this.color,this.font,"start","alphabetic",c.evalExpression(this.decimals),this.fixed,!0)};
return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d=2*Math.PI,e=Math.round;a.Point=function(c,d){this.size=c.evaluator.parser.parse("2");a.Graphic.call(this,c,d)};a.extend(a.Point,a.Graphic);var f,c,k,g,l,n,q,h,r,u,p,m;a.Point.prototype.update=function(){f=this.evaluator;k=f.evalExpression(this.expresion);this.exprX=k[0][0];this.exprY=k[0][1];this.rotateExp&&(g=a.degToRad(f.evalExpression(this.rotateExp)),l=Math.cos(g),n=Math.sin(g),q=this.exprX*l-this.exprY*n,h=this.exprX*
n+this.exprY*l,this.exprX=q,this.exprY=h)};a.Point.prototype.draw=function(){this.uber.draw.call(this,this.color,this.color)};a.Point.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.trace,this.trace)};a.Point.prototype.drawAux=function(h,g){f=this.evaluator;c=this.space;p=e(f.evalExpression(this.size));m=p+1;h.fillStyle=a.getColor(f,g);r=this.abs_coord?e(this.exprX):e(c.getAbsoluteX(this.exprX));u=this.abs_coord?e(this.exprY):e(c.getAbsoluteY(this.exprY));h.beginPath();h.arc(r,u,
p,0,d,!0);h.fill();this.text!=[""]&&this.uber.drawText.call(this,h,this.text,r+m+1,u-m,this.color,this.font,"start","alphabetic",f.evalExpression(this.decimals),this.fixed,!0)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d=Math.round,e=2*Math.PI;a.Segment=function(c,d){this.width=c.evaluator.parser.parse("1");this.size=c.evaluator.parser.parse("2");a.Graphic.call(this,c,d)};a.extend(a.Segment,a.Graphic);var f,c,k,g,l,n,q,h,r,u,p,m,s,t,v,w,B,E;a.Segment.prototype.update=
function(){f=this.evaluator;k=f.evalExpression(this.expresion);this.endPoints=[];for(var c=0,d=k.length;c<d;c++)this.endPoints[c]={x:k[c][0],y:k[c][1]};if(this.rotateExp){g=a.degToRad(f.evalExpression(this.rotateExp));l=Math.cos(g);n=Math.sin(g);c=0;for(d=this.endPoints.length;c<d;c++)q=this.endPoints[c].x*l-this.endPoints[c].y*n,h=this.endPoints[c].x*n+this.endPoints[c].y*l,this.endPoints[c].x=q,this.endPoints[c].y=h}};a.Segment.prototype.draw=function(){this.uber.draw.call(this,this.color,this.color)};
a.Segment.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.trace,this.trace)};a.Segment.prototype.drawAux=function(h,g,k){f=this.evaluator;c=this.space;r=d(f.evalExpression(this.width));h.lineWidth=0<r?r:1E-6;s=f.evalExpression(this.size);0>s&&(s=0);h.fillStyle=a.getColor(f,g);h.strokeStyle=a.getColor(f,k);h.lineCap="round";u=10+h.lineWidth;t=0==h.lineWidth%2?0:0.5;this.abs_coord?(v=d(this.endPoints[0].x),w=d(this.endPoints[0].y),B=d(this.endPoints[1].x),E=d(this.endPoints[1].y)):
(v=d(c.getAbsoluteX(this.endPoints[0].x)),w=d(c.getAbsoluteY(this.endPoints[0].y)),B=d(c.getAbsoluteX(this.endPoints[1].x)),E=d(c.getAbsoluteY(this.endPoints[1].y)));h.beginPath();h.moveTo(v+t,w+t);h.lineTo(B+t,E+t);h.stroke();h.beginPath();h.arc(v,w,s,0,e,!0);h.arc(B,E,s,0,e,!0);h.fill();this.text!=[""]&&(p=parseInt((v+B)/2)-3,m=parseInt((w+E)/2)+3,this.uber.drawText.call(this,h,this.text,p+u,m-u,this.color,this.font,"start","alphabetic",f.evalExpression(this.decimals),this.fixed,!0))};return a}(descartesJS||
{}),descartesJS=function(a){if(a.loadLib)return a;var d=Math.floor,e=Math.round;a.Arrow=function(c,d){this.width=c.evaluator.parser.parse("5");this.size=c.evaluator.parser.parse("2");this.spear=c.evaluator.parser.parse("8");this.arrow="#ee0022";a.Graphic.call(this,c,d)};a.extend(a.Arrow,a.Graphic);var f,c,k,g,l,n,q,h,r,u,p,m,s,t,v,w,B,E;a.Arrow.prototype.update=function(){f=this.evaluator;c=f.evalExpression(this.expresion);this.endPoints=[];for(var d=0,h=c.length;d<h;d++)this.endPoints[d]={x:c[d][0],
y:c[d][1]};if(this.rotateExp){k=a.degToRad(f.evalExpression(this.rotateExp));g=Math.cos(k);l=Math.sin(k);d=0;for(h=this.endPoints.length;d<h;d++)n=this.endPoints[d].x*g-this.endPoints[d].y*l,q=this.endPoints[d].x*l+this.endPoints[d].y*g,this.endPoints[d].x=n,this.endPoints[d].y=q}};a.Arrow.prototype.draw=function(){this.uber.draw.call(this,this.arrow,this.color)};a.Arrow.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.arrow,this.trace)};a.Arrow.prototype.drawAux=function(c,g,k){f=
this.evaluator;h=this.space;f.evalExpression(this.size);p=f.evalExpression(this.width);1>p&&(p=1);m=Math.ceil(p/2);s=h.scale;this.vect=new a.Vector2D(this.endPoints[1].x-this.endPoints[0].x,this.endPoints[1].y-this.endPoints[0].y);t=this.vect.vectorLength();this.angle=this.vect.angleBetweenVectors(a.Vector2D.AXIS_X);c.fillStyle=a.getColor(f,g);c.strokeStyle=a.getColor(f,k);c.lineWidth=2;this.abs_coord?(v=e(this.endPoints[0].x),w=e(this.endPoints[0].y),B=e(this.endPoints[1].x),E=e(this.endPoints[1].y)):
(v=e(h.getAbsoluteX(this.endPoints[0].x)),w=e(h.getAbsoluteY(this.endPoints[0].y)),B=e(h.getAbsoluteX(this.endPoints[1].x)),E=e(h.getAbsoluteY(this.endPoints[1].y)));g=f.evalExpression(this.spear);0>g&&(g=0);c.save();c.translate(v,w,t);this.abs_coord?0<=this.vect.x&&0<=this.vect.y||0>=this.vect.x&&0<=this.vect.y?c.rotate(this.angle):c.rotate(-this.angle):(t*=s,0<=this.vect.x&&0<=this.vect.y||0>=this.vect.x&&0<=this.vect.y?c.rotate(-this.angle):c.rotate(this.angle));c.beginPath();c.moveTo(-m,d(-m));
c.lineTo(d(t-g-p),d(-m));c.lineTo(d(t-2*g),d(-g-m));c.lineTo(d(t),0);c.lineTo(d(t-2*g),d(g+m));c.lineTo(d(t-g-p),d(m));c.lineTo(-m,d(m));c.closePath();c.stroke();c.fill();c.restore();this.text!=[""]&&(r=parseInt((v+B)/2)-3,u=parseInt((w+E)/2)+3,this.uber.drawText.call(this,c,this.text,r,u,k,this.font,"start","alphabetic",f.evalExpression(this.decimals),this.fixed,!0))};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d=Math.round;a.Polygon=function(c,d){this.width=c.evaluator.parser.parse("1");
this.fill="";a.Graphic.call(this,c,d);this.endPoints=[]};a.extend(a.Polygon,a.Graphic);var e,f,c,k,g,l,n,q,h,r,u,p;a.Polygon.prototype.update=function(){e=this.evaluator;c=e.evalExpression(this.expresion);for(var d=0,f=c.length;d<f;d++)this.endPoints[d]={x:c[d][0],y:c[d][1]};if(this.rotateExp){k=a.degToRad(e.evalExpression(this.rotateExp));g=Math.cos(k);l=Math.sin(k);d=0;for(f=this.endPoints.length;d<f;d++)n=this.endPoints[d].x*g-this.endPoints[d].y*l,q=this.endPoints[d].x*l+this.endPoints[d].y*g,
this.endPoints[d].x=n,this.endPoints[d].y=q}};a.Polygon.prototype.draw=function(){this.uber.draw.call(this,this.fill,this.color)};a.Polygon.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.trace,this.trace)};a.Polygon.prototype.drawAux=function(c,g,k){e=this.evaluator;f=this.space;h=d(e.evalExpression(this.width));c.lineWidth=0<h?h:1E-6;c.fillStyle=a.getColor(e,g);c.strokeStyle=a.getColor(e,k);c.lineCap="round";c.lineJoin="round";r=0<h?0.5:0;u=this.abs_coord?d(this.endPoints[0].x):
d(f.getAbsoluteX(this.endPoints[0].x));p=this.abs_coord?d(this.endPoints[0].y):d(f.getAbsoluteY(this.endPoints[0].y));c.beginPath();c.moveTo(u+r,p+r);g=1;for(k=this.endPoints.length;g<k;g++)u=this.abs_coord?d(this.endPoints[g].x):d(f.getAbsoluteX(this.endPoints[g].x)),p=this.abs_coord?d(this.endPoints[g].y):d(f.getAbsoluteY(this.endPoints[g].y)),c.lineTo(u+r,p+r);this.fill&&c.fill();c.stroke()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d=Math.round;a.Arc=function(c,
d){this.width=c.evaluator.parser.parse("1");this.fill="";this.center=c.evaluator.parser.parse("(0,0)");this.radius=c.evaluator.parser.parse("1");this.init=c.evaluator.parser.parse("0");this.end=c.evaluator.parser.parse("90");a.Graphic.call(this,c,d)};a.extend(a.Arc,a.Graphic);var e,f,c,k,g,l,n,q,h,r,u,p,m,s,t,v,w,B,E,C,y,D,z,G;a.Arc.prototype.update=function(){e=this.evaluator;f=e.evalExpression(this.center);this.exprX=f[0][0];this.exprY=f[0][1];this.rotateExp&&(c=a.degToRad(e.evalExpression(this.rotateExp)),
k=Math.cos(c),g=Math.sin(c),l=this.exprX*k-this.exprY*g,n=this.exprX*g+this.exprY*k,this.exprX=l,this.exprY=n);q=e.evalExpression(this.init);h=e.evalExpression(this.end);"(expr)"==this.init.type&&"(expr)"==this.end.type||"[expr]"==this.init.type&&"[expr]"==this.end.type||"(expr)"==this.init.type&&"[expr]"==this.end.type||"[expr]"==this.init.type&&"(expr)"==this.end.type?(this.vectors=!0,r=q[0][0],u=q[0][1],p=h[0][0],m=h[0][1],s=Math.acos((1*r+0*u)/Math.sqrt(r*r+u*u)),t=Math.acos((1*p+0*m)/Math.sqrt(p*
p+m*m)),0<r&&(0<u&&!this.abs_coord)&&(s=2*Math.PI-s),0<r&&(0>u&&this.abs_coord)&&(s=2*Math.PI-s),0>r&&(0>u&&this.abs_coord)&&(s=2*Math.PI-s),0>r&&(0<u&&!this.abs_coord)&&(s=2*Math.PI-s),0<p&&(0<m&&!this.abs_coord)&&(t=2*Math.PI-t),0<p&&(0>m&&this.abs_coord)&&(t=2*Math.PI-t),0>p&&(0>m&&this.abs_coord)&&(t=2*Math.PI-t),0>p&&(0<m&&!this.abs_coord)&&(t=2*Math.PI-t),v=Math.min(s,t),w=Math.max(s,t),s=v,t=w,t-s>Math.PI&&this.abs_coord&&(s=w,t=v),t-s<=Math.PI&&!this.abs_coord&&(s=w,t=v),this.iniAng=s,this.endAng=
t):(this.vectors=!1,this.iniAng=a.degToRad(q),this.endAng=a.degToRad(h))};a.Arc.prototype.draw=function(){this.uber.draw.call(this,this.fill,this.color)};a.Arc.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.fill,this.trace)};a.Arc.prototype.drawAux=function(c,f,h){e=this.evaluator;B=this.space;E=this.abs_coord?d(this.exprX):d(B.getAbsoluteX(this.exprX));C=this.abs_coord?d(this.exprY):d(B.getAbsoluteY(this.exprY));y=e.evalExpression(this.radius);!this.vectors&&this.iniAng>this.endAng&&
(D=this.iniAng,this.iniAng=this.endAng,this.endAng=D);0>y&&(y=0);z=!1;this.abs_coord||(y*=B.scale,this.vectors||(this.iniAng=-this.iniAng,this.endAng=-this.endAng,z=!0));this.vectors&&(z=this.abs_coord?!1:!0);G=d(e.evalExpression(this.width));c.lineWidth=0<G?G:1E-6;c.lineCap="round";c.fillStyle=a.getColor(e,f);c.strokeStyle=a.getColor(e,h);c.beginPath();c.arc(E,C,y,this.iniAng,this.endAng,z);this.fill&&c.fill();c.stroke();this.text!=[""]&&this.uber.drawText.call(this,c,this.text,E+4,C-2,this.color,
this.font,"start","alphabetic",e.evalExpression(this.decimals),this.fixed,!0)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Fill=function(d,e){a.Graphic.call(this,d,e)};a.extend(a.Fill,a.Graphic);a.Fill.prototype.update=function(){};a.Fill.prototype.draw=function(){this.uber.draw.call(this,this.color,this.color)};a.Fill.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.trace,this.trace)};a.Fill.prototype.drawAux=function(a,e){};return a}(descartesJS||
{}),descartesJS=function(a){if(a.loadLib)return a;a.Text=function(c,d){this.width=c.evaluator.parser.parse("0");a.Graphic.call(this,c,d);this.align||(this.align="start");this.ascent=this.fontSize-Math.ceil(this.fontSize/7)-(this.font.match("Courier")?3:0);this.abs_coord=!0};a.extend(a.Text,a.Graphic);var d,e,f,c,k,g,l,n,q,h,r,u,p,m,s,t,v;a.Text.prototype.update=function(){d=this.evaluator;e=d.evalExpression(this.expresion);this.exprX=e[0][0];this.exprY=e[0][1];this.rotateExp&&(f=a.degToRad(d.evalExpression(this.rotateExp)),
c=Math.cos(f),k=Math.sin(f),g=this.exprX*c-this.exprY*k,l=this.exprX*k+this.exprY*c,this.exprX=g,this.exprY=l)};a.Text.prototype.draw=function(){this.uber.draw.call(this,this.color)};a.Text.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.color)};a.Text.prototype.drawAux=function(a,c){"rtfNode"===this.text.type?(r=this.text,this.ascent=0):r=this.splitText(this.text.toString(this.evaluator.evalExpression(this.decimals),this.fixed).split("\\n"));this.text!=[""]&&this.uber.drawText.call(this,
a,r,parseInt(this.exprX)+5,parseInt(this.exprY)+this.ascent,c,this.font,this.align,"alphabetic")};a.Text.prototype.splitText=function(a){d=this.evaluator;n=d.evalExpression(this.width);r=[];this.ctx.font=this.font;if(20<=n&&"undefined"!=a.type){for(var c=0,f=a.length;c<f;c++)q=a[c],h=this.ctx.measureText(q).width,h>n?r=r.concat(this.splitWords(q,n)):r.push(q);u=Math.floor(1.2*this.fontSize)*r.length;d.setVariable("_Text_H_",u);return r}d.setVariable("_Text_H_",0);d.setVariable("_Text_W_",1E3);return a};
a.Text.prototype.splitWords=function(a,c){p=a;m=[];s="";v=0;for(var d,f=0,h=a.length;f<h;f++)t=p.charAt(f)," "===t&&(lastIndexOfWhite=f),s+=t,Math.round(this.ctx.measureText(s).width)>c&&(d=a.substring(v,f+1)," "!==t&&(-1===d.indexOf(" ")?(lastIndexOfWhite=f,f--):f=lastIndexOfWhite),m.push(a.substring(v,lastIndexOfWhite)),s="",v=f+1);m.push(a.substring(v));return m};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d=Math.round;a.Image=function(c,d){this.file="";this.inirot=
c.evaluator.parser.parse("0");a.Graphic.call(this,c,d);this.img=new Image;this.scaleY=this.scaleX=1;this.update()};a.extend(a.Image,a.Graphic);var e,f,c,k,g,l,n,q,h,r,u,p,m,s;a.Image.prototype.update=function(){e=this.evaluator;f=e.evalExpression(this.expresion);this.exprX=f[0][0];this.exprY=f[0][1];this.rotateExp&&(c=a.degToRad(e.evalExpression(this.rotateExp)),k=Math.cos(c),g=Math.sin(c),l=this.exprX*k-this.exprY*g,n=this.exprX*g+this.exprY*k,this.exprX=l,this.exprY=n);4==f[0].length&&(this.centered=
!0,this.scaleX=f[0][2],0==this.scaleX&&(this.scaleX=1E-5),this.scaleY=f[0][3],0==this.scaleY&&(this.scaleY=1E-5));f[1]&&2==f[1].length&&(this.centered=!0,this.scaleX=f[1][0],0==this.scaleX&&(this.scaleX=1E-5),this.scaleY=f[1][1],0==this.scaleY&&(this.scaleY=1E-5));if((q=e.evalExpression(this.file))||""==q)this.img=this.parent.getImage(q)};a.Image.prototype.draw=function(){this.uber.draw.call(this)};a.Image.prototype.drawTrace=function(){this.uber.drawTrace.call(this)};a.Image.prototype.drawAux=function(c){e=
this.evaluator;h=this.space;this.img&&(this.img.ready&&this.img.complete)&&(r=this.centered?0:this.img.width/2,u=this.centered?0:this.img.height/2,p=this.abs_coord?d(this.exprX):d(h.getAbsoluteX(this.exprX)),m=this.abs_coord?d(this.exprY):d(h.getAbsoluteY(this.exprY)),s=a.degToRad(-e.evalExpression(this.inirot)),c.translate(p+r,m+u),c.rotate(s),c.scale(this.scaleX,this.scaleY),this.opacity&&(c.globalAlpha=e.evalExpression(this.opacity)),c.drawImage(this.img,-this.img.width/2,-this.img.height/2),c.setTransform(1,
0,0,1,0,0),c.globalAlpha=1)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Fill=function(d,e){a.Graphic.call(this,d,e)};a.extend(a.Fill,a.Graphic);a.Fill.prototype.update=function(){};a.Fill.prototype.draw=function(){this.uber.draw.call(this,this.color,this.color)};a.Fill.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.trace,this.trace)};a.Fill.prototype.drawAux=function(a,e){};return a}(descartesJS||{}),descartesJS=function(a,d){if(a.loadLib)return a;
a.Macro=function(e,f){this.expresion=void 0;this.inirot=e.evaluator.parser.parse("0");a.Graphic.call(this,e,f);this.graphics=[];var c=e.lessonParser,k=new a.Tokenizer,g;for(g in f)f.hasOwnProperty(g)&&(this[g]=f[g]);if(void 0!=this.expresion){this.expresion.match("'")||(this.expresion="'"+this.expresion+"'");this.expresion=this.evaluator.parser.parse(this.expresion);g=this.expresion.value;var l,n=2;g&&((l=document.getElementById(g))&&"descartes/macro"==l.type?(l=l.text,n=3):(l=a.openExternalFile(g))&&
!l.match("tipo_de_macro")&&(l=null));var q="|";if(l){l=l.replace(/&aacute;/g,"\u00e1").replace(/&eacute;/g,"\u00e9").replace(/&iacute;/g,"\u00ed").replace(/&oacute;/g,"\u00f3").replace(/&uacute;/g,"\u00fa").replace(/&Aacute;/g,"\u00c1").replace(/&Eacute;/g,"\u00c9").replace(/&Iacute;/g,"\u00cd").replace(/&Oacute;/g,"\u00d3").replace(/&Uacute;/g,"\u00da").replace(/&ntilde;/g,"\u00f1").replace(/&Ntilde;/g,"\u00d1").replace(/\&gt;/g,">").replace(/\&lt;/g,"<").replace(/\&amp;/g,"&").split("\n").slice(n);
var h,r;g=0;for(n=l.length;g<n;g++)l[g]&&(l[g]=c.split(l[g]),l[g]&&(l[g][0]&&l[g][0][0]&&"id"==l[g][0][0])&&(h=l[g][0][1],r=h.indexOf("("),-1!=r&&(h=h.substring(0,r)),q+=h+"|"));var u,p,m,s;g=0;for(n=l.length;g<n;g++){u=l[g]||[];h=0;for(r=u.length;h<r;h++)if(p=d[u[h][0]],m=u[h][0].indexOf("."),-1!=m&&(p=d[u[h][0].substring(m+1)]),!("id"!=p&&"text"!=p&&"expresion"!=p&&"interval"!=p&&"steps"!=p&&"drawif"!=p&&"size"!=p&&"width"!=p&&"center"!=p&&"radius"!=p&&"init"!=p&&"end"!=p&&"inirot"!=p&&"do"!=p&&
"while"!=p&&"file"!=p&&"fill"!=p&&"color"!=p))if("text"==p)if(u[h][1].match(/\{\\rtf1/)){p=u[h][1];var t=this;s=function(a,c){for(var d=k.tokenize(c.replace(/\&squot;/g,"'")),f=0,h=d.length;f<h;f++)if("identifier"==d[f].type&&q.match("\\|"+d[f].value+"\\|"))d[f].value=t.name+"."+d[f].value;else if("identifier"==d[f].type&&-1!=(m=d[f].value.indexOf("."))&&q.match("\\|"+d[f].value.substring(0,m)+"\\|"))d[f].value=t.name+"."+d[f].value;return(a.match(/^\\expr/)?"\\expr ":"\\decimals ")+k.flatTokens(d)};
p=p.replace(/\\expr ([a-zA-Z_0-9\u00C0-\u021B+*/%|&^#!?:()><.']*)/gi,s);p=p.replace(/\\decimals ([a-zA-Z_0-9\u00C0-\u021B+*/%|&^#!?:()><.']*)/gi,s);u[h][1]=p}else{s=c.parseText(u[h][1]).textElementsMacros;for(var v=0,w=s.length;v<w;v++){p=k.tokenize(s[v].replace(/\&squot;/g,"'"));for(var B=0,E=p.length;B<E;B++)"identifier"==p[B].type&&q.match("\\|"+p[B].value+"\\|")&&(p[B].value=this.name+"."+p[B].value);p=k.flatTokens(p).replace(/&squot;/g,"'").replace(/'\+\(/g,"[").replace(/\)\+'/g,"]");s[v]=p.substring(1,
p.length-1)}u[h][1]=s.join("")}else{p=k.tokenize(u[h][1].replace(/\&squot;/g,"'"));s=0;for(v=p.length;s<v;s++)if("identifier"==p[s].type&&q.match("\\|"+p[s].value+"\\|"))p[s].value=this.name+"."+p[s].value;else if("identifier"==p[s].type&&-1!=(m=p[s].value.indexOf("."))&&q.match("\\|"+p[s].value.substring(0,m)+"\\|"))p[s].value=this.name+"."+p[s].value;u[h][1]=k.flatTokens(p)}}g=0;for(n=l.length;g<n;g++)if(l[g][0]){u="";h=0;for(r=l[g].length;h<r;h++)l[g][h]="type"!=d[l[g][h][0]]?l[g][h][0]+"='"+l[g][h][1]+
"' ":"espacio='"+this.spaceID+"' "+l[g][h][0]+"='"+l[g][h][1]+"' ",u+=l[g][h];l[g]=u;u.match(/^espacio/)?this.graphics.push(c.parseGraphic(l[g],this.abs_coord,this.background,this.inirot)):c.parseAuxiliar(l[g])}}}};a.extend(a.Macro,a.Graphic);a.Macro.prototype.update=function(){if(this.inipos){var a=this.evaluator.evalExpression(this.inipos);this.iniPosX=a[0][0];this.iniPosY=a[0][1]}};a.Macro.prototype.drawAux=function(a){for(var d=0,c=this.graphics.length;d<c;d++)this.inipos&&(this.graphics[d].abs_coord?
a.translate(this.iniPosX,this.iniPosY):a.translate(this.iniPosX*this.space.scale,-this.iniPosY*this.space.scale)),this.graphics[d].draw(),a.setTransform(1,0,0,1,0,0)};return a}(descartesJS||{},babel),descartesJS=function(a){if(a.loadLib)return a;a.RenderMath={};a.RenderMath.inverseSqrt=function(a){return 1/Math.sqrt(number)};a.Vector2D=function(a,e){this.x=a||0;this.y=e||0};a.Vector2D.prototype.clone=function(){return new a.Vector2D(this.x,this.y)};a.Vector2D.prototype.add=function(d){return new a.Vector2D(this.x+
d.x,this.y+d.y)};a.Vector2D.prototype.substract=function(d){return new a.Vector2D(this.x-d.x,this.y-d.y)};a.Vector2D.prototype.multiply=function(d){return new a.Vector2D(this.x*d.x,this.y*d.y)};a.Vector2D.prototype.divide=function(d){return new a.Vector2D(this.x/d.x,this.y/d.y)};a.Vector2D.prototype.scale=function(d){return new a.Vector2D(this.x*d,this.y*d)};a.Vector2D.prototype.dist=function(a){var e=a.x-this.x;a=a.y-this.y;return Math.sqrt(e*e+a*a)};a.Vector2D.prototype.negate=function(){return new a.Vector2D(-this.x,
-this.y)};a.Vector2D.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};a.Vector2D.prototype.squaredLength=function(){return this.x*this.x+this.y*this.y};a.Vector2D.prototype.normalize=function(){var d=this.squaredLength();return 0<d?(d=Math.sqrt(d),new a.Vector2D(this.x/d,this.y/d)):new a.Vector2D(0,0)};a.Vector2D.prototype.crossProduct=function(a){return this.x*a.y-this.y*a.x};a.Vector2D.prototype.dot=function(a){return this.x*a.x+this.y*a.y};a.Vector2D.prototype.direction=
function(d){var e=this.x-d.x;d=this.y-d.y;var f=e*e+d*d;if(!f)return new a.Vector2D(0,0);f=1/Math.sqrt(f);return new a.Vector2D(e*f,d*f)};a.Vector2D.prototype.lerp=function(d,e){return new a.Vector2D(this.x+e*(d.x-this.x),this.y+e*(d.y-this.y))};a.Vector3D=function(a,e,f){this.x=a||0;this.y=e||0;this.z=f||0};a.Vector3D.prototype.set=function(a,e,f){this.x=a;this.y=e;this.z=f;return this};a.Vector3D.prototype.toVector4D=function(){return new a.Vector4D(this.x,this.y,this.z,1)};a.Vector3D.prototype.copy=
function(){return new a.Vector3D(this.x,this.y,this.z)};a.Vector3D.prototype.add=function(d){return new a.Vector3D(this.x+d.x,this.y+d.y,this.z+d.z)};a.Vector3D.prototype.substract=function(d){return new a.Vector3D(this.x-d.x,this.y-d.y,this.z-d.z)};a.Vector3D.prototype.multiply=function(d){return new a.Vector3D(this.x*d.x,this.y*d.y,this.z*d.z)};a.Vector3D.prototype.negate=function(){return new a.Vector3D(-this.x,-this.y,-this.z)};a.Vector3D.prototype.scale=function(d){return new a.Vector3D(this.x*
d,this.y*d,this.z*d)};a.Vector3D.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)};a.Vector3D.prototype.squaredLength=function(){return this.x*this.x+this.y*this.y+this.z*this.z};a.Vector3D.prototype.normalize=function(){var d=this.length();if(0==d)return new a.Vector3D(0,0,0);if(1==d)return new a.Vector3D(this.x,this.y,this.z);d=1/d;return new a.Vector3D(this.x*d,this.y*d,this.z*d)};a.Vector3D.prototype.crossProduct=function(d){return new a.Vector3D(this.y*
d.z-this.z*d.y,this.z*d.x-this.x*d.z,this.x*d.y-this.y*d.x)};a.Vector3D.prototype.dotProduct=function(d){return new a.Vector3D(this.x*d.x+this.y*d.y+this.z*d.z)};a.Vector3D.prototype.direction=function(d){var e=this.x-d.x,f=this.y-d.y;d=this.z-d.z;var c=Math.sqrt(e*e+f*f+d*d);if(0==c)return new a.Vector3D(0,0,0);c=1/c;return new a.Vector3D(e*c,f*c,d*c)};a.Vector3D.prototype.lerp=function(d,e){return new a.Vector3D(this.x+e*(d.x-this.x),this.y+e*(d.y-this.y),this.z+e*(d.z-this.z))};a.Vector3D.prototype.distance=
function(a){var e=a.x-this.x,f=a.y-this.y;a=a.z-this.z;return Math.sqrt(e*e+f*f+a*a)};a.Vector3D.prototype.unproject=function(d,e,f){var c=new a.Vector4D(2*(this.x-f.x)/f.width-1,2*(this.y-f.y)/f.height-1,2*this.z-1,c[3]=1);d=e.multiply(d);if(!d.inverse())return null;c=d.multiplyVector4(c);return 0==c.w?null:new a.Vector3D(c.x/c.w,c.y/c.w,c.z/c.w)};a.Vector3D.prototype.rotationTo=function(d){var e=new a.Vector3D(1,0,0),f=new a.Vector3D(0,1,0),c=new a.Vector3D(0,0,1),k=this.dotProduct(d),g=new a.Quaternion;
1<=k?g.setIdentity():-0.999999>k?(axis=e.crossProduct(this),1E-6>axis.length()&&(axis=f.crossProduct(this)),1E-6>axis.length()&&(axis=c.crossProduct(this)),axis=axis.normalize(),g=Quaternion.fromAngleAxis(Math.PI,axis)):(e=Math.squrt(2*(1+k)),f=1/e,axis=this.crossProduct(d),g.x=axis.x*f,g.y=axis.y*f,g.z=axis.z*f,g.w=0.5*e,g=Quaternion.normalize());1<g.w?g.w=1:-1>g.w&&(g.w=-1);return g};a.Vector4D=function(a,e,f,c){this.x=a||0;this.y=e||0;this.z=f||0;this.w=c||0};a.Vector4D.prototype.set=function(a,
e,f,c){this.x=a;this.y=e;this.z=f;this.w=c;return this};a.Vector4D.prototype.toVector3D=function(){var d=0!==this.w?1/this.w:0;return new a.Vector3D(this.x*d,this.y*d,this.z*d)};a.Vector4D.prototype.clone=function(){return new a.Vector4D(this.x,this.y,this.z,this.w)};a.Vector4D.prototype.add=function(d){return new a.Vector4D(this.x+d.x,this.y+d.y,this.z+d.z,this.w+d.w)};a.Vector4D.prototype.substract=function(d){return new a.Vector4D(this.x-d.x,this.y-d.y,this.z-d.z,this.w-d.w)};a.Vector4D.prototype.multiply=
function(d){return new a.Vector4D(this.x*d.x,this.y*d.y,this.z*d.z,this.w*d.w)};a.Vector4D.prototype.divide=function(d){return new a.Vector4D(this.x/d.x,this.y/d.y,this.z/d.z,this.w/d.w)};a.Vector4D.prototype.scale=function(d){return new a.Vector4D(this.x*d,this.y*d,this.z*d,this.w*d)};a.Vector4D.prototype.negate=function(){return new a.Vector4D(-this.x,-this.y,-this.z,-this.w)};a.Vector4D.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)};a.Vector4D.prototype.squaredLength=
function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w};a.Vector4D.prototype.lerp=function(d,e){return new a.Vector4D(this.x+e*(d.x-this.x),this.y+e*(d.y-this.y),this.z+e*(d.z-this.z),this.w+e*(d.w-this.w))};a.Matrix2x2=function(a,e,f,c){this.a00=a||0;this.a01=e||0;this.a10=f||0;this.a11=c||0};a.Matrix2x2.prototype.clone=function(){return new a.Matrix2x2(this.a00,this.a01,this.a10,this.a11)};a.Matrix2x2.prototype.setIdentity=function(){this.a00=1;this.a10=this.a01=0;this.a11=1;
return this};a.Matrix2x2.prototype.transpose=function(){return new a.Matrix2x2(this.a00,this.a10,this.a01,this.a11)};a.Matrix2x2.prototype.determinant=function(){return this.a00*this.a11-this.a10*this.a01};a.Matrix2x2.prototype.inverse=function(){var d=this.determinant();if(!d)return null;d=1/d;return new a.Matrix2x2(this.a11*d,-this.a10*d,-this.a01*d,this.a00*d)};a.Matrix2x2.prototype.multiply=function(d){return new a.Matrix2x2(this.a00*d.a00+this.a01*d.a10,this.a00*d.a01+this.a01*d.a11,this.a10*
d.a00+this.a11*d.a10,this.a10*d.a01+this.a11*d.a11)};a.Matrix2x2.prototype.rotate=function(d){var e=Math.sin(d);d=Math.cos(d);return new a.Matrix2x2(this.a00*d+this.a01*e,this.a00*-e+this.a01*d,this.a10*d+this.a11*e,this.a10*-e+this.a11*d)};a.Matrix2x2.prototype.multiplyVector2=function(d){return new a.Vector2D(d.x*this.a00+d.y*this.a01,d.x*this.a10+d.y*this.a11)};a.Matrix2x2.prototype.scale=function(d){return new a.Matrix2x2(this.a00*d.x,this.a01*d.y,this.a10*d.x,this.a11*d.y)};a.Matrix3x3=function(a,
e,f,c,k,g,l,n,q){this.a00=a||0;this.a01=e||0;this.a02=f||0;this.a10=c||0;this.a11=k||0;this.a12=g||0;this.a20=l||0;this.a21=n||0;this.a22=q||0};a.Matrix3x3.prototype.copy=function(){return new a.Matrix3x3(this.a00,this.a01,this.a02,this.a10,this.a11,this.a12,this.a20,this.a21,this.a22)};a.Matrix3x3.prototype.determinant=function(){var a=this.a10,e=this.a11,f=this.a12,c=this.a20,k=this.a21,g=this.a22;return this.a00*(g*e-f*k)+this.a01*(-g*a+f*c)+this.a02*(k*a-e*c)};a.Matrix3x3.prototype.inverse=function(){var d=
this.a00,e=this.a01,f=this.a02,c=this.a10,k=this.a11,g=this.a12,l=this.a20,n=this.a21,q=this.a22,h=q*k-g*n,r=-q*c+g*l,u=n*c-k*l,p=d*h+e*r+f*u;if(!p)return null;p=1/p;return new a.Matrix3x3(h*p,(-q*e+f*n)*p,(g*e-f*k)*p,r*p,(q*d-f*l)*p,(-g*d+f*c)*p,u*p,(-n*d+e*l)*p,(k*d-e*c)*p)};a.Matrix3x3.prototype.multply=function(d){var e=this.a00,f=this.a01,c=this.a02,k=this.a10,g=this.a11,l=this.a12,n=this.a20,q=this.a21,h=this.a22,r=d.a00,u=d.a01,p=d.a02,m=d.a10,s=d.a11,t=d.a12,v=d.a20,w=d.a21;d=d.a22;return new a.Matrix3x3(r*
e+u*k+p*n,r*f+u*g+p*q,r*c+u*l+p*h,m*e+s*k+t*n,m*f+s*g+t*q,m*c+s*l+t*h,v*e+w*k+d*n,v*f+w*g+d*q,v*c+w*l+d*h)};a.Matrix3x3.prototype.multiplyVector2=function(d){return new a.Vector2D(d.x*this.a00+d.y*this.a10+this.a20,d.x*this.a01+d.y*this.a11+this.a21)};a.Matrix3x3.prototype.multiplyVector3=function(d){return new a.Vector3D(d.x*this.a00+d.y*this.a10+d.z*this.a20,d.x*this.a01+d.y*this.a11+d.z*this.a21,d.x*this.a02+d.y*this.a12+d.z*this.a22)};a.Matrix3x3.prototype.setIdentity=function(){this.a00=1;this.a10=
this.a02=this.a01=0;this.a11=1;this.a21=this.a20=this.a12=0;this.a22=1;return this};a.Matrix3x3.prototype.transpose=function(){return new a.Matrix3x3(this.a00,this.a10,this.a20,this.a01,this.a11,this.a21,this.a02,this.a12,this.a22)};a.Matrix3x3.prototype.toMatrix4x4=function(){return new a.Matrix4x4(this.a00,this.a01,this.a02,0,this.a10,this.a11,this.a12,0,this.a20,this.a21,this.a22,0,0,0,0,1)};a.Matrix4x4=function(a,e,f,c,k,g,l,n,q,h,r,u,p,m,s,t){this.a00=a||0;this.a01=e||0;this.a02=f||0;this.a03=
c||0;this.a10=k||0;this.a11=g||0;this.a12=l||0;this.a13=n||0;this.a20=q||0;this.a21=h||0;this.a22=r||0;this.a23=u||0;this.a30=p||0;this.a31=m||0;this.a32=s||0;this.a33=t||0};a.Matrix4x4.prototype.copy=function(){return new a.Matrix4x4(this.a00,this.a01,this.a02,this.a03,this.a10,this.a11,this.a12,this.a13,this.a20,this.a21,this.a22,this.a23,this.a30,this.a31,this.a32,this.a33)};a.Matrix4x4.prototype.setIdentity=function(){this.a00=1;this.a10=this.a03=this.a02=this.a01=0;this.a11=1;this.a21=this.a20=
this.a13=this.a12=0;this.a22=1;this.a32=this.a31=this.a30=this.a23=0;this.a33=1;return this};a.Matrix4x4.prototype.transpose=function(){return new a.Matrix3x3(this.a00,this.a10,this.a20,this.a30,this.a01,this.a11,this.a21,this.a31,this.a02,this.a12,this.a22,this.a32,this.a03,this.a13,this.a23,this.a33)};a.Matrix4x4.prototype.determinant=function(){var a=this.a00,e=this.a01,f=this.a02,c=this.a03,k=this.a10,g=this.a11,l=this.a12,n=this.a13,q=this.a20,h=this.a21,r=this.a22,u=this.a23,p=this.a30,m=this.a31,
s=this.a32,t=this.a33;return p*h*l*c-q*m*l*c-p*g*r*c+k*m*r*c+q*g*s*c-k*h*s*c-p*h*f*n+q*m*f*n+p*e*r*n-a*m*r*n-q*e*s*n+a*h*s*n+p*g*f*u-k*m*f*u-p*e*l*u+a*m*l*u+k*e*s*u-a*g*s*u-q*g*f*t+k*h*f*t+q*e*l*t-a*h*l*t-k*e*r*t+a*g*r*t};a.Matrix4x4.prototype.inverse=function(){var d=this.a00,e=this.a01,f=this.a02,c=this.a03,k=this.a10,g=this.a11,l=this.a12,n=this.a13,q=this.a20,h=this.a21,r=this.a22,u=this.a23,p=this.a30,m=this.a31,s=this.a32,t=this.a33,v=d*g-e*k,w=d*l-f*k,B=d*n-c*k,E=e*l-f*g,C=e*n-c*g,y=f*n-c*
l,D=q*m-h*p,z=q*s-r*p,G=q*t-u*p,A=h*s-r*m,K=h*t-u*m,J=r*t-u*s,H=v*J-w*K+B*A+E*G-C*z+y*D;if(!H)return null;H=1/H;return new a.Matrix4x4((g*J-l*K+n*A)*H,(-e*J+f*K-c*A)*H,(m*y-s*C+t*E)*H,(-h*y+r*C-u*E)*H,(-k*J+l*G-n*z)*H,(d*J-f*G+c*z)*H,(-p*y+s*B-t*w)*H,(q*y-r*B+u*w)*H,(k*K-g*G+n*D)*H,(-d*K+e*G-c*D)*H,(p*C-m*B+t*v)*H,(-q*C+h*B-u*v)*H,(-k*A+g*z-l*D)*H,(d*A-e*z+f*D)*H,(-p*E+m*w-s*v)*H,(q*E-h*w+r*v)*H)};a.Matrix4x4.prototype.toRotationMat=function(){return new a.Matrix4x4(this.a00,this.a01,this.a02,this.a03,
this.a10,this.a11,this.a12,this.a13,this.a20,this.a21,this.a22,this.a23,0,0,0,1)};a.Matrix4x4.prototype.toMatrix3x3=function(){return new a.Matrix4x4(this.a00,this.a01,this.a02,this.a10,this.a11,this.a12,this.a20,this.a21,this.a22)};a.Matrix4x4.prototype.toInverseMat3=function(){var d=this.a00,e=this.a01,f=this.a02,c=this.a10,k=this.a11,g=this.a12,l=this.a20,n=this.a21,q=this.a22,h=q*k-g*n,r=-q*c+g*l,u=n*c-k*l;return!(d*h+e*r+f*u)?null:new a.Matrix3x3(h*id,(-q*e+f*n)*id,(g*e-f*k)*id,r*id,(q*d-f*l)*
id,(-g*d+f*c)*id,u*id,(-n*d+e*l)*id,(k*d-e*c)*id)};a.Matrix4x4.prototype.multiply=function(d){var e=this.a00,f=this.a01,c=this.a02,k=this.a03,g=this.a10,l=this.a11,n=this.a12,q=this.a13,h=this.a20,r=this.a21,u=this.a22,p=this.a23,m=this.a30,s=this.a31,t=this.a32,v=this.a33,w=d.a00,B=d.a01,E=d.a02,C=d.a03,y=d.a10,D=d.a11,z=d.a12,G=d.a13,A=d.a20,K=d.a21,J=d.a22,H=d.a23,M=d.a30,x=d.a31,I=d.a32;d=d.a33;return new a.Matrix4x4(w*e+B*g+E*h+C*m,w*f+B*l+E*r+C*s,w*c+B*n+E*u+C*t,w*k+B*q+E*p+C*v,y*e+D*g+z*h+
G*m,y*f+D*l+z*r+G*s,y*c+D*n+z*u+G*t,y*k+D*q+z*p+G*v,A*e+K*g+J*h+H*m,A*f+K*l+J*r+H*s,A*c+K*n+J*u+H*t,A*k+K*q+J*p+H*v,M*e+x*g+I*h+d*m,M*f+x*l+I*r+d*s,M*c+x*n+I*u+d*t,M*k+x*q+I*p+d*v)};a.Matrix4x4.prototype.multiplyVector3=function(d){return new a.Vector3D(d.x*this.a00+d.y*this.a10+d.z*this.a20+this.a30,d.x*this.a01+d.y*this.a11+d.z*this.a21+this.a31,d.x*this.a02+d.y*this.a12+d.z*this.a22+this.a32)};a.Matrix4x4.prototype.multiplyVector4=function(d){return new a.Vector4D(d.x*this.a00+d.y*this.a10+d.z*
this.a20+d.w*this.a30,d.x*this.a01+d.y*this.a11+d.z*this.a21+d.w*this.a31,d.x*this.a02+d.y*this.a12+d.z*this.a22+d.w*this.a32,d.x*this.a03+d.y*this.a13+d.z*this.a23+d.w*this.a33)};a.Matrix4x4.prototype.translate=function(d){return new a.Matrix4x4(this.a00,this.a01,this.a02,this.a03,this.a10,this.a11,this.a12,this.a13,this.a20,this.a21,this.a22,this.a23,this.a00*d.x+this.a10*d.y+this.a20*d.z+this.a30,this.a01*d.x+this.a11*d.y+this.a21*d.z+this.a31,this.a02*d.x+this.a12*d.y+this.a22*d.z+this.a32,this.a03*
d.x+this.a13*d.y+this.a23*d.z+this.a33)};a.Matrix4x4.prototype.scale=function(d){return new a.Matrix4x4(this.a00*d.x,this.a01*d.x,this.a02*d.x,this.a03*d.x,this.a10*d.y,this.a11*d.y,this.a12*d.y,this.a13*d.y,this.a20*d.z,this.a21*d.z,this.a22*d.z,this.a23*d.z,this.a30,this.a31,this.a32,this.a33)};a.Matrix4x4.prototype.rotate=function(d,e){var f=Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z);if(!f)return null;1!==f&&(f=1/f,e.x*=f,e.y*=f,e.z*=f);var c=Math.sin(d),k=Math.cos(d),g=1-k,f=this.a00,l=this.a01,n=this.a02,
q=this.a03,h=this.a10,r=this.a11,u=this.a12,p=this.a13,m=this.a20,s=this.a21,t=this.a22,v=this.a23,w=e.x*e.x*g+k,B=e.y*e.x*g+e.z*c,E=e.z*e.x*g-e.y*c,C=e.x*e.y*g-e.z*c,y=e.y*e.y*g+k,D=e.z*e.y*g+e.x*c,z=e.x*e.z*g+e.y*c,c=e.y*e.z*g-e.x*c,k=e.z*e.z*g+k;return new a.Matrix4x4(f*w+h*B+m*E,l*w+r*B+s*E,n*w+u*B+t*E,q*w+p*B+v*E,f*C+h*y+m*D,l*C+r*y+s*D,n*C+u*y+t*D,q*C+p*y+v*D,f*z+h*c+m*k,l*z+r*c+s*k,n*z+u*c+t*k,q*z+p*c+v*k,this.a30,this.a31,this.a32,this.a33)};a.Matrix4x4.prototype.rotateX=function(d){var e=
Math.sin(d);d=Math.cos(d);var f=this.a10,c=this.a11,k=this.a12,g=this.a13,l=this.a20,n=this.a21,q=this.a22,h=this.a23;return new a.Matrix4x4(this.a00,this.a01,this.a02,this.a03,f*d+l*e,c*d+n*e,k*d+q*e,g*d+h*e,f*-e+l*d,c*-e+n*d,k*-e+q*d,g*-e+h*d,this.a30,this.a31,this.a32,this.a33)};a.Matrix4x4.prototype.rotateY=function(d){var e=Math.sin(d);d=Math.cos(d);var f=this.a00,c=this.a01,k=this.a02,g=this.a03,l=this.a20,n=this.a21,q=this.a22,h=this.a23;return new a.Matrix4x4(f*d+l*-e,c*d+n*-e,k*d+q*-e,g*
d+h*-e,this.a10,this.a11,this.a12,this.a13,f*e+l*d,c*e+n*d,k*e+q*d,g*e+h*d,this.a30,this.a31,this.a32,this.a33)};a.Matrix4x4.prototype.rotateZ=function(d){var e=Math.sin(d);d=Math.cos(d);var f=this.a00,c=this.a01,k=this.a02,g=this.a03,l=this.a10,n=this.a11,q=this.a12,h=this.a13;return new a.Matrix4x4(f*d+l*e,c*d+n*e,k*d+q*e,g*d+h*e,f*-e+l*d,c*-e+n*d,k*-e+q*d,g*-e+h*d,this.a20,this.a21,this.a22,this.a23,this.a30,this.a31,this.a32,this.a33)};a.Matrix4x4.prototype.frustum=function(d,e,f,c,k,g){var l=
e-d,n=c-f,q=g-k;return new a.Matrix4x4(2*k/l,0,0,0,0,2*k/n,0,0,(e+d)/l,(c+f)/n,-(g+k)/q,-1,0,0,-(2*g*k)/q,0)};a.Matrix4x4.prototype.perspective=function(a,e,f,c){a=f*Math.tan(a*Math.PI/360);e*=a;return this.frustum(-e,e,-a,a,f,c)};a.Matrix4x4.prototype.ortho=function(d,e,f,c,k,g){var l=e-d,n=c-f,q=g-k;return new a.Matrix4x4(2/l,0,0,0,0,2/n,0,0,0,0,-2/q,0,-(d+e)/l,-(c+f)/n,-(g+k)/q,1)};a.Matrix4x4.prototype.lookAt=function(d,e,f){if(d.x===e.x&&d.y===e.y&&d.z===e.z)return(new a.Matrix4x4).setIdentity();
var c=d.x-e.x,k=d.y-e.y;e=d.z-e.z;var g=1/Math.sqrt(c*c+k*k+e*e),c=c*g,k=k*g;e*=g;var l=f.y*e-f.z*k,n=f.z*c-f.x*e;f=f.x*k-f.y*c;(g=Math.sqrt(l*l+n*n+f*f))?(g=1/g,l*=g,n*=g,f*=g):f=n=l=0;var q=k*f-e*n,h=e*l-c*f,r=c*n-k*l;(g=Math.sqrt(q*q+h*h+r*r))?(g=1/g,q*=g,h*=g,r*=g):r=h=q=0;return new a.Matrix4x4(l,q,c,0,n,h,k,0,f,r,e,0,-(l*d.x+n*d.y+f*d.z),-(q*d.x+h*d.y+r*d.z),-(c*d.x+k*d.y+e*d.z),1)};a.Matrix4x4.prototype.fromRotationTranslation=function(d){var e=2*this.x,f=2*this.y,c=2*this.z,k=this.x*e,g=this.x*
f,l=this.x*c,n=this.y*f,q=this.y*c,h=this.z*c,e=this.w*e,f=this.w*f,c=this.w*c;return new a.Matrix4x4(1-(n+h),g+c,l-f,0,g-c,1-(k+h),q+e,0,l+f,q-e,1-(k+n),0,d.x,d.y,d.z,1)};a.Quaternion=function(a,e,f,c){this.x=a||0;this.y=e||0;this.z=f||0;this.w=c||0};a.Quaternion.prototype.clone=function(){return new a.Quaternion(this.x,this.y,this.z,this.w)};a.Quaternion.prototype.setIdentity=function(){this.z=this.y=this.x=0;this.w=1;return this};a.Quaternion.prototype.calculateW=function(){return new a.Quaternion(this.x,
this.y,this.z,-Math.sqrt(Math.abs(1-this.x*this.x-this.y*this.y-this.z*this.z)))};a.Quaternion.prototype.dot=function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w};a.Quaternion.prototype.inverse=function(){var d=this.dot(this),e=0;0!=d&&(e=1/d);return new a.Quaternion(-this.x*e,-this.y*e,-this.z*e,this.w*e)};a.Quaternion.prototype.conjugate=function(){return new a.Quaternion(-this.x,-this.y,-this.z,this.w)};a.Quaternion.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+
this.z*this.z+this.w*this.w)};a.Quaternion.prototype.normalize=function(d,e){var f=this.length();if(0===f)return new a.Quaternion;f=1/f;return new a.Quaternion(this.x*f,this.y*f,this.z*f,this.w*f)};a.Quaternion.prototype.add=function(d){return new a.Quaternion(this.x+d.x,this.y+d.y,this.z+d.z,this.w+d.w)};a.Quaternion.prototype.multiply=function(d){return new a.Quaternion(this.x*d.w+this.w*d.x+this.y*d.z-this.z*d.y,this.y*d.w+this.w*d.y+this.z*d.x-this.x*d.z,this.z*d.w+this.w*d.z+this.x*d.y-this.y*
d.x,this.w*d.w-this.x*d.x-this.y*d.y-this.z*d.z)};a.Quaternion.prototype.multiplyVector3=function(d){var e=this.w*d.x+this.y*d.z-this.z*d.y,f=this.w*d.y+this.z*d.x-this.x*d.z,c=this.w*d.z+this.x*d.y-this.y*d.x;d=-this.x*d.x-this.y*d.y-this.z*d.z;return new a.Vector3D(e*this.w+d*-this.x+f*-this.z-c*-this.y,f*this.w+d*-this.y+c*-this.x-e*-this.z,c*this.w+d*-this.z+e*-this.y-f*-this.x)};a.Quaternion.prototype.scale=function(d){return new a.Quaternion(this.x*d,this.y*d,this.z*d,this.w*d)};a.Quaternion.prototype.toMatrix3x3=
function(){var d=this.x+this.x,e=this.y+this.y,f=this.z+this.z,c=this.x*d,k=this.x*e,g=this.x*f,l=this.y*e,n=this.y*f,q=this.z*f,d=this.w*d,e=this.w*e,f=this.w*f;return new a.Matrix3x3(1-(l+q),k+f,g-e,k-f,1-(c+q),n+d,g+e,n-d,1-(c+l))};a.Quaternion.prototype.toMat4=function(){var d=this.x+this.x,e=this.y+this.y,f=this.z+this.z,c=this.x*d,k=this.x*e,g=this.x*f,l=this.y*e,n=this.y*f,q=this.z*f,d=this.w*d,e=this.w*e,f=this.w*f;return new a.Matrix4x4(1-(l+q),k+f,g-e,0,k-f,1-(c+q),n+d,0,g+e,n-d,1-(c+l),
0,0,0,0,1)};a.Quaternion.prototype.slerp=function(d,e){var f=this.x*d.x+this.y*d.y+this.z*d.z+this.w*d.w;if(1<=Math.abs(f))return new a.Quaternion(this.x,this.y,this.z,this.w);var c=Math.acos(f),k=Math.sqrt(1-f*f);if(0.0010>Math.abs(k))return new a.Quaternion(0.5*this.x+0.5*d.x,0.5*this.y+0.5*d.y,0.5*this.z+0.5*d.z,0.5*this.w+0.5*d.w);f=Math.sin((1-e)*c)/k;c=Math.sin(e*c)/k;return new a.Quaternion(this.x*f+d.x*c,this.y*f+d.y*c,this.z*f+d.z*c,this.w*f+d.w*c)};a.Quaternion.prototype.fromRotationMatrix=
function(d){var e=new a.Quaternion;fTrace=d.a00+d.a11+d.a22;var f;if(0<fTrace)f=Math.sqrt(fTrace+1),e.w=0.5*f,f=0.5/f,e.x=(d.a21-d.a12)*f,e.y=(d.a02-d.a20)*f,e.z=(d.a10-d.a01)*f;else{f=[1,2,0];var c=0;d=[d.a00,d.a01,d.a02,d.a10,d.a11,d.a12,d.a20,d.a21,d.a22];d[4]>d[0]&&(c=1);d[8]>d[3*c+c]&&(c=2);var k=f[c],g=f[k];f=Math.sqrt(d[3*c+c]-d[3*k+k]-d[3*g+g]+1);0==c?e.x=0.5*f:1==c?e.y=0.5*f:e.z=0.5*f;f=0.5/f;e.w=(d[3*g+k]-d[3*k+g])*f;0==k?e.x=(d[3*k+c]+d[3*c+k])*f:1==k?e.y=(d[3*k+c]+d[3*c+k])*f:e.z=(d[3*
k+c]+d[3*c+k])*f;0==k?e.x=(d[3*g+c]+d[3*c+g])*f:1==k?e.y=(d[3*g+c]+d[3*c+g])*f:e.z=(d[3*g+c]+d[3*c+g])*f}return e};a.Quaternion.prototype.setIdentity=function(){this.z=this.y=this.x=0;this.w=1;return this};a.Quaternion.prototype.fromAngleAxis=function(d,e){var f=0.5*d,c=Math.sin(f);return new a.Quaternion(Math.cos(f),c*e.x,c*e.y,c*e.z)};a.Quaternion.prototype.toAngleAxis=function(){var d=this.x*this.x+this.y*this.y+this.z*this.z,e=new a.Vector4D;0<d?(e.w=2*Math.acos(this.w),d=a.RenderMath.inverseSqrt(d),
e.x=this.x*d,e.y=this.y*d,e.z=this.z*d):(e.x=1,e.y=0,e.z=0,e.w=0);return e};a.Matrix4x4.prototype.toArray=function(){return[this.a00,this.a01,this.a02,this.a03,this.a10,this.a11,this.a12,this.a13,this.a20,this.a21,this.a22,this.a23,this.a30,this.a31,this.a32,this.a33]};return a}(descartesJS||{}),descartesJS=function(a){function d(a,c){return c.depth-a.depth}if(a.loadLib)return a;a.Scene=function(a,c){this.parent=a;this.graphics=[]};a.Scene.prototype.add=function(a){this.graphics.push(a)};a.Scene.prototype.draw=
function(){for(var a=0,c=this.graphics.length;a<c;a++)this.graphics[a].transformVertices(this.parent);this.graphics=this.graphics.sort(d);a=0;for(c=this.graphics.length;a<c;a++)this.graphics[a].draw()};a.Primitive3D=function(d,l,n,q,h){this.vertices=d;this.type=l;this.style=n;this.mvMatrix=q;this.ctx=h;this.transformedVertices=[];this.centroid=new a.Vector4D(0,0,0,1);"vertex"===l?this.draw=e:"triangle"===l?this.draw=drawTriangle:"face"===l?this.draw=f:"text"===l?this.draw=c:"segment"===l&&(this.draw=
k)};a.Primitive3D.prototype.transformVertices=function(a){for(var c=this.depth=0,d=this.vertices.length;c<d;c++)this.transformedVertices[c]=a.perspectiveMatrix.multiplyVector4(this.vertices[c]).toVector3D(),this.depth+=this.transformedVertices[c].z,this.transformedVertices[c].x=a.transformCoordinateX(this.transformedVertices[c].x),this.transformedVertices[c].y=a.transformCoordinateY(this.transformedVertices[c].y);this.depth/=d};a.Primitive3D.prototype.setStyle=function(){for(var a in this.style)this.ctx[a]=
this.style[a]};var e=function(){},f=function(){var a=this.ctx;this.setStyle();a.beginPath();a.moveTo(this.transformedVertices[0].x,this.transformedVertices[0].y);for(var c=1,d=this.transformedVertices.length;c<d;c++)a.lineTo(this.transformedVertices[c].x,this.transformedVertices[c].y);a.closePath();"wire"==this.style.model?(a.lineWidth=1,a.strokeStyle=this.fillStyle,a.stroke()):this.style.edges&&a.stroke();a.fill()},c=function(){},k=function(){};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;
a.Graphic3D=function(d,e){this.parent=d;var f=this.parent.evaluator.parser;this.evaluator=d.evaluator;this.spaceID="E0";this.type="";this.background=!1;this.color="#eeffaa";this.backcolor="#6090a0";this.Nu=this.evaluator.parser.parse("7");this.Nv=this.evaluator.parser.parse("7");this.drawif=f.parse("1");this.abs_coord=!1;this.family=this.trace="";this.family_interval=f.parse("[0,1]");this.family_steps=f.parse("8");this.parameter="t";this.parameter_interval=f.parse("[0,1]");this.parameter_steps=f.parse("8");
this.fillM=this.fillP=this.fill="";this.length=this.width=-1;this.editable=!1;this.info="";this.font="Monospaced,PLAIN,12";this.fixed=!0;this.size=f.parse("2");this.text="";this.decimals=f.parse("2");this.spear=f.parse("8");this.arrow="#ee0022";this.center=f.parse("(0,0)");this.radius=f.parse("1");this.init=f.parse("0");this.end=f.parse("90");this.file="";this.inirot=f.parse("0");for(var c in e)e.hasOwnProperty(c)&&(this[c]=e[c]);void 0==this.expresion&&"macro"!=this.type&&(this.expresion=f.parse("(0,0)"));
this.space=this.getSpace();this.canvas=this.background?this.space.backgroundCanvas:this.space.canvas;this.ctx=this.canvas.getContext("2d");this.trace&&(this.traceCtx=this.space.backgroundCanvas.getContext("2d"));this.font=a.convertFont(this.font)};a.Graphic3D.prototype.getSpace=function(){for(var a=this.parent.spaces,e,f=0,c=a.length;f<c;f++)if(e=a[f],e.id==this.spaceID)return e;return a[0]};a.Graphic3D.prototype.getFamilyValues=function(){var a=this.evaluator,e=a.evalExpression(this.family_interval);
this.familyInf=e[0][0];this.familySup=e[0][1];this.fSteps=Math.round(a.evalExpression(this.family_steps));this.family_sep=0<this.fSteps?(this.familySup-this.familyInf)/this.fSteps:0};a.Graphic3D.prototype.drawFamilyAux=function(a,e,f){var c=this.evaluator;this.getFamilyValues();var k=c.getVariable(this.family);if(0<=this.fSteps)for(var g=0,l=this.fSteps;g<=l;g++)c.setVariable(this.family,this.familyInf+g*this.family_sep),c.evalExpression(this.drawif)&&(this.update(),this.drawAux(a,e,f));c.setVariable("_Text_H_",
0);c.setVariable(this.family,k)};a.Graphic3D.prototype.draw=function(a,e){""!=this.family?this.drawFamilyAux(this.ctx,a,e):this.evaluator.evalExpression(this.drawif)&&(this.update(),this.drawAux(this.ctx,a,e))};a.Graphic3D.prototype.drawTrace=function(a,e){""!=this.family?this.drawFamilyAux(this.traceCtx,a,e):this.evaluator.evalExpression(this.drawif)&&(this.update(),this.drawAux(this.traceCtx,a,e))};a.Graphic3D.prototype.drawText=function(d,e,f,c,k,g,l,n,q,h){if("rtfNode"==e.type)d.fillStyle=k,d.strokeStyle=
k,d.textBaseline="alphabetic",e.draw(d,f,c,q,h,l);else{f+=g.match("Arial")?-2:g.match("Times")?-2:0;var r=this.evaluator;d.fillStyle=a.getColor(r,k);d.font=g;d.textAlign=l;d.textBaseline=n;this.fontSize=(this.fontSize=g.match(/(\d+)px/))?this.fontSize[1]:"10";this.border&&(d.strokeStyle=a.getColor(r,this.border),d.lineWidth=parseFloat(this.fontSize)/12);g=1.2*this.fontSize;if(e[0]&&e[0].type){l=0;for(n=e.length;l<n;l++)k=r.evalExpression(e[l],q,h),this.border&&d.strokeText(k,f,c+g*l),d.fillText(k,
f,c+g*l)}else{l=0;for(n=e.length;l<n;l++)k=e[l],this.border&&d.strokeText(k,f,c+g*l),d.fillText(k,f,c+g*l)}}};a.Graphic3D.prototype.findExpresionX=function(a){return(a=a.split(/x=/)[1])?(a=a.split(/y=/)[0],a=a.split(/z=/)[0]):""};a.Graphic3D.prototype.findExpresionY=function(a){return(a=a.split(/y=/)[1])?(a=a.split(/x=/)[0],a=a.split(/z=/)[0]):""};a.Graphic3D.prototype.findExpresionZ=function(a){return(a=a.split(/z=/)[1])?(a=a.split(/x=/)[0],a=a.split(/y=/)[0]):""};return a}(descartesJS||{}),descartesJS=
function(a){if(a.loadLib)return a;a.Surface3D=function(c,d){a.Graphic3D.call(this,c,d);var f=this.evaluator.parser;this.width=-1==this.width?f.parse("1"):this.width;this.mvMatrix=(new a.Matrix4x4).setIdentity();this.exprX=f.parse(this.findExpresionX(this.expresion));this.exprY=f.parse(this.findExpresionY(this.expresion));this.exprZ=f.parse(this.findExpresionZ(this.expresion))};a.extend(a.Surface3D,a.Graphic3D);var d,e,f,c,k,g,l,n,q;a.Surface3D.prototype.update=function(){d=this.evaluator;d.getVariable("u");
d.getVariable("v");d.setVariable("u",0);d.setVariable("v",0);e=d.evalExpression(this.Nu);f=d.evalExpression(this.Nv);q=a.getColor(d,this.color);l=[];for(var h=0;h<=e;h++){d.setVariable("u",h/e);for(var r=0;r<=f;r++)d.setVariable("v",r/f),c=d.evalExpression(this.exprX),k=d.evalExpression(this.exprY),d.setVariable("x",c),d.setVariable("y",k),g=d.evalExpression(this.exprZ),l.push(new a.Vector4D(c,k,g,1))}for(h=0;h<e;h++)for(r=0;r<f;r++)n=[],n.push(l[r+h*f+h]),n.push(l[r+1+h*f+h]),n.push(l[r+2+(h+1)*
f+h]),n.push(l[r+1+(h+1)*f+h]),this.space.scene.add(new a.Primitive3D(n,"face",{lineWidth:2,fillStyle:q,strokeStyle:"#808080",lineCap:"round",lineJoin:"round",edges:this.edges},this.mvMatrix,this.ctx))};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Mesh3D=function(d,c){a.Graphic3D.call(this,d,c);var e=this.evaluator.parser;this.width=-1==this.width?e.parse("1"):this.width;this.mvMatrix=(new a.Matrix4x4).setIdentity();e=a.openExternalFile(this.evaluator.evalExpression(this.file)).split(/\r/);
this.vertices=[];this.faces=[];for(var g=function(a){return parseInt(a)},l=0,n=e.length;l<n;l++)e[l].match(/^V\(/)?this.vertices.push(this.evaluator.parser.parse(e[l].substring(1),!1,this.name)):e[l].match(/^F\(/)?this.faces.push(e[l].substring(2,e[l].length-1).split(",").map(g)):e[l].match(/^VAR\(/)&&this.evaluator.evalExpression(this.evaluator.parser.parse(e[l].substring(4,e[l].length-1),!0,this.name))};a.extend(a.Mesh3D,a.Graphic3D);var d,e;a.Mesh3D.prototype.update=function(){d=this.evaluator;
e=a.getColor(d,this.color);for(var f,c,k=0,g=this.faces.length;k<g;k++){f=[];for(var l=0,n=this.faces[k].length;l<n;l++)c=this.evaluator.evalExpression(this.vertices[this.faces[k][l]])[0],f.push(new a.Vector4D(c[0],c[1],c[2],1));this.space.scene.add(new a.Primitive3D(f,"face",{lineWidth:2,fillStyle:e,strokeStyle:"#808080",lineCap:"round",lineJoin:"round",edges:this.edges},this.mvMatrix,this.ctx))}};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d=Math.max,e=Math.min,
f=Math.PI,c=Math.cos,k=Math.sin,g=Math.abs,l,n,q,h,r,u,p,m,s,t,v,w,B,E,C,y,D,z;a.R2=function(a,c){this.x=a||0;this.y=c||0};a.R2.prototype.set=function(a,c){this.x=a||0;this.y=c||0};a.R2.prototype.copy=function(){return new a.R2(this.x,this.y)};a.R2.prototype.ix=function(){return Math.round(d(e(this.x,32E3),-32E3))};a.R2.prototype.iy=function(){return Math.round(d(e(this.y,32E3),-32E3))};a.R2.prototype.equals=function(a){return this.x==a.x&&this.y==a.y};a.R2.prototype.norm2=function(){return this.x*
this.x+this.y*this.y};a.R2.prototype.norm=function(){return Math.sqrt(this.norm2())};a.R2.prototype.distance=function(a){n=this.copy();n.sub(a);return n.norm()};a.R2.prototype.dot=function(a){return this.x*a.x+this.y*a.y};a.R2.prototype.det=function(a){return this.x*a.y-this.y*a.x};a.R2.prototype.mul=function(a){this.x*=a;this.y*=a};a.R2.prototype.div=function(a){this.x/=a;this.y/=a};a.R2.prototype.add=function(a){this.x+=a.x;this.y+=a.y};a.R2.prototype.sub=function(a){this.x-=a.x;this.y-=a.y};a.R2.prototype.normalize=
function(){l=this.norm();0!=l&&this.div(l)};a.R2.prototype.rotR90=function(){l=this.x;this.x=this.y;this.y=-l};a.R2.prototype.rotL90=function(){l=this.x;this.x=-this.y;this.y=l};a.R2.prototype.rot=function(a){q=this.copy();u=c(a);p=k(a);this.x=q.x*u-q.y*p;this.y=q.x*p+q.y*u};a.R2.prototype.rot=function(a){this.rot(a*f/180)};a.R2.prototype.intersection=function(c,f,k,l){m=f.x-c.x;s=k.x-l.x;t=k.x-c.x;v=f.y-c.y;w=k.y-l.y;B=k.y-c.y;z=m*w-s*v;return 1E-6<g(z)?(h=(t*w-B*s)/z,r=(-t*v+B*m)/z,0<=h&&1>=h&&
0<=r&&1>=r?new a.R2(c.x+m*h,c.y+v*h):null):(f.x-k.x)*B!=(f.y-k.y)*t?null:c.x!=f.x?(E=e(c.x,f.x),C=d(c.x,f.x),E<=k.x&&k.x<=C?k:E<=l.x&&l.x<=C?l:null):k.x!=l.x?(y=e(k.x,l.x),D=d(k.x,l.x),y<=c.x&&c.x<=D?c:y<=f.x&&f.x<=D?f:null):c.y!=f.y?(E=e(c.y,f.y),C=d(c.y,f.y),E<=k.y&&k.y<=C?k:E<=l.y&&l.y<=C?l:null):k.y!=l.y?(y=e(k.y,l.y),D=d(k.y,l.y),y<=c.y&&c.y<=D?c:y<=f.y&&f.y<=D?f:null):c.x==k.x&&c.y==k.y?c:null};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.R2Newton=function(a,c){this.evaluator=
a;this.constraint=c;if("=="==this.constraint.value||"<"==this.constraint.value||"<="==this.constraint.value||">"==this.constraint.value||">="==this.constraint.value)this.sign="<"==this.constraint.value||"<="==this.constraint.value?"menor":">"==this.constraint.value||">="==this.constraint.value?"mayor":"igual",this.constraint=this.constraint.equalToMinus(),this.constraint=this.constraint.childs[0]};a.R2Newton.prototype.getUnitNormal=function(){this.normal.normalize();return this.normal.copy()};var d,
e,f,c,k,g,l,n;a.R2Newton.prototype.gradient=function(c){d=this.evaluator;g=new a.R2(0,0);l=d.getVariable("x");n=d.getVariable("y");d.setVariable("x",c.x);d.setVariable("y",c.y);this.f0=d.evalExpression(this.constraint);d.setVariable("x",d.getVariable("x")+1E-12);e=d.evalExpression(this.constraint);g.x=(e-this.f0)/1E-12;g.x=!isNaN(g.x)?g.x:Infinity;d.setVariable("x",d.getVariable("x")-1E-12);d.setVariable("y",d.getVariable("y")+1E-12);e=d.evalExpression(this.constraint);g.y=(e-this.f0)/1E-12;g.y=!isNaN(g.y)?
g.y:Infinity;d.setVariable("x",l);d.setVariable("y",n);return g};a.R2Newton.prototype.findZero=function(a){d=this.evaluator;k=a.copy();l=d.getVariable("x");n=d.getVariable("y");d.setVariable("x",a.x);d.setVariable("y",a.y);this.f0=d.evalExpression(this.constraint);if("menor"==this.sign&&0>=this.f0||"mayor"==this.sign&&0<=this.f0)return k;d.setVariable("x",l);d.setVariable("y",n);for(var h=0;256>h;h++)if(f=k.x,c=k.y,this.normal=this.gradient(k),0!=this.normal.norm2()&&this.normal.mul(-this.f0/this.normal.norm2()),
k.x=f+this.normal.x,k.y=c+this.normal.y,1E-6>this.normal.norm()){0==this.normal.x&&0==this.normal.y&&(this.normal.x=k.x-a.x,this.normal.y=k.y-a.y);break}return k};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Vector2D=function(a,e){this.x=a;this.y=e};a.Vector2D.AXIS_X=new a.Vector2D(1,0);a.Vector2D.AXIS_Y=new a.Vector2D(0,1);a.Vector2D.prototype.vectorLength=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};a.Vector2D.prototype.dotProduct=function(a){return this.x*
a.x+this.y*a.y};a.Vector2D.prototype.angleBetweenVectors=function(a){return Math.acos(this.dotProduct(a)/(this.vectorLength()*a.vectorLength()))};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d=Math.floor,e,f,c,k,g,l,n;a.Control=function(a,c){this.parent=a;this.evaluator=a.evaluator;var d=this.parser=a.evaluator.parser;this.id="graphic"!==c.type?"C":"G";this.gui=this.type="";this.region="south";this.y=this.x=0;this.w="video"!==c.type?100:350;this.h="video"!==c.type?
23:120;"graphic"!==c.type?"text"!==c.type?this.expresion=d.parse("(0,0,100,23)"):(this.expresion=d.parse("(0,0,300,200)"),this.w=300,this.h=200):this.expresion=d.parse("(0,0)");this.fixed=2!=this.parent.version?!1:!0;this.visible=!0;this.color=4>this.parent.version?"#000000":"#222222";this.colorInt="graphic"!==c.type?"#f0f8ff":"#ff0000";this.underlined=this.italics=this.bold="";this.font_size=4>this.parent.version?-1:d.parse("12");this.parameter=this.action="";this.parameterFont="Monospace 12px";
this.drawif=d.parse("1");this.activeif=d.parse("1");this.tooltip="";this.tooltipFont="Monospace 12px";this.Explanation="";this.ExplanationFont="Monospace 12px";this.cID=this.msg_pos="";this.valueExpr=d.parse("0");this.decimals=d.parse("2");this.min=d.parse("-Infinity");this.max=d.parse("Infinity");this.incr=d.parse("0.1");this.exponentialif=this.discrete=!1;this.zIndex=-1;for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f]);if(("video"===this.type||"audio"===this.type)&&"interior"!==this.region)this.region=
"interior";void 0==this.name&&(this.name=2==this.parent.version?this.id:"_nada_");this.name="_._"==this.name||"_nada_"==this.name||"_void_"==this.name?"":this.name;d=this.evaluator.evalExpression(this.expresion);this.x=d[0][0];this.y=d[0][1];4==d[0].length&&(this.w=d[0][2],this.h=d[0][3]);this.actionExec=this.parent.lessonParser.parseAction(this)};a.Control.prototype.init=function(){};a.Control.prototype.update=function(){};a.Control.prototype.draw=function(){};a.Control.prototype.getContainer=function(){var a=
this.parent.spaces,c;if("interior"==this.region)for(var d=0,f=a.length;d<f;d++){if(c=a[d],c.id==this.spaceID)return c.addCtr(this),this.zIndex=c.zIndex,c.numericalControlContainer}else{if("external"==this.region)return this.parent.externalSpace.container;if("scenario"==this.region)return this.cID?(this.expresion=this.evaluator.parser.parse("(0,-1000,"+this.w+","+this.h+")"),this.parent.scenarioRegion.scenarioSpace.addCtr(this),this.zIndex=this.parent.scenarioRegion.scenarioSpace.zIndex,this.parent.scenarioRegion.scenarioSpace.numericalControlContainer):
this.parent.externalSpace.container;if("north"==this.region)return this.parent.northSpace.controls.push(this),this.parent.northSpace.container;if("south"==this.region)return this.parent.southSpace.controls.push(this),this.parent.southSpace.container;if("east"==this.region)return this.parent.eastSpace.controls.push(this),this.parent.eastSpace.container;if("west"==this.region)return this.parent.westSpace.controls.push(this),this.parent.westSpace.container;if("special"==this.region)return this.parent.specialSpace.controls.push(this),
this.parent.specialSpace.container}a[0].addCtr(this);this.zIndex=a[0].zIndex;return a[0].numericalControlContainer};a.Control.prototype.addControlContainer=function(a){var c=this.getContainer();c.childNodes[0]?c.insertBefore(a,c.childNodes[0]):c.appendChild(a);c.childNodes[0]?c.insertBefore(a,c.childNodes[0]):c.appendChild(a)};a.Control.prototype.updatePositionAndSize=function(){c=k=g=l=!1;n=this.evaluator.evalExpression(this.expresion);c=this.x!=n[0][0];k=this.y!=n[0][1];this.x=n[0][0];this.y=n[0][1];
4===n[0].length&&(g=this.w!=n[0][2],l=this.h!=n[0][3],this.w=n[0][2],this.h=n[0][3]);if(g||l||c||k)this.init(),this.draw()};a.Control.prototype.updateAndExecAction=function(){this.parent.updateControls();"init"===this.action&&(this.click=!1);this.actionExec.execute();this.parent.updateControls();"animate"!==this.action&&this.parent.update()};a.Control.prototype.createGradient=function(a,c){this.linearGradient=this.ctx.createLinearGradient(0,0,0,c);e=c*c;for(var h=0;h<c;h++)f=d(h-35*c/100),this.linearGradient.addColorStop(h/
c,"rgba(0,0,0,"+192*f*f/e/255+")")};var q,h,r,u,p,m,s;a.Control.prototype.getScreenshot=function(){r=this;q=document.createElement("canvas");q.setAttribute("width",r.w);q.setAttribute("height",r.h);h=q.getContext("2d");h.font=r.fieldFontSize+"px Arial, Helvetica, 'Droid Sans', Sans-serif";r.canvas&&(u=r.canvas.offsetLeft,p=r.canvas.offsetTop,h.drawImage(r.canvas,u,p));r.label&&(u=r.label.offsetLeft,p=r.label.offsetTop,m=r.label.offsetWidth,s=r.label.offsetHeight,h.fillStyle="#e0e4e8",h.fillRect(u,
p,m,s),h.fillStyle="black",h.textAlign="center",h.textBaseline="middle",h.fillText(r.name,u+m/2,p+s/2));r.field&&(u=r.field.offsetLeft,p=r.field.offsetTop,m=r.field.offsetWidth,s=r.field.offsetHeight,h.fillStyle="white",h.strokeStyle="#666666",h.lineWidth=1,h.fillRect(u,0,m,s),h.strokeRect(u+0.5,0.5,m-1,s-1),h.fillStyle="black",h.textAlign="center",h.textAlign="left",h.fillText(r.field.value,u+2,s/2));r.select&&(u=r.select.offsetLeft,p=r.select.offsetTop,m=r.select.offsetWidth,s=r.select.offsetHeight,
h.fillStyle="#e0e4e8",h.strokeStyle="#666666",h.lineWidth=1,h.fillRect(u,0,m,s),h.strokeRect(u+0.5,0.5,m,s-1),h.fillStyle="black",h.textAlign="center",h.textAlign="left",h.fillText(r.select.value,u+2,s/2),h.fillStyle="#c0c0c0",h.fillRect(u+m-15+0.5,0.5,15,s-1),h.strokeRect(u+m-15+0.5,0.5,15,s-1),h.fillStyle="black",h.beginPath(),h.moveTo(u+m-15+4.5,s/2-2.5),h.lineTo(u+m-15+8,s/2+2.5),h.lineTo(u+m-15+11.5,s/2-2.5),h.closePath(),h.fill());return q};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;
var d=Math.floor,e,f,c,k,g,l,n,q,h,r,u,p,m=900;a.Button=function(c,d){this.imageSrc="";this.image=new Image;this.imageOver=new Image;this.imageDown=new Image;a.Control.call(this,c,d);-1===this.font_size&&(this.fontSizeNotSet=!0);"["===this.name.charAt(0)&&"]"===this.name.charAt(this.name.length-1)?this.name=this.parser.parse(this.name.substring(1,this.name.length-1)):this.name=this.parser.parse("'"+this.name+"'");var f;this.imageSrc.match("_COLORES_")&&(f=this.imageSrc.split("_"),this.colorInt="#"+
f[2],this.color="#"+f[3],this.font_size=this.parser.parse(f[5]),this.imageSrc="");this.imageSrc=this.parser.parse("'"+this.imageSrc+"'");f=this.evaluator.evalExpression(this.imageSrc).trim();if(""!=f){var h=f.substr(0,f.lastIndexOf(".")),e=f.substr(f.lastIndexOf("."));f.toLowerCase().match(/vacio.gif$/)?(this.image.ready=1,3===this.parent.version&&(this.name=this.parser.parse("")),this.emptyImage={ready:!0},this.parser.parse("'vacio.gif'")):(this.image=this.parent.getImage(f),this.imageOver=this.parent.getImage(h+
"_over"+e),this.imageDown=this.parent.getImage(h+"_down"+e))}this.canvas=document.createElement("canvas");this.canvas.setAttribute("class","DescartesButton");this.canvas.setAttribute("id",this.id);this.canvas.setAttribute("width",this.w+"px");this.canvas.setAttribute("height",this.h+"px");this.canvas.setAttribute("style","left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";");this.ctx=this.canvas.getContext("2d");this.ctx.imageSmoothingEnabled=!1;this.ctx.mozImageSmoothingEnabled=!1;this.ctx.webkitImageSmoothingEnabled=
!1;this.addControlContainer(this.canvas);this.registerMouseAndTouchEvents();this.init()};a.extend(a.Button,a.Control);a.Button.prototype.init=function(){e=this.evaluator;f=this.canvas;k=e.evalExpression(this.expresion);this.x=k[0][0];this.y=k[0][1];4==k[0].length&&(this.w=parseInt(k[0][2]),this.h=parseInt(k[0][3]));f.setAttribute("width",this.w+"px");f.setAttribute("height",this.h+"px");f.setAttribute("style","left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";");this.fontSizeNotSet&&
(this.font_size=e.parser.parse(a.getFieldFontSize(this.h)+""));this.createGradient(this.w,this.h)};a.Button.prototype.update=function(){e=this.evaluator;f=this.canvas;this.activeIfValue=0<e.evalExpression(this.activeif);(this.drawIfValue=0<e.evalExpression(this.drawif))?(f.style.display="block",this.draw()):(this.click=!1,f.style.display="none");this.updatePositionAndSize()};a.Button.prototype.draw=function(){e=this.evaluator;c=this.ctx;g=e.evalExpression(this.font_size);l=e.evalExpression(this.name);
n=e.evalExpression(this.imageSrc);q="vacio.gif"===n?this.emptyImage:this.parent.getImage(n);c.clearRect(0,0,this.w,this.h);r=h=0;this.click&&(r=h=1);q&&q.ready?q!==this.emptyImage&&q.complete&&c.drawImage(q,parseInt((this.w-q.width)/2)+h,parseInt((this.h-q.height)/2)+r):(c.fillStyle=a.getColor(e,this.colorInt),c.fillRect(0,0,this.w,this.h),this.click||(a.drawLine(c,this.w-1,0,this.w-1,this.h,"rgba(0,0,0,"+128/255+")"),a.drawLine(c,0,0,0,this.h,"rgba(0,0,0,"+24/255+")"),a.drawLine(c,1,0,1,this.h,"rgba(0,0,0,"+
8/255+")")),c.fillStyle=this.linearGradient,c.fillRect(0,0,this.w,this.h));""!=this.imageOver.src&&(this.imageOver.ready&&this.over)&&c.drawImage(this.imageOver,parseInt((this.w-q.width)/2)+h,parseInt((this.h-q.height)/2)+r);""!=this.imageDown.src&&this.imageDown.ready&&this.click?c.drawImage(this.imageDown,parseInt((this.w-q.width)/2)+h,parseInt((this.h-q.height)/2)+r):this.click&&(a.drawLine(c,0,0,0,this.h-2,"gray"),a.drawLine(c,0,0,this.w-1,0,"gray"),c.fillStyle="rgba(0, 0, 0,"+24/255+")",c.fillRect(0,
0,this.w,this.h));c.fillStyle=a.getColor(e,this.color);c.font=this.italics+" "+this.bold+" "+g+"px Arial";c.textAlign="center";c.textBaseline="middle";this.colorInt!=this.color&&(c.lineWidth=parseInt(g/6),c.strokeStyle=a.getColor(e,this.colorInt),c.strokeText(l,d(this.w/2+h)+0.5,d(this.h/2+r)+0.5));c.fillText(l,d(this.w/2+h)+0.5,d(this.h/2+r)+0.5);this.underlined&&(u=c.measureText(l).width,c.strokeStyle=a.getColor(e,this.color),c.lineWidth=d(g/10)||2,c.lineCap="round",c.beginPath(),c.moveTo(parseInt((this.w-
u)/2)+h,d((this.h+g)/2)+d(g/5)-1.5+r),c.lineTo(parseInt((this.w+u)/2)+h,d((this.h+g)/2)+d(g/5)-1.5+r),c.stroke());this.activeIfValue||(c.fillStyle="rgba(240,240,240,"+160/255+")",c.fillRect(0,0,this.w,this.h))};a.Button.prototype.bottonPressed=function(){this.updateAndExecAction()};a.Button.prototype.registerMouseAndTouchEvents=function(){function c(a,d,f){clearInterval(k);g.click&&(d.call(g),a=f?a:30,k=setTimeout(function(){c(a,d)},a))}function d(a){a.preventDefault();g.whichButton=null==a.which?
2>a.button?"LEFT":4==a.button?"MIDDLE":"RIGHT":2>a.which?"LEFT":2==a.which?"MIDDLE":"RIGHT";"LEFT"==g.whichButton&&g.activeIfValue&&(g.click=!0,g.draw(),g.evaluator.setVariable(g.id,g.evaluator.evalExpression(g.valueExpr)),"calculate"==g.action&&c(m,g.bottonPressed,!0),p?window.addEventListener("touchend",f,!1):window.addEventListener("mouseup",f,!1))}function f(a){if(g.activeIfValue||g.click)g.click=!1,g.draw(),"calculate"!=g.action&&g.bottonPressed(),a.preventDefault(),p?window.removeEventListener("touchend",
f,!1):window.removeEventListener("mouseup",f,!1)}function h(a){g.over=!0;g.draw()}function e(a){g.over=!1;g.click=!1;g.draw()}p=a.hasTouchSupport;var g=this,k;g.canvas.oncontextmenu=function(){return!1};this.over=this.click=!1;p?this.canvas.addEventListener("touchstart",d,!1):(this.canvas.addEventListener("mousedown",d,!1),this.canvas.addEventListener("mouseover",h,!1),this.canvas.addEventListener("mouseout",e,!1))};a.Button.prototype.getScreenshot=function(){return this.canvas};return a}(descartesJS||
{}),descartesJS=function(a){if(a.loadLib)return a;var d,e,f,c,k,g,l,n,q,h,r,u,p,m,s,t,v;a.Spinner=function(c,d){a.Control.call(this,c,d);this.tabindex=++this.parent.tabindex;this.containerControl=document.createElement("div");this.canvas=document.createElement("canvas");this.divUp=document.createElement("div");this.divDown=document.createElement("div");this.field=document.createElement("input");this.label=document.createElement("label");this.txtLabel=document.createTextNode(this.name);this.label.appendChild(this.txtLabel);
""!=this.name.trim()&&this.containerControl.appendChild(this.label);this.containerControl.appendChild(this.field);this.containerControl.appendChild(this.canvas);this.containerControl.appendChild(this.divUp);this.containerControl.appendChild(this.divDown);this.addControlContainer(this.containerControl);this.originalIncr=this.incr;if(0>=this.evaluator.evalExpression(this.decimals)){var f=this.evaluator.evalExpression(this.incr);0<f?this.originalIncr=this.incr=this.evaluator.parser.parse(parseInt(f).toString()):
this.incr=this.evaluator.parser.parse("1")}this.registerMouseAndTouchEvents();this.init()};a.extend(a.Spinner,a.Control);a.Spinner.prototype.init=function(){d=this.evaluator;this.value=this.validateValue(d.evalExpression(this.valueExpr));var c=this.formatOutputValue(this.value);this.fieldFontSize=2!==this.parent.version?a.getFieldFontSize(this.h):10;var f=2!==this.parent.version?"":"_____",h=a.getTextWidth(c+"_",this.fieldFontSize+"px Arial"),e=2+parseInt(this.h/2),g=parseInt(this.w/2-e/2),f=a.getTextWidth(this.name+
f,this.fieldFontSize+"px Arial");this.visible||(g=this.w-e,h=0);g<f&&(g=f);""==this.name&&(g=0);this.w-g-e<h&&(g=this.w-e-h);0>g&&(g=0);f=this.w-(g+e);this.containerControl.setAttribute("class","DescartesSpinnerContainer");this.containerControl.setAttribute("style","width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";");this.canvas.setAttribute("width",e+"px");this.canvas.setAttribute("height",this.h+"px");this.canvas.setAttribute("style","position: absolute; left: "+
g+"px; top: 0px;");this.ctx=this.canvas.getContext("2d");this.divUp.setAttribute("style","background-color: rgba(255, 255, 255, 0); cursor: pointer; position: absolute; width : "+e+"px; height : "+this.h/2+"px; left: "+g+"px; top: 0px;");this.divDown.setAttribute("style","background-color: rgba(255, 255, 255, 0); cursor: pointer; position: absolute; width : "+e+"px; height : "+this.h/2+"px; left: "+g+"px; top: "+this.h/2+"px;");this.field.setAttribute("type","text");this.field.setAttribute("id",this.id+
"_spinner");this.field.value=c;this.field.setAttribute("class","DescartesSpinnerField");this.field.setAttribute("style","font-family: Arial; font-size: "+this.fieldFontSize+"px; width : "+(f-2)+"px; height : "+(this.h-2)+"px; left: "+(e+g)+"px;");this.field.setAttribute("tabindex",this.tabindex);this.label.setAttribute("class","DescartesSpinnerLabel");this.label.setAttribute("style","font-size:"+this.fieldFontSize+"px; width: "+g+"px; height: "+this.h+"px; line-height: "+this.h+"px;");d.setVariable(this.id,
this.value);this.createGradient(this.h/2,this.h)};a.Spinner.prototype.update=function(){d=this.evaluator;0>=d.evalExpression(this.decimals)?(e=d.evalExpression(this.incr),0<e?this.originalIncr=this.incr=d.parser.parse(parseInt(e).toString()):this.incr=d.parser.parse("1")):this.incr=this.originalIncr;this.activeIfValue=0<d.evalExpression(this.activeif);this.drawIfValue=0<d.evalExpression(this.drawif);this.field.disabled=!this.activeIfValue;this.drawIfValue?(this.containerControl.style.display="block",
this.draw()):(this.click=!1,this.containerControl.style.display="none");this.updatePositionAndSize();f=this.field.value;c=this.value;this.value=this.validateValue(d.getVariable(this.id));this.field.value=this.formatOutputValue(this.value);this.value==c&&this.field.value!=f&&(this.value=this.validateValue(f),this.field.value=this.formatOutputValue(this.value));d.setVariable(this.id,this.value)};a.Spinner.prototype.draw=function(){k=this.ctx;g=this.canvas.width;l=this.canvas.height;k.fillStyle="#f0f8ff";
k.fillRect(0,0,g,l);k.fillStyle=this.linearGradient;k.fillRect(0,0,g,l);this.up?(n="gray",q="#f0f8ff"):(n="#f0f8ff",q="gray");a.drawLine(k,0,0,g,0,n);a.drawLine(k,0,0,0,l/2,n);a.drawLine(k,0,l/2,g,l/2,q);this.down?(n="gray",q="#f0f8ff"):(n="#f0f8ff",q="gray");a.drawLine(k,0,l/2+1,g,l/2+1,n);a.drawLine(k,0,l/2+1,0,l,n);a.drawLine(k,0,l-1,g,l-1,q);h=[parseInt(g/2+1),parseInt(g/5+1),parseInt(g-g/5+1)];r=[parseInt(l/8+1),parseInt(l/8+1+l/4),parseInt(l/8+1+l/4)];k.fillStyle=this.activeIfValue?"#2244cc":
"#8888aa";k.beginPath();k.moveTo(h[0],r[0]);k.lineTo(h[1],r[1]);k.lineTo(h[2],r[2]);k.fill();r=[parseInt(l-l/8),parseInt(l-l/8-l/4),parseInt(l-l/8-l/4)];k.fillStyle=this.activeIfValue?"#d00018":"#aa8888";k.beginPath();k.moveTo(h[0],r[0]);k.lineTo(h[1],r[1]);k.lineTo(h[2],r[2]);k.fill();k.fillStyle="rgba(0,0,0,"+24/255+")";this.up&&k.fillRect(0,0,g,l/2);this.down&&k.fillRect(0,l/2,g,l)};a.Spinner.prototype.validateValue=function(a){d=this.evaluator;u=parseFloat(d.evalExpression(d.parser.parse(a.toString().replace(this.parent.decimal_symbol,
"."))));isNaN(u)&&(u=0);u<d.evalExpression(this.min)&&(u=d.evalExpression(this.min));u>d.evalExpression(this.max)&&(u=d.evalExpression(this.max));this.discrete&&(p=d.evalExpression(this.incr),u=0==p?0:p*Math.round(u/p));m=d.evalExpression(this.decimals);0>=m&&(m=0);return u=parseFloat(parseFloat(u).toFixed(m))};a.Spinner.prototype.formatOutputValue=function(a){u=a+"";s=u.indexOf(".");-1!=s&&(t=u.substring(s+1),t.length>m&&(u=parseFloat(u).toFixed(m)));if(this.fixed&&(2!==this.parent.version||2===
this.parent.version&&!this.exponentialif))u=parseFloat(a).toFixed(m);this.exponentialif&&0!=parseFloat(u)&&(u=this.fixed&&2!==this.parent.version?parseFloat(u).toExponential(m):parseFloat(u).toExponential(),u=u.toUpperCase(),u=u.replace("+",""));return u=u.replace(".",this.parent.decimal_symbol)};a.Spinner.prototype.increase=function(){this.changeValue(parseFloat(this.value)+this.evaluator.evalExpression(this.incr))};a.Spinner.prototype.decrease=function(){this.changeValue(parseFloat(this.value)-
this.evaluator.evalExpression(this.incr))};a.Spinner.prototype.changeValue=function(a){this.activeIfValue&&(this.value=this.validateValue(a),this.field.value=this.formatOutputValue(this.value),this.evaluator.setVariable(this.id,this.value),this.updateAndExecAction())};a.Spinner.prototype.registerMouseAndTouchEvents=function(){function c(a,d,f){clearInterval(l);if(m.up||m.down)d.call(m),a=f?a:30,l=setTimeout(function(){c(a,d)},a)}function d(a){a.preventDefault();m.whichButton=null==a.which?2>a.button?
"LEFT":4==a.button?"MIDDLE":"RIGHT":2>a.which?"LEFT":2==a.which?"MIDDLE":"RIGHT";"LEFT"==m.whichButton&&m.activeIfValue&&(m.up=!0,c(r,m.increase,!0),m.draw())}function f(a){a.preventDefault();m.whichButton=null==a.which?2>a.button?"LEFT":4==a.button?"MIDDLE":"RIGHT":2>a.which?"LEFT":2==a.which?"MIDDLE":"RIGHT";"LEFT"==m.whichButton&&m.activeIfValue&&(m.down=!0,c(r,m.decrease,!0),m.draw())}function h(a){m.up=!1;clearInterval(l);m.draw();a.preventDefault()}function e(a){m.down=!1;clearInterval(l);m.draw();
a.preventDefault()}function g(a){m.up=!1;clearInterval(l);m.draw();a.preventDefault()}function k(a){m.down=!1;clearInterval(l);m.draw();a.preventDefault()}v=a.hasTouchSupport;var m=this,r=v?500:200,l;m.divUp.oncontextmenu=m.divDown.oncontextmenu=m.field.oncontextmenu=m.label.oncontextmenu=function(){return!1};v?this.label.addEventListener("touchstart",function(a){a.preventDefault();return!1}):this.label.addEventListener("mousedown",function(a){a.preventDefault();return!1});this.field.addEventListener("keydown",
function(a){13==a.keyCode&&m.changeValue(m.field.value)},!1);v?this.divUp.addEventListener("touchstart",d,!1):this.divUp.addEventListener("mousedown",d,!1);v?this.divDown.addEventListener("touchstart",f,!1):this.divDown.addEventListener("mousedown",f,!1);v||this.divUp.addEventListener("mouseout",h,!1);v||this.divDown.addEventListener("mouseout",e,!1);v?(this.divUp.addEventListener("touchend",g,!1),window.addEventListener("touchend",g,!1)):(this.divUp.addEventListener("mouseup",g,!1),window.addEventListener("mouseup",
g,!1));v?(this.divDown.addEventListener("touchend",k,!1),window.addEventListener("touchend",k,!1)):(this.divDown.addEventListener("mouseup",k,!1),window.addEventListener("mouseup",k,!1))};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d,e,f,c,k,g,l,n,q,h,r,u,p,m,s,t,v,w,B,E;a.TextField=function(c,d){a.Control.call(this,c,d);void 0===this.valueExprString&&(this.valueExprString="");this.emptyString=!1;this.ok=0;this.tabindex=++this.parent.tabindex;if(this.answer)if(this.answer.match("krypto_")&&
(this.answer=(new a.Krypto).decode(this.answer.substring(7))),this.answerPattern=this.answer,this.onlyText){this.answer=a.buildRegularExpresionsPatterns(this.answer);var f=this.answerPattern.indexOf("|");this.firstAnswer=-1==f?this.answerPattern:this.answerPattern.substring(0,f)}else this.buildRangeExpresions(),this.firstAnswer=this.parser.parse(this.answerPattern.substring(1,this.answerPattern.indexOf(",")));if(this.onlyText){if(!this.valueExprString.match(/^'/)||!this.valueExprString.match(/^'/))this.valueExpr=
this.evaluator.parser.parse("'"+this.valueExprString+"'");this.validateValue=function(a){return"''"==a||"'"==a?"":a};this.formatOutputValue=function(a){return a.toString()};this.evaluateAnswer=this.evaluateTextualAnswer}""==this.name.trim()&&(this.name="");this.containerControl=document.createElement("div");this.field=document.createElement("input");this.label=document.createElement("label");this.txtLabel=document.createTextNode(this.name);this.label.appendChild(this.txtLabel);this.containerControl.appendChild(this.label);
this.containerControl.appendChild(this.field);this.addControlContainer(this.containerControl);this.registerMouseAndTouchEvents();this.init()};a.extend(a.TextField,a.Control);a.TextField.prototype.init=function(){d=this.evaluator;this.value=this.validateValue(d.evalExpression(this.valueExpr));var c=this.formatOutputValue(this.value);this.fieldFontSize=a.getFieldFontSize(this.h);var f=a.getTextWidth(c+"_",this.fieldFontSize+"px Arial"),h=parseInt(this.w/2),e=a.getTextWidth(this.name,this.fieldFontSize+
"px Arial");h<e&&(h=e);""==this.name&&(h=0);this.w-h<f&&(h=this.w-f);0>h&&(h=0);f=this.w-h;this.containerControl.setAttribute("class","DescartesTextFieldContainer");this.containerControl.setAttribute("style","width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";");this.field.setAttribute("type","text");this.field.setAttribute("id",this.id+"TextField");this.field.setAttribute("class","DescartesTextFieldField");this.field.setAttribute("style","font-size: "+
this.fieldFontSize+"px; width : "+(f-2)+"px; height : "+(this.h-2)+"px; left: "+h+"px;");this.field.setAttribute("tabindex",this.tabindex);this.field.value=c;this.label.setAttribute("class","DescartesTextFieldLabel");this.label.setAttribute("style","font-size:"+this.fieldFontSize+"px; width: "+h+"px; height: "+this.h+"px; line-height: "+this.h+"px;");d.setVariable(this.id,this.value);this.oldValue=this.value};a.TextField.prototype.update=function(){d=this.evaluator;this.activeIfValue=0<d.evalExpression(this.activeif);
this.drawIfValue=0<d.evalExpression(this.drawif);this.field.disabled=!this.activeIfValue;this.drawIfValue?(this.containerControl.style.display="block",this.draw()):this.containerControl.style.display="none";this.updatePositionAndSize();e=this.field.value;f=this.value;this.value=this.validateValue(d.getVariable(this.id));this.field.value=this.formatOutputValue(this.value);this.value===f&&this.field.value!=e&&(this.value=this.validateValue(e),this.field.value=this.formatOutputValue(this.value));d.setVariable(this.id,
this.value)};a.TextField.prototype.validateValue=function(a){if(""===a||"''"==a)return"";d=this.evaluator;c=parseFloat(d.evalExpression(d.parser.parse(a.toString().replace(this.parent.decimal_symbol,"."))));isNaN(c)&&(c=0);c<d.evalExpression(this.min)&&(c=d.evalExpression(this.min));c>d.evalExpression(this.max)&&(c=d.evalExpression(this.max));this.discrete&&(a=d.evalExpression(this.incr),c=0==a?0:a*Math.round(c/a));return c=parseFloat(parseFloat(c).toFixed(d.evalExpression(this.decimals)))};a.TextField.prototype.formatOutputValue=
function(a){if(""===a)return"";c=a+"";k=this.evaluator.evalExpression(this.decimals);g=c.indexOf(".");-1!=g&&c.substring(g+1).length>k&&(c=parseFloat(c).toFixed(k));this.fixed&&(c=parseFloat(a).toFixed(k));this.exponentialif&&(c=c.toExponential(k),c=c.toUpperCase(),c=c.replace("+",""));return c=c.replace(".",this.parent.decimal_symbol)};a.TextField.prototype.changeValue=function(a,c){this.activeIfValue&&(this.value=this.validateValue(a),this.field.value=this.formatOutputValue(this.value),this.evaluate&&
(this.ok=this.evaluateAnswer()),this.evaluator.setVariable(this.id,this.value),this.evaluator.setVariable(this.id+".ok",this.ok),this.updateAndExecAction())};a.TextField.prototype.evaluateAnswer=function(){d=this.evaluator;l=parseFloat(this.value);for(var a=0,c=this.answer.length;a<c;a++)if(m=this.answer[a][0],s=this.answer[a][1],n=d.evalExpression(m.expression),q=d.evalExpression(s.expression),h="("==m.type,r="["==m.type,u=")"==s.type,p="]"==s.type,t=this.value,h&&u&&t>n&&t<q||h&&p&&t>n&&t<=q||r&&
u&&t>=n&&t<q||r&&p&&t>=n&&t<=q)return 1;return 0};a.TextField.prototype.buildRangeExpresions=function(){this.answer=this.answer.split("|");for(var a=0,c=this.answer.length;a<c;a++)this.answer[a]=this.answer[a].trim(),this.answer[a]=this.answer[a].split(","),v=this.answer[a][0].trim(),this.answer[a][0]={type:v[0],expression:this.evaluator.parser.parse(v.substring(1))},v=this.answer[a][1].trim(),this.answer[a][1]={type:v[v.length-1],expression:this.evaluator.parser.parse(v.substring(0,v.length-1))}};
a.TextField.prototype.evaluateTextualAnswer=function(){l=this.value;for(var c=0,d=this.answer.length;c<d;c++){v=this.answer[c];B=!0;for(var f=0,h=v.length;f<h;f++)w=v[f],w.ignoreAcents&&(l=a.replaceAcents(l),w.regExp=a.replaceAcents(w.regExp)),w.ignoreCaps&&(l=l.toLowerCase(),w.regExp=w.regExp.toLowerCase()),B=B&&!!l.match(w.regExp);if(B)return 1}return 0};a.TextField.prototype.getFirstAnswer=function(){return this.answer?this.onlyText?this.firstAnswer:this.evaluator.evalExpression(this.firstAnswer):
""};a.TextField.prototype.registerMouseAndTouchEvents=function(){E=a.hasTouchSupport;var c=this;c.label.oncontextmenu=function(){return!1};E?c.label.addEventListener("touchstart",function(a){a.preventDefault();return!1}):c.label.addEventListener("mousedown",function(a){a.preventDefault();return!1});this.field.addEventListener("blur",function(a){c.update()},!1);this.field.addEventListener("keydown",function(a){c.activeIfValue&&13==a.keyCode&&c.changeValue(c.field.value,!0)},!1)};return a}(descartesJS||
{}),descartesJS=function(a){if(a.loadLib)return a;var d=Math.abs,e,f,c,k,g,l,n,q;a.Menu=function(c,d){this.options="";a.Control.call(this,c,d);var f=this.parser;this.options=this.options.split(",");this.menuOptions=[];this.strValue=[];for(var h,e=0,g=this.options.length;e<g;e++)h=this.options[e].split(/[\[\]]/,2),1==h.length?(this.menuOptions.push(h[0]),this.strValue.push(e.toString())):2==h.length&&(this.menuOptions.push(h[0]),""==h[1]?this.strValue.push(e.toString()):this.strValue.push(h[1]));e=
0;for(g=this.strValue.length;e<g;e++)this.strValue[e]=f.parse(this.strValue[e]);this.containerControl=document.createElement("div");this.label=document.createElement("label");this.txtLabel=document.createTextNode(this.name);this.label.appendChild(this.txtLabel);this.select=document.createElement("select");e=0;for(g=this.menuOptions.length;e<g;e++)f=document.createElement("option"),f.innerHTML=this.menuOptions[e],this.select.appendChild(f);this.field=document.createElement("input");this.containerControl.appendChild(this.label);
this.containerControl.appendChild(this.select);this.visible&&this.containerControl.appendChild(this.field);this.addControlContainer(this.containerControl);this.registerMouseAndTouchEvents();this.init()};a.extend(a.Menu,a.Control);var h;a.Menu.prototype.init=function(){h=this.evaluator;this.fieldFontSize=2!=this.parent.version?a.getFieldFontSize(this.h):10;var c=0,d=0,f=0;this.value=h.evalExpression(this.valueExpr);this.indexValue=this.getIndex(this.value);for(var e=0,g=this.menuOptions.length;e<g;e++)f=
a.getTextWidth(this.menuOptions[e],this.fieldFontSize+"px Arial"),f>c&&(c=f,d=e);c+=25;f=a.getTextWidth(this.formatOutputValue(h.evalExpression(this.strValue[d])),this.fieldFontSize+"px Arial")+7;d=a.getTextWidth(this.name,this.fieldFontSize+"px Arial")+10;""==this.name&&(d=0);this.visible||(f=0);for(e=this.w-f-d;e<c&&0<d;)d--,e++;for(;e<c&&0<f;)f--,e++;for(;d+e+f+1<this.w;)e++,f++;var c=d,g=c+e,f=this.w-g,k=this.formatOutputValue(h.evalExpression(this.strValue[this.indexValue]));this.containerControl.setAttribute("class",
"DescartesSpinnerContainer");this.containerControl.setAttribute("style","width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";");this.label.setAttribute("class","DescartesMenuLabel");this.label.setAttribute("style","font-size:"+this.fieldFontSize+"px; width: "+d+"px; height: "+this.h+"px; line-height: "+this.h+"px;");this.field.setAttribute("type","text");this.field.setAttribute("id",this.id+"menu");this.field.value=k;this.field.setAttribute("class",
"DescartesMenuField");this.field.setAttribute("style","font-size: "+this.fieldFontSize+"px; width : "+(f-2)+"px; height : "+(this.h-2)+"px; left: "+g+"px;");this.select.setAttribute("id",this.id+"menuSelect");this.select.setAttribute("class","DescartesMenuSelect");this.select.setAttribute("style","text-align: left; font-size: "+this.fieldFontSize+"px; width : "+e+"px; height : "+this.h+"px; left: "+c+"px; border-color: #7a8a99; border-width: 1.5px; border-style: solid; background-color: #eeeeee;");
this.select.selectedIndex=this.indexValue;h.setVariable(this.id,parseFloat(k))};a.Menu.prototype.update=function(){h=this.evaluator;this.activeIfValue=0<h.evalExpression(this.activeif);this.drawIfValue=0<h.evalExpression(this.drawif);this.field.disabled=this.activeIfValue?!1:!0;this.select.disabled=this.activeIfValue?!1:!0;this.drawIfValue?this.containerControl.style.display="block":(this.click=!1,this.containerControl.style.display="none");this.updatePositionAndSize();this.value=h.getVariable(this.id);
this.field.value=this.formatOutputValue(this.value);h.setVariable(this.id,parseFloat(this.value));this.select.selectedIndex=parseFloat(this.getIndex(this.value))};a.Menu.prototype.getIndex=function(a){a=parseFloat(a.toString().replace(this.parent.decimal_symbol,"."));e=-1;f=Infinity;for(var h=0,g=this.strValue.length;h<g;h++)c=d(a-parseFloat(this.evaluator.evalExpression(this.strValue[h]))),c<=f&&(f=c,e=h);return e};a.Menu.prototype.formatOutputValue=function(a){k=a+"";g=this.evaluator.evalExpression(this.decimals);
l=k.indexOf(".");-1!=l&&(n=k.substring(l+1),n.length>g&&(k=parseFloat(k).toFixed(g)));this.fixed&&(k=parseFloat(a).toFixed(g));this.exponentialif&&(k=k.toExponential(g),k=k.toUpperCase(),k=k.replace("+",""));return k=k.replace(".",this.parent.decimal_symbol)};a.Menu.prototype.changeValue=function(){this.activeIfValue&&(this.evaluator.setVariable(this.id,this.value),this.updateAndExecAction())};a.Menu.prototype.registerMouseAndTouchEvents=function(){q=a.hasTouchSupport;var c=this;c.select.oncontextmenu=
c.label.oncontextmenu=c.field.oncontextmenu=function(){return!1};q?c.label.addEventListener("touchstart",function(a){a.preventDefault();return!1}):c.label.addEventListener("mousedown",function(a){a.preventDefault();return!1});this.select.addEventListener("change",function(a){c.value=c.evaluator.evalExpression(c.strValue[this.selectedIndex]);c.field.value=c.formatOutputValue(c.value);c.evaluator.setVariable(c.id,c.field.value);c.changeValue();a.preventDefault()},!1);this.field.addEventListener("keydown",
function(a){13==a.keyCode&&(c.indexValue=c.getIndex(c.field.value),c.value=c.evaluator.evalExpression(c.strValue[c.indexValue]),c.field.value=c.formatOutputValue(c.indexValue),c.select.selectedIndex=c.indexValue,c.changeValue())},!1)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d=Math.floor,e="h",f,c,k,g,l,n,q,h,r,u,p,m,s,t,v,w,B,E,C,y,D,z,G,A;a.Scrollbar=function(c,d){a.Control.call(this,c,d);this.orientation=this.w>=this.h?e:"v";this.containerControl=document.createElement("div");
this.canvas=document.createElement("canvas");this.divUp=document.createElement("div");this.divDown=document.createElement("div");this.field=document.createElement("input");this.scrollManipulator=document.createElement("div");this.label=document.createElement("label");this.txtLabel=document.createTextNode(this.name);this.label.appendChild(this.txtLabel);this.containerControl.appendChild(this.canvas);this.containerControl.appendChild(this.label);this.containerControl.appendChild(this.divUp);this.containerControl.appendChild(this.divDown);
this.containerControl.appendChild(this.field);this.containerControl.appendChild(this.scrollManipulator);this.addControlContainer(this.containerControl);this.registerMouseAndTouchEvents();this.init()};a.extend(a.Scrollbar,a.Control);a.Scrollbar.prototype.init=function(){f=this.evaluator;this.findOffset();0==f.evalExpression(this.decimals)?this.incr=1:this.incr=(f.evalExpression(this.max)-f.evalExpression(this.min))/100;this.value=this.validateValue(f.evalExpression(this.valueExpr));k=this.formatOutputValue(this.value);
g=this.evaluator.evalExpression(this.expresion);this.x=g[0][0];this.y=g[0][1];4==g[0].length&&(this.w=g[0][2],this.h=g[0][3]);this.orientation=this.w>=this.h?e:"v";this.initScroll(k);f.setVariable(this.id,this.value);var a=this.value;this.value=null;this.activeIfValue=!0;this.changeValue(a);this.prePos=this.pos};a.Scrollbar.prototype.initScroll=function(d){c=this;f=c.evaluator;var h="v"===c.orientation?parseInt(19+5*(c.h-100)/100):c.h;c.fieldFontSize="v"===c.orientation?h-parseInt(c.h/20)-1:2!==c.parent.version?
a.getFieldFontSize(h):10;var e=a.getTextWidth(d+"_",c.fieldFontSize+"px Arial"),g=c.parent.getSpaceById(c.spaceID).h;c.labelHeight=""==c.name?0:h;c.fieldHeight=""==c.visible?0:h;if("v"===c.orientation)c.canvasWidth=c.w,c.canvasHeight=c.h-c.labelHeight-c.fieldHeight,18<=c.canvasHeight+c.y-g&&(c.canvasHeight=g),e=0,e=c.fieldHeight,h=e+c.canvasHeight,c.canvasX=0,c.canvasY=c.fieldHeight,c.labelWidth=c.w,c.labelY=h,c.upWidth=c.downW=c.w,c.upHeight=c.downH=15,c.upX=0,c.upY=c.fieldHeight,c.downX=0,c.downY=
h-c.downH,c.fieldWidth=c.w,c.fieldX=0,c.scrollManipulatorW=c.w,c.scrollManipulatorH=parseInt((c.canvasHeight-c.upHeight-c.downH-c.labelHeight-c.fieldHeight)/10),c.scrollManipulatorH=15>c.scrollManipulatorH?15:c.scrollManipulatorH,c.scrollManipulatorLimInf=h-c.downH-c.scrollManipulatorH,c.scrollManipulatorLimSup=e+c.downH;else{h=a.getTextWidth(c.name,c.fieldFontSize+"px Arial")+10;c.labelWidth=h;c.fieldWidth=e;""==c.name&&(c.labelWidth=0);c.visible||(c.fieldWidth=0);for(h=c.w-c.fieldWidth-c.labelWidth;58>
h&&0<c.labelWidth;)c.labelWidth--,h++;for(;58>h&&0<c.fieldWidth;)c.fieldWidth--,h++;e=c.labelWidth;g=e+h;c.fieldWidth=c.w-g;c.canvasWidth=h;c.canvasHeight=c.h;c.canvasX=c.labelWidth;c.canvasY=0;c.fieldX=c.canvasWidth+c.labelWidth;c.labelHeight=c.h;c.labelY=0;c.upWidth=c.downW=15;c.upHeight=c.downH=c.h;c.upX=g-c.downW;c.upY=0;c.downX=c.labelWidth;c.downY=0;c.scrollManipulatorW=parseInt((c.canvasWidth-c.upWidth-c.downW)/10);c.scrollManipulatorW=15>c.scrollManipulatorW?15:c.scrollManipulatorW;c.scrollManipulatorH=
c.h;c.scrollManipulatorLimInf=e+c.downW;c.scrollManipulatorLimSup=e+c.canvasWidth-c.downW-c.scrollManipulatorW}c.containerControl.setAttribute("class","DescartesScrollbarContainer");c.containerControl.setAttribute("style","width: "+c.w+"px; height: "+c.h+"px; left: "+c.x+"px; top: "+c.y+"px; z-index: "+c.zIndex+";");c.canvas.setAttribute("width",c.w+"px");c.canvas.setAttribute("height",c.h+"px");c.canvas.setAttribute("style","position: absolute; left: 0px; top: 0px;");c.ctx=c.canvas.getContext("2d");
c.divUp.setAttribute("style","background-color: rgba(255, 255, 255, 0); cursor: pointer; position: absolute; width : "+c.upWidth+"px; height : "+c.upHeight+"px; left: "+c.upX+"px; top: "+c.upY+"px;");c.divDown.setAttribute("style","background-color: rgba(255, 255, 255, 0); cursor: pointer; position: absolute; width : "+c.downW+"px; height : "+c.downH+"px; left: "+c.downX+"px; top: "+c.downY+"px;");c.scrollManipulator.setAttribute("style","background-color: rgba(255, 255, 255, 0); cursor: pointer; position: absolute; width : "+
c.scrollManipulatorW+"px; height : "+c.scrollManipulatorH+"px;");c.scrollManipulator.style.top=("v"===c.orientation?c.scrollManipulatorLimInf:0)+"px";c.scrollManipulator.style.left=("v"===c.orientation?0:c.scrollManipulatorLimInf)+"px";c.field.setAttribute("type","text");c.field.setAttribute("id",c.id+"scrollbar");c.field.setAttribute("class","DescartesScrollbarField");c.field.setAttribute("style","font-size: "+c.fieldFontSize+"px; width : "+(c.fieldWidth-2)+"px; height : "+(c.fieldHeight-2)+"px; left: "+
c.fieldX+"px; top: 0px;");c.field.value=d;0===c.fieldHeight&&(c.field.style.display="none");c.label.setAttribute("class","DescartesScrollbarLabel");c.label.setAttribute("style","font-size:"+c.fieldFontSize+"px; width: "+c.labelWidth+"px; height: "+c.labelHeight+"px; line-height: "+c.labelHeight+"px; left: 0px; top:"+c.labelY+"px;");c.txtLabel=document.createTextNode(c.name)};a.Scrollbar.prototype.update=function(){f=this.evaluator;0==f.evalExpression(this.decimals)?this.incr=1:this.incr=(f.evalExpression(this.max)-
f.evalExpression(this.min))/100;this.activeIfValue=0<f.evalExpression(this.activeif);this.drawIfValue=0<f.evalExpression(this.drawif);this.field.disabled=!this.activeIfValue;this.drawIfValue?(this.containerControl.style.display="block",this.draw()):this.containerControl.style.display="none";this.updatePositionAndSize();this.value=this.validateValue(f.getVariable(this.id));this.field.value=this.formatOutputValue(this.value);f.setVariable(this.id,this.value)};a.Scrollbar.prototype.draw=function(){c=
this;l=c.ctx;q=d(this.w);n=d(this.h);l.fillStyle="#e0e4e8";l.fillRect(0,0,q,n);l.strokeStyle="#7a8a99";c.down&&(l.fillStyle="#ccdcec",l.fillRect(c.downX+0.5,c.downY+0.5,c.downW,c.downH-1));l.strokeRect(c.downX+0.5,c.downY+0.5,c.downW,c.downH-1);c.up&&(l.fillStyle="#ccdcec",l.fillRect(c.upX+0.5,c.upY-0.5,c.upWidth,c.upHeight+1));l.strokeRect(c.upX+0.5,c.upY-0.5,c.upWidth,c.upHeight+1);h=4;l.fillStyle="black";l.beginPath();c.orientation===e?(l.moveTo(c.downX+h,c.downH/2),l.lineTo(c.downX+c.downW-h,
h),l.lineTo(c.downX+c.downW-h,c.downH-h),l.moveTo(c.upX+c.upWidth-h,c.downH/2),l.lineTo(c.upX+h,h),l.lineTo(c.upX+h,c.downH-h),l.fill(),c.activeIfValue&&(r=d(c.pos),l.fillStyle="#ccdcec",l.fillRect(r+0.5,0,d(c.scrollManipulatorW),n),l.strokeStyle="#6382bf",l.strokeRect(r+0.5,0,d(c.scrollManipulatorW),n),u=d(c.scrollManipulatorW/2),l.beginPath(),l.moveTo(r+u+0.5-2,3),l.lineTo(r+u+0.5-2,n-3),l.moveTo(r+u+0.5,3),l.lineTo(r+u+0.5,n-3),l.moveTo(r+u+0.5+2,3),l.lineTo(r+u+0.5+2,n-3),l.stroke())):(l.moveTo(c.downX+
c.downW/2,c.downY+c.downH-h),l.lineTo(c.downX+h,c.downY+h),l.lineTo(c.downX+c.downW-h,c.downY+h),l.moveTo(c.upX+c.upWidth/2,c.upY+h),l.lineTo(c.upX+h,c.upY+c.upHeight-h),l.lineTo(c.upX+c.upWidth-h,c.upY+c.upHeight-h),l.fill(),c.activeIfValue&&(r=d(c.pos),l.fillStyle="#ccdcec",l.fillRect(0,r+0.5,q,d(c.scrollManipulatorH)),l.strokeStyle="#6382bf",l.strokeRect(0,r+0.5,q,d(c.scrollManipulatorH)),u=d(c.scrollManipulatorH/2),l.beginPath(),l.moveTo(3,r+u+0.5-2),l.lineTo(q-3,r+u+0.5-2),l.moveTo(3,r+u+0.5),
l.lineTo(q-3,r+u+0.5),l.moveTo(3,r+u+0.5+2),l.lineTo(q-3,r+u+0.5+2),l.stroke()));l.strokeRect(0.5,0.5,q-1,n-1);c.activeIfValue||(l.fillStyle="rgba(240,240,240,"+160/255+")",l.fillRect(0,0,q,n.h))};a.Scrollbar.prototype.validateValue=function(a){f=this.evaluator;p=a.toString();p=parseFloat(p.replace(this.parent.decimal_symbol,"."));isNaN(p)&&(p=0);this.minimo=f.evalExpression(this.min);p<this.minimo&&(this.value=null,p=this.minimo);this.maximo=f.evalExpression(this.max);p>this.maximo&&(this.value=
null,p=this.maximo);m=this.incr;p=0!=m?p*m/m:0;this.fixed&&(p=parseFloat(parseFloat(p).toFixed(f.evalExpression(this.decimals))));return p};a.Scrollbar.prototype.formatOutputValue=function(a){p=a+"";s=this.evaluator.evalExpression(this.decimals);t=p.indexOf(".");-1!=t&&(v=p.substring(t+1),v.length>s&&(p=parseFloat(p).toFixed(s)));this.fixed&&(p=parseFloat(a).toFixed(s));this.exponentialif&&(p=p.toExponential(s),p=p.toUpperCase(),p=p.replace("+",""));return p=p.replace(".",this.parent.decimal_symbol)};
a.Scrollbar.prototype.increase=function(){this.changeValue(parseFloat(this.value)+this.incr)};a.Scrollbar.prototype.decrease=function(){this.changeValue(parseFloat(this.value)-this.incr)};a.Scrollbar.prototype.increase10=function(){h=(this.evaluator.evalExpression(this.max)-this.evaluator.evalExpression(this.min))/10;this.orientation==e?this.clickPos.x>this.prePos&&this.changeValue(parseFloat(this.value)+h):this.clickPos.y<this.prePos&&this.changeValue(parseFloat(this.value)+h)};a.Scrollbar.prototype.decrease10=
function(){h=(this.evaluator.evalExpression(this.max)-this.evaluator.evalExpression(this.min))/10;this.orientation==e?this.clickPos.x<this.prePos&&this.changeValue(parseFloat(this.value)-h):this.clickPos.y>this.prePos&&this.changeValue(parseFloat(this.value)-h)};a.Scrollbar.prototype.changeValue=function(a){this.activeIfValue&&(w=this.validateValue(a),w!=this.value&&(this.value=w,this.field.value=this.formatOutputValue(w),this.changeScrollPositionFromValue(),this.prePos=this.pos,this.evaluator.setVariable(this.id,
this.value),this.updateAndExecAction()))};a.Scrollbar.prototype.changeValueForScrollMovement=function(){f=this.evaluator;B=this.scrollManipulatorLimInf;E=this.scrollManipulatorLimSup;C=f.evalExpression(this.min);y=f.evalExpression(this.max);m=this.incr;w=d((this.pos-B)*(y-C)/(E-B)/m)*m+C;w!=this.value&&(this.value=w,this.field.value=this.formatOutputValue(w),f.setVariable(this.id,this.value),this.parent.updateControls(),this.actionExec.execute(),this.parent.update())};a.Scrollbar.prototype.changeScrollPositionFromValue=
function(){f=this.evaluator;B=this.scrollManipulatorLimInf;E=this.scrollManipulatorLimSup;C=f.evalExpression(this.min);y=f.evalExpression(this.max);m=this.incr;this.pos=(this.value-C)*(E-B)/(y-C)+B;this.orientation==e?this.scrollManipulator.style.left=this.pos+"px":this.scrollManipulator.style.top=this.pos+"px"};a.Scrollbar.prototype.registerMouseAndTouchEvents=function(){function c(a,d,f,h){clearInterval(y);if((s.up||s.down||s.canvasClick)&&1E-7<Math.abs(s.value-h))d.call(s),a=f?a:30,y=setTimeout(function(){c(a,
d,!1,h)},a)}function d(a){a.preventDefault();s.whichButton=null==a.which?2>a.button?"LEFT":4==a.button?"MIDDLE":"RIGHT":2>a.which?"LEFT":2==a.which?"MIDDLE":"RIGHT";"LEFT"==s.whichButton&&s.activeIfValue&&(s.clickPos=s.getCursorPosition(a),s.canvasClick=!0,s.orientation==e?s.clickPos.x<s.prePos?c(w,s.decrease10,!0,s.minimo):c(w,s.increase10,!0,s.maximo):s.clickPos.y<s.prePos?c(w,s.increase10,!0,s.maximo):c(w,s.decrease10,!0,s.minimo))}function f(a){s.canvasClick=!1;clearInterval(y);a.preventDefault()}
function h(a){!0==s.canvasClick&&(s.clickPos=s.getCursorPosition(a),a.preventDefault())}function g(a){s.activeIfValue&&(s.scrollClick=!0,s.initPos=s.getCursorPosition(a),window.addEventListener("mouseup",m,!1),window.addEventListener("mousemove",r,!1),a.preventDefault())}function k(a){s.activeIfValue&&(s.scrollClick=!0,s.initPos=s.getCursorPosition(a),window.addEventListener("touchend",l,!1),window.addEventListener("touchmove",onToucheMove_scrollManipulator,!1),a.preventDefault())}function m(a){s.scrollClick=
!1;s.prePos=s.pos;window.removeEventListener("mouseup",m,!1);window.removeEventListener("mousemove",r,!1);a.preventDefault()}function l(a){s.scrollClick=!1;s.prePos=s.pos;window.removeEventListener("touchend",l,!1);window.removeEventListener("touchmove",r,!1);a.preventDefault()}function r(a){var c=s.getCursorPosition(a);s.orientation==e?(s.pos=s.prePos-(s.initPos.x-c.x),s.pos<s.scrollManipulatorLimInf&&(s.pos=s.scrollManipulatorLimInf),s.pos>s.scrollManipulatorLimSup&&(s.pos=s.scrollManipulatorLimSup),
s.scrollManipulator.setAttribute("style","background-color: rgba(255, 255, 255, 0); cursor: pointer; position: absolute; width : "+s.scrollManipulatorW+"px; height : "+s.h+"px; left: "+s.pos+"px; top: 0px;")):(s.pos=s.prePos-(s.initPos.y-c.y),s.pos>s.scrollManipulatorLimInf&&(s.pos=s.scrollManipulatorLimInf),s.pos<s.scrollManipulatorLimSup&&(s.pos=s.scrollManipulatorLimSup),s.scrollManipulator.setAttribute("style","background-color: rgba(255, 255, 255, 0); cursor: pointer; position: absolute; width : "+
s.w+"px; height : "+s.scrollManipulatorH+"px; left: 0px; top: "+s.pos+"px;"));s.changeValueForScrollMovement();a.preventDefault()}function p(a){a.preventDefault();s.whichButton=null==a.which?2>a.button?"LEFT":4==a.button?"MIDDLE":"RIGHT":2>a.which?"LEFT":2==a.which?"MIDDLE":"RIGHT";"LEFT"==s.whichButton&&s.activeIfValue&&(s.up=!0,c(w,s.increase,!0,s.maximo))}function u(a){a.preventDefault();s.whichButton=null==a.which?2>a.button?"LEFT":4==a.button?"MIDDLE":"RIGHT":2>a.which?"LEFT":2==a.which?"MIDDLE":
"RIGHT";"LEFT"==s.whichButton&&s.activeIfValue&&(s.down=!0,c(w,s.decrease,!0,s.minimo))}function n(a){s.up=!1;clearInterval(y);a.preventDefault()}function v(a){s.down=!1;clearInterval(y);a.preventDefault()}function t(a){s.up=!1;clearInterval(y);a.preventDefault();s.draw()}function q(a){s.down=!1;clearInterval(y);a.preventDefault();s.draw()}D=a.hasTouchSupport;var s=this,w=D?500:200,y;s.canvas.oncontextmenu=s.divUp.oncontextmenu=s.divDown.oncontextmenu=s.label.oncontextmenu=s.field.oncontextmenu=s.scrollManipulator.oncontextmenu=
function(){return!1};this.field.addEventListener("keydown",function(a){13==a.keyCode&&s.changeValue(s.field.value)},!1);D?this.canvas.addEventListener("touchstart",d,!1):this.canvas.addEventListener("mousedown",d,!1);D||this.divDown.addEventListener("mouseout",v,!1);D?window.addEventListener("touchend",f,!1):window.addEventListener("mouseup",f,!1);D?this.canvas.addEventListener("touchmove",h,!1):this.canvas.addEventListener("mousemove",h,!1);D?this.scrollManipulator.addEventListener("touchstart",
k,!1):this.scrollManipulator.addEventListener("mousedown",g,!1);D?this.divUp.addEventListener("touchstart",p,!1):this.divUp.addEventListener("mousedown",p,!1);D?this.divDown.addEventListener("touchstart",u,!1):this.divDown.addEventListener("mousedown",u,!1);D||this.divUp.addEventListener("mouseout",n,!1);D||this.divDown.addEventListener("mouseout",v,!1);D?window.addEventListener("touchend",t,!1):window.addEventListener("mouseup",t,!1);D?window.addEventListener("touchend",q,!1):window.addEventListener("mouseup",
q,!1)};a.Scrollbar.prototype.findOffset=function(){z=this.containerControl;this.offsetTop=this.offsetLeft=0;G=this.containerControl.style.display;for(this.containerControl.style.display="block";z;)this.offsetLeft+=z.offsetLeft||0,this.offsetTop+=z.offsetTop||0,z=z.parentNode;this.containerControl.style.display=G};a.Scrollbar.prototype.getCursorPosition=function(c){A=a.getCursorPosition(c);return{x:A.x-this.offsetLeft,y:A.y-this.offsetTop}};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;
var d;a.Audio=function(d,f){this.controls=!0;this.file="";a.Control.call(this,d,f);var c=this.evaluator.evalExpression(this.expresion);4==c[0].length?(this.w=c[0][2],this.h=c[0][3]):(this.w=100,this.h=28);this.audio=this.parent.getAudio(this.file);this.autoplay&&(this.audio.setAttribute("autoplay","autoplay"),this.audio.play());this.loop&&this.audio.setAttribute("loop","loop");this.controls&&this.audio.setAttribute("controls","controls");this.audio.setAttribute("style","position: absolute; width: "+
this.w+"px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";");this.addControlContainer(this.audio)};a.extend(a.Audio,a.Control);a.Audio.prototype.init=function(){this.audio.style.left=this.x+"px";this.audio.style.top=this.y+"px"};a.Audio.prototype.update=function(){d=this.evaluator;0<d.evalExpression(this.drawif)?this.audio.style.display="block":(this.audio.style.display="none",this.audio.pause());this.updatePositionAndSize()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;
var d;a.Video=function(d,f){this.controls=!0;this.file="";a.Control.call(this,d,f);var c=this.evaluator.evalExpression(this.expresion);4==c[0].length?(this.w=c[0][2],this.h=c[0][3]):this.h=this.w=null;this.video=document.createElement("video");this.autoplay&&this.video.setAttribute("autoplay","autoplay");this.loop&&this.video.setAttribute("loop","loop");this.controls&&this.video.setAttribute("controls","controls");this.poster&&this.video.setAttribute("poster",this.poster);this.w&&(this.video.setAttribute("width",
this.w),this.video.setAttribute("height",this.h));this.video.setAttribute("style","position: absolute; overflow: hidden; left: "+this.x+"px; top: "+this.y+"px;");var c=this.file,k=c.lastIndexOf(".");-1!=k&&(c=this.file.substring(0,k));this.video.canPlayType("video/mp4")&&(k=document.createElement("source"),k.setAttribute("src",c+".mp4"),k.setAttribute("type","video/mp4"),this.video.appendChild(k));this.video.canPlayType("video/ogg")&&(k=document.createElement("source"),k.setAttribute("src",c+".ogg"),
k.setAttribute("type","video/ogg"),this.video.appendChild(k),k=document.createElement("source"),k.setAttribute("src",c+".ogv"),k.setAttribute("type","video/ogg"),this.video.appendChild(k));this.video.canPlayType("video/webm")&&(k=document.createElement("source"),k.setAttribute("src",c+".webm"),k.setAttribute("type","video/webm"),this.video.appendChild(k));this.addControlContainer(this.video)};a.extend(a.Video,a.Control);a.Video.prototype.init=function(){this.video.style.left=this.x+"px";this.video.style.top=
this.y+"px"};a.Video.prototype.update=function(){d=this.evaluator;0<d.evalExpression(this.drawif)?this.video.style.display="block":(this.video.style.display="none",this.video.pause());this.updatePositionAndSize()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d,e;a.TextArea=function(d,c){a.Control.call(this,d,c);this.region="interior";this.tabindex=++this.parent.tabindex;if(this.answer){this.answer.match("krypto_")&&(this.answer=(new a.Krypto).decode(this.answer.substring(7)));
var e=this.parent.lessonParser.parseText(this.answer)}this.containerControl=document.createElement("div");this.textArea=document.createElement("div");this.textAreaAnswer=document.createElement("div");this.showButton=document.createElement("div");this.activeCover=document.createElement("div");this.containerControl.appendChild(this.textArea);this.containerControl.appendChild(this.textAreaAnswer);this.containerControl.appendChild(this.showButton);this.containerControl.appendChild(this.activeCover);this.addControlContainer(this.containerControl);
this.showAnswer=!1;this.text=void 0==this.text||void 0==this.text.type?this.rawText||"":this.text.hasFormula?this.rawText:this.text.toHTML();e&&void 0!=e.type&&!this.text.hasFormula&&(this.answer=e.toHTML());this.evaluator.setVariable(this.id,this.text);this.drawButton();this.registerMouseAndTouchEvents();this.init()};a.extend(a.TextArea,a.Control);a.TextArea.prototype.init=function(){e=this.answer?28:8;d=this.evaluator;this.text=d.getVariable(this.id);this.containerControl.setAttribute("class","DescartesTextAreaContainer");
this.containerControl.setAttribute("style","width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";");this.containerControl.style.display=0<d.evalExpression(this.drawif)?"block":"none";this.containerControl.setAttribute("spellcheck","false");this.textArea.setAttribute("class","DescartesTextAreaContainer");this.textArea.setAttribute("style","width: "+(this.w-8)+"px; height: "+(this.h-e)+"px; left: 4px; top: 4px; background-color: white; text-align: left; font: "+
a.convertFont(this.font)+";");this.textArea.setAttribute("contenteditable","true");this.textArea.innerHTML="<span style='position: relative; top: 10px; left: 10px; white-space: nowrap;' >"+this.text+"</span>";this.textAreaAnswer.setAttribute("class","DescartesTextAreaContainer");this.textAreaAnswer.setAttribute("style","width: "+(this.w-8)+"px; height: "+(this.h-e)+"px; left: 4px; top: 4px; background-color: white; text-align: left; font: "+a.convertFont(this.font)+";");this.textAreaAnswer.style.display=
this.showAnswer?"block":"none";this.textAreaAnswer.innerHTML="<span style='position: relative; top: 10px; left: 10px; white-space: nowrap;'>"+this.answer+"</span>";this.showButton.setAttribute("style","width: 20px; height: 16px; position: absolute; bottom: 4px; right: 4px; cursor: pointer;");this.showButton.style.backgroundImage="url("+this.imageUnPush+")";this.showButton.style.display=this.answer?"block":"none";this.showButton.innerHTML="<span style='position: relative; top: 2px; text-align: center; font: 9px Arial'> S </span>";
this.activeCover.setAttribute("style","position: absolute; width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px;")};a.TextArea.prototype.drawButton=function(){var d=document.createElement("canvas");d.setAttribute("width",20);d.setAttribute("height",16);var c=d.getContext("2d");this.canvas=d;this.ctx=c;this.createGradient(20,16);c.lineWidth=1;c.fillStyle="white";c.fillRect(0,0,20,16);c.fillStyle=this.linearGradient;c.fillRect(0,0,20,16);a.drawLine(c,19,0,19,16,"rgba(0,0,0,"+
128/255+")");a.drawLine(c,0,0,0,16,"rgba(0,0,0,"+24/255+")");a.drawLine(c,1,0,1,16,"rgba(0,0,0,"+8/255+")");this.imageUnPush=d.toDataURL();c.fillStyle="white";c.fillRect(0,0,20,16);c.fillStyle=this.linearGradient;c.fillRect(0,0,20,16);a.drawLine(c,0,0,0,14,"gray");a.drawLine(c,0,0,19,0,"gray");c.fillStyle="rgba(0, 0, 0,"+24/255+")";c.fillRect(0,0,this.w,this.h);this.imagePush=d.toDataURL()};a.TextArea.prototype.update=function(){d=this.evaluator;this.activeIfValue=0<d.evalExpression(this.activeif);
this.drawIfValue=0<d.evalExpression(this.drawif);d.setVariable(this.id,this.text);this.activeCover.style.display=this.activeIfValue?"none":"block";this.containerControl.style.display=this.drawIfValue?"block":"none";this.updatePositionAndSize()};a.TextArea.prototype.registerMouseAndTouchEvents=function(){function a(d){d.preventDefault();c.showButton.style.backgroundImage="url("+c.imageUnPush+")"}var c=this;this.showButton.addEventListener("mousedown",function(a){a.preventDefault();c.showAnswer=!c.showAnswer;
c.textAreaAnswer.style.display=c.showAnswer?"block":"none";c.showButton.childNodes[0].childNodes[0].textContent=c.showAnswer?"T":"S";c.showButton.style.backgroundImage="url("+c.imagePush+")"});this.showButton.addEventListener("mouseup",a);this.showButton.addEventListener("mouseout",a)};a.TextArea.prototype.getScreenshot=function(){var a=document.createElement("canvas");a.setAttribute("width",this.w);a.setAttribute("height",this.h);var c=a.getContext("2d");c.fillStyle="white";c.strokeStyle="black";
c.lineWidth=1;c.fillRect(0,0,this.w,this.h);c.strokeRect(0,0,this.w,this.h);return a};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d=2*Math.PI,e,f,c,k,g,l,n,q,h;a.GraphicControl=function(c,d){f=c.evaluator.parser;this.spaceID="E0";this.text="";this.size=f.parse("4");this.font="Monospaced,PLAIN,12";this.image=new Image;this.image.onload=function(){this.ready=1};this.imageSrc="";a.Control.call(this,c,d);this.touchId=null;this.font=a.convertFont(this.font);this.constraintExpr&&
(this.constraint=f.parse(this.constraintExpr),"(expr)"==this.constraint.type&&(this.constraint=f.parse(this.constraintExpr.substring(1,this.constraintExpr.length-1))),"compOperator"==this.constraint.type?this.newt=new a.R2Newton(this.evaluator,this.constraint):this.constraint=null,q=new a.R2(0,0));this.container=this.getContainer();this.mouseCacher=document.createElement("div");this.mouseCacher.setAttribute("class","DescartesGraphicControl");this.mouseCacher.setAttribute("id",this.id);this.mouseCacher.setAttribute("dragged",
!0);this.mouseCacher.setAttribute("tabindex","-1");this.ctx=this.space.ctx;this.container.appendChild(this.mouseCacher);this.registerMouseAndTouchEvents();this.init()};a.extend(a.GraphicControl,a.Control);a.GraphicControl.prototype.init=function(){e=this.evaluator;h=a.hasTouchSupport;var c=e.evalExpression(this.expresion);this.x=c[0][0];this.y=c[0][1];e.setVariable(this.id+".x",this.x);e.setVariable(this.id+".y",this.y);""!=this.imageSrc&&!this.imageSrc.toLowerCase().match(/vacio.gif$/)?(this.image=
this.parent.getImage(this.imageSrc),this.width=this.image.width,this.height=this.image.height):(this.width=2*e.evalExpression(this.size),this.height=2*e.evalExpression(this.size));this._w=h&&70>this.width?70:this.width;this._h=h&&70>this.height?70:this.height;this.mouseCacher.setAttribute("style","cursor: pointer; background-color: rgba(255, 255, 255, 0); width: "+this._w+"px; height: "+this._h+"px; z-index: "+this.zIndex+";");this.mouseCacher.style.left=parseInt(this.space.getAbsoluteX(this.x)-this._w/
2)+"px";this.mouseCacher.style.top=parseInt(this.space.getAbsoluteY(this.y)-this._h/2)+"px";e.setVariable(this.id+".activo",0)};a.GraphicControl.prototype.update=function(){e=this.evaluator;this.activeIfValue=0<e.evalExpression(this.activeif);this.drawIfValue=0<e.evalExpression(this.drawif);this.x=e.getVariable(this.id+".x");this.y=e.getVariable(this.id+".y");c=this.space.getAbsoluteX(this.x);k=this.space.getAbsoluteY(this.y);this.active||(this.mouseCacher.style.left=parseInt(c-this._w/2)+"px",this.mouseCacher.style.top=
parseInt(k-this._h/2)+"px");this.mouseCacher.style.display=this.drawIfValue?"block":"none";this.constraint&&this.evalConstraint();this.draw()};a.GraphicControl.prototype.draw=function(){e=this.evaluator;this.drawIfValue&&(l=this.ctx,n=this.space.backgroundCtx,c=parseInt(this.space.getAbsoluteX(this.x))+0.5,k=parseInt(this.space.getAbsoluteY(this.y))+0.5,""!=this.text&&this.drawText(c,k),this.image.ready?(this.image.complete&&l.drawImage(this.image,parseInt(c-this.image.width/2),parseInt(k-this.image.height/
2)),this.trace&&(n.save(),n.translate(c,k),n.scale(parseInt(this.image.width/2),parseInt(this.image.height/2)),n.beginPath(),n.arc(0,0,1,0,d,!1),n.restore(),n.lineWidth=1,n.strokeStyle=a.getColor(e,this.trace),n.stroke())):(l.beginPath(),l.arc(c,k,parseInt(this.width/2),0,d,!1),l.fillStyle=a.getColor(e,this.colorInt),l.fill(),l.lineWidth=1,l.strokeStyle=a.getColor(e,this.color),l.stroke(),this.active&&(l.beginPath(),l.arc(c,k,parseInt(this.width/2)-2,0,d,!1),l.strokeStyle="black",l.stroke()),this.trace&&
(n.lineWidth=1,n.strokeStyle=a.getColor(e,this.trace),n.beginPath(),n.arc(c,k,parseInt(this.width/2),0,d,!1),n.stroke())))};a.GraphicControl.prototype.evalConstraint=function(a,c){q.set(this.x,this.y);g=this.newt.findZero(q);this.x=g.x;this.y=g.y;this.evaluator.setVariable(this.id+".x",this.x);this.evaluator.setVariable(this.id+".y",this.y)};a.GraphicControl.prototype.drawText=function(c,d){l=this.ctx;e=this.evaluator;l.fillStyle=a.getColor(e,this.color);l.font=this.font;l.textBaseline="alphabetic";
l.fillText(e.evalExpression(this.text[0],e.evalExpression(this.decimals),this.fixed),parseInt(c+1+this.width/2),parseInt(d-1-this.height/2))};a.GraphicControl.prototype.getContainer=function(){for(var a=this.parent.spaces,c,d=0,f=a.length;d<f;d++)if(c=a[d],c.id==this.spaceID)return c.addCtr(this),this.zIndex=c.zIndex,this.space=c,c.graphicControlContainer;a[0].addCtr(this);this.zIndex=a[0].zIndex;this.space=a[0];return a[0].graphicControlContainer};a.GraphicControl.prototype.deactivate=function(){this.active=
!1;this.evaluator.setVariable(this.id+".activo",0)};a.GraphicControl.prototype.registerMouseAndTouchEvents=function(){function c(a){a.preventDefault();k.whichButton=null==a.which?2>a.button?"LEFT":4==a.button?"MIDDLE":"RIGHT":2>a.which?"LEFT":2==a.which?"MIDDLE":"RIGHT";"LEFT"==k.whichButton&&(k.activeIfValue&&k.over)&&(k.parent.deactivateGraphiControls(),k.click=!0,k.active=!0,k.evaluator.setVariable(k.id+".activo",1),k.posAnte=k.getCursorPosition(a),k.prePos={x:k.space.getAbsoluteX(k.x),y:k.space.getAbsoluteY(k.y)},
window.addEventListener("mouseup",f,!1),window.addEventListener("mousemove",h,!1))}function d(a){a.preventDefault();k.activeIfValue&&(k.parent.deactivateGraphiControls(),k.click=!0,k.active=!0,k.evaluator.setVariable(k.id+".activo",1),k.posAnte=k.getCursorPosition(a),k.prePos={x:k.space.getAbsoluteX(k.x),y:k.space.getAbsoluteY(k.y)},window.addEventListener("touchmove",h,!1),window.addEventListener("touchend",f,!1))}function f(c){c.preventDefault();k.touchId=null;if(k.activeIfValue||k.active)k.click=
!1,a.hasTouchSupport?(window.removeEventListener("touchmove",h,!1),window.removeEventListener("touchend",f,!1)):(window.removeEventListener("mouseup",f,!1),window.removeEventListener("mousemove",h,!1)),k.parent.update(),k.mouseCacher.style.left=k.space.getAbsoluteX(k.x)-k._w/2+"px",k.mouseCacher.style.top=k.space.getAbsoluteY(k.y)-k._h/2+"px"}function h(a){a.preventDefault();a.touchId=k.touchId;l=k.getCursorPosition(a);k.posX=k.prePos.x-(k.posAnte.x-l.x);k.posY=k.prePos.y-(k.posAnte.y-l.y);k.evaluator.setVariable(k.id+
".x",k.space.getRelativeX(k.posX));k.evaluator.setVariable(k.id+".y",k.space.getRelativeY(k.posY));k.parent.updateControls();k.parent.update()}function e(a){k.over=!0}function g(a){k.over=!1;k.click=!1}var k=this;this.active=this.over=this.click=!1;this.mouseCacher.oncontextmenu=function(){return!1};a.hasTouchSupport?this.mouseCacher.addEventListener("touchstart",d,!1):(this.mouseCacher.addEventListener("mousedown",c,!1),this.mouseCacher.addEventListener("mouseover",e,!1),this.mouseCacher.addEventListener("mouseout",
g,!1));var l};a.GraphicControl.prototype.getCursorPosition=function(a){if(a.touches){var c;if(a.touchId){d=0;for(f=a.touches.length;d<f;d++)if(a.touches[d].identifier==a.touchId){c=a.touches[d];break}}else for(var d=0,f=a.touches.length;d<f;d++)if(a.target==a.touches[d].target){c=a.touches[d];this.touchId=c.identifier;break}mouseX=c.pageX;mouseY=c.pageY}else void 0!=a.pageX&&void 0!=a.pageY?(mouseX=a.pageX,mouseY=a.pageY):(mouseX=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,
mouseY=a.clientY+document.body.scrollTop+document.documentElement.scrollTop);return{x:mouseX-(this.space.container.offsetLeft+this.space.container.parentNode.offsetLeft),y:mouseY-(this.space.container.offsetTop+this.space.container.parentNode.offsetTop)}};return a}(descartesJS||{}),descartesJS=function(a,d){var e,f,c,k,g,l,n,q,h,r;if(a.loadLib)return a;var u,p,m,s,t,v,w,B=/[\w-//]*(\.png|\.jpg|\.gif|\.svg|\.PNG|\.JPG|\.GIF|\.SVG)/g,E,C,y,D,z,G,A,K,J,H,M,x,I,F,P;a.LessonParser=function(c){this.parent=
c;this.parser=c.evaluator.parser;this.RTFparser=new a.RTFParser(c.evaluator)};a.LessonParser.prototype.parseButtonsConfig=function(a){var c={rowsNorth:0,rowsSouth:0,widthEast:125,widthWest:125,height:23};a=this.split(a);for(var f=0,h=a.length;f<h;f++)switch(p=a[f][0],m=a[f][1],d[p]){case "rowsNorth":c.rowsNorth=parseInt(m);break;case "rowsSouth":c.rowsSouth=parseInt(m);break;case "widthEast":c.widthEast=parseInt(m);break;case "widthWest":c.widthWest=parseInt(m);break;case "height":c.height=parseInt(m);
break;case "about":c.about="true"===d[m];break;case "config":c.config="true"===d[m];break;case "init":c.init="true"===d[m];break;case "clear":c.clear="true"===d[m];break;default:console.log("----- attributo de space no identificado: <"+p+"> valor: <"+m+"> -----")}return c};a.LessonParser.prototype.parseSpace=function(c){s={};c=this.split(c);for(var f=0,h=c.length;f<h;f++)switch(p=c[f][0],m=c[f][1],d[p]){case "type":s.type=m;break;case "id":s.id=m;break;case "x":u=m;u="%"===u[u.length-1]?(this.parent.container.width*
parseFloat(u)/100).toString():m;s.xExpr=this.parser.parse(u);break;case "y":u=m;u="%"===u[u.length-1]?(this.parent.container.height*parseFloat(u)/100).toString():m;s.yExpr=this.parser.parse(u);break;case "width":u=m;"%"===u[u.length-1]?u=this.parent.container.width*parseFloat(u)/100:(u=parseFloat(m),u!=m&&(u=this.parent.container.width));s.w=u;break;case "height":u=m;"%"===u[u.length-1]?u=this.parent.container.height*parseFloat(u)/100:(u=parseFloat(m),u!=m&&(u=this.parent.container.height));s.h=u;
break;case "drawif":s.drawif=this.parser.parse(m);break;case "fixed":s.fixed="true"===d[m];break;case "scale":u=parseFloat(m);u.toString()!=m&&(u=48);s.scale=u;break;case "O.x":s.OxExpr=m;break;case "O.y":s.OyExpr=m;break;case "image":s.imageSrc=m;break;case "bg_display":s.bg_display=d[m];break;case "background":s.background=this.convertColor(m);break;case "net":s.net="false"===d[m]?"":this.convertColor(m);break;case "net10":s.net10="false"===d[m]?"":this.convertColor(m);break;case "axes":s.axes=
"false"===d[m]?"":this.convertColor(m);break;case "text":s.text="false"===d[m]?"":this.convertColor(m);break;case "numbers":s.numbers="true"===d[m];break;case "x-axis":s.x_axis="false"===d[m]?"":m;break;case "y-axis":s.y_axis="false"===d[m]?"":m;break;case "sensitive_to_mouse_movements":s.sensitive_to_mouse_movements="true"===d[m];break;case "cID":s.cID=m;break;case "R3":s.R3="true"===d[m];break;case "render":s.render=d[m];break;case "split":s.split="true"===d[m];break;case "file":s.file=m;break;
default:console.log("----- attributo de space no identificado: <"+p+"> valor: <"+m+"> -----")}if("R2"===s.type||4>this.parent.version)return new a.Space2D(this.parent,s);if("R3"===s.type)return new a.Space3D(this.parent,s);if("AP"===s.type)return new a.SpaceAP(this.parent,s);if("HTMLIFrame"===s.type)return new a.SpaceHTML_IFrame(this.parent,s)};a.LessonParser.prototype.parseControl=function(c){t={};c=this.split(c);for(var f=0,h=c.length;f<h;f++)switch(p=c[f][0],m=c[f][1],d[p]){case "id":t.id=m;break;
case "type":t.type=d[m.trim()];break;case "gui":t.gui=d[m];break;case "region":t.region=d[m];break;case "space":t.spaceID=m;break;case "name":t.name=m;break;case "expresion":t.expresion=this.parser.parse(m.replace(")(",","));break;case "fixed":t.fixed="true"===d[m];break;case "visible":t.visible="true"===d[m];break;case "color":t.color=this.convertColor(m);break;case "colorInt":t.colorInt=this.convertColor(m);break;case "bold":"false"!=d[m]&&(t.bold="bold");break;case "italics":"false"!=d[m]&&(t.italics=
"italic");break;case "underlined":"false"!=d[m]&&(t.underlined=!0);break;case "font_size":t.font_size=this.parser.parse(m);break;case "image":t.imageSrc=m;break;case "action":t.action=d[m];break;case "parameter":t.parameter=m;break;case "drawif":t.drawif=this.parser.parse(m);break;case "activeif":t.activeif=this.parser.parse(m);break;case "tooltip":t.tooltip=m;break;case "tooltipFont":t.tooltipFont=m;break;case "Explanation":t.Explanation=m;break;case "ExplanationFont":t.ExplanationFont=m;break;case "msg_pos":t.msg_pos=
d[m];break;case "cID":t.cID=m;break;case "value":var e=m.replace(/&squot;/g,"'");e.match(/^\|/)&&(e="'"+e.substring(1),e.match(/\|$/)&&(e=e.substring(0,e.length-1)+"'"));t.valueExpr=this.parser.parse(e);t.valueExprString=e;break;case "decimals":t.decimals=this.parser.parse(m);break;case "min":t.min=this.parser.parse(m);break;case "max":t.max=this.parser.parse(m);break;case "incr":0!=m&&(t.incr=this.parser.parse(m));break;case "discrete":t.discrete="true"===d[m];break;case "onlyText":t.onlyText="true"===
d[m];break;case "evaluate":t.evaluate="true"===d[m];break;case "answer":t.answer=m;break;case "exponentialif":t.exponentialif=parseFloat(m);break;case "size":t.size=this.parser.parse(m);break;case "constraint":t.constraintExpr=m;break;case "text":t.rawText=m;for(var e=this.parseText(m),g=0,k=e.length;g<k;g++)e[g]=this.parser.parse(e[g],!1);t.text=e;break;case "trace":t.trace=this.convertColor(m);break;case "options":t.options=m;break;case "font":t.font=m;break;case "file":t.file=m;break;case "autoplay":t.autoplay=
"true"===d[m];break;case "loop":t.loop="true"===d[m];break;case "controls":t.controls="true"===d[m];break;case "poster":t.poster=d[m];break;default:g=p.indexOf(".");e=d[p.substring(0,g)];g=d[p.substring(g+1)];if("parameter"===e&&"font"===g){t.parameterFont=m;break}else if("Explanation"===e&&"font"===g){t.ExplanationFont=m;break}else if("tooltip"===e&&"font"===g){t.tooltipFont=m;break}console.log("----- attributo de control no identificado: <"+p+"> valor: <"+m+"> -----")}if("numeric"===t.type){if(void 0===
t.gui||"spinner"===t.gui)return new a.Spinner(this.parent,t);if("button"===t.gui)return new a.Button(this.parent,t);if("textfield"===t.gui)return new a.TextField(this.parent,t);if("menu"===t.gui)return new a.Menu(this.parent,t);if("scrollbar"===t.gui)return new a.Scrollbar(this.parent,t)}else{if("video"===t.type)return new a.Video(this.parent,t);if("audio"===t.type)return new a.Audio(this.parent,t);if("graphic"===t.type)return new a.GraphicControl(this.parent,t);if("text"===t.type)return new a.TextArea(this.parent,
t)}};a.LessonParser.prototype.parseGraphic=function(c,f,h,e){v={rotateExp:e,parameter:"t"};c=this.split(c);e=0;for(var g=c.length;e<g;e++)switch(p=c[e][0],m=c[e][1],d[p]){case "space":v.spaceID=m;break;case "type":v.type=d[m];break;case "background":v.background="true"===d[m];break;case "color":v.color=this.convertColor(m);break;case "drawif":v.drawif=this.parser.parse(m);break;case "abs_coord":v.abs_coord="true"===d[m];break;case "expresion":"macro"!=v.type?(v.expresion=this.parser.parse(m),v.expresionString=
m):v.expresion=m;break;case "trace":v.trace=this.convertColor(m);break;case "family":v.family=m;break;case "parameter":v.parameter=m;break;case "fill":v.fill=this.convertColor(m);break;case "fillP":v.fillP=this.convertColor(m);break;case "fillM":v.fillM=this.convertColor(m);break;case "width":v.width=this.parser.parse(m);break;case "visible":v.visible="true"===d[m];break;case "editable":v.editable="true"===d[m];break;case "info":v.info=m;break;case "text":v.text=this.parseText(m);break;case "font":v.font=
m;break;case "fixed":v.fixed="true"===d[m];break;case "decimals":v.decimals=this.parser.parse(m);break;case "size":v.size=this.parser.parse(m);break;case "spear":v.spear=this.parser.parse(m);break;case "arrow":v.arrow=this.convertColor(m);break;case "center":v.center=this.parser.parse(m);break;case "radius":v.radius=this.parser.parse(m);break;case "init":v.init=this.parser.parse(m);break;case "end":v.end=this.parser.parse(m);break;case "vectors":v.vectors="true"===d[m];break;case "file":var k=m.replace(/&squot;/g,
"'");"["===k.charAt(0)&&"]"===k.charAt(k.length-1)&&(k=k.substring(1,k.length-1));k.match(B)&&(k="'"+k+"'");v.file=this.parser.parse(k);break;case "opacity":v.opacity=this.parser.parse(m);break;case "inirot":v.inirot=this.parser.parse(m);break;case "inipos":v.inipos=this.parser.parse(m);break;case "name":v.name=m;break;case "range":v.range=this.parser.parse(m);break;case "border":"false"!=d[m]&&(v.border=this.convertColor(m));break;case "align":v.align=d[m];break;default:if(void 0!=v.family&&p.substring(0,
v.family.length+1)===v.family+"."){switch(d[p.substring(v.family.length+1)]){case "interval":v.family_interval=this.parser.parse(m);break;case "steps":v.family_steps=this.parser.parse(m)}break}if(void 0!=v.parameter&&p.substring(0,v.parameter.length+1)===v.parameter+"."){switch(d[p.substring(v.parameter.length+1)]){case "interval":v.parameter_interval=this.parser.parse(m);break;case "steps":v.parameter_steps=this.parser.parse(m)}break}console.log("----- attributo del graphic no identificado: <"+p+
"> valor: <"+m+"> -----")}f&&(v.abs_coord=f);h&&(v.background=h);if("equation"===v.type)return new a.Equation(this.parent,v);if("curve"===v.type)return new a.Curve(this.parent,v);if("sequence"===v.type)return new a.Sequence(this.parent,v);if("point"===v.type)return new a.Point(this.parent,v);if("segment"===v.type)return new a.Segment(this.parent,v);if("arrow"===v.type)return new a.Arrow(this.parent,v);if("polygon"===v.type)return new a.Polygon(this.parent,v);if("arc"===v.type)return new a.Arc(this.parent,
v);if("text"===v.type)return new a.Text(this.parent,v);if("image"===v.type)return new a.Image(this.parent,v);if("macro"===v.type)return new a.Macro(this.parent,v);if("fill"===v.type)return new a.Fill(this.parent,v)};a.LessonParser.prototype.parse3DGraphic=function(c,f,h,e){v={rotateExp:e,parameter:"t"};c=this.split(c);f=0;for(h=c.length;f<h;f++)switch(p=c[f][0],m=c[f][1],d[p]){case "space":v.spaceID=m;break;case "type":v.type=d[m];break;case "background":v.background="true"===d[m];break;case "color":v.color=
this.convertColor(m);break;case "drawif":v.drawif=this.parser.parse(m);break;case "expresion":"macro"!=v.type&&"curve"!=v.type&&"surface"!=v.type?(v.expresion=this.parser.parse(m),v.expresionString=m):v.expresion=m;break;case "family":v.family=m;break;case "parameter":v.parameter=m;break;case "width":v.width=this.parser.parse(m);break;case "length":v.length=this.parser.parse(m);break;case "text":e=this.parseText(m);for(var g=0,k=e.length;g<k;g++)e[g]=this.parser.parse(e[g],!1);v.text=e;break;case "font":v.font=
m;break;case "fixed":v.fixed="true"===d[m];break;case "decimals":v.decimals=this.parser.parse(m);break;case "file":e=m.replace(/&squot;/g,"'");"["===e.charAt(0)&&"]"===e.charAt(e.length-1)&&(e=e.substring(1,e.length-1));e.match(/./)&&(e="'"+e+"'");v.file=this.parser.parse(e);break;case "model":v.model=d[m];break;case "edges":v.edges="true"===d[m];break;case "Nu":v.Nu=this.parser.parse(m);break;case "Nv":v.Nv=this.parser.parse(m);break;case "name":v.name=m;break;case "backcolor":v.backcolor=this.convertColor(m);
break;case "inirot":v.inirot=this.parser.parse(m);break;case "endrot":v.endrot=this.parser.parse(m);break;case "inipos":v.inipos=this.parser.parse(m);break;case "endpos":v.endpos=this.parser.parse(m);break;default:if(void 0!=v.family&&p.substring(0,v.family.length+1)===v.family+"."){switch(d[p.substring(v.family.length+1)]){case "interval":v.family_interval=this.parser.parse(m);break;case "steps":v.family_steps=this.parser.parse(m)}break}if(void 0!=v.parameter&&p.substring(0,v.parameter.length+1)===
v.parameter+"."){switch(d[p.substring(v.parameter.length+1)]){case "interval":v.parameter_interval=this.parser.parse(m);break;case "steps":v.parameter_steps=this.parser.parse(m)}break}console.log("----- attributo del graphic no identificado: <"+p+"> valor: <"+m+"> -----")}if("point"===v.type)return new a.Point3D(this.parent,v);if("segment"===v.type)return new a.Segment3D(this.parent,v);if("polygon"===v.type)return new a.Polygon3D(this.parent,v);if("curve"===v.type)return new a.Curve3D(this.parent,
v);if("triangle"===v.type)return new a.Triangle3D(this.parent,v);if("face"===v.type)return new a.Face3D(this.parent,v);if("polireg"===v.type)return new a.Polireg3D(this.parent,v);if("surface"===v.type)return new a.Surface3D(this.parent,v);if("text"===v.type)return new a.Text3D(this.parent,v);if("mesh"===v.type)return new a.Mesh3D(this.parent,v);console.log(v.type)};a.LessonParser.prototype.parseAuxiliar=function(c){w={};c=this.split(c);for(var f=0,h=c.length;f<h;f++)c[f][1]=c[f][1].replace(/&squot;/g,
"'");f=0;for(h=c.length;f<h;f++)switch(p=c[f][0],m=c[f][1],d[p]){case "id":w.id=m;break;case "editable":w.editable="true"===d[m];break;case "constant":w.constant="true"===d[m];break;case "array":w.array="true"===d[m];break;case "size":w.size=this.parser.parse(m);break;case "file":w.file=m;break;case "matrix":w.matrix="true"===d[m];break;case "rows":w.rows=this.parser.parse(m);break;case "columns":w.columns=this.parser.parse(m);break;case "algorithm":w.algorithm="true"===d[m];break;case "init":w.init=
m;break;case "do":w.doExpr=m;break;case "while":w.whileExpr=m;break;case "range":w.range=m;break;case "expresion":w.expresion=m;break;case "evaluate":w.evaluate=d[m];break;case "event":w.event=d[m];break;case "condition":w.condition=m;break;case "execution":w.execution=d[m];break;case "msg_pos":w.msg_pos=d[m];break;case "action":w.action=d[m];break;case "parameter":w.parameter=m;break;case "sequence":w.sequence="true"===d[m];break;default:var e=p.indexOf("."),g=d[p.substring(0,e)],e=d[p.substring(e+
1)];if("parameter"===g&&"font"===e){w.parameterFont=m;break}console.log("----- attributo de auxiliar no identificado: <"+p+"> valor: <"+m+"> -----")}w.sequence?new a.AuxSequence(this.parent,w):w.constant?(c=new a.Constant(this.parent,w),w.evaluate&&"always"===w.evaluate&&this.parent.auxiliaries.push(c)):w.algorithm&&w.evaluate?(c=new a.Algorithm(this.parent,w),this.parent.auxiliaries.push(c)):w.array&&!w.matrix&&")"!=w.id.charAt(w.id.length-1)?(c=new a.Vector(this.parent,w),w.evaluate&&"always"===
w.evaluate&&this.parent.auxiliaries.push(c)):w.matrix&&")"!=w.id.charAt(w.id.length-1)?(c=new a.Matrix(this.parent,w),w.evaluate&&"always"===w.evaluate&&this.parent.auxiliaries.push(c)):w.event&&")"!=w.id.charAt(w.id.length-1)?this.parent.events.push(new a.Event(this.parent,w)):")"===w.id.charAt(w.id.length-1)?new a.Function(this.parent,w):new a.Variable(this.parent,w)};a.LessonParser.prototype.parseAction=function(c){E=c.action;C=c.parent;y=c.parameter;if(E)switch(E){case "message":return new a.Message(C,
y);case "calculate":return new a.Calculate(C,y);case "openURL":return new a.OpenURL(C,y);case "openScene":return new a.OpenScene(C,y);case "about":return new a.About(C,y);case "config":return new a.Config(C,y);case "init":return new a.Init(C,y);case "clear":return new a.Clear(C,y);case "animate":return new a.Animate(C,y);case "initAnimation":return new a.InitAnimation(C,y);case "playAudio":return new a.PlayAudio(C,y);default:console.log("----- Accion no soportada aun: <"+E+"> -----")}else return{execute:function(){}}};
a.LessonParser.prototype.parseAnimation=function(c){var f={};c=this.split(c);for(var h=0,e=c.length;h<e;h++)switch(p=c[h][0],m=c[h][1],d[p]){case "delay":f.delay=m;break;case "controls":f.controls="true"===d[m];break;case "auto":f.auto="true"===d[m];break;case "loop":f.loop="true"===d[m];break;case "init":f.init=m;break;case "do":f.doExpr=m;break;case "while":f.whileExpr=m;break;case "id":f.id=m;break;case "algorithm":f.algorithm="true"===d[m];break;case "evaluate":f.evaluate="true"===d[m];break;
default:console.log("----- attributo de la animacion no identificado: <"+p+">  <"+m+"> -----")}return new a.Animation(this.parent,f)};var R,L,V,T,N,Q,O,S,U,X;a.LessonParser.prototype.parsePleca=function(d,u){d=this.split(d);f=e="";c=0;k="#536891";g="white";l="left";n="";q="SansSerif,BOLD,20";h="SansSerif,PLAIN,18";r=void 0;for(var s=0,t=d.length;s<t;s++)switch(p=d[s][0],m=d[s][1],p){case "title":e=m;break;case "subtitle":f=m;break;case "subtitlines":c=m;break;case "bgcolor":""!=m&&(k="#"+a.getColor(this.evaluator,
m));break;case "fgcolor":""!=m&&(g="#"+a.getColor(this.evaluator,m));break;case "align":""!=m&&(l=m);break;case "titleimage":n=m;break;case "titlefont":q=""!=m?a.convertFont(m):a.convertFont(q);break;case "subtitlefont":h=""!=m?a.convertFont(m):a.convertFont(h);break;default:console.log("----- attributo de la pleca no identificado: <"+p+">  <"+m+"> -----")}R=h.substring(0,h.indexOf("px"));R=R.substring(R.lastIndexOf(" "));""!=n&&(L=this.parent.getImage(n),V=L.height);r=document.createElement("div");
r.setAttribute("id","descartesPleca");V?(r.setAttribute("style","position: absolute; left: 0px; top: 0px; text-align: "+l+"; width: "+(u-30)+"px; height: "+(V-16)+"px; background: "+k+"; color: "+g+"; padding-top: 8px; padding-bottom: 8px; padding-left: 15px; padding-right: 15px; margin: 0px; overflow: hidden; z-index: 100;"),L.setAttribute("style","position: absolute; left: 0px; top: 0px; z-index: -1; width: 100%; height: 100%"),r.appendChild(L)):r.setAttribute("style","position: absolute; left: 0px; top: 0px; text-align: "+
l+"; width: "+(u-30)+"px; background: "+k+"; color: "+g+"; padding-top: 8px; padding-bottom: 8px; padding-left: 15px; padding-right: 15px; margin: 0px; z-index: 100;");T=document.createElement("div");T.setAttribute("style","padding: 0px; margin: 0px; font: "+q+"; overflow: hidden; white-space: nowrap;");T.innerHTML=e;N=document.createElement("div");if(1===parseInt(c)){X=0;Q=document.createElement("div");Q.innerHTML=f;document.body.appendChild(Q);S=R;do S-=X,Q.setAttribute("style","padding: 0px; margin: 0px; font: "+
h+"; font-size: "+S+"px; width: "+(u-30)+"px; line-height: "+S+"px;"),O=Q.offsetHeight,U=O/S,X=1;while(1<U&&8<S);document.body.removeChild(Q);N.setAttribute("style","padding: 0px; margin: 0px; font: "+h+"; font-size: "+S+"px; line-height: 110%; overflow: hidden; white-space: nowrap;")}else N.setAttribute("style","padding: 0px; margin: 0px; font: "+h+"; line-height: 110%;");N.innerHTML=f;r.appendChild(T);r.appendChild(N);r.imageHeight=V;return r};a.LessonParser.prototype.split=function(a){if("string"!=
typeof a)return[];a=(a||"").replace(/\\'/g,"\u2019");D=[];G=z=0;A=!1;K=0;for(J=!1;z<a.length;){" "===a.charAt(z)&&!A&&z++;" "!=a.charAt(z)&&!A&&(A=!0,K=z);"="===a.charAt(z)&&("'"===a.charAt(z+1)&&!J)&&(J=!0,D[G]=[a.substring(K,z)],K=z+2,z+=2);J&&"'"===a.charAt(z)&&(A=J=!1,D[G].push(a.substring(K,z)),G++);if("="===a.charAt(z)&&"'"!=a.charAt(z+1)&&!J){D[G]=[a.substring(K,z)];K=z+1;z++;var c=a.substring(z).indexOf("=");-1===c?c=a.length:(c+=z,c=a.substring(z,c).lastIndexOf(" "),c=-1===c?a.length:c+z);
D[G].push(a.substring(K,c));G++;A=!1;z=c}z++}return D};a.LessonParser.prototype.splitComa=function(a){H=[];M=[];for(var c=x=0,d=a.length;c<d;c++)"("===a.charAt(c)?M.push(c):")"===a.charAt(c)?M.pop():","===a.charAt(c)&&0===M.length&&(H.push(a.substring(x,c)),x=c+1);H.push(a.substring(x));return H};a.LessonParser.prototype.convertColor=function(a){if(d[a])return"net"===d[a]?"red":d[a];if(6===a.length)return"#"+a;if(8===a.length)return"rgba("+parseInt("0x"+a.substring(2,4),16)+","+parseInt("0x"+a.substring(4,
6),16)+","+parseInt("0x"+a.substring(6,8),16)+","+(1-parseInt("0x"+a.substring(0,2),16)/255)+")";if("("===a[0]){I="(";F=this.splitComa(a.substring(1,a.length-1));a=0;for(var c=F.length;a<c;a++)P=parseInt(F[a],16),F[a]!=P.toString(16)?("["===F[a].charAt(0)&&"]"===F[a].charAt(F[a].length-1)&&(F[a]=F[a].substring(1,F[a].length-1)),I=I+F[a]+(a<c-1?",":")")):I=I+P/255+(a<c-1?",":")");return this.parser.parse(I)}return"#aa0000"};a.LessonParser.prototype.parseText=function(c){return c.match(/^\{\\rtf1/)?
this.RTFparser.parse(c.substring(10)):new a.SimpleText(this.parent,c)};return a}(descartesJS||{},babel),descartesJS=function(a){function d(a,c){u=[];u.type="matrix";u.rows=a;u.cols=c;var d;m=0;for(s=c;m<s;m++){d=[];p=0;for(t=a;p<t;p++)d.push(0);u[m]=d}return u}function e(a,c){h=a.rows;r=a.cols;u=d(h,r);var f;for(m=0;m<h;m++)for(p=0;p<r;p++){for(s=f=0;s<r;s++)f+=a[s][m]*c[p][s];u[p][m]=f}return u}function f(a,c,f){for(var h=d(f.length-1,f.length-1),e=0,g=h.length;e<g;e++)for(var k=0;k<g;k++)h[e][k]=
e<a?k<c?f[e][k]:f[e][k+1]:e<c?f[e+1][k]:f[e+1][k+1];return h}function c(a){if(1<a.cols){for(var d=0,h=1,e=0,g=a.cols;e<g;e++)d+=h*a[0][e]*c(f(0,e,a)),h=-h;return d}return a[0][0]}if(a.loadLib)return a;var k=Math.floor,g,l,n,q;a.Node=function(a,c){this.sep="";this.type=a;this.value=c;this.parent=null;this.childs=[]};a.Node.prototype.getRoot=function(){return null===this.parent?this:this.parent.getRoot()};a.Node.prototype.addChild=function(a){a.parent=this;this.childs.push(a)};a.Node.prototype.replaceLastChild=
function(a){g=this.childs.length-1;lastChild=this.childs[g];lastChild.parent=null;this.childs[g]=a;a.parent=this;return a};a.Node.prototype.contains=function(a){if(this.value===a)return!0;for(var c=0,d=this.childs.length;c<d;c++)if(this.childs[c].contains(a))return!0;return!1};a.Node.prototype.equalToMinus=function(){return"compOperator"===this.type?(this.type="operator",this.value="-",n=new a.Node("compOperator","=="),q=new a.Node("number","0"),n.addChild(this),n.addChild(q),l=this.getRoot(),l.setAllEvaluateFunction(),
l):this};a.Node.prototype.setAllEvaluateFunction=function(){this.setEvaluateFunction();for(var a=0,c=this.childs.length;a<c;a++)this.childs[a].setAllEvaluateFunction()};a.Node.prototype.setEvaluateFunction=function(){if("number"===this.type)this.evaluate=function(a){return parseFloat(this.value)};else if("string"===this.type)this.evaluate=function(a){return this.value};else if("identifier"===this.type&&0===this.childs.length)if("rnd"==this.value)this.evaluate=function(a){return Math.random()};else{var a;
this.evaluate=function(c,d){a=c.variables[this.value];if("object"===typeof a)return a.evaluate(c);void 0==a&&d&&(a=c.matrices[this.value]);return void 0!==a?a:0}}else if("identifier"===this.type&&"square_bracket"===this.childs[0].type&&1===this.childs[0].childs.length){var g,l;this.evaluate=function(a){g=this.childs[0].childs[0].evaluate(a);try{return l=a.vectors[this.value][0>g?0:k(g)],void 0!==l?l:0}catch(c){return 0}}}else if("identifier"===this.type&&"square_bracket"===this.childs[0].type&&1<
this.childs[0].childs.length){var s,n;this.evaluate=function(a){s=this.childs[0].childs[0].evaluate(a);n=this.childs[0].childs[1].evaluate(a);try{return l=a.matrices[this.value][0>s?0:k(s)][0>n?0:k(n)],void 0!==l?l:0}catch(c){return 0}}}else if("identifier"===this.type&&"parentheses"===this.childs[0].type){var t;this.evaluate=function(a){t=[];for(var c=0,d=this.childs[0].childs.length;c<d;c++)t.push(this.childs[0].childs[c].evaluate(a));return"_Eval_"===this.value?a.evalExpression(a.parser.parse(t[0])):
a.functions[this.value].apply(a,t)}}else if("operator"===this.type){var q,z,G;"+"===this.value?this.evaluate=function(a){q=this.childs[0].evaluate(a,!0);z=this.childs[1].evaluate(a,!0);if("matrix"!==q.type||"matrix"!==z.type)return q+z;a=q;var c=z;h=a.rows;r=a.cols;u=d(h,r);for(m=0;m<h;m++)for(p=0;p<r;p++)u[p][m]=a[p][m]+c[p][m];return u}:"-"===this.value?this.evaluate=function(a){q=this.childs[0].evaluate(a,!0);z=this.childs[1].evaluate(a,!0);if("matrix"!==q.type||"matrix"!==z.type)return q-z;a=
q;var c=z;h=a.rows;r=a.cols;u=d(h,r);for(m=0;m<h;m++)for(p=0;p<r;p++)u[p][m]=a[p][m]-c[p][m];return u}:"*"===this.value?this.evaluate=function(a){q=this.childs[0].evaluate(a,!0);z=this.childs[1].evaluate(a,!0);return"matrix"!==q.type||"matrix"!==z.type?q*z:e(q,z)}:"/"===this.value?this.evaluate=function(a){q=this.childs[0].evaluate(a,!0);z=this.childs[1].evaluate(a,!0);if("matrix"!==q.type||"matrix"!==z.type)return q/z;a=q;var h;h=z;var g=d(h.length,h.length),k=c(h);if(0===k)h=0;else{var k=1/k,m;
if(1<h.length)for(var l=0,p=h.length;l<p;l++){m=k;for(var r=0;r<p;r++)g[r][l]=m*c(f(l,r,h)),m=-m;k=-k}else g[0][0]=k;h=g}a=0===h?d(a.rows,a.cols):e(a,h);return a}:"%"===this.value?this.evaluate=function(a){q=this.childs[0].evaluate(a);z=this.childs[1].evaluate(a);return q-k(q/z)*z}:"^"===this.value&&(this.evaluate=function(a){return Math.pow(this.childs[0].evaluate(a),this.childs[1].evaluate(a))})}else if("compOperator"===this.type)"<"===this.value?this.evaluate=function(a){return(this.childs[0].evaluate(a)<
this.childs[1].evaluate(a))+0}:"<="===this.value?this.evaluate=function(a){return(this.childs[0].evaluate(a)<=this.childs[1].evaluate(a))+0}:">"===this.value?this.evaluate=function(a){return(this.childs[0].evaluate(a)>this.childs[1].evaluate(a))+0}:">="===this.value?this.evaluate=function(a){return(this.childs[0].evaluate(a)>=this.childs[1].evaluate(a))+0}:"=="===this.value?this.evaluate=function(a){return(this.childs[0].evaluate(a)===this.childs[1].evaluate(a))+0}:"!="===this.value&&(this.evaluate=
function(a){return(this.childs[0].evaluate(a)!=this.childs[1].evaluate(a))+0});else if("boolOperator"===this.type)"&"===this.value?this.evaluate=function(a){return(q=this.childs[0].evaluate(a)?1:0)?this.childs[1].evaluate(a)?1:0:0}:"|"===this.value?this.evaluate=function(a){return(q=this.childs[0].evaluate(a)?1:0)?1:this.childs[1].evaluate(a)?1:0}:"!"===this.value&&(this.evaluate=function(a){q=this.childs[0].evaluate(a)?1:0;return!q+0});else if("conditional"===this.type)this.evaluate=function(a){q=
this.childs[0].evaluate(a);return 0<q?this.childs[1].evaluate(a):this.childs[2].evaluate(a)};else if("sign"===this.type)this.evaluate="sign+"===this.value?function(a){return this.childs[0].evaluate(a)}:function(a){return-this.childs[0].evaluate(a)};else if("parentheses"===this.type)this.evaluate=function(a,c){return this.childs[0].evaluate(a,c)};else if("(expr)"===this.type||"[expr]"===this.type){var A,K;this.evaluate=function(a){A=this.childs.length;G=[];if(1===A&&1===this.childs[0].childs.length&&
"(expr)"===this.type)G=this.childs[0].childs[0].evaluate(a);else for(var c=0;c<A;c++){K=[];for(var d=0,f=this.childs[c].childs.length;d<f;d++)K.push(this.childs[c].childs[d].evaluate(a));G[c]=K}return G}}else if("asign"===this.type){var J,H,M,x,I,F;this.evaluate=function(a){J=this.childs[0];H=this.childs[1];1===J.childs.length&&"square_bracket"===J.childs[0].type?(g=J.childs[0].childs,1===g.length?(M=g[0].evaluate(a),M=0>M?0:k(M),a.vectors[J.value][M]=H.evaluate(a)):2===g.length&&(x=g[0].evaluate(a),
I=g[1].evaluate(a),x=0>x?0:k(x),I=0>I?0:k(I),a.matrices[J.value][x]||(a.matrices[J.value][x]=[]),a.matrices[J.value][x][I]=H.evaluate(a))):(F=H.evaluate(a),F.type?a.matrices[J.value]=F:a.variables[J.value]=F)}}};var h,r,u,p,m,s,t;a.Node.prototype.toString=function(){var a="tipo: "+this.type+", valor: "+this.value+"\n";this.sep="   "+(this.parent?this.parent.sep:"");for(var c=0,d=this.childs.length;c<d;c++)a+=this.sep+this.childs[c].toString();return a};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;
var d,e,f,c,k,g,l,n,q,h=/^\s+/,r=/^[a-zA-Z_\u00C0-\u021B]+[a-zA-Z_0-9\u00C0-\u021B]*([.]*[0-9a-zA-Z_\u00C0-\u021B]+[0-9]*)*/,u=/^[0-9]+[.][0-9]+|^[.][0-9]+|^[0-9]+/,p=/^==|^!=|^<=|^<|^>=|^>|^#/,m=/^\!|^\~|^\&\&|^\&|^\|\||^\|/,s=/^=/,t=/^[\?\:]/,v=/^[\+\-\*\/\%\^]/,w=/^\[|^\]/,B=/^\(|^\)/,E=/^,/,C=/^;/;a.Tokenizer=function(){};a.Tokenizer.prototype.tokenize=function(a){function D(a,d,f){e.push({type:a,value:d});g=g.slice(f);c+=f;n++;q=a}if(d=a)a=a.replace(/\\u(\S+) /g,function(a,c){return String.fromCharCode(parseInt(c,
16))}),a=a.replace(/\&sup(.+);/g,"^$1 "),a=a.replace(/&squot;/g,"'"),a.match(/\=\|\*/g)&&(a=a.replace("|*","'","g").replace("*|","'","g")),a.match(/\=\|/g)&&(a=a.replace("|","'","g"));e=[];f=!1;c=0;g=a;n=0;for(q="";a&&c<a.length;)if(f=c,"'"==g[0]){for(l=1;"'"!=g[l];)if(l<g.length)l++;else{console.log(">Error, unknown symbol: ["+g+"], in the string <<"+d+">>");return}k=g.substring(1,l);D("string",k,k.length+2)}else if(k=g.match(h))g=g.slice(k[0].length),c+=k[0].length,n++;else if(k=g.match(r))"number"===
q&&e.push({type:"operator",value:"*"}),D("identifier",k[0],k[0].length);else if(k=g.match(u))D("number",k[0],k[0].length);else if(k=g.match(p)){var z=k[0];"#"==z&&(z="!=");D("compOperator",z,k[0].length)}else if(k=g.match(m))z=k[0],"||"==z?z="|":"&&"==z?z="&":"~"==z&&(z="!"),D("boolOperator",z,k[0].length);else if((k=g.match(s))&&!g.match(/^==/))D("asign",k[0],k[0].length);else if(k=g.match(t))D("conditional",k[0],k[0].length);else if(k=g.match(v))D("operator",k[0],k[0].length);else if(k=g.match(w))D("square_bracket",
k[0],k[0].length);else if(k=g.match(B))D("parentheses",k[0],k[0].length);else if(k=g.match(E))D("separator",k[0],k[0].length);else if(k=g.match(C))D("final_of_expresion",k[0],k[0].length);else if(f==c){console.log("Error, simbolo no conocido: ["+g+"], en la cadena <<"+d+">>");return}return e};a.Tokenizer.prototype.flatTokens=function(a){a=a||[];for(var c="",d=0,f=a.length;d<f;d++)c="string"==a[d].type?c+"&squot;"+a[d].value+"&squot;":c+a[d].value;return c};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;
a.Parser=function(c){this.evaluator=c;this.tokenizer=new a.Tokenizer;this.vectors={};this.matrices={};this.variables={};this.functions={};this.registerDefaultValues()};a.Parser.prototype.setVariable=function(a,c){this.variables[a]=c};a.Parser.prototype.getVariable=function(a){return this.variables[a]};a.Parser.prototype.setVector=function(a,c,d){this.vectors[a][c]=d};a.Parser.prototype.getVector=function(a){this.vectors.hasOwnProperty(a)||(this.vectors[a]=[0,0,0]);return this.vectors[a]};a.Parser.prototype.setMatrix=
function(a,c,d,f){this.matrices[a][c][d]=f};a.Parser.prototype.getMatrix=function(a){this.matrices.hasOwnProperty(a)||(this.matrices[a]=[[0,0,0],[0,0,0],[0,0,0]]);return this.matrices[a]};a.Parser.prototype.setFunction=function(a,c){this.functions[a]=c};a.Parser.prototype.getFunction=function(a){this.functions.hasOwnProperty(a)||(this.functions[a]=function(){return 0});return this.functions[a]};var d,e,f,c,k,g,l,n,q,h,r,u;a.Parser.prototype.parse=function(p,m){(f=this.tokenizer.tokenize(p))||(f=[]);
c=null;m=!m||!1;d=n=l=g=0;for(e=f.length;d<e;d++)if(q=f[d],h=q.value,r=q.type,"identifier"===r&&(d+1<e&&"parentheses"===f[d+1].type&&"("===f[d+1].value?this.getFunction(h):d+1<e&&"square_bracket"===f[d+1].type&&"["===f[d+1].value?f[d+3]&&"square_bracket"===f[d+3].type&&"]"===f[d+3].value?this.getVector(h):this.getMatrix(h):this.getVariable(h)),"asign"===r&&m&&(r="compOperator",h="=="),"asign"===r)if(k=new a.Node(r,h),null!=c)if("identifier"===c.type)c.parent&&c.parent.replaceLastChild(k),k.addChild(c),
c=k,m=!0;else if("square_bracket"===c.type)k.addChild(c.parent),c=k,m=!0;else{k.type="compOperator";k.value="==";for(m=!0;c.parent&&this.getPrecedence(c.parent.value)>=this.getPrecedence(k.value);)c=c.parent;c.parent&&c.parent.replaceLastChild(k);k.addChild(c);c=k}else{console.log("Error1: en la expresion <<"+p+">>, en el token {valor: "+h+", tipo: "+r+"}");break}else if("parentheses"===r&&"("===h||"square_bracket"===r&&"["===h)if(k=new a.Node(r,h),"("===h&&g++,"["===h&&l++,null===c)"("===h&&(new a.Node("(expr)",
"(expr)")).addChild(k),"["===h&&(new a.Node("[expr]","[expr]")).addChild(k),c=k;else if("operator"===c.type||"boolOperator"===c.type||"compOperator"===c.type||"conditional"===c.type||"asign"===c.type)c.addChild(k),c=k;else if("sign"===c.type)c.addChild(k),c=k;else if("parentheses"===c.type&&"("===c.value)c.addChild(k),c=k;else if("square_bracket"===c.type&&"["===c.value)c.addChild(k),c=k;else if("parentheses"===c.type&&"()"===c.value)c.parent.addChild(k),c=k;else if("square_bracket"===c.type&&"[]"===
c.value)c.parent.addChild(k),c=k;else if("identifier"===c.type)c.addChild(k),c=k;else{console.log("Error2: en la expresion <<"+p+">>, en el token ["+d+"] {valor: "+h+", tipo: "+r+"}");break}else if("parentheses"===r&&")"===h)if(g--,null===c)console.log("Error3: en la expresion <<"+p+">>, en el token (valor:"+h+", tipo:"+r);else{for(;c&&c.parent&&"("!=c.value;)c=c.parent;if(c&&"("===c.value)c.value="()";else{console.log("Error4: en la expresion <<"+p+">>, en el token {valor: "+h+", tipo: "+r+"}");
break}}else if("square_bracket"===r&&"]"===h)if(l--,null===c)console.log("Error5: en la expresion <<"+p+">>, en el token (valor:"+h+", tipo:"+r);else{for(;c&&c.parent&&"["!=c.value;)c=c.parent;if(c&&"["===c.value)c.value="[]";else{console.log("Error6: en la expresion <<"+p+">>, en el token {valor: "+h+", tipo: "+r+"}");break}}else if("number"===r||"string"===r||"identifier"===r)if(k=new a.Node(r,h),null===c)c=k;else if("operator"===c.type||"compOperator"===c.type||"boolOperator"===c.type||"parentheses"===
c.type&&"("===c.value||"square_bracket"===c.type&&"["===c.value||"sign"===c.type||"conditional"===c.type||"asign"===c.type)c.addChild(k),c=k;else{console.log("Error7: en la expresion <<"+p+">>, en el token {valor: "+h+", tipo: "+r+"}");break}else if("operator"===r||"compOperator"===r||"boolOperator"===r)if(k=new a.Node(r,h),null===c)if("-"===h||"+"===h)k.type="sign",k.value="sign"+h,c=k;else if("!"===h)c=k;else{console.log("Error8: en la expresion <<"+p+">>, en el token {valor: "+h+", tipo: "+r+"}");
break}else if("operator"===c.type||"compOperator"===c.type||"boolOperator"===c.type||"asign"===c.type||"conditional"===c.type||"square_bracket"===c.type&&"["===c.value&&("-"===h||"+"===h||"!"===h)||"parentheses"===c.type&&"("===c.value&&("-"===h||"+"===h||"!"===h)){if("-"===h||"+"===h)k.type="sign",k.value="sign"+h;c.addChild(k);c=k}else if("number"===c.type||"parentheses"===c.type&&"()"===c.value||"square_bracket"===c.type&&"[]"===c.value||"string"===c.type||"identifier"===c.type||"conditional"===
c.type||"asign"===c.type){for(;c.parent&&this.getPrecedence(c.parent.value)>=this.getPrecedence(k.value);)c=c.parent;c.parent&&c.parent.replaceLastChild(k);k.addChild(c);c=k}else{console.log("Error9: en la expresion <<"+p+">>, en el token {valor: "+h+", tipo: "+r+"}");break}else if("conditional"===r)if(k=new a.Node(r,h),null!=c)if("?"===k.value){for(n++;c.parent&&this.getPrecedence(c.parent.value)>this.getPrecedence(k.value);)c=c.parent;c.parent&&c.parent.replaceLastChild(k);k.addChild(c);c=k}else{for(n--;c&&
c.parent&&"?"!=c.value;)c=c.parent;if(c&&"?"===c.value)c.value="?:";else{console.log("Error10: en la expresion <<"+p+">>, en el token {valor: "+h+", tipo: "+r+"}");break}}else{console.log("Error11: en la expresion <<"+p+">>, en el token {valor: "+h+", tipo: "+r+"}");break}else if("separator"===r)if(null!=c)for(;c.parent&&"("!=c.value&&"["!=c.value;)c=c.parent;else{console.log("Error12: en la expresion <<"+p+">>, en el token {valor: "+h+", tipo: "+r+"}");break}else{console.log("Error13: en la expresion <<"+
p+">>, en el token {valor: "+h+", tipo: "+r+"}");break}0<g&&alert("Error, faltan parentesis por cerrar: "+p);0>g&&alert("Error, faltan parentesis por abrir: "+p);0<l&&alert("Error, faltan square bracketss por cerrar: "+p);0>l&&alert("Error, faltan square bracketss por abrir: "+p);0!=n&&alert("Error, condicional incompleta: "+p);(u=c?c.getRoot():null)&&u.setAllEvaluateFunction();return u};a.Parser.prototype.getPrecedence=function(a){switch(a){case "=":return 1;case "(":return 2;case "[":return 2;case "?":return 2;
case ":":return 3;case "?:":return 3;case "|":return 6;case "&":return 7;case "<":return 5;case "<=":return 5;case ">":return 5;case ">=":return 5;case "==":return 5;case "!=":return 5;case "+":return 6;case "-":return 6;case "/":return 7;case "*":return 7;case "sign-":return 7;case "sign+":return 7;case "!":return 8;case "^":return 8;case "%":return 8;default:return 9}};a.Parser.prototype.registerDefaultValues=function(){this.variables.rnd=Math.random;this.variables.pi=Math.PI;this.variables.e=Math.E;
this.variables.Infinity=Infinity;this.variables["-Infinity"]=-Infinity;this.functions.sqr=function(a){return a*a};this.functions.sqrt=this.functions["ra\u00edz"]=Math.sqrt;this.functions.exp=Math.exp;this.functions.log=Math.log;this.functions.log10=function(a){return Math.log(a)/Math.log(10)};this.functions.abs=Math.abs;this.functions.ent=Math.floor;this.functions.sgn=function(a){return 0<a?1:0>a?-1:0};this.functions.ind=function(a){return a?1:0};this.functions.sin=this.functions.sen=Math.sin;this.functions.cos=
Math.cos;this.functions.tan=Math.tan;this.functions.cot=function(a){return 1/Math.tan(a)};this.functions.sec=function(a){return 1/Math.cos(a)};this.functions.csc=function(a){return 1/Math.sin(a)};this.functions.sinh=this.functions.senh=function(a){return(Math.exp(a)-Math.exp(-a))/2};this.functions.cosh=function(a){return(Math.exp(a)+Math.exp(-a))/2};this.functions.tanh=function(a){return(Math.exp(a)-Math.exp(-a))/(Math.exp(a)+Math.exp(-a))};this.functions.coth=function(a){return 1/this.functions.tanh(a)};
this.functions.sech=function(a){return 1/this.functions.cosh(a)};this.functions.csch=function(a){return 1/this.functions.sinh(a)};this.functions.asin=this.functions.asen=Math.asin;this.functions.acos=Math.acos;this.functions.atan=Math.atan;this.functions.min=Math.min;this.functions.max=Math.max;var c=this;this.functions._Trace_=function(a){console.log(a)};this.functions._Stop_Audios_=function(){c.evaluator.parent.stopAudios()};this.functions.esCorrecto=function(c,d){return a.esCorrecto(c,d)};this.functions.escorrecto=
function(c,d){return a.escorrecto(c,d)};window.parent!==window&&(this.functions["parent.set"]=function(a,c){window.parent.postMessage({type:"set",name:a,value:c},"*")},this.functions["parent.update"]=function(){window.parent.postMessage({type:"update"},"*")},this.functions["parent.get"]=function(a,c){window.parent.postMessage({type:"get",name:a,value:c},"*")},this.functions["parent.exec"]=function(a,c){window.parent.postMessage({type:"exec",name:a,value:c},"*")})};return a}(descartesJS||{}),descartesJS=
function(a){if(a.loadLib)return a;var d=Math.floor;a.Evaluator=function(d){this.parent=d;this.parser=new a.Parser(this);this.variables=this.parser.variables;this.functions=this.parser.functions;this.vectors=this.parser.vectors;this.matrices=this.parser.matrices};a.Evaluator.prototype.setVariable=function(a,d){this.variables[a]=d};a.Evaluator.prototype.getVariable=function(a){return this.variables[a]};a.Evaluator.prototype.setVector=function(a,f,c){f=0>f?0:d(f);this.vectors[a][f]=c};a.Evaluator.prototype.getVector=
function(a,f){f=0>f?0:d(f);return this.vectors[a][f]};a.Evaluator.prototype.setMatrix=function(a,f,c,k){f=0>f?0:d(f);c=0>c?0:d(c);this.matrices[a][f][c]=k};a.Evaluator.prototype.getMatrix=function(a,f,c){f=0>f?0:d(f);c=0>c?0:d(c);return this.matrices[a][f][c]};a.Evaluator.prototype.setFunction=function(a,d){this.functions[a]=d};a.Evaluator.prototype.getFunction=function(a){return this.functions[a]};a.Evaluator.prototype.evalExpression=function(a){return a?a.evaluate(this):0};return a}(descartesJS||
{}),descartesJS=function(a){if(a.loadLib)return a;var d=2,e=!1;a.RTFNode=function(a,c,d,f){this.evaluator=a;this.type="rtfNode";this.value=c;this.nodeType=d;this.style=f;this.styleString=f.toString();this.color=f.textColor;this.underline=f.textUnderline;this.overline=f.textOverline;this.parent=null;this.children=[];"textBlock"==this.nodeType?this.draw=this.drawTextBlock:"textLineBlock"==this.nodeType?this.draw=this.drawTextLineBlock:"formula"==this.nodeType?this.draw=this.drawFormula:"superIndex"==
this.nodeType?this.draw=this.drawSuperIndex:"subIndex"==this.nodeType?this.draw=this.drawSubIndex:"dynamicText"==this.nodeType?(this.draw=this.drawDynamicText,this.decimal_symbol=this.evaluator.parent.decimal_symbol):"fraction"==this.nodeType?this.draw=this.drawFraction:"numerator"==this.nodeType||"denominator"==this.nodeType?this.draw=this.drawNumDen:"radical"==this.nodeType?this.draw=this.drawRadical:"limit"==this.nodeType?this.draw=this.drawLimit:"integral"==this.nodeType?this.draw=this.drawIntegral:
"sum"==this.nodeType?this.draw=this.drawSum:"matrix"==this.nodeType?this.draw=this.drawMatrix:"defparts"==this.nodeType?this.draw=this.drawDefparts:"text"==this.nodeType||"newLine"==this.nodeType?this.draw=this.drawText:"mathSymbol"==this.nodeType?this.draw=this.drawMathSymbol:"index"==this.nodeType||"radicand"==this.nodeType||"from"==this.nodeType||"to"==this.nodeType||"what"==this.nodeType||"element"==this.nodeType?this.draw=this.drawGenericBlock:"componentNumCtrl"==this.nodeType?this.draw=this.drawComponentNumCtrl:
"componentSpace"==this.nodeType&&(this.draw=this.drawComponentSpace)};a.RTFNode.prototype.getRoot=function(){return null==this.parent?this:this.parent.getRoot()};a.RTFNode.prototype.addChild=function(a){a.parent=this;this.children.push(a)};var f=0,c=0,k=0;a.RTFNode.prototype.getTextMetrics=function(){if("textBlock"==this.nodeType){this.spaceWidth=a.getTextWidth(" ",this.styleString);for(var h=0,g=this.children.length;h<g;h++)this.children[h].getTextMetrics()}else if("textLineBlock"==this.nodeType)this.spaceWidth=
a.getTextWidth(" ",this.styleString),this.getBlockMetric();else if("newLine"==this.nodeType){this.spaceWidth=a.getTextWidth(" ",this.styleString);var l=a.getFontMetrics(this.styleString);this.baseline=l.baseline;this.descent=l.descent;this.ascent=l.ascent;this.width=l.width;this.height=l.height}else if("text"==this.nodeType||"dynamicText"==this.nodeType){this.spaceWidth=a.getTextWidth(" ",this.styleString);l=a.getFontMetrics(this.styleString);this.baseline=l.baseline;this.descent=l.descent;this.ascent=
l.ascent;var h=this.value,p;"string"!=typeof this.value&&(g=void 0==this.decimals?d:this.evaluator.evalExpression(this.decimals),p=void 0==this.fixed?e:this.fixed,h=this.evaluator.evalExpression(this.value,g,p),parseFloat(h)==h&&(h=parseFloat(h).toFixed(g),h=p?h:parseFloat(h),h=h.toString().replace(".",this.decimal_symbol)),h+=" ");this.width=a.getTextWidth(h,this.styleString);this.height=l.height}else if("formula"==this.nodeType)this.spaceWidth=a.getTextWidth(" ",this.styleString),this.getBlockMetric();
else if("superIndex"==this.nodeType)this.spaceWidth=a.getTextWidth(" ",this.styleString),g=f,l=c,g=k,h=a.getFontMetrics(this.styleString),this.getBlockMetric(),0>this.height&&(this.ascent=h.ascent,this.descent=h.descent,this.height=this.ascent+this.descent,this.width=1.5*this.spaceWidth),h=g/2-l+this.height,this.superIndexPos=h-this.ascent,this.ascent=h,this.descent=l,this.baseline=this.ascent,this.height=this.ascent+this.descent;else if("subIndex"==this.nodeType)this.spaceWidth=a.getTextWidth(" ",
this.styleString),g=f,l=c,h=a.getFontMetrics(this.styleString),this.getBlockMetric(),0>this.height&&(this.ascent=h.ascent,this.descent=h.descent,this.height=this.ascent+this.descent,this.width=1.5*this.spaceWidth),this.subIndexPos=l+1,this.ascent=g,this.descent=this.subIndexPos+this.descent,this.baseline=this.ascent,this.height=this.ascent+this.descent;else if("fraction"==this.nodeType){this.spaceWidth=a.getTextWidth(" ",this.styleString);l=c;g=k;p=this.children[0];var m=this.children[1],h=a.getFontMetrics(p.styleString);
p.getBlockMetric();m.getBlockMetric();0>p.height&&(p.height=h.height,p.width=this.spaceWidth);0>m.height&&(m.height=h.height,m.width=this.spaceWidth);this.height=p.height+m.height-1;this.ascent=p.height+g/2-l;this.descent=this.height-this.ascent;this.baseline=this.ascent;this.width=Math.max(p.width,m.width)+this.spaceWidth+8}else if("radical"==this.nodeType){this.spaceWidth=a.getTextWidth(" ",this.styleString);l=this.children[0].style.clone();if(1===this.children.length)this.children[1]=new a.RTFNode(this.evaluator,
"","radicand",l),this.children[1].addChild(this.children[0]),this.children[0]=new a.RTFNode(this.evaluator,"","index",l);else if("index"!==this.children[0].nodeType||"radicand"!==this.children[1].nodeType){p=new a.RTFNode(this.evaluator,"","radicand",l);h=0;for(g=this.children.length;h<g;h++)p.addChild(this.children[h]);this.children=[];this.children[0]=new a.RTFNode(this.evaluator,"","index",l);this.children[1]=p}l=this.children[0];h=this.children[1];l.getBlockMetric();h.getBlockMetric();this.ascent=
h.height/2<l.height?h.height/2+l.height+2-h.descent:h.ascent+4;this.descent=h.descent;this.baseline=this.ascent;this.height=this.ascent+this.descent;this.width=l.width+h.width+4*this.spaceWidth}else if("sum"==this.nodeType)this.spaceWidth=a.getTextWidth(" ",this.styleString),l=this.children[0],g=this.children[1],p=this.children[2],l.getBlockMetric(),g.getBlockMetric(),p.getBlockMetric(),-1==l.ascent&&(m=a.getFontMetrics(l.styleString),l.ascent=m.ascent,l.descent=m.descent,l.height=m.height),-1==g.ascent&&
(m=a.getFontMetrics(g.styleString),g.ascent=m.ascent,g.descent=m.descent,g.height=m.height),h=a.getFontMetrics(this.styleString),this.ascent=h.height+g.height>p.ascent?h.height-h.descent+g.height:p.ascent,this.descent=l.height>p.descent?l.height+h.descent:p.descent,this.baseline=this.ascent,this.height=this.ascent+this.descent,h=this.style.clone(),h.fontType="Times New Roman",h.Bold="bold",h=h.toString(),h=a.getTextWidth(String.fromCharCode(8721),h),this.width=Math.max(l.width,g.width,h)+Math.max(p.width,
this.spaceWidth)+this.spaceWidth;else if("integral"==this.nodeType)this.spaceWidth=a.getTextWidth(" ",this.styleString),l=this.children[0],g=this.children[1],p=this.children[2],l.getBlockMetric(),g.getBlockMetric(),p.getBlockMetric(),-1==l.ascent&&(m=a.getFontMetrics(l.styleString),l.ascent=m.ascent,l.descent=m.descent,l.height=m.height),-1==g.ascent&&(m=a.getFontMetrics(g.styleString),g.ascent=m.ascent,g.descent=m.descent,g.height=m.height),h=a.getFontMetrics(this.styleString),this.ascent=h.height+
g.height>p.ascent?h.height-h.descent+g.height:p.ascent,this.descent=l.height>p.descent?l.height+h.descent:p.descent,this.baseline=this.ascent,this.height=this.ascent+this.descent,h=this.style.clone(),h.fontSize*=1.5,h.fontType="Times New Roman",h.Bold="bold",h=h.toString(),h=a.getTextWidth(String.fromCharCode(8747),h),this.width=Math.max(l.width,g.width,h)+Math.max(p.width,this.spaceWidth)+2*this.spaceWidth;else if("limit"==this.nodeType)this.spaceWidth=a.getTextWidth(" ",this.styleString),l=this.children[0],
g=this.children[1],p=this.children[2],h=a.getFontMetrics(this.styleString),l.getBlockMetric(),g.getBlockMetric(),p.getBlockMetric(),-1==l.ascent&&(m=a.getFontMetrics(l.styleString),l.ascent=m.ascent,l.descent=m.descent,l.height=m.height),-1==g.ascent&&(m=a.getFontMetrics(g.styleString),g.ascent=m.ascent,g.descent=m.descent,g.height=m.height),-1==p.ascent&&(m=a.getFontMetrics(p.styleString),p.ascent=m.ascent,p.descent=m.descent,p.height=m.height),this.ascent=p.ascent,this.descent=Math.max(h.height,
p.descent),this.baseline=this.ascent,this.height=this.ascent+this.descent,h=a.getTextWidth(" "+String.fromCharCode(8594),this.styleString),0==l.width&&(l.width=this.spaceWidth),0==g.width&&(g.width=this.spaceWidth),0==p.width&&(p.width=this.spaceWidth),this.width=g.width+l.width+p.width+h+this.spaceWidth;else if("matrix"==this.nodeType){this.spaceWidth=a.getTextWidth(" ",this.styleString);h=a.getFontMetrics(this.styleString);l=c;p=h.ascent;for(var m=h.descent,q=h.height,n=this.spaceWidth,v,w,h=0,
g=this.children.length;h<g;h++)this.children[h].getBlockMetric(),v=this.children[h].height,w=this.children[h].width,q<v&&(q=v,p=this.children[h].ascent,m=this.children[h].descent),n<w&&(n=w);this.childWidth=n+2*this.spaceWidth;this.childHeight=q;this.childAscent=p;this.childDescent=m;this.height=this.rows*q;this.ascent=this.height/2+l;this.descent=this.height-this.ascent;this.width=this.columns*this.childWidth+this.spaceWidth}else if("defparts"==this.nodeType){this.spaceWidth=a.getTextWidth(" ",this.styleString);
h=a.getFontMetrics(this.styleString);l=c;p=h.ascent;m=h.descent;q=h.height;n=this.spaceWidth;h=0;for(g=this.children.length;h<g;h++)this.children[h].getBlockMetric(),v=this.children[h].height,w=this.children[h].width,q<v&&(q=v,p=this.children[h].ascent,m=this.children[h].descent),n<w&&(n=w);this.childWidth=n+2*this.spaceWidth;this.childHeight=q;this.childAscent=p;this.childDescent=m;this.height=this.parts*q;this.ascent=this.height/2+l;this.descent=this.height-this.ascent;this.width=n+this.spaceWidth/
2}else"mathSymbol"==this.nodeType?(this.spaceWidth=a.getTextWidth(" ",this.styleString),l=a.getFontMetrics(this.styleString),this.baseline=l.baseline,this.descent=l.descent,this.ascent=l.ascent,this.width=a.getTextWidth(this.value,this.styleString)+a.getTextWidth(" ",this.styleString),this.height=l.height):"componentNumCtrl"==this.nodeType?(this.spaceWidth=a.getTextWidth(" ",this.styleString),this.componentNumCtrl=this.evaluator.parent.getControlByCId(this.value),this.height=this.ascent=this.descent=
this.baseline=0,this.width=this.componentNumCtrl.w):"componentSpace"==this.nodeType?(this.spaceWidth=a.getTextWidth(" ",this.styleString),this.componentSpace=this.evaluator.parent.getSpaceByCId(this.value),this.height=this.ascent=this.descent=this.baseline=0,this.width=this.componentSpace.w):console.log("Element i=unknown",this.nodeType)};a.RTFNode.prototype.getBlockMetric=function(){this.width=0;for(var a=-1,d=-1,e,g=0,l=this.children.length;g<l;g++){e=this.children[g];e.getTextMetrics();childAscent=
e.ascent;childDescent=e.descent;this.width+=e.width;var q=childDescent;e=e.height;f=childAscent;c=q;k=e;d<childAscent&&(d=childAscent);a<childDescent&&(a=childDescent)}this.ascent=d;this.descent=a;this.baseline=this.ascent;this.height=this.ascent+this.descent};a.RTFNode.prototype.drawTextBlock=function(a,c,f,g,k,l,q){this.stableWidth||(this.getTextMetrics(),d=g,e=k);q=q?-this.children[0].ascent:0;for(var n=k=g=0,w=this.children.length;n<w;n++)0<n&&(k+=this.children[n-1].height),"center"==l?g=-this.children[n].width/
2:"right"==l&&(g=-this.children[n].width),this.children[n].draw(a,c+g,f+q+k)};a.RTFNode.prototype.drawTextLineBlock=function(c,d,f){for(var e=0,g=0,k=this.children.length;g<k;g++)0<g&&(e+=this.children[g-1].width,"formula"==this.children[g-1].nodeType&&(e+=2*a.getTextWidth(" ",this.children[g].styleString))),this.children[g].draw(c,d+e,f+this.baseline)};a.RTFNode.prototype.drawFormula=function(a,c,d){for(var f=0,e=0,g=this.children.length;e<g;e++)0<e&&(f+=this.children[e-1].width),this.children[e].draw(a,
c+this.spaceWidth+f,d)};a.RTFNode.prototype.drawText=function(a,c,d){null!=this.color&&(a.fillStyle=this.color);a.font=this.styleString;a.textAlign="start";a.textBaseline="alphabetic";a.fillText(this.value,c-1,d);if(this.underline){var f="bold"==this.style.textBold,e=f?1:0.5;a.lineWidth=f?2:1;null!=this.color&&(a.strokeStyle=this.color);a.beginPath();a.moveTo(c-1,parseInt(d+this.descent/2)+e);a.lineTo(c-1+this.width,parseInt(d+this.descent/2)+e);a.stroke()}this.overline&&(e=(f="bold"==this.style.textBold)?
2:1.5,a.lineWidth=f?2:1,null!=this.color&&(a.strokeStyle=this.color),a.beginPath(),a.moveTo(c-1,parseInt(d-this.ascent)+e),a.lineTo(c-1+this.width,parseInt(d-this.ascent)+e),a.stroke())};a.RTFNode.prototype.drawDynamicText=function(c,f,g){var k=Math.floor(0.5*this.spaceWidth),l=void 0==this.decimals?d:this.evaluator.evalExpression(this.decimals),q=void 0==this.fixed?e:this.fixed,n=this.evaluator.evalExpression(this.value,l,q);parseFloat(n)==n&&(n=q?parseFloat(n).toFixed(l):parseFloat(parseFloat(n).toFixed(l)),
n=(""+n).replace(".",this.decimal_symbol));null!=this.color&&(c.fillStyle=this.color);c.font=this.styleString;c.textAlign="start";c.textBaseline="alphabetic";this.width=a.getTextWidth(n,this.styleString);c.fillText(n,k+f,g);this.underline&&(q=(l="bold"==this.style.textBold)?1:0.5,c.lineWidth=l?2:1,null!=this.color&&(c.strokeStyle=this.color),c.beginPath(),c.moveTo(k+f-1,parseInt(g+this.descent/2)+q),c.lineTo(k+f-1+this.width,parseInt(g+this.descent/2)+q),c.stroke());this.overline&&(q=(l="bold"==this.style.textBold)?
2:1.5,c.lineWidth=l?2:1,null!=this.color&&(c.strokeStyle=this.color),c.beginPath(),c.moveTo(k+f-1,parseInt(g-this.ascent)+q),c.lineTo(k+f-1+this.width,parseInt(g-this.ascent)+q),c.stroke());this.width+=2*k};a.RTFNode.prototype.drawRadical=function(a,c,d){var f=Math.floor(this.spaceWidth);this.children[0].draw(a,c,Math.floor(d+this.children[1].descent-this.children[1].height/2-this.children[0].descent));this.children[1].draw(a,c+1.5*f+this.children[0].width,d);a.lineWidth=1;null!=this.color&&(a.strokeStyle=
this.color);a.beginPath();a.moveTo(c,Math.floor(d+this.children[1].descent-this.children[1].height/2));a.lineTo(c+this.children[0].width,Math.floor(d+this.children[1].descent-this.children[1].height/2));a.lineTo(c+this.children[0].width+0.5*f,d+this.children[1].descent);a.lineTo(c+this.children[0].width+1*f,d-this.children[1].ascent);a.lineTo(c+this.children[0].width+2*f+this.children[1].width,d-this.children[1].ascent);a.stroke()};a.RTFNode.prototype.drawFraction=function(a,c,d){this.children[0].draw(a,
c+(this.width-this.children[0].width)/2,d-this.ascent);this.children[1].draw(a,c+(this.width-this.children[1].width)/2,d-this.ascent+this.children[0].height-1);var f=Math.floor(0.5*this.spaceWidth);a.lineWidth=1;null!=this.color&&(a.strokeStyle=this.color);a.beginPath();a.moveTo(c+f,parseInt(d-this.ascent+this.children[0].height)+0.5);a.lineTo(c-f+this.width-1,parseInt(d-this.ascent+this.children[0].height)+0.5);a.stroke()};a.RTFNode.prototype.drawNumDen=function(a,c,d){for(var f=0,e=0,g=this.children.length;e<
g;e++)0<e&&(f+=this.children[e-1].width),this.children[e].draw(a,c+f,d+this.baseline)};a.RTFNode.prototype.drawSubIndex=function(a,c,d){for(var f=0,e=0,g=this.children.length;e<g;e++)0<e&&(f+=this.children[e-1].width),this.children[e].draw(a,c+f,d+this.subIndexPos)};a.RTFNode.prototype.drawSuperIndex=function(a,c,d){for(var f=0,e=0,g=this.children.length;e<g;e++)0<e&&(f+=this.children[e-1].width),this.children[e].draw(a,c+f,d-this.superIndexPos)};a.RTFNode.prototype.drawLimit=function(c,d,f){var e=
a.getFontMetrics(this.styleString),g=" "+String.fromCharCode(8594),k=a.getTextWidth(g,this.styleString);this.children[0].draw(c,d,f+e.descent+this.children[0].ascent);this.children[1].draw(c,d+this.children[0].width+k,f+e.descent+this.children[1].ascent);this.children[2].draw(c,d+k+this.children[0].width+this.children[1].width,f);null!=this.color&&(c.fillStyle=this.color);c.font=this.styleString;c.textAlign="start";c.textBaseline="alphabetic";c.fillText("l\u00edm",d+this.children[0].width,f);c.fillText(g,
d+this.children[0].width,f+e.descent+this.children[0].ascent)};a.RTFNode.prototype.drawIntegral=function(c,d,f){var e=this.style.clone();e.fontSize*=1.5;e.fontType="Times New Roman";e.Bold="bold";var e=e.toString(),g=a.getTextWidth(String.fromCharCode(8747),e),k=a.getFontMetrics(e),l=Math.max(this.children[0].width,this.children[1].width,Math.floor(1.5*g));this.children[0].draw(c,d+g,f+k.descent+this.children[0].ascent);this.children[1].draw(c,d+g+this.spaceWidth/2,f-this.ascent+this.children[1].ascent);
this.children[2].draw(c,d+l+g,f);null!=this.color&&(c.fillStyle=this.color);c.font=e;c.textAlign="start";c.textBaseline="alphabetic";c.fillText(String.fromCharCode(8747),d,f+k.descent/2)};a.RTFNode.prototype.drawSum=function(c,d,f){var e=this.style.clone();e.fontType="Times New Roman";e.Bold="bold";var e=e.toString(),g=a.getTextWidth(String.fromCharCode(8721),e),k=a.getFontMetrics(this.styleString),l=Math.max(this.children[0].width,this.children[1].width,g);this.children[0].draw(c,d+(l-this.children[0].width)/
2,f+k.descent+this.children[0].ascent);this.children[1].draw(c,d+(l-this.children[1].width)/2,f-k.ascent-this.children[1].descent);this.children[2].draw(c,d+l,f);null!=this.color&&(c.fillStyle=this.color);c.font=e;c.textAlign="start";c.textBaseline="alphabetic";c.fillText(String.fromCharCode(8721),d+Math.floor((l-g)/2),f-5)};a.RTFNode.prototype.drawMatrix=function(a,c,d){for(var f,e,g=0,k=this.children.length;g<k;g++)f=g%this.columns,e=Math.floor(g/this.columns),this.children[g].draw(a,2*this.spaceWidth+
c+f*this.childWidth,d-this.ascent+this.childAscent+e*this.childHeight);a.lineWidth=1;null!=this.color&&(a.strokeStyle=this.color);a.beginPath();a.moveTo(Math.floor(c+this.spaceWidth)+0.5,d-this.ascent+0.5);a.lineTo(Math.floor(c+this.spaceWidth/2)+0.5,d-this.ascent+0.5);a.lineTo(Math.floor(c+this.spaceWidth/2)+0.5,d+this.descent+0.5);a.lineTo(Math.floor(c+this.spaceWidth)+0.5,d+this.descent+0.5);a.moveTo(Math.floor(c+this.width-this.spaceWidth)-0.5,d-this.ascent+0.5);a.lineTo(Math.floor(c+this.width-
this.spaceWidth/2)-0.5,d-this.ascent+0.5);a.lineTo(Math.floor(c+this.width-this.spaceWidth/2)-0.5,d+this.descent+0.5);a.lineTo(Math.floor(c+this.width-this.spaceWidth)-0.5,d+this.descent+0.5);a.stroke()};a.RTFNode.prototype.drawDefparts=function(a,c,d){for(var f=0,e=this.children.length;f<e;f++)this.children[f].draw(a,c+this.spaceWidth/4,d-this.ascent+this.childAscent+f%this.parts*this.childHeight);a.lineWidth=1;null!=this.color&&(a.strokeStyle=this.color);a.beginPath();a.moveTo(Math.floor(c+this.spaceWidth/
3)+0.5,d-this.ascent+0.5);a.lineTo(Math.floor(c+this.spaceWidth/6)+0.5,d-this.ascent+0.5+(this.spaceWidth/3-this.spaceWidth/6));a.lineTo(Math.floor(c+this.spaceWidth/6)+0.5,d+this.descent-this.height/2-(this.spaceWidth/3-this.spaceWidth/6));a.lineTo(c+0.5,d+this.descent-this.height/2);a.lineTo(Math.floor(c+this.spaceWidth/6)+0.5,d+this.descent-this.height/2+(this.spaceWidth/3-this.spaceWidth/6));a.lineTo(Math.floor(c+this.spaceWidth/6)+0.5,d+this.descent+0.5-(this.spaceWidth/3-this.spaceWidth/6));
a.lineTo(Math.floor(c+this.spaceWidth/3)+0.5,d+this.descent+0.5);a.stroke()};a.RTFNode.prototype.drawMathSymbol=function(a,c,d){a.lineWidth=1;null!=this.color&&(a.strokeStyle=this.color,a.fillStyle=this.color);a.beginPath();"("==this.value?(a.font=this.styleString,a.textAlign="start",a.textBaseline="alphabetic",a.fillText("(",c,d)):")"==this.value?(a.font=this.styleString,a.textAlign="start",a.textBaseline="alphabetic",a.fillText(")",c+this.spaceWidth,d)):(a.font=this.styleString,a.textAlign="center",
a.textBaseline="alphabetic",a.fillText(this.value,c+this.width/2,d))};a.RTFNode.prototype.drawGenericBlock=function(a,c,d){for(var f=0,e=0,g=this.children.length;e<g;e++)0<e&&(f+=this.children[e-1].width),this.children[e].draw(a,c+f,d)};a.RTFNode.prototype.drawComponentNumCtrl=function(a,c,d){this.getTextMetrics();this.componentNumCtrl.expresion=this.evaluator.parser.parse("("+c+","+(d-this.parent.ascent)+","+this.componentNumCtrl.w+","+this.componentNumCtrl.h+")")};a.RTFNode.prototype.drawComponentSpace=
function(a,c,d){this.getTextMetrics();this.componentSpace.xExpr=this.evaluator.parser.parse(c+"");this.componentSpace.yExpr=this.evaluator.parser.parse(d-this.parent.ascent+"")};a.RTFNode.prototype.draw=function(a,c,d){console.log(">>> Dibujo desconocido ",this.nodeType);this.children[0].draw(a,c,d)};a.RTFNode.prototype.toHTML=function(){var a="";if("textLineBlock"===this.nodeType||"textBlock"===this.nodeType)for(var c=0,d=this.children.length;c<d;c++)a+=this.children[c].toHTML();else"text"===this.nodeType?
a="<span "+this.style.toCSS()+">"+this.value+"</span>":"newLine"===this.nodeType?a="<span "+this.style.toCSS()+">"+this.value+"<br /></span>":console.log(">>><<<",this);return a};var g=document.createElement("span");g.appendChild(document.createTextNode("\u00c1p"));var l=document.createElement("div");l.setAttribute("style","display: inline-block; width: 1px; height: 0px;");var n=document.createElement("div");n.setAttribute("style","margin: 0; padding: 0;");n.appendChild(g);n.appendChild(l);var q=
{};a.getFontMetrics=function(a){if(q[a])return q[a];g.setAttribute("style","font: "+a+"; margin: 0; padding: 0;");document.body.appendChild(n);var c={};l.style.verticalAlign="baseline";c.ascent=l.offsetTop-g.offsetTop;l.style.verticalAlign="bottom";c.height=l.offsetTop-g.offsetTop;c.descent=c.height-c.ascent;c.baseline=c.ascent;document.body.removeChild(n);return q[a]=c};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d=String.fromCharCode,e,f,c,k,g,l,n,q,h,r,u;a.RTFTokenizer=
function(){};a.RTFTokenizer.prototype.tokenize=function(a){if(a)a=a.replace(/\\rquote /g,"'").replace(/\\endash /g,"-").replace(/\n/g," ").replace(/\r/g,"").replace(/\\uc(\d+) /g,"").replace(/\\uc(\d+)/g,"");else return[];e=[];f=a.length;e=[];c="";g=k=0;n=a.charAt(0);q=!1;for(h="text";k<f;)l=n,n=a.charAt(k+1),q?"\\"===n||"{"===n||"}"===n||" "===n||";"===n?(q=!1,c+=l,(r=c.match(/^\'([0-9a-f]{2})/))?(u="","text"===h&&(u=e.pop().value),u+=d(parseInt(r[1],16))+c.substring(3),e.push({type:"text",value:u}),
h="text"):((r=c.match(/^u[0-9]+/))?(u="","text"===h&&(u=e.pop().value),u+=d(r[0].substring(1)),e.push({type:"text",value:u})):e.push({type:"controlWord",value:c}),h="controlWord"),c=""):c+=l:"\\"===l?(q=!0,""!==c&&(e.push({type:"text",value:c}),h="text"),c=""):"{"===l?(g++,""!==c&&(e.push({type:"text",value:c}),h="text"),c="",e.push({type:"openBlock",value:g}),h="openBlock"):"}"===l?(""!==c&&(e.push({type:"text",value:c}),h="text"),c="",e.push({type:"closeBlock",value:g}),h="closeBlock",g--):""===
c&&" "===l&&"controlWord"===h?h="text":c+=l,k++;""!==c&&(console.log(c),e.push({type:"text",value:c}));return e};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.RTFParser=function(c){this.evaluator=c;this.tokenizer=new a.RTFTokenizer};var d,e,f,c,k,g,l,n,q,h,r,u,p,m,s,t,v,w,B,E,C,y,D,z,G,A,K,J,H,M;a.RTFParser.prototype.parse=function(x){x=d=this.tokenizer.tokenize(x);for(var I=[],F=!1,P=!1,R=[],L=0,V=x.length;L<V;L++){"openBlock"==x[L].type&&R.push(x[L].value);"closeBlock"==
x[L].type&&(R.pop(),0>=R.length&&(F=!1));if("controlWord"==x[L].type&&("expr"==x[L].value||"decimals"==x[L].value))P=!0;"controlWord"==x[L].type&&"mjaformula"==x[L].value&&(F=!0);if("text"==x[L].type&&F&&!P){for(var T=0,N=x[L].value,Q="",O=0,S=N.length;O<S;O++)if("("==N.charAt(O)||")"==N.charAt(O)||"+"==N.charAt(O)||"-"==N.charAt(O)||"*"==N.charAt(O)||"="==N.charAt(O))Q=N.substring(T,O),""!=Q&&I.push({type:"text",value:Q}),I.push({type:N.charAt(O),value:N.charAt(O)}),T=O+1;Q=N.substring(T,O);""!=
Q&&I.push({type:"text",value:Q})}else I.push(x[L]),"text"==x[L].type&&P&&(P=!1)}d=I;e={};c=2;if("openBlock"==d[0].type&&"fonttbl"==d[1].value){for(f=d[0].value;"closeBlock"!=d[c].type&&d[c].value!=f;)e[d[c].value]=d[c+2].value.substring(0,d[c+2].value.length-1),c+=3;c++}k={};g=0;if("openBlock"==d[c].type&&"colortbl"==d[c+1].value){f=d[c++].value;for(c++;"closeBlock"!=d[c].type&&d[c].value!=f;)l=parseInt(d[c++].value.substring(3)).toString(16),n=parseInt(d[c++].value.substring(5)).toString(16),q=parseInt(d[c++].value.substring(4)).toString(16),
";"===d[c].value&&c++,k[g++]="#"+(2>l.length?"0"+l:l)+(2>n.length?"0"+n:n)+(2>q.length?"0"+q:q);c++}h=new a.RTFNode(this.evaluator,"","textBlock","",!1,"");r=new a.RTFNode(this.evaluator,"","textLineBlock","",!1,"");h.addChild(r);m=p=u=null;E=B=w=v=t=s=!1;C=[new a.FontStyle(20,"Arial","","",!1,!1,null)];y=C[0];D=!0;G=z=-1;A=[];M=H=J=K=!1;x=c;for(I=d.length;x<I;x++)if("controlWord"==d[x].type&&e[d[x].value])y.fontType=e[d[x].value];else if("controlWord"==d[x].type&&d[x].value.match(/^fs(\d+)/))y.fontSize=
parseInt(d[x].value.match(/^fs(\d+)/)[1]/2);else if("controlWord"==d[x].type&&"b"==d[x].value)y.textBold="bold";else if("controlWord"==d[x].type&&"b0"==d[x].value)y.textBold="";else if("controlWord"==d[x].type&&"i"==d[x].value)y.textItalic="italic";else if("controlWord"==d[x].type&&"i0"==d[x].value)y.textItalic="";else if("controlWord"==d[x].type&&"ul"==d[x].value)y.textUnderline=!0;else if("controlWord"==d[x].type&&"ulnone"==d[x].value)y.textUnderline=!1;else if("controlWord"==d[x].type&&"ol"==d[x].value)y.textOverline=
!0;else if("controlWord"==d[x].type&&"olnone"==d[x].value)y.textOverline=!1;else if("controlWord"==d[x].type&&d[x].value.match(/^cf(\d+)/))y.textColor=k[parseInt(d[x].value.substring(2))];else if("openBlock"==d[x].type)z=d[x].value,y=y.clone(),C.push(y),A.push(null);else if("closeBlock"==d[x].type)d[x].value==G&&(G=-1,s=!1,r=r.parent),C.pop(),y=C[C.length-1],A.pop();else if("controlWord"==d[x].type&&"par"==d[x].value){r.addChild(new a.RTFNode(this.evaluator,"","newLine",y.clone()));h=new a.RTFNode(this.evaluator,
"","textLineBlock",y.clone());if("textBlock"!=r.nodeType)for(r=r.parent;"textBlock"!=r.nodeType;)r=r.parent;r.addChild(h);r=h}else if("controlWord"==d[x].type&&"mjaformula"==d[x].value)K=!0,G=z,s=!0,h=new a.RTFNode(this.evaluator,"","formula",y.clone()),r.addChild(h),r=h,A[A.length-1]=h;else if("controlWord"==d[x].type&&("fraction"==d[x].value||"radicand"==d[x].value||"radical"==d[x].value||"what"==d[x].value||"sum"==d[x].value||"integral"==d[x].value||"limit"==d[x].value))F=A[A.length-2].style.clone(),
h=new a.RTFNode(this.evaluator,"",d[x].value,F),A[A.length-2].addChild(h),A[A.length-1]=h;else if("controlWord"==d[x].type&&"index"==d[x].value||"to"==d[x].value||"from"==d[x].value)F=A[A.length-2].style.clone(),F.fontSize=parseInt(F.fontSize-0.2*F.fontSize),8>F.fontSize&&(F.fontSize=8),h=new a.RTFNode(this.evaluator,"",d[x].value,F),A[A.length-2].addChild(h),A[A.length-1]=h;else if("controlWord"==d[x].type&&("num"==d[x].value||"den"==d[x].value))F=A[A.length-2].style.clone(),F.fontSize=Math.round(F.fontSize-
0.1*F.fontSize),8>F.fontSize&&(F.fontSize=8),"num"==d[x].value?h=new a.RTFNode(this.evaluator,"","numerator",F):"den"==d[x].value&&(h=new a.RTFNode(this.evaluator,"","denominator",F)),A[A.length-2].addChild(h),A[A.length-1]=h;else if("controlWord"==d[x].type&&("subix"==d[x].value||"supix"==d[x].value))F=A[A.length-2].style.clone(),F.fontSize=Math.floor(F.fontSize-F.fontSize/3),8>F.fontSize&&(F.fontSize=8),"subix"==d[x].value?h=new a.RTFNode(this.evaluator,"","subIndex",F):"supix"==d[x].value&&(h=
new a.RTFNode(this.evaluator,"","superIndex",F)),h.originalStyle=A[A.length-2].style.clone(),A[A.length-2].addChild(h),A[A.length-1]=h;else if("controlWord"==d[x].type&&("defparts"==d[x].value||"matrix"==d[x].value||"element"==d[x].value))F=A[A.length-2].style.clone(),h=new a.RTFNode(this.evaluator,"",d[x].value,F),A[A.length-2].addChild(h),A[A.length-1]=h,"defparts"==d[x].value?m=h:"matrix"==d[x].value&&(p=h);else if("controlWord"==d[x].type&&"parts"==d[x].value)E=!0;else if("text"==d[x].type&&E)m.parts=
parseInt(d[x].value),E=!1;else if("controlWord"==d[x].type&&"rows"==d[x].value)w=!0;else if("text"==d[x].type&&w)p.rows=parseInt(d[x].value),w=!1;else if("controlWord"==d[x].type&&"columns"==d[x].value)B=!0;else if("text"==d[x].type&&B)p.columns=parseInt(d[x].value),B=!1;else if("controlWord"==d[x].type&&"expr"==d[x].value)D=!1,t=!0;else if("controlWord"==d[x].type&&"decimals"==d[x].value)v=!0;else if("text"==d[x].type&&v)u.decimals=this.evaluator.parser.parse(parseInt(d[x].value)+""),v=!1;else if("controlWord"==
d[x].type&&"fixed1"==d[x].value)u.fixed=!0;else if("controlWord"==d[x].type&&"fixed0"==d[x].value)u.fixed=!1;else if(!("controlWord"==d[x].type&&"component"==d[x].value))if("controlWord"==d[x].type&&"NumCtrl"==d[x].value)J=!0;else if("controlWord"==d[x].type&&"Space"==d[x].value)H=!0;else if("controlWord"==d[x].type&&"hyperlink"==d[x].value)M=!0;else if("text"==d[x].type&&M){textContent=d[x].value.split("|")[0];F=y.clone();F.textUnderline=!0;F.textColor="blue";h=new a.RTFNode(this.evaluator,textContent,
"text",F);if("textLineBlock"!=r.nodeType)for(r=r.parent;"textLineBlock"!=r.nodeType;)r=r.parent;r.addChild(h);M=!1}else if("text"==d[x].type&&J)h=new a.RTFNode(this.evaluator,d[x].value,"componentNumCtrl",y.clone()),r.addChild(h),J=!1;else if("text"==d[x].type&&H)h=new a.RTFNode(this.evaluator,d[x].value,"componentSpace",y.clone()),r.addChild(h),H=!1;else if("text"==d[x].type&&t)F=A[A.length-2].style.clone(),textContent=this.evaluator.parser.parse(d[x].value),h=new a.RTFNode(this.evaluator,textContent,
"dynamicText",F),A[A.length-2].addChild(h),u=A[A.length-1]=h,t=!1;else if("text"==d[x].type&&!t&&!s){textContent=d[x].value;h=new a.RTFNode(this.evaluator,textContent,"text",y.clone());if("textLineBlock"!=r.nodeType)for(r=r.parent;"textLineBlock"!=r.nodeType;)r=r.parent;r.addChild(h)}else if("text"==d[x].type&&!t&&s)textContent=d[x].value,h=new a.RTFNode(this.evaluator,textContent,"text",A[A.length-1].style.clone()),A[A.length-1].addChild(h);else if("("==d[x].type||")"==d[x].type)F=A[A.length-1].style.clone(),
F.textItalic="",h=new a.RTFNode(this.evaluator,d[x].type,"mathSymbol",F),A[A.length-1].addChild(h);else if("+"==d[x].type||"-"==d[x].type||"*"==d[x].type||"="==d[x].type)h=new a.RTFNode(this.evaluator,d[x].type,"mathSymbol",A[A.length-1].style.clone()),A[A.length-1].addChild(h);if(null!=r){var U=r.getRoot();U.stableWidth=D;U.getTextMetrics();U.hasFormula=K}return U};a.FontStyle=function(a,c,d,f,e,g,k){this.fontSize=a;this.fontType=c;this.textItalic=d;this.textBold=f;this.textUnderline=e;this.textOverline=
g;this.textColor=k};a.FontStyle.prototype.toString=function(){return(this.textBold+" "+this.textItalic+" "+this.fontSize+"px "+this.fontType).trim()};a.FontStyle.prototype.toCSS=function(){var a="style='font: "+this.fontSize+"px "+this.fontType+"; ";this.textUnderline&&!this.textOverline&&(a+="text-decoration: underline; ");!this.textUnderline&&this.textOverline&&(a+="text-decoration: overline; ");this.textUnderline&&this.textOverline&&(a+="text-decoration: underline overline; ");this.textBold&&!this.textItalic&&
(a+="font-style: normal; font-weight: bold; ");!this.textBold&&this.textItalic&&(a+="font-style: italic; font-weight: normal; ");this.textBold&&this.textItalic&&(a+="font-style: italic; font-weight: bold; ");!this.textBold&&!this.textItalic&&(a+="font-style: normal; font-weight: normal; ");this.textColor&&(a+="color: "+this.textColor+"; ");return a+"'"};a.FontStyle.prototype.clone=function(){return new a.FontStyle(this.fontSize,this.fontType,this.textItalic,this.textBold,this.textUnderline,this.textOverline,
this.textColor)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d,e,f,c,k,g,l,n,q,h,r,u,p,m,s;a.Space=function(a,c){this.parent=a;e=this.evaluator=this.parent.evaluator;f=e.parser;this.values=c;this.type="R2";this.xExpr=f.parse("0");this.yExpr=f.parse("0");this.w=parseInt(a.container.width);this.h=parseInt(a.container.height);this.drawif=f.parse("1");this.fixed=2!=a.version?!1:!0;this.scale=48;this.Oy=this.Ox=0;this.image=new Image;this.image.onload=function(){this.ready=
1};this.imageSrc="";this.bg_display="topleft";this.background="descinst.com.mja.descartes.DescartesJS.class"===a.code||a.arquimedes?"#f0f8fa":"#ffffff";this.net=2!=a.version?"#c0c0c0":"";this.net10=2!=a.version?"#808080":"";this.axes=2!=a.version?"#808080":"";this.text="#ffafaf";this.numbers=!1;this.x_axis=2!=a.version?"":" ";this.y_axis=2!=a.version?"":" ";this.sensitive_to_mouse_movements=!1;this.cID="";this.mouse_y=this.mouse_x=0;this.ctrs=[];this.graphics=[];this.zIndex=a.zIndex;this.plecaHeight=
a.plecaHeight||0;this.displaceRegionNorth=a.displaceRegionNorth||0;this.displaceRegionWest=a.displaceRegionWest||0;for(var d in c)c.hasOwnProperty(d)&&(this[d]=c[d]);this.init()};a.Space.prototype.init=function(){d=this.parent;e=this.evaluator;c=this.id;this.displaceRegionNorth=d.displaceRegionNorth||0;this.displaceRegionWest=d.displaceRegionWest||0;l=parseInt(d.container.height);n=parseInt(d.container.width);e.setVariable(c+"._w",this.w);e.setVariable(c+"._h",this.h);this.x=e.evalExpression(this.xExpr)+
this.displaceRegionWest;this.y=e.evalExpression(this.yExpr)+this.plecaHeight+this.displaceRegionNorth;this.container&&(this.container.style.left=this.x+"px",this.container.style.top=this.y+"px");0<=this.y?(k=l-this.y,this.h>k&&(this.h=k)):(k=this.h+this.y,this.h=k>=l?l:k);0<=this.x?(g=n-this.x,this.w>g&&(this.w=g)):(g=this.w+this.x,this.w=g>=n?n:g);if(""!=this.imageSrc||!this.imageSrc.trim().toLowerCase().match(/vacio.gif$/))this.image=d.getImage(this.imageSrc);this.OxExpr&&(h=this.OxExpr,"%"===h[h.length-
1]?this.Ox=this.w*parseFloat(h)/100:(q=parseFloat(h),q!=h&&(q=0),this.Ox=q));this.OyExpr&&(r=this.OyExpr,"%"===r[r.length-1]?this.Oy=this.h*parseFloat(r)/100:(q=parseFloat(r),q!=r&&(q=0),this.Oy=q));2!==d.version?(e.setVariable(c+"._w",this.w),e.setVariable(c+"._h",this.h),e.setVariable(c+".escala",this.scale),e.setVariable(c+".Ox",this.Ox),e.setVariable(c+".Oy",this.Oy),e.setVariable(c+".mouse_x",0),e.setVariable(c+".mouse_y",0),e.setVariable(c+".mouse_pressed",0)):(q=e.getVariable("_w"),void 0===
q&&(q=this.w),e.setVariable("_w",q),q=e.getVariable("_h"),void 0===q&&(q=this.h),e.setVariable("_h",q),q=e.getVariable("escala"),void 0===q&&(q=this.scale),e.setVariable("escala",q),q=e.getVariable("Ox"),void 0===q&&(q=this.Ox),e.setVariable("Ox",q),q=e.getVariable("Oy"),void 0===q&&(q=this.Oy),e.setVariable("Oy",q),e.setVariable("mouse_x",0),e.setVariable("mouse_y",0),e.setVariable("mouse_pressed",0),""===this.x_axis&&""===this.y_axis&&(this.axes=""));this.w_2=this.w/2;this.h_2=this.h/2};a.Space.prototype.addCtr=
function(a){this.ctrs.push(a)};a.Space.prototype.addGraph=function(a){this.graphics.push(a)};a.Space.prototype.getRelativeX=function(a){return(a-this.w_2-this.Ox)/this.scale};a.Space.prototype.getRelativeY=function(a){return(-a+this.h_2+this.Oy)/this.scale};a.Space.prototype.getAbsoluteX=function(a){return a*this.scale+this.w_2+this.Ox};a.Space.prototype.getAbsoluteY=function(a){return-a*this.scale+this.h_2+this.Oy};a.Space.prototype.findOffset=function(){u=this.container;this.offsetTop=this.offsetLeft=
0;p=this.container.style.display;for(this.container.style.display="block";u;){m=null;u.getAttribute&&(m=u.getAttribute("class"));if(m&&("DescartesSpace2DContainer"===m||"DescartesSpace3DContainer"===m||"DescartesAppContainer"===m))this.offsetLeft+=u.offsetLeft||0,this.offsetTop+=u.offsetTop||0;u=u.parentNode}this.container.style.display=p};a.Space.prototype.getCursorPosition=function(c){s=a.getCursorPosition(c);return{x:s.x-this.offsetLeft,y:s.y-this.offsetTop}};return a}(descartesJS||{}),descartesJS=
function(a){var d,e;if(a.loadLib)return a;var f=Math.floor,c=Math.round,k=2*Math.PI,g,l,n,q,h,r,u,p,m,s,t,v,w,B,E,C,y,D,z,G,A,K;a.Space2D=function(c,d){a.Space.call(this,c,d);g=this;g.backgroundCanvas=document.createElement("canvas");g.backgroundCanvas.setAttribute("id",g.id+"_background");g.backgroundCanvas.setAttribute("width",g.w+"px");g.backgroundCanvas.setAttribute("height",g.h+"px");g.backgroundCtx=g.backgroundCanvas.getContext("2d");g.backgroundCtx.imageSmoothingEnabled=!1;g.backgroundCtx.mozImageSmoothingEnabled=
!1;g.backgroundCtx.webkitImageSmoothingEnabled=!1;g.canvas=document.createElement("canvas");g.canvas.setAttribute("id",g.id+"_canvas");g.canvas.setAttribute("width",g.w+"px");g.canvas.setAttribute("height",g.h+"px");g.canvas.setAttribute("class","DescartesSpace2DCanvas");g.canvas.setAttribute("style","z-index: "+g.zIndex+";");g.ctx=g.canvas.getContext("2d");g.ctx.imageSmoothingEnabled=!1;g.ctx.mozImageSmoothingEnabled=!1;g.ctx.webkitImageSmoothingEnabled=!1;g.graphicControlContainer=document.createElement("div");
g.graphicControlContainer.setAttribute("id",g.id+"_graphicControls");g.graphicControlContainer.setAttribute("style","position: absolute; left: 0px; top: 0px; z-index: "+g.zIndex+";");g.numericalControlContainer=document.createElement("div");g.numericalControlContainer.setAttribute("id",g.id+"_numericalControls");g.numericalControlContainer.setAttribute("style","position: absolute; left: 0px; top: 0px; z-index: "+g.zIndex+";");g.container=document.createElement("div");g.container.setAttribute("id",
g.id);g.container.setAttribute("class","DescartesSpace2DContainer");g.container.setAttribute("style","left: "+g.x+"px; top: "+g.y+"px; z-index: "+g.zIndex+";");g.parent.arquimedes&&"#f0f8fa"===a.getColor(g.evaluator,g.background)&&(g.container.style.border="1px solid #b8c4c8");g.container.appendChild(g.backgroundCanvas);g.container.appendChild(g.canvas);g.container.appendChild(g.graphicControlContainer);g.container.appendChild(g.numericalControlContainer);c.container.insertBefore(g.container,c.loader);
g.parent.images[g.id+".image"]=g.canvas;g.parent.images[g.id+".image"].ready=1;g.parent.images[g.id+".image"].complete=!0;g.evaluator.setVariable(g.id+".image",g.id+".image");g.parent.images[g.id+".back"]=g.backgroundCanvas;g.parent.images[g.id+".back"].ready=1;g.parent.images[g.id+".back"].complete=!0;g.evaluator.setVariable(g.id+".back",g.id+".back");"descartesJS_scenario"!==g.id&&g.registerMouseAndTouchEvents()};a.extend(a.Space2D,a.Space);a.Space2D.prototype.init=function(){g=this;g.uber.init.call(g);
g.canvas&&(g.backgroundCanvas.setAttribute("width",g.w+"px"),g.backgroundCanvas.setAttribute("height",g.h+"px"),g.canvas.setAttribute("width",g.w+"px"),g.canvas.setAttribute("height",g.h+"px"));g.container&&g.findOffset()};a.Space2D.prototype.update=function(a){g=this;l=g.evaluator;n=g.parent;g.drawIfValue=0<g.evaluator.evalExpression(g.drawif);h=2!=n.version?g.id+".Ox":"Ox";r=2!=n.version?g.id+".Oy":"Oy";u=2!=n.version?g.id+".escala":"escala";l.setVariable(g.id+"._w",g.w);l.setVariable(g.id+"._h",
g.h);p=g.x!=l.evalExpression(g.xExpr)+g.displaceRegionWest;m=g.y!=l.evalExpression(g.yExpr)+n.plecaHeight+g.displaceRegionNorth;g.spaceChange=a||p||m||g.drawBefore!=g.drawIfValue||g.Ox!=l.getVariable(h)||g.Oy!=l.getVariable(r)||g.scale!=l.getVariable(u);g.x=p?l.evalExpression(g.xExpr)+g.displaceRegionWest:g.x;g.y=m?l.evalExpression(g.yExpr)+n.plecaHeight+g.displaceRegionNorth:g.y;g.Ox=l.getVariable(h);g.Oy=l.getVariable(r);g.scale=l.getVariable(u);g.drawBefore=g.drawIfValue;1E-6>g.scale?(g.scale=
1E-6,l.setVariable(u,0)):1E6<g.scale&&(g.scale=1E6,l.setVariable(u,1E6));if(p||m)g.container.style.left=g.x+"px",g.container.style.top=g.y+"px",g.findOffset();if(g.drawIfValue){g.container.style.display="block";a=0;for(var c=g.graphics.length;a<c;a++)s=g.graphics[a],""!=s.trace&&(!g.spaceChange&&!g.click&&!s.background)&&s.drawTrace();g.drawBackground();g.draw()}else g.container.style.display="none"};a.Space2D.prototype.drawBackground=function(){if(this.spaceChange){l=this.evaluator;q=this.backgroundCtx;
q.clearRect(0,0,this.backgroundCanvas.width,this.backgroundCanvas.height);q.fillStyle=a.getColor(l,this.background);q.fillRect(0,0,this.backgroundCanvas.width,this.backgroundCanvas.height);this.image&&(""!=this.image.src&&this.image.ready&&this.image.complete)&&("topleft"===this.bg_display?q.drawImage(this.image,0,0):"stretch"===this.bg_display?q.drawImage(this.image,0,0,this.w,this.h):"patch"===this.bg_display?(q.fillStyle=q.createPattern(this.image,"repeat"),q.fillRect(0,0,this.canvas.width,this.canvas.height)):
"center"===this.bg_display&&q.drawImage(this.image,(this.w-this.image.width)/2,(this.h-this.image.height)/2));if(""!=this.net||2!=this.parent.version&&""!=this.net10||2===this.parent.version&&""!=this.net&&""!=this.net10||""!=this.axes||this.numbers&&""!=this.axes){for(var c=this.scale,d=0,e=0>this.w+this.h?0:this.w+this.h;c>e;)c/=10,d++;for(;c<e/10;)c*=10}q.lineWidth=1;""!=this.net&&(q.strokeStyle=a.getColor(l,this.net),this.drawMarks(q,c/10,-1));if(2!=this.parent.version&&""!=this.net10||2===this.parent.version&&
""!=this.net&&""!=this.net10)q.strokeStyle=a.getColor(l,this.net10),this.drawMarks(q,c,-1);if(""!=this.axes){q.strokeStyle=a.getColor(l,this.axes);q.beginPath();if(""!=this.x_axis||2!=this.parent.version)q.moveTo(0,f(this.h/2+this.Oy)+0.5),q.lineTo(this.w,f(this.h/2+this.Oy)+0.5);if(""!=this.y_axis||2!=this.parent.version)q.moveTo(f(this.w/2+this.Ox)+0.5,0),q.lineTo(f(this.w/2+this.Ox)+0.5,this.h);q.stroke();this.drawMarks(q,c,4);this.drawMarks(q,c/2,2);this.drawMarks(q,c/2/5,1)}if(""!=this.x_axis||
""!=this.y_axis)q.fillStyle=a.getColor(l,this.axes),q.font=a.convertFont("SansSerif,PLAIN,12"),q.textAlign="right",q.textBaseline="top",q.fillText(this.x_axis,f(this.w)-2,f(this.h/2+this.Oy)),q.fillText(this.y_axis,f(this.w/2+this.Ox)-2,0);this.numbers&&""!=this.axes&&(q.fillStyle=a.getColor(l,this.axes),q.font=a.convertFont("SansSerif,PLAIN,12"),q.textAlign="start",q.textBaseline="bottom",c>(this.w+this.h)/2?this.drawNumbers(q,c/5,c<=this.scale?d+1:d):c>(this.w+this.h)/4?this.drawNumbers(q,c/2,c<=
this.scale?d+1:d):this.drawNumbers(q,c,d));c=0;for(d=this.graphics.length;c<d;c++)s=this.graphics[c],s.background&&s.draw()}};a.Space2D.prototype.draw=function(){q=this.ctx;q.clearRect(0,0,this.canvas.width,this.canvas.height);for(var c=0,d=this.graphics.length;c<d;c++)s=this.graphics[c],s.background||s.draw();c=0;for(d=this.ctrs.length;c<d;c++)t=this.ctrs[c],"graphic"===t.type&&t.draw();if(""!=this.text&&this.click&&"LEFT"===this.whichButton){q.fillStyle=a.getColor(this.evaluator,this.text);q.strokeStyle=
q.fillStyle;q.lineWidth=1;q.font=a.convertFont("Monospaced,PLAIN,12");q.textAlign="center";q.textBaseline="alphabetic";var c=1>=this.scale?this.mouse_x.toFixed(0):this.mouse_x.toFixed(this.scale.toString().length),d=1>=this.scale?this.mouse_y.toFixed(0):this.mouse_y.toFixed(this.scale.toString().length),c="("+c+","+d+")",d=q.measureText(c).width,e=this.getAbsoluteX(this.mouse_x),g=this.getAbsoluteY(this.mouse_y),h=f(e),l=f(g-10);h+d/2>this.w?h=this.w-d/2:0>h-d/2&&(h=d/2);l+1>this.h?l=this.h:0>l-14&&
(l=15);q.fillText(c,h,l);q.beginPath();q.arc(e,g,2.5,0,k,!0);q.stroke()}};a.Space2D.prototype.drawMarks=function(a,d,e){v=this.w;w=this.h;D=0;z=v;G=0;A=w;C=f(v/2+this.Ox);y=f(w/2+this.Oy);0<=e&&(D=C-e,z=C+e,G=y-e,A=y+e);a.beginPath();for(e=-c(C/d);(B=C+c(e*d))<v;e++)a.moveTo(B+0.5,G+0.5),a.lineTo(B+0.5,A+0.5);for(e=-c(y/d);(E=y+c(e*d))<w;e++)a.moveTo(D+0.5,E+0.5),a.lineTo(z+0.5,E+0.5);a.stroke()};a.Space2D.prototype.drawNumbers=function(a,d,e){v=this.w;w=this.h;C=f(v/2+this.Ox);y=f(w/2+this.Oy);for(e=
-c(C/d);(B=C+c(e*d))<v;e++)a.fillText(parseFloat((e*d/this.scale).toFixed(4)),B+1,y-2);for(e=-c(y/d);(E=y+c(e*d))<w;e++)0!==parseFloat(-e*d/this.scale)&&a.fillText(parseFloat((-e*d/this.scale).toFixed(4)),C+5,E+5)};a.Space2D.prototype.registerMouseAndTouchEvents=function(){function c(a){n.click=1;n.evaluator.setVariable(n.id+".mouse_pressed",1);n.parent.deactivateGraphiControls();m(a);window.addEventListener("touchmove",p,!1);window.addEventListener("touchend",g,!1);a.preventDefault()}function g(a){n.click=
0;n.evaluator.setVariable(n.id+".mouse_pressed",0);window.removeEventListener("touchmove",p,!1);window.removeEventListener("touchend",g,!1);a.preventDefault();n.parent.update()}function k(a){n.click=1;n.evaluator.setVariable(n.id+".mouse_pressed",1);n.parent.deactivateGraphiControls();n.whichButton=null===a.which?2>a.button?"LEFT":4===a.button?"MIDDLE":"RIGHT":2>a.which?"LEFT":2===a.which?"MIDDLE":"RIGHT";"RIGHT"===n.whichButton&&(window.addEventListener("mouseup",l,!1),n.fixed||(n.clickPosForZoom=
n.getCursorPosition(a).y,n.tempScale=n.scale,window.addEventListener("mousemove",q,!1)));"LEFT"===n.whichButton&&(n.evaluator.setVariable(n.id+".mouse_pressed",1),m(a),window.addEventListener("mousemove",p,!1),window.addEventListener("mouseup",l,!1));a.preventDefault()}function l(a){n.click=0;n.evaluator.setVariable(n.id+".mouse_pressed",0);a.preventDefault();"RIGHT"===n.whichButton&&window.removeEventListener("mousemove",q,!1);n.sensitive_to_mouse_movements||window.removeEventListener("mousemove",
p,!1);window.removeEventListener("mouseup",l,!1);n.parent.update()}function m(a){n.posAnte=n.getCursorPosition(a);n.mouse_x=n.getRelativeX(n.posAnte.x);n.mouse_y=n.getRelativeY(n.posAnte.y);n.evaluator.setVariable(n.id+".mouse_x",n.mouse_x);n.evaluator.setVariable(n.id+".mouse_y",n.mouse_y);n.parent.update()}function q(a){n.clickPosForZoomNew=n.getCursorPosition(a).y;n.evaluator.setVariable(2!==n.parent.version?n.id+".escala":"escala",n.tempScale+n.tempScale/45*((n.clickPosForZoom-n.clickPosForZoomNew)/
10));n.parent.update();a.preventDefault()}function p(a){n.fixed||(n.posNext=n.getCursorPosition(a),d=f(n.posAnte.x-n.posNext.x),e=f(n.posAnte.y-n.posNext.y),h=2!=n.parent.version?n.id+".Ox":"Ox",r=2!=n.parent.version?n.id+".Oy":"Oy",n.evaluator.setVariable(h,n.Ox-d),n.evaluator.setVariable(r,n.Oy-e),n.posAnte.x-=d,n.posAnte.y-=e);n.click&&m(a);a.preventDefault()}var n=this;K=a.hasTouchSupport;n.canvas.oncontextmenu=function(){return!1};K&&(this.sensitive_to_mouse_movements&&this.canvas.addEventListener("touchmove",
m,!1),this.canvas.addEventListener("touchstart",c,!1));K||(this.sensitive_to_mouse_movements&&this.canvas.addEventListener("mousemove",m,!1),this.canvas.addEventListener("mousedown",k,!1))};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d=Math.floor,e=Math.cos,f=Math.sin,c,k,g;a.Space3D=function(d,g){a.Space.call(this,d,g);c=this;c.backgroundCanvas=document.createElement("canvas");c.backgroundCanvas.setAttribute("id",c.id+"_background");c.backgroundCanvas.setAttribute("width",
c.w+"px");c.backgroundCanvas.setAttribute("height",c.h+"px");c.backgroundCtx=c.backgroundCanvas.getContext("2d");c.backgroundCtx.imageSmoothingEnabled=!1;c.backgroundCtx.mozImageSmoothingEnabled=!1;c.backgroundCtx.webkitImageSmoothingEnabled=!1;c.canvas=document.createElement("canvas");c.canvas.setAttribute("id",c.id+"_canvas");c.canvas.setAttribute("width",c.w+"px");c.canvas.setAttribute("height",c.h+"px");c.canvas.setAttribute("class","DescartesSpace3DCanvas");c.canvas.setAttribute("style","z-index: "+
c.zIndex+";");c.ctx=c.canvas.getContext("2d");c.ctx.imageSmoothingEnabled=!1;c.ctx.mozImageSmoothingEnabled=!1;c.ctx.webkitImageSmoothingEnabled=!1;c.graphicControlContainer=document.createElement("div");c.graphicControlContainer.setAttribute("id",c.id+"_graphicControls");c.graphicControlContainer.setAttribute("style","position: absolute; left: 0px; top: 0px; z-index: "+c.zIndex+";");c.numericalControlContainer=document.createElement("div");c.numericalControlContainer.setAttribute("id",c.id+"_numericalControls");
c.numericalControlContainer.setAttribute("style","position: absolute; left: 0px; top: 0px; z-index: "+c.zIndex+";");c.container=document.createElement("div");c.container.setAttribute("id",c.id);c.container.setAttribute("class","DescartesSpace3DContainer");c.container.setAttribute("style","left: "+c.x+"px; top: "+c.y+"px; z-index: "+c.zIndex+";");c.container.appendChild(c.backgroundCanvas);c.container.appendChild(c.canvas);c.container.appendChild(c.graphicControlContainer);c.container.appendChild(c.numericalControlContainer);
d.container.insertBefore(c.container,d.loader);c.eye=new a.Vector3D(0,0,0);c.center=new a.Vector3D(0,0,0);c.yUpEye=new a.Vector3D(0,0,1);c.distanceEyeCenter=10;c.alpha=Math.PI/4;c.beta=-Math.PI/5;c.lookAtMatrix=new a.Matrix4x4;c.perspectiveMatrix=new a.Matrix4x4;c.perspective=(new a.Matrix4x4).perspective(45,c.w/c.h,0.01,1E3);cosAlpha=e(-c.alpha);sinAlpha=f(-c.alpha);cosBeta=e(c.beta);sinBeta=f(c.beta);c.eye.set(c.distanceEyeCenter*cosAlpha*cosBeta,c.distanceEyeCenter*sinAlpha*cosBeta,-c.distanceEyeCenter*
sinBeta);c.yUpEye=c.yUpEye.set(e(-c.alpha-Math.PI/2),f(-c.alpha-Math.PI/2),0).crossProduct(c.eye).normalize();c.lookAtMatrix=c.lookAtMatrix.setIdentity().lookAt(c.eye,c.center,c.yUpEye);c.perspectiveMatrix=c.perspective.multiply(c.lookAtMatrix);c.registerMouseAndTouchEvents();c.update()};a.extend(a.Space3D,a.Space);a.Space3D.prototype.init=function(){c=this;c.uber.init.call(c);c.canvas&&(c.backgroundCanvas.setAttribute("width",c.w+"px"),c.backgroundCanvas.setAttribute("height",c.h+"px"),c.canvas.setAttribute("width",
c.w+"px"),c.canvas.setAttribute("height",c.h+"px"));c.container&&c.findOffset();c.w_2=c.w/2;c.h_2=c.h/2};a.Space3D.prototype.update=function(c){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);this.ctx.fillStyle=a.getColor(this.evaluator,this.background);this.ctx.fillRect(0,0,this.backgroundCanvas.width,this.backgroundCanvas.height);if(!this.click){this.scene=new a.Scene(this);c=0;for(var d=this.graphics.length;c<d;c++)k=this.graphics[c],k.update()}this.scene.draw()};a.Space3D.prototype.transformCoordinateX=
function(a){return d((a+1)*this.w_2+this.Ox)};a.Space3D.prototype.transformCoordinateY=function(a){return d((1-a)*this.h_2+this.Oy)};a.Space3D.prototype.registerMouseAndTouchEvents=function(){var c,d;function k(a){t.click=1;t.evaluator.setVariable(t.id+".mouse_pressed",1);p(a);window.addEventListener("touchmove",s,!1);window.addEventListener("touchend",h,!1);(!t.fixed||t.sensitive_to_mouse_movements)&&a.preventDefault()}function h(a){t.click=0;t.evaluator.setVariable(t.id+".mouse_pressed",0);window.removeEventListener("touchmove",
s,!1);window.removeEventListener("touchend",h,!1);a.preventDefault()}function r(a){t.click=1;t.whichButton=null==a.which?2>a.button?"LEFT":4==a.button?"MIDDLE":"RIGHT":2>a.which?"LEFT":2==a.which?"MIDDLE":"RIGHT";"LEFT"==t.whichButton&&(t.evaluator.setVariable(t.id+".mouse_pressed",1),t.posAnte=t.getCursorPosition(a),c=t.getRelativeX(t.posAnte.x),d=t.getRelativeY(t.posAnte.y),p(a),window.addEventListener("mousemove",s,!1),window.addEventListener("mouseup",u,!1));a.preventDefault()}function u(a){t.click=
0;t.evaluator.setVariable(t.id+".mouse_pressed",0);a.preventDefault();"RIGHT"==t.whichButton&&window.removeEventListener("mousemove",m,!1);window.removeEventListener("mouseup",u,!1)}function p(a){t.posAnte=t.getCursorPosition(a);t.mouse_x=t.getRelativeX(t.posAnte.x);t.mouse_y=t.getRelativeY(t.posAnte.y);t.evaluator.setVariable(t.id+".mouse_x",t.mouse_x);t.evaluator.setVariable(t.id+".mouse_y",t.mouse_y);t.parent.update()}function m(a){}function s(a){t.click&&(p(a),t.alpha+=t.mouse_x-c,t.beta+=t.mouse_y-
d,v=e(-t.alpha),w=f(-t.alpha),B=e(t.beta),E=f(t.beta),t.eye.set(t.distanceEyeCenter*v*B,t.distanceEyeCenter*w*B,-t.distanceEyeCenter*E),t.yUpEye=t.yUpEye.set(e(-t.alpha-Math.PI/2),f(-t.alpha-Math.PI/2),0).crossProduct(t.eye).normalize(),t.lookAtMatrix=t.lookAtMatrix.setIdentity().lookAt(t.eye,t.center,t.yUpEye),t.perspectiveMatrix=t.perspective.multiply(t.lookAtMatrix),c=t.mouse_x,d=t.mouse_y)}var t=this;g=a.hasTouchSupport;d=c=0;this.canvas.oncontextmenu=function(){return!1};g&&(this.sensitive_to_mouse_movements&&
this.canvas.addEventListener("touchmove",p,!1),this.canvas.addEventListener("touchstart",k,!1));g||(this.sensitive_to_mouse_movements&&this.canvas.addEventListener("mousemove",p,!1),this.canvas.addEventListener("mousedown",r,!1));var v,w,B,E};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d;a.SpaceAP=function(e,f){a.Space.call(this,e,f);this.exportarVars=this.importarVars=null;d=e.evaluator;this.file.match(/^\[/)&&this.file.match(/\]$/)?this.file=d.parser.parse(this.file.substring(1,
this.file.length-1)):this.file.match(/^\'/)&&this.file.match(/\'$/)?this.file=d.parser.parse(this.file):this.file=d.parser.parse("'"+this.file+"'");this.oldFile=d.evalExpression(this.file);this.initFile()};a.extend(a.SpaceAP,a.Space);a.SpaceAP.prototype.initFile=function(){this.firstUpdate=!0;var d;if(this.oldFile){var f=document.getElementById(this.oldFile);d=f&&"descartes/spaceApFile"==f.type?f.text:a.openExternalFile(this.oldFile);null!=d&&(d=d.split("\n"))}if(d&&d.toString().match(/<applet/gi)){for(var f=
"",c=!1,k=0,g=d.length;k<g&&!(d[k].match("<applet")&&(c=!0),c&&(f+=d[k]),d[k].match("</applet"));k++);k=document.createElement("div");k.innerHTML=f;k.firstChild.setAttribute("width",this.w);k.firstChild.setAttribute("height",this.h);f=this.descApp?this.descApp.container:null;this.descApp=new a.DescartesApp(k.firstChild);this.descApp.container.setAttribute("class","DescartesAppContainer");this.descApp.container.setAttribute("style","position: absolute; overflow: hidden; background-color: "+this.background+
"; width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";");f?this.parent.container.replaceChild(this.descApp.container,f):this.parent.container.insertBefore(this.descApp.container,this.parent.loader);f=this.descApp.spaces;k=0;for(g=f.length;k<g;k++)f[k].findOffset();this.descApp.container.style.display=0<this.evaluator.evalExpression(this.drawif)?"block":"none";var l=this;this.descApp.update=function(){this.updateAuxiliaries();this.updateEvents();
this.updateControls();this.updateSpaces();l.exportar()}}else f=this.descApp?this.descApp.container:null,this.descApp={},this.descApp.container=document.createElement("div"),this.descApp.container.setAttribute("class","DescartesAppContainer"),k="position: absolute; overflow: hidden; background-color: "+this.background+"; width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";",this.image&&("topleft"==this.bg_display?k+="background-image: url("+this.imageSrc+
"); background-repeat:no-repeat;":"stretch"==this.bg_display?k+="background-image: url("+this.imageSrc+"); background-repeat:no-repeat; background-size: 100% 100%;":"patch"==this.bg_display?k+="background-image: url("+this.imageSrc+");":"center"==this.bg_display&&(k+="background-image: url("+this.imageSrc+"); background-repeat:no-repeat; background-position: center center;")),this.descApp.container.setAttribute("style",k),f?this.parent.container.replaceChild(this.descApp.container,f):this.parent.container.insertBefore(this.descApp.container,
this.parent.loader),this.descApp.container.style.display=0<this.evaluator.evalExpression(this.drawif)?"block":"none"};a.SpaceAP.prototype.update=function(){var a=this.evaluator.evalExpression(this.file);if(this.oldFile!=a)this.oldFile=a,this.initFile();else{var a=this.x!=this.evaluator.evalExpression(this.xExpr),d=this.y!=this.evaluator.evalExpression(this.yExpr)+this.plecaHeight;this.x=a?this.evaluator.evalExpression(this.xExpr):this.x;this.y=d?this.evaluator.evalExpression(this.yExpr)+this.plecaHeight:
this.y;a&&(this.descApp.container.style.left=this.x+"px");d&&(this.descApp.container.style.top=this.y+"px");if(a||d)for(var a=this.descApp.spaces,d=0,c=a.length;d<c;d++)a[d].findOffset();this.descApp.container.style.display=0<this.evaluator.evalExpression(this.drawif)?"block":"none";if(this.firstUpdate&&(this.firstUpdate=!1,null==this.importarVars)){this.importarVars=[];for(var k in this.evaluator.variables)this.evaluator.variables.hasOwnProperty(k)&&k.match(/^public./)&&this.importarVars.push({varName:k,
value:this.evaluator.getVariable(k)})}this.importar()}};a.SpaceAP.prototype.importar=function(){for(var a,d=!1,c=0,k=this.importarVars.length;c<k;c++)a=this.evaluator.getVariable(this.importarVars[c].varName),a!=this.importarVars[c].value&&(this.importarVars[c].value=a,this.descApp.evaluator.setVariable(this.importarVars[c].varName,this.importarVars[c].value),d=!0);d&&this.descApp.update()};a.SpaceAP.prototype.exportar=function(){};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;
var d,e,f,c;a.SpaceHTML_IFrame=function(c,d){a.Space.call(this,c,d);var f=this.parent.evaluator;window.navigator.userAgent.toLowerCase().match(/firefox/);this.file=this.file?this.file.trim():"";this.file.match(/^\[/)&&this.file.match(/\]$/)?this.file=f.parser.parse(this.file.substring(1,this.file.length-1)):this.file.match(/^\'/)&&this.file.match(/\'$/)?this.file=f.parser.parse(this.file):this.file=f.parser.parse("'"+this.file+"'");this.oldFile=f.evalExpression(this.file);this.MyIFrame=document.createElement("iframe");
this.MyIFrame.setAttribute("src",this.oldFile);this.MyIFrame.setAttribute("id",this.id);this.MyIFrame.setAttribute("marginheight",0);this.MyIFrame.setAttribute("marginwidth",0);this.MyIFrame.setAttribute("frameborder",0);this.MyIFrame.setAttribute("scrolling","auto");this.MyIFrame.setAttribute("style","position: absolute; width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px;");this.parent.container.insertBefore(this.MyIFrame,this.parent.loader);var e=this;this.MyIFrame.onload=
function(a){var c=this;e.evaluator.setFunction(e.id+".set",function(a,d){c.contentWindow.postMessage({type:"set",name:a,value:d},"*")});e.evaluator.setFunction(e.id+".update",function(a,d){c.contentWindow.postMessage({type:"update"},"*")});e.evaluator.setFunction(e.id+".exec",function(a,d){c.contentWindow.postMessage({type:"exec",name:a,value:d},"*")})};this.update=this.iframeUpdate;this.evaluator.setVariable(this.id+"._scroll",0)};a.extend(a.SpaceHTML_IFrame,a.Space);a.SpaceHTML_IFrame.prototype.init=
function(){self=this;self.uber.init.call(self);self.MyIFrame&&(self.MyIFrame.style.width=self.w+"px",self.MyIFrame.style.height=self.h+"px",self.MyIFrame.style.left=self.x+"px",self.MyIFrame.style.top=self.y+"px")};a.SpaceHTML_IFrame.prototype.iframeUpdate=function(a){d=this.evaluator;this.drawIfValue=0<d.evalExpression(this.drawif);if(this.drawif){this.MyIFrame.style.display=this.drawIfValue?"block":"none";a&&(this.y=this.x=Math.Infinity);e=this.x!==d.evalExpression(this.xExpr)+this.displaceRegionWest;
f=this.y!==d.evalExpression(this.yExpr)+this.parent.plecaHeight+this.displaceRegionNorth;this.x=e?d.evalExpression(this.xExpr)+this.displaceRegionWest:this.x;this.y=f?d.evalExpression(this.yExpr)+this.parent.plecaHeight+this.displaceRegionNorth:this.y;if(e||f)this.MyIFrame.style.left=this.x+"px",this.MyIFrame.style.top=this.y+"px";c=d.evalExpression(this.file);c!==this.oldFile&&(this.oldFile=c,this.MyIFrame.setAttribute("src",c));this.scrollVar=d.getVariable(this.id+"._scroll");1==this.scrollVar?
(this.MyIFrame.setAttribute("scrolling","yes"),this.MyIFrame.style.overflow=""):-1==this.scrollVar?(this.MyIFrame.setAttribute("scrolling","no"),this.MyIFrame.style.overflow="hidden"):(this.MyIFrame.setAttribute("scrolling","auto"),this.MyIFrame.style.overflow="")}};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d;a.DescartesLoader=function(a){this.children=a.children;this.lessonParser=a.lessonParser;this.images=a.images;this.images.length=a.images.length;this.audios=
a.audios;this.audios.length=a.audios.length;this.arquimedes=a.arquimedes;this.descartesApp=a;var c=a.image_loader?a.image_loader:g(a.loader.width,a.loader.height);this.imageLoader=document.createElement("div");this.imageLoader.width=a.width;this.imageLoader.height=a.height;this.imageLoader.setAttribute("class","DescartesLoaderImage");this.imageLoader.setAttribute("style","background-image: url("+c+"); width: "+a.width+"px; height: "+a.height+"px;");a.loader.appendChild(this.imageLoader);this.loaderBar=
document.createElement("canvas");this.loaderBar.width=a.width;this.loaderBar.height=a.height;this.loaderBar.setAttribute("class","DescartesLoaderBar");this.loaderBar.setAttribute("style","width: "+a.width+"px; height:"+a.height+"px;");this.loaderBar.ctx=this.loaderBar.getContext("2d");a.loader.appendChild(this.loaderBar);this.barWidth=Math.floor(80);this.barHeight=Math.floor(a.loader.height/70);var d=this;this.timer=setInterval(function(){d.drawLoaderBar(d.loaderBar.ctx,a.width,a.height)},10);a.firstRun=
!1;this.initPreloader()};a.DescartesLoader.prototype.initPreloader=function(){var c=this.children,d=this.images,f=this.audios,e=/[\w-//]*(\.png|\.jpg|\.gif|\.svg|\.PNG|\.JPG|\.GIF|\.SVG)/g,g=/[\w-//]*(\.ogg|\.oga|\.mp3|\.wav|\.OGG|\.OGA\.MP3|\.WAV)/g,k=/vector|array|bektore|vecteur|matriz/g,p=/archivo|file|fitxer|artxibo|fichier|arquivo/g;this.arquimedes&&(d["lib/DescartesCCLicense.png"]=a.getCreativeCommonsLicenseImage(),d["lib/DescartesCCLicense.png"].addEventListener("load",function(){this.ready=
1}),d["lib/DescartesCCLicense.png"].addEventListener("error",function(){this.errorload=1}));var m,s,t,v,w,B;v=0;for(w=c.length;v<w;v++){if(m=c[v].value.match(e)){t=0;for(B=m.length;t<B;t++)s=m[t],!s.toLowerCase().match(/vacio.gif$/)&&""!=s.substring(0,s.length-4)&&(d[s]=new Image,d[s].addEventListener("load",function(){this.ready=1}),d[s].addEventListener("error",function(){this.errorload=1}),d[s].src=s)}if(m=c[v].value.match(g)){t=0;for(s=m.length;t<s;t++)this.initAudio(m[t])}(t=c[v].value.match(k)&&
c[v].value.match(p))&&this.lessonParser.parseAuxiliar(c[v].value)}for(var E in d)d.hasOwnProperty(E)&&this.images.length++;for(E in f)f.hasOwnProperty(E)&&this.audios.length++;var C=this,y=this.images.length+this.audios.length,D=function(){C.readys=0;for(var a in d)d.hasOwnProperty(a)&&(d[a].ready||d[a].errorload)&&C.readys++;for(a in C.audios)f.hasOwnProperty(a)&&(f[a].ready||f[a].errorload)&&C.readys++;C.readys!=y?setTimeout(D,30):(clearTimeout(C.timer),C.descartesApp.initBuildApp())};D()};a.DescartesLoader.prototype.initAudio=
function(a){var c=this.audios,d=a.lastIndexOf("."),d=-1===d?a.lenght:d,d=a.substring(0,d),f=new Audio;f.setAttribute("preload","auto");var e=function(){this.ready=1};f.addEventListener("canplaythrough",e);f.addEventListener("load",e);f.addEventListener("error",function(){console.log("El archivo '"+a+"' no puede ser reproducido");this.errorload=1});f.canPlayType("audio/mpeg")&&(e=document.createElement("source"),e.setAttribute("src",d+".mp3"),e.setAttribute("type","audio/mpeg"),f.appendChild(e));f.canPlayType("audio/ogg")&&
(e=document.createElement("source"),e.setAttribute("src",d+".ogg"),e.setAttribute("type","audio/ogg"),f.appendChild(e),e=document.createElement("source"),e.setAttribute("src",d+".oga"),e.setAttribute("type","audio/ogg"),f.appendChild(e));f.canPlayType("audio/wav")&&(e=document.createElement("source"),e.setAttribute("src",d+".wav"),e.setAttribute("type","audio/wav"),f.appendChild(e));f.load();f.play();f.pause();c[a]=f};var e,f,c,k;a.DescartesLoader.prototype.drawLoaderBar=function(a,g,q){e=this.barWidth;
f=this.barHeight;c=this.images.length+this.audios.length;k=2*(e-2)/c;a.translate(g/2,(q-65*d)/2+90*d);a.scale(d,d);a.strokeRect(-e,-f,2*e,f);a.fillStyle="gray";a.fillRect(-e+2,-f+2,2*(e-2),f-4);a.fillStyle="#1f375d";a.fillRect(-e+2,-f+2,this.readys*k,f-4);a.setTransform(1,0,0,1,0,0)};var g=function(a,c){var f=document.createElement("canvas");f.width=a;f.height=c;var e=f.getContext("2d");e.save();e.strokeStyle="#1f375d";e.fillStyle="#1f375d";e.lineCap="round";e.lineWidth=2;e.beginPath();d=a<c?a/360:
c/195;d=2.5<d?2.5:d;e.translate((a-120*d)/2,(c-65*d)/2);e.scale(d,d);e.moveTo(3,25);e.lineTo(3,1);e.lineTo(21,1);e.bezierCurveTo(33,1,41,15,41,25);e.stroke();e.beginPath();e.moveTo(1,63);e.lineTo(1,64);e.moveTo(5,62);e.lineTo(5,64);e.moveTo(9,61);e.lineTo(9,64);e.moveTo(13,60);e.lineTo(13,64);e.moveTo(17,58);e.lineTo(17,64);e.moveTo(21,56);e.lineTo(21,64);e.moveTo(25,53);e.lineTo(25,64);e.moveTo(29,50);e.lineTo(29,64);e.moveTo(33,46);e.lineTo(33,64);e.moveTo(37,41);e.lineTo(37,64);e.moveTo(41,32);
e.lineTo(41,64);e.stroke();e.font="20px Arial, Helvetica, 'Droid Sans', Sans-serif";e.fillText("escartes",45,33);e.fillText("JS",98,64);e.restore();return f.toDataURL()};return a}(descartesJS||{}),descartesJS=function(a){function d(a){for(var c="[",k=0,g=a.length;k<g;k++){if(a[k]instanceof Array)c+=d(a[k]);else{e=a[k];if("undefined"==typeof e||!e)e=0;"string"==typeof e&&(e="'"+e+"'");c+=e}k<g-1&&(c+=",")}return c+"]"}if(a.loadLib)return a;a.DescartesApp=function(d){this.applet=d;this.parentContainer=
d.parentNode;this.width=parseFloat(d.getAttribute("width"));this.height=parseFloat(d.getAttribute("height"));this.decimal_symbol=".";this.children=d.getElementsByTagName("param");this.code=d.getAttribute("code");this.saveState=[];this.images={};this.images.length=-1;this.audios={};this.audios.length=-1;this.evaluator=new a.Evaluator(this);this.lessonParser=new a.LessonParser(this);this.firstRun=!0;this.arquimedes=!!this.code.match("descinst.DescartesWeb2_0.class")||!!this.code.match("descinst.Arquimedes.class");
this.licenseW2="{\\rtf1\\uc0{\\fonttbl\\f0\\fcharset0 Arial;\\f1\\fcharset0 Arial;\\f2\\fcharset0 Arial;\\f3\\fcharset0 Arial;\\f4\\fcharset0 Arial;}{\\f0\\fs34 __________________________________________________________________________________ \\par \\fs22                                        Los contenidos de esta unidad did\u00e1ctica interactiva est\u00e1n bajo una  {\\*\\hyperlink licencia Creative Commons|http://creativecommons.org/licenses/by-nc-sa/2.5/es/}, si no se indica lo contrario.\\par                                        La unidad did\u00e1ctica fue creada con DescartesWeb2.0, que es un producto de c\u00f3digo abierto del  {\\*\\hyperlink Ministerio de Educaci\u00f3n de Espa\u00f1a|http://recursostic.educacion.es/descartes/web/DescartesWeb2.0/} y\\par                                        el {\\*\\hyperlink Instituto de Matem\u00e1ticas|http://arquimedes.matem.unam.mx/} de la Universidad Nacional Aut\u00f3noma de M\u00e9xico, cedido bajo licencia {\\*\\hyperlink EUPL v 1.1|/resources/eupl_v1.1es.pdf}, con {\\*\\hyperlink c\u00f3digo en Java|http://recursostic.educacion.es/descartes/web/source/}.}";
this.licenseA="{\\rtf1\\uc0{\\fonttbl\\f0\\fcharset0 Arial;\\f1\\fcharset0 Arial;\\f2\\fcharset0 Arial;\\f3\\fcharset0 Arial;\\f4\\fcharset0 Arial;}{\\f0\\fs34 __________________________________________________________________________________ \\par \\fs22                                        Los contenidos de esta unidad did\u00e1ctica interactiva est\u00e1n bajo una  {\\*\\hyperlink licencia Creative Commons|http://creativecommons.org/licenses/by-nc-sa/2.5/es/}, si no se indica lo contrario.\\par                                        La unidad did\u00e1ctica fue creada con Arqu\u00edmedes, que es un producto de c\u00f3digo abierto del  {\\*\\hyperlink Ministerio de Educaci\u00f3n de Espa\u00f1a|http://recursostic.educacion.es/descartes/web/DescartesWeb2.0/} y\\par                                        el {\\*\\hyperlink Instituto de Matem\u00e1ticas|http://arquimedes.matem.unam.mx/} de la Universidad Nacional Aut\u00f3noma de M\u00e9xico, cedido bajo licencia {\\*\\hyperlink EUPL v 1.1|/resources/eupl_v1.1es.pdf}, con {\\*\\hyperlink c\u00f3digo en Java|http://recursostic.educacion.es/descartes/web/source/}.}";
d=this.children;for(var c,e=0,g=0,l=0,n=d.length;l<n;l++)c=d[l],"rtf_height"==c.name&&(e=parseInt(c.value)),"Buttons"==babel[c.name]&&(this.buttonsConfig=this.lessonParser.parseButtonsConfig(c.value),g=this.buttonsConfig.height),"image_loader"==c.name&&(this.image_loader=c.value);this.arquimedes&&e&&(this.height=e+g+70);this.init()};a.DescartesApp.prototype.init=function(){this.spaces=[];this.externalSpace={container:document.createElement("div"),controls:[]};this.northSpace={container:document.createElement("div"),
controls:[]};this.southSpace={container:document.createElement("div"),controls:[]};this.eastSpace={container:document.createElement("div"),controls:[]};this.westSpace={container:document.createElement("div"),controls:[]};this.specialSpace={container:document.createElement("div"),controls:[]};this.editableRegion={container:document.createElement("div"),textFields:[]};this.controls=[];this.auxiliaries=[];this.events=[];this.numberOfIframes=this.plecaHeight=this.tabindex=this.zIndex=0;void 0!=this.container&&
this.parentContainer.removeChild(this.container);this.container=document.createElement("div");this.loader=document.createElement("div");this.parentContainer.appendChild(this.container);this.container.width=this.width;this.container.height=this.height;this.container.setAttribute("class","DescartesAppContainer");this.container.setAttribute("style","width:"+this.width+"px; height:"+this.height+"px;");this.container.appendChild(this.loader);this.loader.width=this.width;this.loader.height=this.height;
this.loader.setAttribute("class","DescartesLoader");this.loader.setAttribute("style","width:"+this.width+"px; height:"+this.height+"px; z-index:1000;");this.firstRun?this.descartesLoader=new a.DescartesLoader(this):this.initBuildApp()};a.DescartesApp.prototype.initBuildApp=function(){for(var a=this.children,c=this.lessonParser,d=[],e=[],l=[],n=[],q=[],h=[],r,u=0,p=a.length;u<p;u++)if(r=a[u],"pleca"==r.name)r=c.parsePleca(r.value,this.width),this.container.insertBefore(r,this.loader),this.plecaHeight=
r.imageHeight?r.imageHeight:r.offsetHeight;else if("Buttons"==babel[r.name])this.buttonsConfig=c.parseButtonsConfig(r.value);else if("decimal_symbol"==babel[r.name])this.decimal_symbol=r.value;else if("version"==babel[r.name])this.version=parseInt(r.value);else if("language"==babel[r.name])this.language=r.value;else if("rtf"==r.name){var m=parseInt(this.height)-this.plecaHeight-this.buttonsConfig.height-45;n.push("space='descartesJS_scenario' type='text' expresion='[10,20]' background='yes' text='"+
r.value.replace(/'/g,"&squot;")+"'");n.push("space='descartesJS_scenario' type='text' expresion='[10,"+(m-25)+"]' background='yes' text='"+this.licenseA+"'");n.push("space='descartesJS_scenario' type='image' expresion='[15,"+m+"]' background='yes' abs_coord='yes' file='lib/DescartesCCLicense.png'")}else"E"==r.name.charAt(0)?(r.value.match(/'HTMLIFrame'/)&&this.numberOfIframes++,d.push(r.value)):"C"==r.name.charAt(0)&&"_"==r.name.charAt(1)?e.push(r.value):"A"==r.name.charAt(0)&&"_"==r.name.charAt(1)?
l.push(r.value):"G"==r.name.charAt(0)?n.push(r.value):"S"==r.name.charAt(0)?q.push(r.value):"Animation"==babel[r.name]&&h.push(r.value);this.scenarioRegion={container:document.createElement("div"),scroll:0};this.scenarioRegion.container.setAttribute("id","descartesJS_Scenario_Region");this.scenarioRegion.scenarioSpace=this.lessonParser.parseSpace("tipo='R2' id='descartesJS_scenario' fondo='blanco' x='0' y='0' fijo='yes' red='no' red10='no' ejes='no' text='no' ancho='"+this.width+"' alto='"+this.height+
"'");this.scenarioRegion.container.appendChild(this.scenarioRegion.scenarioSpace.container);this.arquimedes&&(this.container.appendChild(this.scenarioRegion.container),this.spaces.push(this.scenarioRegion.scenarioSpace));u=0;for(p=d.length;u<p;u++)a=c.parseSpace(d[u]),this.arquimedes&&this.scenarioRegion.container.appendChild(a.container),this.spaces.push(a),this.zIndex++;u=0;for(p=n.length;u<p;u++)if(d=c.parseGraphic(n[u]))d.visible&&(this.editableRegionVisible=!0),d.space.addGraph(d);u=0;for(p=
q.length;u<p;u++)(d=c.parse3DGraphic(q[u]))&&d.space.addGraph(d);u=0;for(p=e.length;u<p;u++)this.controls.push(c.parseControl(e[u]));u=0;for(p=l.length;u<p;u++)c.parseAuxiliar(l[u]);u=0;for(p=h.length;u<p;u++)this.animation=c.parseAnimation(h[u]);this.configRegions();this.updateAuxiliaries();u=0;for(p=this.controls.length;u<p;u++)this.controls[u].init();this.updateControls();this.updateSpaces(!0);var s=this;this.numberOfIframes?setTimeout(function(){s.finishInit()},300*this.numberOfIframes):this.finishInit()};
a.DescartesApp.prototype.finishInit=function(){this.update();this.loader.style.display="none";this.parentContainer.style.overflow="hidden";window.parent!==window&&(this.parentContainer.style.margin="0px",this.parentContainer.style.padding="0px",window.parent.postMessage({type:"reportSize",href:window.location.href,width:this.width,height:this.height},"*"),window.parent.postMessage({type:"ready"},"*"))};a.DescartesApp.prototype.configRegions=function(){var d=this.evaluator.parser,c=this.buttonsConfig,
e=this.container;if(2!=this.version)var g="15",l=100,n=100,q=100,h=100;else g="14",l=63,n=50,q=44,h=53;var r=0,u=0,p=0,m=p=0,s=0,t=0,v=0,w=0,t=this.northSpace.controls,B=this.southSpace.controls,E=this.eastSpace.controls,C=this.westSpace.controls;if(0<c.rowsNorth||0<t.length||c.about||c.config){0>=c.rowsNorth?(r=c.height,c.rowsNorth=1):r=c.height*c.rowsNorth;var y=this.northSpace.container;y.setAttribute("id","descartesJS_northRegion");y.setAttribute("style","width:"+e.width+"px; height:"+r+"px; background:#c0c0c0; position:absolute; left:0px; top:0px; z-index:100;");
e.insertBefore(y,this.loader);var s=e.width,D=0;c.about&&(D=l,s-=D);c.config&&(s-=n);for(var y=Math.ceil(t.length/c.rowsNorth),z=s/y,p=0,G=t.length;p<G;p++)t[p].expresion=d.parse("("+(D+z*(p%y))+","+c.height*Math.floor(p/y)+","+z+","+c.height+")"),t[p].drawif=d.parse("1");if(c.about){var A;"espa\u00f1ol"==this.language?A="cr\u00e9ditos":"english"==this.language&&(A="about");new a.Button(this,{region:"north",name:A,font_size:d.parse(g),expresion:d.parse("(0, 0, "+l+", "+r+")")})}c.config&&(A="config",
new a.Button(this,{region:"north",name:A,font_size:d.parse(g),action:"config",expresion:d.parse("("+(s+l)+", 0, "+n+", "+r+")")}))}if(0<c.rowsSouth||0<B.length||c.init||c.clear){0>=c.rowsSouth?(u=c.height,c.rowsSouth=1):u=c.height*c.rowsSouth;t=e.width;D=0;c.init&&(D=q,t-=D);c.clear&&(t-=h);y=this.southSpace.container;y.setAttribute("id","descartesJS_southRegion");y.setAttribute("style","width:"+e.width+"px; height:"+u+"px; background:#c0c0c0; position:absolute; left: 0px; top:"+(e.height-u)+"px; z-index:100;");
e.insertBefore(y,this.loader);y=Math.ceil(B.length/c.rowsSouth);z=t/y;p=0;for(G=B.length;p<G;p++)B[p].expresion=d.parse("("+(D+z*(p%y))+","+c.height*Math.floor(p/y)+","+z+","+c.height+")"),B[p].drawif=d.parse("1");c.init&&("espa\u00f1ol"==this.language?A="inicio":"english"==this.language&&(A="init"),new a.Button(this,{region:"south",name:A,font_size:d.parse(g),action:"init",expresion:d.parse("(0, 0, "+q+", "+u+")")}));c.clear&&("espa\u00f1ol"==this.language?A="limpiar":"english"==this.language&&(A=
"clear"),new a.Button(this,{region:"south",name:A,font_size:d.parse(g),action:"clear",expresion:d.parse("("+(t+q)+", 0, "+h+", "+u+")")}))}if(0<E.length){p=e.height-r-u;v=c.widthEast;y=this.eastSpace.container;y.setAttribute("id","descartesJS_eastRegion");y.setAttribute("style","width:"+v+"px; height:"+p+"px; background:#c0c0c0; position:absolute; left:"+(e.width-v)+"px; top:"+r+"px; z-index:100;");e.insertBefore(y,this.loader);p=0;for(G=E.length;p<G;p++)E[p].expresion=d.parse("(0,"+c.height*p+","+
v+","+c.height+")"),E[p].drawif=d.parse("1")}if(0<C.length){p=e.height-r-u;w=c.widthWest;y=this.westSpace.container;y.setAttribute("id","descartesJS_westRegion");y.setAttribute("style","width: "+w+"px; height: "+p+"px; background: #c0c0c0; position: absolute; left: 0px; top: "+r+"px; z-index: 100;");e.insertBefore(y,this.loader);p=0;for(G=C.length;p<G;p++)C[p].expresion=d.parse("(0,"+c.height*p+","+w+","+c.height+")"),C[p].drawif=d.parse("1")}if(this.editableRegionVisible){m=c.height;y=this.editableRegion.container;
y.setAttribute("id","descartesJS_editableRegion");y.setAttribute("style","width:"+e.width+"px; height:"+m+"px; position:absolute; left:0px; top:"+(e.height-u-c.height)+"px; z-index:100; background:#c0c0c0; overflow:hidden;");e.insertBefore(y,this.loader);d=this.editableRegion.textFields;c=e.width/d.length;g=a.getFieldFontSize(m);p=0;for(G=d.length;p<G;p++)"div"==d[p].type?(y.appendChild(d[p].container),d[p].container.setAttribute("style","font-family: Arial, Helvetica, 'Droid Sans', Sans-serif; width: "+
(c-4)+"px; height: "+m+"px; position: absolute; left: "+p*c+"px; top: 0px;"),l=d[p].container.firstChild,l.setAttribute("style","font-family: Arial, Helvetica, 'Droid Sans', Sans-serif; font-size: "+g+"px; padding-top: 0%; background-color: #e0e4e8; position: absolute; left: 0px; top: 0px; height:"+m+"px; text-align: center; line-height: "+m+"px;"),n=l.offsetWidth,l.style.width=n+"px",l.firstChild.textContent=l.firstChild.textContent.substring(3,l.firstChild.textContent.length-3),d[p].container.lastChild.setAttribute("style",
"font-family:'Courier New', Courier, 'Droid Sans Mono', Monospace; font-size: "+g+"px; width:"+(c-n)+"px; height:"+m+"px; position:absolute; left:"+n+"px; top:0px; border:2px groove white;")):(y.appendChild(d[p]),d[p].setAttribute("style","font-family:'Courier New', Courier, 'Droid Sans Mono', Monospace; font-size: "+g+"px; width:"+c+"px; height:"+m+"px; position:absolute; left:"+p*c+"px; top:0px; border:2px groove white;"))}this.displaceRegionNorth=r;this.displaceRegionWest=w;e.width-=v;e.height=
e.height-u-m;p=0;for(G=this.spaces.length;p<G;p++)this.spaces[p].init()};a.DescartesApp.prototype.update=function(){this.updateAuxiliaries();this.updateEvents();this.updateControls();this.updateSpaces()};a.DescartesApp.prototype.deactivateGraphiControls=function(){for(var a,c=0,d=this.controls.length;c<d;c++)a=this.controls[c],"graphic"==a.type&&a.deactivate()};a.DescartesApp.prototype.updateAuxiliaries=function(){for(var a=0,c=this.auxiliaries.length;a<c;a++)this.auxiliaries[a].update()};a.DescartesApp.prototype.updateEvents=
function(){for(var a=0,c=this.events.length;a<c;a++)this.events[a].update()};a.DescartesApp.prototype.updateControls=function(){for(var a=0,c=this.controls.length;a<c;a++)this.controls[a].update()};a.DescartesApp.prototype.updateSpaces=function(a){for(var c=0,d=this.spaces.length;c<d;c++)this.spaces[c].update(a)};a.DescartesApp.prototype.clear=function(){for(var a=0,c=this.spaces.length;a<c;a++)this.spaces[a].spaceChange=!0,this.spaces[a].drawBackground()};a.DescartesApp.prototype.play=function(){this.animation&&
this.animation.play()};a.DescartesApp.prototype.stop=function(){this.animation&&this.animation.stop()};a.DescartesApp.prototype.reinitAnimation=function(){this.animation&&this.animation.reinit()};a.DescartesApp.prototype.stopAudios=function(){this.stop();for(var a in this.audios)this.audios.hasOwnProperty(a)&&this.audios[a].pause&&(this.audios[a].pause(),this.audios[a].currentTime=0)};a.DescartesApp.prototype.getImage=function(a){var c=this.images;if(a)return c[a]||(c[a]=new Image,c[a].addEventListener("load",
function(){this.ready=1}),c[a].addEventListener("error",function(){this.errorload=1}),c[a].src=a),c[a]};a.DescartesApp.prototype.getAudio=function(a){var c=this.audios;if(a){if(c[a])return c[a];a=file.lastIndexOf(".");a=-1===a?file.lenght:a;a=file.substring(0,a);var d=new Audio;d.setAttribute("preload","auto");var e=function(){this.ready=1};d.addEventListener("canplaythrough",e);d.addEventListener("load",e);d.addEventListener("error",function(){console.log("El archivo '"+file+"' no puede ser reproducido");
this.errorload=1});d.canPlayType("audio/mpeg")&&(e=document.createElement("source"),e.setAttribute("src",a+".mp3"),e.setAttribute("type","audio/mpeg"),d.appendChild(e));d.canPlayType("audio/ogg")&&(e=document.createElement("source"),e.setAttribute("src",a+".ogg"),e.setAttribute("type","audio/ogg"),d.appendChild(e),e=document.createElement("source"),e.setAttribute("src",a+".oga"),e.setAttribute("type","audio/ogg"),d.appendChild(e));d.canPlayType("audio/wav")&&(e=document.createElement("source"),e.setAttribute("src",
a+".wav"),e.setAttribute("type","audio/wav"),d.appendChild(e));d.load();d.play();d.pause();c[file]=d}else return new Audio};a.DescartesApp.prototype.getControlByCId=function(a){for(var c,d=0,e=this.controls.length;d<e;d++)if(c=this.controls[d],c.cID==a)return c;return{update:function(){},w:0}};a.DescartesApp.prototype.getControlById=function(a){for(var c,d=0,e=this.controls.length;d<e;d++)if(c=this.controls[d],c.id==a)return c;return{update:function(){}}};a.DescartesApp.prototype.getSpaceByCId=function(a){for(var c,
d=0,e=this.spaces.length;d<e;d++)if(c=this.spaces[d],c.cID==a)return c;return{update:function(){},w:0}};a.DescartesApp.prototype.getSpaceById=function(a){for(var c,d=0,e=this.spaces.length;d<e;d++)if(c=this.spaces[d],c.id==a)return c;return{update:function(){},w:0}};var e;a.DescartesApp.prototype.getState=function(){var a,c="",e=this.evaluator.variables,g;for(g in e)e.hasOwnProperty(g)&&(a=e[g],"string"==typeof a&&(a="'"+a+"'"),void 0!=a&&("rnd"!=g&&"pi"!=g&&"e"!=g&&"Infinity"!=g&&"-Infinity"!=g&&
"object"!=typeof a)&&(c=""!=c?c+"\n"+g+"="+a:g+"="+a));var e=this.evaluator.vectors,l;for(l in e)e.hasOwnProperty(l)&&(a=e[l],c=c+"\n"+l+"="+d(a));l=this.evaluator.matrices;for(var n in l)l.hasOwnProperty(n)&&(a=l[n],c=c+"\n"+n+"="+d(a));return c};a.DescartesApp.prototype.setState=function(a){a=a.split("\n");for(var c,d,e=0,l=a.length;e<l;e++)c=a[e].split("="),2<=c.length&&(d=eval(c[1]),-1!=c[1].indexOf("[[")?(this.evaluator.matrices[c[0]]=d,this.evaluator.matrices[c[0]].rows=d.length,this.evaluator.matrices[c[0]].cols=
d[0].length):-1!=c[1].indexOf("[")?(this.evaluator.vectors[c[0]]=d,this.evaluator.variables[c[0]+".long"]=d.length):this.evaluator.variables[c[0]]=d),this.update()};a.DescartesApp.prototype.getEvaluation=function(){for(var a=0,c=0,d="",e=0,l=this.controls.length;e<l;e++)"textfield"==this.controls[e].gui&&this.controls[e].evaluate&&(a++,c+=this.controls[e].ok,this.controls[e].value=""==this.controls[e].value?"''":this.controls[e].value,d+=" \\n "+this.controls[e].id+"="+this.controls[e].value+"|"+
this.controls[e].ok);return"questions="+a+" \\n correct="+c+" \\n wrong="+(a-c)+d};a.DescartesApp.prototype.showSolution=function(){for(var a=this.controls,c=0,d=a.length;c<d;c++)"textfield"==a[c].gui&&a[c].evaluate&&a[c].changeValue(a[c].getFirstAnswer());this.update()};a.DescartesApp.prototype.showAnswer=function(){for(var a=0,c=this.saveState.length;a<c;a++)this.evaluator.evalExpression(this.saveState[a]);this.update()};return a}(descartesJS||{}),descartesJS=function(a){function d(){for(var c=
document.getElementsByTagName("applet"),d,e=[],f=0,h=c.length;f<h;f++)d=c[f],(d.getAttribute("code").match("DescartesJS")||d.getAttribute("code").match("Descartes.class")||d.getAttribute("code").match("descinst.DescartesWeb2_0.class")||d.getAttribute("code").match("descinst.Arquimedes.class"))&&e.push(d);c=0;for(d=e.length;c<d;c++)a.apps.push(new a.DescartesApp(e[c])),e[c].className="DescartesJS"}function e(){var a=document.getElementById("StyleDescartesApps");a&&a.parentNode.removeChild(a);a=document.createElement("style");
a.id="StyleDescartesApps";a.type="text/css";a.setAttribute("rel","stylesheet");a.innerHTML="applet.DescartesJS {display:none;} applet {display:none;}";document.head.appendChild(a)}function f(){for(var a=document.getElementsByTagName("*"),c=[],d=0,e=a.length;d<e;d++)"DescartesAppContainer"==a[d].className&&c.push(a[d]);d=0;for(e=c.length;d<e;d++)c[d].parentNode.removeChild(c[d])}function c(c){for(var d=0,e=a.apps.length;d<e;d++){c=a.apps[d].spaces;for(var f=0,h=c.length;f<h;f++)c[f].findOffset()}}
function k(e){a.getFeatures();a.hasCanvasSupport?(f(),d(),document.getElementById("StyleDescartesApps").innerHTML="applet.DescartesJS {display:none;}",window.addEventListener("resize",c),setTimeout(function(){window.scrollTo(0,1)},1)):document.getElementById("StyleDescartesApps").innerHTML="applet {display:block;}"}a.apps=[];a.getDescartesApps=function(){return a.apps};(!window.hasOwnProperty("debugDescartesJS")||!debugDescartesJS)&&e();a.receiveMessage=function(c){if(0<a.apps.length&&(c=c.data))if("set"===
c.type)a.apps[0].evaluator.setVariable(c.name,c.value);else if("update"===c.type)a.apps[0].update();else if("exec"===c.type){var d=a.apps[0].evaluator.getFunction(c.name),e=[];""!==c.value&&(e=c.value.toString().split(","));d&&d.apply(a.apps[0].evaluator,e)}};void 0===a.loadLib&&(a.loadLib=!0,window.addEventListener("load",k),window.addEventListener("message",a.receiveMessage));return a}(descartesJS||{});
